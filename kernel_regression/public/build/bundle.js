var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function c(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function m(){return f(" ")}function d(){return f("")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function w(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function b(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let $,_;function M(){if(void 0===$){$=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){$=!0}}return $}function T(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=u("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=M();let i;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=p(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=p(n.contentWindow,"resize",e)}),o(t,n),()=>{(r||i&&n.contentWindow)&&i(),h(n)}}class E{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.e=u(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)s(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(h)}}function k(t){_=t}function R(t){(function(){if(!_)throw new Error("Function called outside component initialization");return _})().$$.on_mount.push(t)}const A=[],S=[],C=[],j=[],N=Promise.resolve();let I=!1;function X(t){C.push(t)}let V=!1;const B=new Set;function P(){if(!V){V=!0;do{for(let t=0;t<A.length;t+=1){const e=A[t];k(e),L(e.$$)}for(k(null),A.length=0;S.length;)S.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];B.has(e)||(B.add(e),e())}C.length=0}while(A.length);for(;j.length;)j.pop()();I=!1,V=!1,B.clear()}}function L(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}const U=new Set;function F(t,e){t&&t.i&&(U.delete(t),t.i(e))}function z(t,e,n,r){if(t&&t.o){if(U.has(t))return;U.add(t),undefined.c.push((()=>{U.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function q(t){t&&t.c()}function D(t,n,a,o){const{fragment:s,on_mount:h,on_destroy:l,after_update:u}=t.$$;s&&s.m(n,a),o||X((()=>{const n=h.map(e).filter(i);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(X)}function H(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function O(t,e){-1===t.$$.dirty[0]&&(A.push(t),I||(I=!0,N.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(e,i,a,o,s,l,u,c=[-1]){const f=_;k(e);const m=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:i.context||[]),callbacks:n(),dirty:c,skip_bound:!1,root:i.target||f.$$.root};u&&u(m.root);let d=!1;if(m.ctx=a?a(e,i.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return m.ctx&&s(m.ctx[t],m.ctx[t]=i)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](i),d&&O(e,t)),n})):[],m.update(),d=!0,r(m.before_update),m.fragment=!!o&&o(m.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);m.fragment&&m.fragment.l(t),t.forEach(h)}else m.fragment&&m.fragment.c();i.intro&&F(e.$$.fragment),D(e,i.target,i.anchor,i.customElement),P()}k(f)}class K{$destroy(){H(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const W=[];function Y(e,n=t){let r;const i=new Set;function o(t){if(a(e,t)&&(e=t,r)){const t=!W.length;for(const t of i)t[1](),W.push(t,e);if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(a,s=t){const h=[a,s];return i.add(h),1===i.size&&(r=n(o)||t),a(e),()=>{i.delete(h),0===i.size&&(r(),r=null)}}}}const Q=Object.prototype.toString;function J(t){return Q.call(t).endsWith("Array]")}function Z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,a=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>t.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[r],s=r+1;s<a;s++)t[s]>o&&(o=t[s]);return o}function tt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,a=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(a<=r||a>t.length||!Number.isInteger(a))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[r],s=r+1;s<a;s++)t[s]<o&&(o=t[s]);return o}function et(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!J(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=tt(t),i=Z(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=n.min,o=void 0===a?n.autoMinMax?r:0:a,s=n.max,h=void 0===s?n.autoMinMax?i:1:s;if(o>=h)throw new RangeError("min option must be smaller than max option");for(var l=(h-o)/(i-r),u=0;u<t.length;u++)e[u]=(t[u]-r)*l+o;return e}class nt{constructor(t){var e,n,r,i,a,o,s,h,l,u=(t=At.checkMatrix(t)).clone(),c=u.rows,f=u.columns,m=new Array(c),d=1;for(e=0;e<c;e++)m[e]=e;for(h=new Array(c),n=0;n<f;n++){for(e=0;e<c;e++)h[e]=u.get(e,n);for(e=0;e<c;e++){for(l=Math.min(e,n),a=0,r=0;r<l;r++)a+=u.get(e,r)*h[r];h[e]-=a,u.set(e,n,h[e])}for(i=n,e=n+1;e<c;e++)Math.abs(h[e])>Math.abs(h[i])&&(i=e);if(i!==n){for(r=0;r<f;r++)o=u.get(i,r),u.set(i,r,u.get(n,r)),u.set(n,r,o);s=m[i],m[i]=m[n],m[n]=s,d=-d}if(n<c&&0!==u.get(n,n))for(e=n+1;e<c;e++)u.set(e,n,u.get(e,n)/u.get(n,n))}this.LU=u,this.pivotVector=m,this.pivotSign=d}isSingular(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1}solve(t){t=Rt.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,a=t.columns,o=t.subMatrixRow(this.pivotVector,0,a-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<a;r++)o[n][r]-=o[i][r]*e[n][i];for(i=s-1;i>=0;i--){for(r=0;r<a;r++)o[i][r]/=e[i][i];for(n=0;n<i;n++)for(r=0;r<a;r++)o[n][r]-=o[i][r]*e[n][i]}return o}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new Rt(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)r[i][a]=i>a?t[i][a]:i===a?1:0;return r}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new Rt(e,n),i=0;i<e;i++)for(var a=0;a<n;a++)r[i][a]=i<=a?t[i][a]:0;return r}get pivotPermutationVector(){return this.pivotVector.slice()}}function rt(t,e){var n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}function it(t,e,n){for(var r=new Array(t),i=0;i<t;i++){r[i]=new Array(e);for(var a=0;a<e;a++)r[i][a]=n}return r}class at{constructor(t,e={}){var n=(t=At.checkMatrix(t)).rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:a=!0,autoTranspose:o=!1}=e;var s,h=Boolean(i),l=Boolean(a),u=!1;if(n<r)if(o){n=(s=t.transpose()).rows,r=s.columns,u=!0;var c=h;h=l,l=c}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();var f=Math.min(n,r),m=Math.min(n+1,r),d=new Array(m),p=it(n,f,0),g=it(r,r,0),v=new Array(r),w=new Array(n),y=new Array(m);for(let t=0;t<m;t++)y[t]=t;var x=Math.min(n-1,r),b=Math.max(0,Math.min(r-2,n)),$=Math.max(x,b);for(let t=0;t<$;t++){if(t<x){d[t]=0;for(let e=t;e<n;e++)d[t]=rt(d[t],s[e][t]);if(0!==d[t]){s[t][t]<0&&(d[t]=-d[t]);for(let e=t;e<n;e++)s[e][t]/=d[t];s[t][t]+=1}d[t]=-d[t]}for(let e=t+1;e<r;e++){if(t<x&&0!==d[t]){let r=0;for(let i=t;i<n;i++)r+=s[i][t]*s[i][e];r=-r/s[t][t];for(let i=t;i<n;i++)s[i][e]+=r*s[i][t]}v[e]=s[t][e]}if(h&&t<x)for(let e=t;e<n;e++)p[e][t]=s[e][t];if(t<b){v[t]=0;for(let e=t+1;e<r;e++)v[t]=rt(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<r;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<n&&0!==v[t]){for(let e=t+1;e<n;e++)w[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)w[e]+=v[n]*s[e][n];for(let e=t+1;e<r;e++){let r=-v[e]/v[t+1];for(let i=t+1;i<n;i++)s[i][e]+=r*w[i]}}if(l)for(let e=t+1;e<r;e++)g[e][t]=v[e]}}let _=Math.min(r,n+1);if(x<r&&(d[x]=s[x][x]),n<_&&(d[_-1]=0),b+1<_&&(v[b]=s[b][_-1]),v[_-1]=0,h){for(let t=x;t<f;t++){for(let e=0;e<n;e++)p[e][t]=0;p[t][t]=1}for(let t=x-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<f;e++){let r=0;for(let i=t;i<n;i++)r+=p[i][t]*p[i][e];r=-r/p[t][t];for(let i=t;i<n;i++)p[i][e]+=r*p[i][t]}for(let e=t;e<n;e++)p[e][t]=-p[e][t];p[t][t]=1+p[t][t];for(let e=0;e<t-1;e++)p[e][t]=0}else{for(let e=0;e<n;e++)p[e][t]=0;p[t][t]=1}}if(l)for(let t=r-1;t>=0;t--){if(t<b&&0!==v[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=g[i][t]*g[i][e];n=-n/g[t+1][t];for(let i=t+1;i<r;i++)g[i][e]+=n*g[i][t]}for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}for(var M=_-1,T=Number.EPSILON;_>0;){let t,e;for(t=_-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+T*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===_-2)e=4;else{let n;for(n=_-1;n>=t&&n!==t;n--){let e=(n!==_?Math.abs(v[n]):0)+(n!==t+1?Math.abs(v[n-1]):0);if(Math.abs(d[n])<=T*e){d[n]=0;break}}n===t?e=3:n===_-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=v[_-2];v[_-2]=0;for(let n=_-2;n>=t;n--){let i=rt(d[n],e),a=d[n]/i,o=e/i;if(d[n]=i,n!==t&&(e=-o*v[n-1],v[n-1]=a*v[n-1]),l)for(let t=0;t<r;t++)i=a*g[t][n]+o*g[t][_-1],g[t][_-1]=-o*g[t][n]+a*g[t][_-1],g[t][n]=i}break}case 2:{let e=v[t-1];v[t-1]=0;for(let r=t;r<_;r++){let i=rt(d[r],e),a=d[r]/i,o=e/i;if(d[r]=i,e=-o*v[r],v[r]=a*v[r],h)for(let e=0;e<n;e++)i=a*p[e][r]+o*p[e][t-1],p[e][t-1]=-o*p[e][r]+a*p[e][t-1],p[e][r]=i}break}case 3:{const e=Math.max(Math.abs(d[_-1]),Math.abs(d[_-2]),Math.abs(v[_-2]),Math.abs(d[t]),Math.abs(v[t])),i=d[_-1]/e,a=d[_-2]/e,o=v[_-2]/e,s=d[t]/e,u=v[t]/e,c=((a+i)*(a-i)+o*o)/2,f=i*o*(i*o);let m=0;0===c&&0===f||(m=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),m=f/(c+m));let w=(s+i)*(s-i)+m,y=s*u;for(let e=t;e<_-1;e++){let i=rt(w,y);0===i&&(i=Number.MIN_VALUE);let a=w/i,o=y/i;if(e!==t&&(v[e-1]=i),w=a*d[e]+o*v[e],v[e]=a*v[e]-o*d[e],y=o*d[e+1],d[e+1]=a*d[e+1],l)for(let t=0;t<r;t++)i=a*g[t][e]+o*g[t][e+1],g[t][e+1]=-o*g[t][e]+a*g[t][e+1],g[t][e]=i;if(i=rt(w,y),0===i&&(i=Number.MIN_VALUE),a=w/i,o=y/i,d[e]=i,w=a*v[e]+o*d[e+1],d[e+1]=-o*v[e]+a*d[e+1],y=o*v[e+1],v[e+1]=a*v[e+1],h&&e<n-1)for(let t=0;t<n;t++)i=a*p[t][e]+o*p[t][e+1],p[t][e+1]=-o*p[t][e]+a*p[t][e+1],p[t][e]=i}v[_-2]=w;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,l))for(let e=0;e<=M;e++)g[e][t]=-g[e][t];for(;t<M&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,l&&t<r-1)for(let n=0;n<r;n++)e=g[n][t+1],g[n][t+1]=g[n][t],g[n][t]=e;if(h&&t<n-1)for(let r=0;r<n;r++)e=p[r][t+1],p[r][t+1]=p[r][t],p[r][t]=e;t++}_--}}if(u){var E=g;g=p,p=E}this.m=n,this.n=r,this.s=d,this.U=p,this.V=g}solve(t){var e=t,n=this.threshold,r=this.s.length,i=Rt.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i[t][t]=0:i[t][t]=1/this.s[t];var a=this.U,o=this.rightSingularVectors,s=o.mmul(i),h=o.rows,l=a.length,u=Rt.zeros(h,l);for(let t=0;t<h;t++)for(let e=0;e<l;e++){let n=0;for(let i=0;i<r;i++)n+=s[t][i]*a[e][i];u[t][e]=n}return u.mmul(e)}solveForDiagonal(t){return this.solve(Rt.diag(t))}inverse(){var t=this.V,e=this.threshold,n=t.length,r=t[0].length,i=new Rt(n,this.s.length);for(let a=0;a<n;a++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e?i[a][n]=t[a][n]/this.s[n]:i[a][n]=0;var a=this.U,o=a.length,s=a[0].length,h=new Rt(n,o);for(let t=0;t<n;t++)for(let e=0;e<o;e++){let n=0;for(let r=0;r<s;r++)n+=i[t][r]*a[e][r];h[t][e]=n}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return Rt.isMatrix(this.U)||(this.U=new Rt(this.U)),this.U}get rightSingularVectors(){return Rt.isMatrix(this.V)||(this.V=new Rt(this.V)),this.V}get diagonalMatrix(){return Rt.diag(this.s)}}function ot(t,e,n){var r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function st(t,e,n){var r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function ht(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function lt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function ut(t,e,n){return{row:ct(t,e),column:ft(t,n)}}function ct(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function ft(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function mt(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(gt("startRow",e),gt("endRow",n),gt("startColumn",r),gt("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function dt(t){for(var e=Rt.zeros(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(n,0,e.get(n,0)+t.get(n,r));return e}function pt(t){for(var e=Rt.zeros(1,t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(0,r,e.get(0,r)+t.get(n,r));return e}function gt(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class vt extends(kt()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return Rt}}class wt extends vt{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}class yt extends vt{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}class xt extends vt{constructor(t,e,n,r,i){mt(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class bt extends vt{constructor(t,e,n){var r=ut(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class $t extends vt{constructor(t,e){super(t,(e=ct(t,e)).length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class _t extends vt{constructor(t,e){e=ft(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class Mt extends vt{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}class Tt extends vt{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class Et extends vt{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function kt(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)r.set(i,a,n[i*e+a]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var a=0;a<e;a++)r.set(i,a,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),a=0;a<t;a++)for(var o=0;o<e;o++){var s=Math.floor(r()*n);i.set(a,o,s)}return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=Math.min(t,e),i=this.zeros(t,e),a=0;a<r;a++)i.set(a,a,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=Math.min(r,e,n),a=this.zeros(e,n),o=0;o<i;o++)a.set(o,o,t[o]);return a}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.min(t.get(a,o),e.get(a,o)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),a=0;a<n;a++)for(var o=0;o<r;o++)i.set(a,o,Math.max(t.get(a,o),e.get(a,o)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}set(t,e,n){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){ot(this,t);for(var e=new Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){ot(this,t),e=ht(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){ot(this,t),ot(this,e);for(var n=0;n<this.columns;n++){var r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){st(this,t);for(var e=new Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){st(this,t),e=lt(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){st(this,t),st(this,e);for(var n=0;n<this.rows;n++){var r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=ht(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){ot(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){st(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){ot(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){ot(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){ot(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){ot(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){st(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){st(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){st(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){st(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){switch(t){case"row":return dt(this);case"column":return pt(this);default:return function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)e+=this.get(n,r)*this.get(n,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var n=this.to1DArray();if(n.length!==t.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*t[i];return r}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),a=new Array(n),o=0;o<r;o++){for(var s=0;s<n;s++)a[s]=t.get(s,o);for(var h=0;h<e;h++){var l=0;for(s=0;s<n;s++)l+=this.get(h,s)*a[s];i.set(h,o,l)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),a=t.get(0,1),o=this.get(1,0),s=t.get(1,0),h=this.get(1,1),l=t.get(1,1),u=(n+h)*(r+l),c=(o+h)*r,f=n*(a-l),m=h*(s-r),d=(n+i)*l,p=u+m-d+(i-h)*(s+l),g=f+d,v=c+m,w=u-c+f+(o-n)*(r+a);return e.set(0,0,p),e.set(0,1,g),e.set(1,0,v),e.set(1,1,w),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),h=this.get(2,0),l=this.get(2,1),u=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),d=t.get(1,0),p=t.get(1,1),g=t.get(1,2),v=t.get(2,0),w=t.get(2,1),y=t.get(2,2),x=(n-a)*(-f+p),b=(-n+a+o)*(c-f+p),$=(a+o)*(-c+f),_=n*c,M=(-n+h+l)*(c-m+g),T=(-n+h)*(m-g),E=(h+l)*(-c+m),k=(-i+l+u)*(p+v-w),R=(i-u)*(p-w),A=i*v,S=(l+u)*(-v+w),C=(-i+o+s)*(g+v-y),j=(i-s)*(g-y),N=(o+s)*(-v+y),I=_+A+r*d,X=(n+r+i-a-o-l-u)*p+b+$+_+k+A+S,V=_+M+E+(n+r+i-o-s-h-l)*g+A+C+N,B=x+o*(-c+f+d-p-g-v+y)+b+_+A+C+j,P=x+b+$+_+s*w,L=A+C+j+N+a*m,U=_+M+T+l*(-c+m+d-p-g-v+w)+k+R+A,F=k+R+A+S+h*f,z=_+M+T+E+u*y;return e.set(0,0,I),e.set(0,1,X),e.set(0,2,V),e.set(1,0,B),e.set(1,1,P),e.set(1,2,L),e.set(2,0,U),e.set(2,1,F),e.set(2,2,z),e}mmulStrassen(t){var n=this.clone(),r=n.rows,i=n.columns,a=t.rows,o=t.columns;function s(t,n,r){var i=t.rows,a=t.columns;if(i===n&&a===r)return t;var o=e.zeros(n,r);return o=o.setSubMatrix(t,0,0)}i!==a&&console.warn(`Multiplying ${r} x ${i} and ${a} x ${o} matrix: dimensions do not match.`);var h=Math.max(r,a),l=Math.max(i,o);return function t(n,r,i,a){if(i<=512||a<=512)return n.mmul(r);i%2==1&&a%2==1?(n=s(n,i+1,a+1),r=s(r,i+1,a+1)):i%2==1?(n=s(n,i+1,a),r=s(r,i+1,a)):a%2==1&&(n=s(n,i,a+1),r=s(r,i,a+1));var o=parseInt(n.rows/2,10),h=parseInt(n.columns/2,10),l=n.subMatrix(0,o-1,0,h-1),u=r.subMatrix(0,o-1,0,h-1),c=n.subMatrix(0,o-1,h,n.columns-1),f=r.subMatrix(0,o-1,h,r.columns-1),m=n.subMatrix(o,n.rows-1,0,h-1),d=r.subMatrix(o,r.rows-1,0,h-1),p=n.subMatrix(o,n.rows-1,h,n.columns-1),g=r.subMatrix(o,r.rows-1,h,r.columns-1),v=t(e.add(l,p),e.add(u,g),o,h),w=t(e.add(m,p),u,o,h),y=t(l,e.sub(f,g),o,h),x=t(p,e.sub(d,u),o,h),b=t(e.add(l,c),g,o,h),$=t(e.sub(m,l),e.add(u,f),o,h),_=t(e.sub(c,p),e.add(d,g),o,h),M=e.add(v,x);M.sub(b),M.add(_);var T=e.add(y,b),E=e.add(w,x),k=e.sub(v,w);k.add(y),k.add($);var R=e.zeros(2*M.rows,2*M.columns);return(R=(R=(R=(R=R.setSubMatrix(M,0,0)).setSubMatrix(T,M.rows,0)).setSubMatrix(E,0,M.columns)).setSubMatrix(k,M.rows,M.columns)).subMatrix(0,i-1,0,a-1)}(n=s(n,h,l),t=s(t,h,l),h,l)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.rows;r++){var i=et(this.getRow(r),{min:t,max:e});n.setRow(r,i)}return n}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.columns;r++){var i=et(this.getColumn(r),{min:t,max:e});n.setColumn(r,i)}return n}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,a=new this.constructor[Symbol.species](e*r,n*i),o=0;o<e;o++)for(var s=0;s<n;s++)for(var h=0;h<r;h++)for(var l=0;l<i;l++)a[r*o+h][i*s+l]=this.get(o,s)*t.get(h,l);return a}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){mt(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),a=t;a<=e;a++)for(var o=n;o<=r;o++)i[a-t][o-n]=this.get(a,o);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var a=e;a<=n;a++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,a-e,this.get(t[i],a))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var a=e;a<=n;a++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(a-e,i,this.get(a,t[i]))}return r}setSubMatrix(t,e,n){mt(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n=ut(this,t,e),r=new this.constructor[Symbol.species](t.length,e.length),i=0;i<n.row.length;i++)for(var a=n.row[i],o=0;o<n.column.length;o++){var s=n.column[o];r[i][o]=this.get(a,s)}return r}trace(){for(var t=Math.min(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new wt(this)}rowView(t){return ot(this,t),new yt(this,t)}columnView(t){return st(this,t),new Mt(this,t)}flipRowView(){return new Tt(this)}flipColumnView(){return new Et(this)}subMatrixView(t,e,n,r){return new xt(this,t,e,n,r)}selectionView(t,e){return new bt(this,t,e)}rowSelectionView(t){return new $t(this,t)}columnSelectionView(t){return new _t(this,t)}det(){var t,e,n,r,i,a;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),a=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*a.det()):new nt(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new at(this,{autoTranspose:!0}),n=e.leftSingularVectors,r=e.rightSingularVectors,i=e.diagonal,a=0;a<i.length;a++)Math.abs(i[a])>t?i[a]=1/i[a]:i[a]=0;return i=this.constructor[Symbol.species].diag(i),r.mmul(i.mmul(n.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}}function n(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var r,i="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",a=eval;for(var o of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var s=a(M("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:o[1],op:o[0]})),h=a(M("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${o[1]}S`,op:o[0]})),l=a(M("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${o[1]}M`,op:o[0]})),u=a(M("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:o[1]}));for(r=1;r<o.length;r++)e.prototype[o[r]]=s,e.prototype[`${o[r]}S`]=h,e.prototype[`${o[r]}M`]=l,e[o[r]]=u}var c=[["~","not"]];for(var f of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){c.push([`Math.${t}`,t])})),c)){var m=a(M("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:f[1],method:f[0]})),d=a(M("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:f[1]}));for(r=1;r<f.length;r++)e.prototype[f[r]]=m,e[f[r]]=d}for(var p of[["Math.pow",1,"pow"]]){var g="arg0";for(r=1;r<p[1];r++)g+=`, arg${r}`;if(1!==p[1]){var v=a(M("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:p[2],method:p[0],args:g})),w=a(M(i,{name:p[2],args:g}));for(r=2;r<p.length;r++)e.prototype[p[r]]=v,e[p[r]]=w}else{var y={name:p[2],args:g,method:p[0]},x=a(M("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",y)),b=a(M("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",y)),$=a(M("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",y)),_=a(M("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",y));for(r=2;r<p.length;r++)e.prototype[p[r]]=x,e.prototype[`${p[r]}M`]=$,e.prototype[`${p[r]}S`]=b,e[p[r]]=_}}function M(t,e){for(var n in e)t=t.replace(new RegExp(`%${n}%`,"g"),e[n]);return t}return e}class Rt extends(kt(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(Rt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}removeRow(t){if(ot(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),ot(this,t,!0),e=ht(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(st(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),st(this,t,!0),e=lt(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}kt(),Symbol.species;class At extends(kt()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return Rt}}class St{constructor(t){var e,n,r,i,a=(t=At.checkMatrix(t)).clone(),o=t.rows,s=t.columns,h=new Array(s);for(r=0;r<s;r++){var l=0;for(e=r;e<o;e++)l=rt(l,a.get(e,r));if(0!==l){for(a.get(r,r)<0&&(l=-l),e=r;e<o;e++)a.set(e,r,a.get(e,r)/l);for(a.set(r,r,a.get(r,r)+1),n=r+1;n<s;n++){for(i=0,e=r;e<o;e++)i+=a.get(e,r)*a.get(e,n);for(i=-i/a.get(r,r),e=r;e<o;e++)a.set(e,n,a.get(e,n)+i*a.get(e,r))}}h[r]=-l}this.QR=a,this.Rdiag=h}solve(t){t=Rt.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,a,o,s=t.columns,h=t.clone(),l=e.columns;for(a=0;a<l;a++)for(i=0;i<s;i++){for(o=0,r=a;r<n;r++)o+=e[r][a]*h[r][i];for(o=-o/e[a][a],r=a;r<n;r++)h[r][i]+=o*e[r][a]}for(a=l-1;a>=0;a--){for(i=0;i<s;i++)h[a][i]/=this.Rdiag[a];for(r=0;r<a;r++)for(i=0;i<s;i++)h[r][i]-=h[a][i]*e[r][a]}return h.subMatrix(0,l-1,0,s-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,i=new Rt(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)i[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,n,r,i=this.QR,a=i.rows,o=i.columns,s=new Rt(a,o);for(n=o-1;n>=0;n--){for(t=0;t<a;t++)s[t][n]=0;for(s[n][n]=1,e=n;e<o;e++)if(0!==i[n][n]){for(r=0,t=n;t<a;t++)r+=i[t][n]*s[t][e];for(r=-r/i[n][n],t=n;t<a;t++)s[t][e]+=r*i[t][n]}}return s}}function Ct(t,e=!1){return t=At.checkMatrix(t),e?new at(t).inverse():jt(t,Rt.eye(t.rows))}function jt(t,e,n=!1){return t=At.checkMatrix(t),e=At.checkMatrix(e),n?new at(t).solve(e):t.isSquare()?new nt(t).solve(e):new St(t).solve(e)}class Nt{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=At.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var r,i,a=t.columns,o=it(a,a,0),s=new Array(a),h=new Array(a),l=t;if(!!n||t.isSymmetric()){for(r=0;r<a;r++)for(i=0;i<a;i++)o[r][i]=l.get(r,i);!function(t,e,n,r){var i,a,o,s,h,l,u,c;for(h=0;h<t;h++)n[h]=r[t-1][h];for(s=t-1;s>0;s--){for(c=0,o=0,l=0;l<s;l++)c+=Math.abs(n[l]);if(0===c)for(e[s]=n[s-1],h=0;h<s;h++)n[h]=r[s-1][h],r[s][h]=0,r[h][s]=0;else{for(l=0;l<s;l++)n[l]/=c,o+=n[l]*n[l];for(i=n[s-1],a=Math.sqrt(o),i>0&&(a=-a),e[s]=c*a,o-=i*a,n[s-1]=i-a,h=0;h<s;h++)e[h]=0;for(h=0;h<s;h++){for(i=n[h],r[h][s]=i,a=e[h]+r[h][h]*i,l=h+1;l<=s-1;l++)a+=r[l][h]*n[l],e[l]+=r[l][h]*i;e[h]=a}for(i=0,h=0;h<s;h++)e[h]/=o,i+=e[h]*n[h];for(u=i/(o+o),h=0;h<s;h++)e[h]-=u*n[h];for(h=0;h<s;h++){for(i=n[h],a=e[h],l=h;l<=s-1;l++)r[l][h]-=i*e[l]+a*n[l];n[h]=r[s-1][h],r[s][h]=0}}n[s]=o}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(o=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/o;for(h=0;h<=s;h++){for(a=0,l=0;l<=s;l++)a+=r[l][s+1]*r[l][h];for(l=0;l<=s;l++)r[l][h]-=a*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(h=0;h<t;h++)n[h]=r[t-1][h],r[t-1][h]=0;r[t-1][t-1]=1,e[0]=0}(a,h,s,o),function(t,e,n,r){var i,a,o,s,h,l,u,c,f,m,d,p,g,v,w,y;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;var x=0,b=0,$=Number.EPSILON;for(l=0;l<t;l++){for(b=Math.max(b,Math.abs(n[l])+Math.abs(e[l])),u=l;u<t&&!(Math.abs(e[u])<=$*b);)u++;if(u>l)do{for(i=n[l],f=rt(c=(n[l+1]-i)/(2*e[l]),1),c<0&&(f=-f),n[l]=e[l]/(c+f),n[l+1]=e[l]*(c+f),m=n[l+1],a=i-n[l],o=l+2;o<t;o++)n[o]-=a;for(x+=a,c=n[u],p=d=1,g=d,v=e[l+1],w=0,y=0,o=u-1;o>=l;o--)for(g=p,p=d,y=w,i=d*e[o],a=d*c,f=rt(c,e[o]),e[o+1]=w*f,w=e[o]/f,c=(d=c/f)*n[o]-w*i,n[o+1]=a+w*(d*i+w*n[o]),h=0;h<t;h++)a=r[h][o+1],r[h][o+1]=w*r[h][o]+d*a,r[h][o]=d*r[h][o]-w*a;c=-w*y*g*v*e[l]/m,e[l]=w*c,n[l]=d*c}while(Math.abs(e[l])>$*b);n[l]=n[l]+x,e[l]=0}for(o=0;o<t-1;o++){for(h=o,c=n[o],s=o+1;s<t;s++)n[s]<c&&(h=s,c=n[s]);if(h!==o)for(n[h]=n[o],n[o]=c,s=0;s<t;s++)c=r[s][o],r[s][o]=r[s][h],r[s][h]=c}}(a,h,s,o)}else{var u=it(a,a,0),c=new Array(a);for(i=0;i<a;i++)for(r=0;r<a;r++)u[r][i]=l.get(r,i);!function(t,e,n,r){var i,a,o,s,h,l,u,c=0,f=t-1;for(l=c+1;l<=f-1;l++){for(u=0,s=l;s<=f;s++)u+=Math.abs(e[s][l-1]);if(0!==u){for(o=0,s=f;s>=l;s--)n[s]=e[s][l-1]/u,o+=n[s]*n[s];for(a=Math.sqrt(o),n[l]>0&&(a=-a),o-=n[l]*a,n[l]=n[l]-a,h=l;h<t;h++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][h];for(i/=o,s=l;s<=f;s++)e[s][h]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,h=f;h>=l;h--)i+=n[h]*e[s][h];for(i/=o,h=l;h<=f;h++)e[s][h]-=i*n[h]}n[l]=u*n[l],e[l][l-1]=u*a}}for(s=0;s<t;s++)for(h=0;h<t;h++)r[s][h]=s===h?1:0;for(l=f-1;l>=c+1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(h=l;h<=f;h++){for(a=0,s=l;s<=f;s++)a+=n[s]*r[s][h];for(a=a/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][h]+=a*n[s]}}}(a,u,c,o),function(t,e,n,r,i){var a,o,s,h,l,u,c,f,m,d,p,g,v,w,y,x=t-1,b=0,$=t-1,_=Number.EPSILON,M=0,T=0,E=0,k=0,R=0,A=0,S=0,C=0;for(a=0;a<t;a++)for((a<b||a>$)&&(n[a]=i[a][a],e[a]=0),o=Math.max(a-1,0);o<t;o++)T+=Math.abs(i[a][o]);for(;x>=b;){for(h=x;h>b&&(0===(A=Math.abs(i[h-1][h-1])+Math.abs(i[h][h]))&&(A=T),!(Math.abs(i[h][h-1])<_*A));)h--;if(h===x)i[x][x]=i[x][x]+M,n[x]=i[x][x],e[x]=0,x--,C=0;else if(h===x-1){if(c=i[x][x-1]*i[x-1][x],k=(E=(i[x-1][x-1]-i[x][x])/2)*E+c,S=Math.sqrt(Math.abs(k)),i[x][x]=i[x][x]+M,i[x-1][x-1]=i[x-1][x-1]+M,f=i[x][x],k>=0){for(S=E>=0?E+S:E-S,n[x-1]=f+S,n[x]=n[x-1],0!==S&&(n[x]=f-c/S),e[x-1]=0,e[x]=0,E=(f=i[x][x-1])/(A=Math.abs(f)+Math.abs(S)),k=S/A,E/=R=Math.sqrt(E*E+k*k),k/=R,o=x-1;o<t;o++)S=i[x-1][o],i[x-1][o]=k*S+E*i[x][o],i[x][o]=k*i[x][o]-E*S;for(a=0;a<=x;a++)S=i[a][x-1],i[a][x-1]=k*S+E*i[a][x],i[a][x]=k*i[a][x]-E*S;for(a=b;a<=$;a++)S=r[a][x-1],r[a][x-1]=k*S+E*r[a][x],r[a][x]=k*r[a][x]-E*S}else n[x-1]=f+E,n[x]=f+E,e[x-1]=S,e[x]=-S;x-=2,C=0}else{if(f=i[x][x],m=0,c=0,h<x&&(m=i[x-1][x-1],c=i[x][x-1]*i[x-1][x]),10===C){for(M+=f,a=b;a<=x;a++)i[a][a]-=f;f=m=.75*(A=Math.abs(i[x][x-1])+Math.abs(i[x-1][x-2])),c=-.4375*A*A}if(30===C&&(A=(A=(m-f)/2)*A+c)>0){for(A=Math.sqrt(A),m<f&&(A=-A),A=f-c/((m-f)/2+A),a=b;a<=x;a++)i[a][a]-=A;M+=A,f=m=c=.964}for(C+=1,l=x-2;l>=h&&(E=((R=f-(S=i[l][l]))*(A=m-S)-c)/i[l+1][l]+i[l][l+1],k=i[l+1][l+1]-S-R-A,R=i[l+2][l+1],E/=A=Math.abs(E)+Math.abs(k)+Math.abs(R),k/=A,R/=A,l!==h)&&!(Math.abs(i[l][l-1])*(Math.abs(k)+Math.abs(R))<_*(Math.abs(E)*(Math.abs(i[l-1][l-1])+Math.abs(S)+Math.abs(i[l+1][l+1]))));)l--;for(a=l+2;a<=x;a++)i[a][a-2]=0,a>l+2&&(i[a][a-3]=0);for(s=l;s<=x-1&&(w=s!==x-1,s!==l&&(E=i[s][s-1],k=i[s+1][s-1],R=w?i[s+2][s-1]:0,0!==(f=Math.abs(E)+Math.abs(k)+Math.abs(R))&&(E/=f,k/=f,R/=f)),0!==f);s++)if(A=Math.sqrt(E*E+k*k+R*R),E<0&&(A=-A),0!==A){for(s!==l?i[s][s-1]=-A*f:h!==l&&(i[s][s-1]=-i[s][s-1]),f=(E+=A)/A,m=k/A,S=R/A,k/=E,R/=E,o=s;o<t;o++)E=i[s][o]+k*i[s+1][o],w&&(E+=R*i[s+2][o],i[s+2][o]=i[s+2][o]-E*S),i[s][o]=i[s][o]-E*f,i[s+1][o]=i[s+1][o]-E*m;for(a=0;a<=Math.min(x,s+3);a++)E=f*i[a][s]+m*i[a][s+1],w&&(E+=S*i[a][s+2],i[a][s+2]=i[a][s+2]-E*R),i[a][s]=i[a][s]-E,i[a][s+1]=i[a][s+1]-E*k;for(a=b;a<=$;a++)E=f*r[a][s]+m*r[a][s+1],w&&(E+=S*r[a][s+2],r[a][s+2]=r[a][s+2]-E*R),r[a][s]=r[a][s]-E,r[a][s+1]=r[a][s+1]-E*k}}}if(0===T)return;for(x=t-1;x>=0;x--)if(E=n[x],0===(k=e[x]))for(h=x,i[x][x]=1,a=x-1;a>=0;a--){for(c=i[a][a]-E,R=0,o=h;o<=x;o++)R+=i[a][o]*i[o][x];if(e[a]<0)S=c,A=R;else if(h=a,0===e[a]?i[a][x]=0!==c?-R/c:-R/(_*T):(f=i[a][a+1],m=i[a+1][a],u=(f*A-S*R)/(k=(n[a]-E)*(n[a]-E)+e[a]*e[a]),i[a][x]=u,i[a+1][x]=Math.abs(f)>Math.abs(S)?(-R-c*u)/f:(-A-m*u)/S),_*(u=Math.abs(i[a][x]))*u>1)for(o=a;o<=x;o++)i[o][x]=i[o][x]/u}else if(k<0)for(h=x-1,Math.abs(i[x][x-1])>Math.abs(i[x-1][x])?(i[x-1][x-1]=k/i[x][x-1],i[x-1][x]=-(i[x][x]-E)/i[x][x-1]):(y=It(0,-i[x-1][x],i[x-1][x-1]-E,k),i[x-1][x-1]=y[0],i[x-1][x]=y[1]),i[x][x-1]=0,i[x][x]=1,a=x-2;a>=0;a--){for(d=0,p=0,o=h;o<=x;o++)d+=i[a][o]*i[o][x-1],p+=i[a][o]*i[o][x];if(c=i[a][a]-E,e[a]<0)S=c,R=d,A=p;else if(h=a,0===e[a]?(y=It(-d,-p,c,k),i[a][x-1]=y[0],i[a][x]=y[1]):(f=i[a][a+1],m=i[a+1][a],g=(n[a]-E)*(n[a]-E)+e[a]*e[a]-k*k,v=2*(n[a]-E)*k,0===g&&0===v&&(g=_*T*(Math.abs(c)+Math.abs(k)+Math.abs(f)+Math.abs(m)+Math.abs(S))),y=It(f*R-S*d+k*p,f*A-S*p-k*d,g,v),i[a][x-1]=y[0],i[a][x]=y[1],Math.abs(f)>Math.abs(S)+Math.abs(k)?(i[a+1][x-1]=(-d-c*i[a][x-1]+k*i[a][x])/f,i[a+1][x]=(-p-c*i[a][x]-k*i[a][x-1])/f):(y=It(-R-m*i[a][x-1],-A-m*i[a][x],S,k),i[a+1][x-1]=y[0],i[a+1][x]=y[1])),_*(u=Math.max(Math.abs(i[a][x-1]),Math.abs(i[a][x])))*u>1)for(o=a;o<=x;o++)i[o][x-1]=i[o][x-1]/u,i[o][x]=i[o][x]/u}for(a=0;a<t;a++)if(a<b||a>$)for(o=a;o<t;o++)r[a][o]=i[a][o];for(o=t-1;o>=b;o--)for(a=b;a<=$;a++){for(S=0,s=b;s<=Math.min(o,$);s++)S+=r[a][s]*i[s][o];r[a][o]=S}}(a,h,s,o,u)}this.n=a,this.e=h,this.d=s,this.V=o}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return Rt.isMatrix(this.V)||(this.V=new Rt(this.V)),this.V}get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,a=new Rt(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)a[t][e]=0;a[t][t]=i[t],r[t]>0?a[t][t+1]=r[t]:r[t]<0&&(a[t][t-1]=r[t])}return a}}function It(t,e,n,r){var i,a;return Math.abs(n)>Math.abs(r)?[(t+(i=r/n)*e)/(a=n+i*r),(e-i*t)/a]:[((i=n/r)*t+e)/(a=r+i*n),(i*e-t)/a]}class Xt{constructor(t){if(!(t=At.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,r,i=t,a=i.rows,o=new Rt(a,a),s=!0;for(n=0;n<a;n++){var h=o[n],l=0;for(r=0;r<n;r++){var u=o[r],c=0;for(e=0;e<r;e++)c+=u[e]*h[e];h[r]=c=(i.get(n,r)-c)/o[r][r],l+=c*c}for(s&=(l=i.get(n,n)-l)>0,o[n][n]=Math.sqrt(Math.max(l,0)),r=n+1;r<a;r++)o[n][r]=0}if(!s)throw new Error("Matrix is not positive definite");this.L=o}solve(t){t=At.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,i,a,o=t.columns,s=t.clone();for(a=0;a<n;a++)for(i=0;i<o;i++){for(r=0;r<a;r++)s[a][i]-=s[r][i]*e[a][r];s[a][i]/=e[a][a]}for(a=n-1;a>=0;a--)for(i=0;i<o;i++){for(r=a+1;r<n;r++)s[a][i]-=s[r][i]*e[r][a];s[a][i]/=e[a][a]}return s}get lowerTriangularMatrix(){return this.L}}var Vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Bt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}function Pt(t){var e={exports:{}};return t(e,e.exports),e.exports}var Lt={func:Symbol("func"),validate:Symbol("validate")};const{func:Ut}=Lt;var Ft={predicates:{positive:t=>t>0,negative:t=>t<0,nonNegative:t=>t>=0,integer:t=>t===(0|t),[Ut]:{is:t=>t,eq:t=>e=>e===t,gt:t=>e=>e>t,gte:t=>e=>e>=t,lt:t=>e=>e<t,lte:t=>e=>e<=t}},validator:t=>"number"==typeof t};const{func:zt}=Lt;var qt={predicates:{empty:t=>""===t,nonEmpty:t=>""!==t,[zt]:{is:t=>t,eq:t=>e=>e===t,length:t=>e=>e.length===t,minLength:t=>e=>e.length>=t,maxLength:t=>e=>e.length<=t,matches:t=>e=>t.test(e),startsWith:t=>e=>e.startsWith(t),endsWith:t=>e=>e.endsWith(t)}},validator:t=>"string"==typeof t};const{func:Dt}=Lt;const Ht={number:Ft,string:qt,object:{predicates:{plain:t=>{if("object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.getPrototypeOf({})},empty:t=>0===Object.keys(t).length,nonEmpty:t=>Object.keys(t).length>0,[Dt]:{is:t=>t,instanceOf:t=>e=>e instanceof t}},validator:t=>"object"==typeof t}},Ot=({validators:t=[],predicates:e=Ht,type:n=null}={})=>{const r=new Proxy((function(){}),{get:(i,a)=>{if(a===Lt.validate)return(e,r="argument")=>{if(!n)return new Error("missing required type specifier");for(let i=0;i<t.length;++i){const a=t[i];if(!a.fn(e))throw 0===i?new Error(`Expected ${r} \`${e}\` to be of type \`${n}\`, but received type \`${typeof e}\``):new Error(`Expected ${n} \`${r}\` \`${e}\` failed predicate \`${a.key}\``)}};const o=e[a];if(o)return"function"==typeof o?(t.push({key:a,fn:o}),r):Ot({type:a,validators:[{key:a,fn:o.validator}],predicates:o.predicates});{const n=e[Lt.func]&&e[Lt.func][a];return n?new Proxy((function(){}),{get:()=>{throw new Error(`invalid use of functional predicate "${a}"`)},apply:(e,i,o)=>(t.push({key:a,fn:n(...o)}),r)}):r}},apply:(t,e,n)=>{if(2!==n.length&&3!==n.length)throw new Error('invalid number of arguments to "ow"');n[1][Lt.validate](n[0],n[2])}});return r};var Gt=Ot(),Kt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Kt(t,[{key:"next",value:function(){throw new Error("RNG.next must be overridden")}},{key:"seed",value:function(t,e){throw new Error("RNG.seed must be overridden")}},{key:"clone",value:function(t,e){throw new Error("RNG.clone must be overridden")}},{key:"_seed",value:function(t,e){if(t===(0|t))return t;for(var n=""+t,r=0,i=0;i<n.length;++i)r^=0|n.charCodeAt(i);return r}},{key:"name",get:function(){throw new Error("RNG.name must be overridden")}}]),t}(),Yt=Object.defineProperty({default:Wt},"__esModule",{value:!0}),Qt=Pt((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var n=new r(t),a=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.alea=a}(0,t,!1)})),Jt=Pt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xor128=a}(0,t,!1)})),Zt=Pt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xorwow=a}(0,t,!1)})),te=Pt((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.x&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xorshift7=a}(0,t,!1)})),ee=Pt((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,o,s=[],h=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,h=Math.max(h,e.length)),i=0,a=-32;a<h;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,i=0==(n=s[127&a]^=r+o)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=o,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&(a.X&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.xor4096=a}(0,t,!1)})),ne=Pt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var n=new r(t),a=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,a&&("object"==typeof a&&i(a,n),o.state=function(){return i(n,{})}),o}e&&e.exports?e.exports=a:n&&n.amd?n((function(){return a})):this.tychei=a}(0,t,!1)})),re=Bt(Object.freeze({__proto__:null,default:{}})),ie=Pt((function(t){!function(e,n,r){var i,a=256,o=r.pow(a,6),s=r.pow(2,52),h=2*s,l=255;function u(t,l,u){var g=[],v=d(m((l=1==l?{entropy:!0}:l||{}).entropy?[t,p(n)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(t)),p(t)}catch(t){var r=e.navigator,o=r&&r.plugins;return[+new Date,e,o,e.screen,p(n)]}}():t,3),g),w=new c(g),y=function(){for(var t=w.g(6),e=o,n=0;t<s;)t=(t+n)*a,e*=a,n=w.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return y.int32=function(){return 0|w.g(4)},y.quick=function(){return w.g(4)/4294967296},y.double=y,d(p(w.S),n),(l.pass||u||function(t,e,n,i){return i&&(i.S&&f(i,w),t.state=function(){return f(w,{})}),n?(r.random=t,e):t})(y,v,"global"in l?l.global:this==r,l.state)}function c(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=l&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=l&i+1],n=n*a+s[l&(s[i]=s[o=l&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function d(t,e){for(var n,r=t+"",i=0;i<r.length;)e[l&i]=l&(n^=19*e[l&i])+r.charCodeAt(i++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}if(d(r.random(),n),t.exports){t.exports=u;try{i=re}catch(t){}}else r.seedrandom=u}("undefined"!=typeof self?self:Vt,[],Math)}));ie.alea=Qt,ie.xor128=Jt,ie.xorwow=Zt,ie.xorshift7=te,ie.xor4096=ee,ie.tychei=ne;var ae=ie,oe=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),se=he(Gt);function he(t){return t&&t.__esModule?t:{default:t}}var le=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.seed(t,n),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),oe(e,[{key:"next",value:function(){return this._rng()}},{key:"seed",value:function(t){(0,se.default)(t,se.default.function),this._rng=t}},{key:"clone",value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return new(Function.prototype.bind.apply(e,[null].concat([this._rng],n)))}},{key:"name",get:function(){return"function"}}]),e}(he(Yt).default),ue=Object.defineProperty({default:le},"__esModule",{value:!0}),ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe=pe(ae),me=pe(Yt),de=pe(ue);function pe(t){return t&&t.__esModule?t:{default:t}}function ge(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var ve,we=Object.defineProperty({default:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=void 0===r?"default":r,a=e.slice(1);switch(void 0===i?"undefined":ce(i)){case"object":if(i instanceof me.default)return i;break;case"function":return new de.default(i);case"string":case"number":return new de.default(fe.default.apply(void 0,ge(a)))}throw new Error('invalid RNG "'+i+'"')}},"__esModule",{value:!0}),ye=(ve=Gt)&&ve.__esModule?ve:{default:ve};var xe=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,ye.default)(e,ye.default.number),(0,ye.default)(n,ye.default.number),function(){return t.next()*(n-e)+e}}},"__esModule",{value:!0}),be=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var $e=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,be.default)(e,be.default.number.integer),(0,be.default)(n,be.default.number.integer),function(){return t.next()*(n-e+1)+e|0}}},"__esModule",{value:!0}),_e=Object.defineProperty({default:function(t){return function(){return t.next()>=.5}}},"__esModule",{value:!0}),Me=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Te=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Me.default)(e,Me.default.number),(0,Me.default)(n,Me.default.number),function(){var r=void 0,i=void 0,a=void 0;do{a=(r=2*t.next()-1)*r+(i=2*t.next()-1)*i}while(!a||a>1);return e+n*i*Math.sqrt(-2*Math.log(a)/a)}}},"__esModule",{value:!0}),Ee=Object.defineProperty({default:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=t.normal.apply(t,n);return function(){return Math.exp(i())}}},"__esModule",{value:!0}),ke=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Re=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,ke.default)(e,ke.default.number.gte(0).lt(1)),function(){return t.next()+e|0}}},"__esModule",{value:!0}),Ae=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Se=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return(0,Ae.default)(e,Ae.default.number.positive.integer),(0,Ae.default)(n,Ae.default.number.gte(0).lte(1)),function(){for(var r=0,i=0;r++<e;)i+=t.next()<n;return i}}},"__esModule",{value:!0}),Ce=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var je=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;(0,Ce.default)(e,Ce.default.number.gt(0).lte(1));var n=1/Math.log(1-e);return function(){return 1+Math.log(t.next())*n|0}}},"__esModule",{value:!0}),Ne=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Ie=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Xe=function(t){return Ie[t]},Ve=.9189385332046727,Be=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,Ne.default)(e,Ne.default.number.positive),e<10){var n=Math.exp(-e);return function(){for(var r=n,i=0,a=t.next();a>r;)a-=r,r=e*r/++i;return i}}var r=Math.sqrt(e),i=.931+2.53*r,a=.02483*i-.059,o=1.1239+1.1328/(i-3.4),s=.9277-3.6224/(i-2);return function(){for(;;){var n=void 0,h=t.next();if(h<=.86*s)return n=h/s-.43,Math.floor((2*a/(.5-Math.abs(n))+i)*n+e+.445);h>=s?n=t.next()-.5:(n=((n=h/s-.93)<0?-.5:.5)-n,h=t.next()*s);var l=.5-Math.abs(n);if(!(l<.013&&h>l)){var u=0|Math.floor((2*a/l+i)*n+e+.445);if(h=h*o/(a/(l*l)+i),u>=10){var c=(u+.5)*Math.log(e/u)-e-Ve+u-(1/12-(1/360-1/(1260*u*u))/(u*u))/u;if(Math.log(h*r)<=c)return u}else if(u>=0&&Math.log(h)<=u*Math.log(e)-e-Xe(u))return u}}}}},"__esModule",{value:!0}),Pe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Le=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Pe.default)(e,Pe.default.number.positive),function(){return-Math.log(1-t.next())/e}}},"__esModule",{value:!0}),Ue=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Fe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Ue.default)(e,Ue.default.number.integer.gte(0)),function(){for(var n=0,r=0;r<e;++r)n+=t.next();return n}}},"__esModule",{value:!0}),ze=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var qe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,ze.default)(e,ze.default.number.integer.positive);var n=t.irwinHall(e);return function(){return n()/e}}},"__esModule",{value:!0}),De=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var He=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,De.default)(e,De.default.number.gte(0));var n=1/e;return function(){return 1/Math.pow(1-t.next(),n)}}},"__esModule",{value:!0}),Oe=Pt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RNGFactory=e.RNG=void 0;var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=y(Gt),i=y(Yt),a=y(we),o=y(xe),s=y($e),h=y(_e),l=y(Te),u=y(Ee),c=y(Re),f=y(Se),m=y(je),d=y(Be),p=y(Le),g=y(Fe),v=y(qe),w=y(He);function y(t){return t&&t.__esModule?t:{default:t}}e.RNG=i.default,e.RNGFactory=a.default;var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(0,r.default)(e,r.default.object.instanceOf(i.default)),this._cache={},this.use(e)}return n(t,[{key:"clone",value:function(){return new t(arguments.length?a.default.apply(void 0,arguments):this.rng.clone())}},{key:"use",value:function(){this._rng=a.default.apply(void 0,arguments)}},{key:"patch",value:function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}},{key:"unpatch",value:function(){this._patch&&(Math.random=this._patch,delete this._patch)}},{key:"next",value:function(){return this._rng.next()}},{key:"float",value:function(t,e){return this.uniform(t,e)()}},{key:"int",value:function(t,e){return this.uniformInt(t,e)()}},{key:"integer",value:function(t,e){return this.uniformInt(t,e)()}},{key:"bool",value:function(){return this.uniformBoolean()()}},{key:"boolean",value:function(){return this.uniformBoolean()()}},{key:"uniform",value:function(t,e){return this._memoize("uniform",o.default,t,e)}},{key:"uniformInt",value:function(t,e){return this._memoize("uniformInt",s.default,t,e)}},{key:"uniformBoolean",value:function(){return this._memoize("uniformBoolean",h.default)}},{key:"normal",value:function(t,e){return(0,l.default)(this,t,e)}},{key:"logNormal",value:function(t,e){return(0,u.default)(this,t,e)}},{key:"bernoulli",value:function(t){return(0,c.default)(this,t)}},{key:"binomial",value:function(t,e){return(0,f.default)(this,t,e)}},{key:"geometric",value:function(t){return(0,m.default)(this,t)}},{key:"poisson",value:function(t){return(0,d.default)(this,t)}},{key:"exponential",value:function(t){return(0,p.default)(this,t)}},{key:"irwinHall",value:function(t){return(0,g.default)(this,t)}},{key:"bates",value:function(t){return(0,v.default)(this,t)}},{key:"pareto",value:function(t){return(0,w.default)(this,t)}},{key:"_memoize",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a=""+r.join(";"),o=this._cache[t];return void 0!==o&&o.key===a||(o={key:a,distribution:e.apply(void 0,[this].concat(r))},this._cache[t]=o),o.distribution}},{key:"rng",get:function(){return this._rng}}]),t}();e.default=new x})).default;class Ge{constructor(t,e){t instanceof Rt&&e instanceof Rt?(this.mean=t,this.cov=e):(this.mean=new Rt([t]).transpose(),this.cov=new Rt(e))}at(t){const e=new Rt([t]).transpose().sub(this.mean);return e.transpose().mmul(Ct(this.cov)).mmul(e).mul(-.5).exp()*(1/Math.sqrt(Math.pow(2*Math.PI,this.mean.rows)*this.cov.det()))}marginalize(t){const e=Ke(this.mean,0,0,t,1),n=Ke(this.mean,t,0,this.mean.rows,1),r=Ke(this.cov,0,0,t,t),i=Ke(this.cov,t,t,this.mean.rows,this.mean.rows);return[new Ge(e,r),new Ge(n,i)]}condition(t){const e=t.length,n=new Rt([t]).transpose(),r=Ke(this.cov,0,0,e,e),i=Ke(this.cov,0,e,e,this.mean.rows),a=i.transpose(),o=Ke(this.cov,e,e,this.mean.rows,this.mean.rows),s=new Xt(r).lowerTriangularMatrix,h=jt(s,n),l=jt(s,i).transpose().mmul(h),u=o.sub(a.mmul(Ct(r)).mmul(i));return new Ge(l,u)}transformationMatrix(){const t=new Nt(this.cov),e=t.eigenvectorMatrix,n=Rt.zeros(e.rows,e.columns);for(let e=0;e<n.rows;++e)n.set(e,e,Math.sqrt(t.realEigenvalues[e]));return e.mmul(n)}sample(){const t=Rt.zeros(this.mean.rows,1),e=Oe.normal();for(let n=0;n<this.mean.rows;++n)t.set(n,0,e());return Rt.add(this.mean,this.transformationMatrix().mmul(t))}getMean(){return this.mean.transpose()[0]}getSd(){return this.cov.diag().map((t=>Math.sqrt(t)))}}function Ke(t,e,n,r,i){const a=new Rt(r-e,i-n);for(let o=e;o<r;++o)for(let r=n;r<i;++r)a.set(o-e,r-n,t.get(o,r));return a}class We{constructor(){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0])}call(t,e){return this.g.at([t-e])*this.scale}inv0(t){var e=this.get_sigma2(),n=t/this.scale;const r=Math.sqrt(2*e*Math.PI),i=-2*e;return Math.sqrt(i*Math.log(n*r))}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,n){return[]}}class Ye{constructor(t){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0]),this.cut_size=t}call(t,e){var n=this.cut_size,r=Math.floor(e/n),i=e-r*n;return 1==Math.abs(r%2)&&(e+=n-2*i),this.g.at([e-t])*this.scale}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,n){for(var r=e,i=[];r<n;)i.push(r),r+=this.cut_size;return i}}function Qe(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Je(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)<0?r=a+1:i=a}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Qe(t(e),n)}(t)),{left:r,center:function(t,n,i,a){null==i&&(i=0),null==a&&(a=t.length);const o=r(t,n,i,a-1);return o>i&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const a=r+i>>>1;n(t[a],e)>0?i=a:r=a+1}return r}}}const Ze=Je(Qe).right;Je((function(t){return null===t?NaN:+t})).center;var tn=Math.sqrt(50),en=Math.sqrt(10),nn=Math.sqrt(2);function rn(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=tn?10:a>=en?5:a>=nn?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=tn?10:a>=en?5:a>=nn?2:1)}function an(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a}function on(t){if(!(i=t.length))return[];for(var e=-1,n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}(t,sn),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r}function sn(t){return t.length}function hn(){return on(arguments)}function ln(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function un(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function cn(){}var fn=.7,mn=1/fn,dn="\\s*([+-]?\\d+)\\s*",pn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",gn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vn=/^#([0-9a-f]{3,8})$/,wn=new RegExp("^rgb\\("+[dn,dn,dn]+"\\)$"),yn=new RegExp("^rgb\\("+[gn,gn,gn]+"\\)$"),xn=new RegExp("^rgba\\("+[dn,dn,dn,pn]+"\\)$"),bn=new RegExp("^rgba\\("+[gn,gn,gn,pn]+"\\)$"),$n=new RegExp("^hsl\\("+[pn,gn,gn]+"\\)$"),_n=new RegExp("^hsla\\("+[pn,gn,gn,pn]+"\\)$"),Mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Tn(){return this.rgb().formatHex()}function En(){return this.rgb().formatRgb()}function kn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=vn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Rn(e):3===n?new jn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?An(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?An(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=wn.exec(t))?new jn(e[1],e[2],e[3],1):(e=yn.exec(t))?new jn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xn.exec(t))?An(e[1],e[2],e[3],e[4]):(e=bn.exec(t))?An(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=$n.exec(t))?Vn(e[1],e[2]/100,e[3]/100,1):(e=_n.exec(t))?Vn(e[1],e[2]/100,e[3]/100,e[4]):Mn.hasOwnProperty(t)?Rn(Mn[t]):"transparent"===t?new jn(NaN,NaN,NaN,0):null}function Rn(t){return new jn(t>>16&255,t>>8&255,255&t,1)}function An(t,e,n,r){return r<=0&&(t=e=n=NaN),new jn(t,e,n,r)}function Sn(t){return t instanceof cn||(t=kn(t)),t?new jn((t=t.rgb()).r,t.g,t.b,t.opacity):new jn}function Cn(t,e,n,r){return 1===arguments.length?Sn(t):new jn(t,e,n,null==r?1:r)}function jn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Nn(){return"#"+Xn(this.r)+Xn(this.g)+Xn(this.b)}function In(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Xn(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Vn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Pn(t,e,n,r)}function Bn(t){if(t instanceof Pn)return new Pn(t.h,t.s,t.l,t.opacity);if(t instanceof cn||(t=kn(t)),!t)return new Pn;if(t instanceof Pn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,h=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=h<.5?a+i:2-a-i,o*=60):s=h>0&&h<1?0:o,new Pn(o,s,h,t.opacity)}function Pn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ln(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}ln(cn,kn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Tn,formatHex:Tn,formatHsl:function(){return Bn(this).formatHsl()},formatRgb:En,toString:En}),ln(jn,Cn,un(cn,{brighter:function(t){return t=null==t?mn:Math.pow(mn,t),new jn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?fn:Math.pow(fn,t),new jn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Nn,formatHex:Nn,formatRgb:In,toString:In})),ln(Pn,(function(t,e,n,r){return 1===arguments.length?Bn(t):new Pn(t,e,n,null==r?1:r)}),un(cn,{brighter:function(t){return t=null==t?mn:Math.pow(mn,t),new Pn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?fn:Math.pow(fn,t),new Pn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new jn(Ln(t>=240?t-240:t+120,i,r),Ln(t,i,r),Ln(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Un=t=>()=>t;function Fn(t){return 1==(t=+t)?zn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Un(isNaN(e)?n:e)}}function zn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Un(isNaN(t)?e:t)}var qn=function t(e){var n=Fn(e);function r(t,e){var r=n((t=Cn(t)).r,(e=Cn(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=zn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Dn(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}}function Hn(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Jn(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}function On(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Gn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Kn(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Jn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Wn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yn=new RegExp(Wn.source,"g");function Qn(t,e){var n,r,i,a=Wn.lastIndex=Yn.lastIndex=0,o=-1,s=[],h=[];for(t+="",e+="";(n=Wn.exec(t))&&(r=Yn.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,h.push({i:o,x:Gn(n,r)})),a=Yn.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,r=0;r<e;++r)s[(n=h[r]).i]=n.x(t);return s.join("")})}function Jn(t,e){var n,r=typeof e;return null==e||"boolean"===r?Un(e):("number"===r?Gn:"string"===r?(n=kn(e))?(e=n,qn):Qn:e instanceof kn?qn:e instanceof Date?On:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Dn:Array.isArray(e)?Hn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Kn:Gn)(t,e)}function Zn(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}const tr=Math.PI,er=2*tr,nr=1e-6,rr=er-nr;function ir(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ar(){return new ir}function or(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function sr(t){return(t=or(Math.abs(t)))?t[1]:NaN}ir.prototype=ar.prototype={constructor:ir,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,h=r-e,l=a-t,u=o-e,c=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>nr)if(Math.abs(u*s-h*l)>nr&&i){var f=n-a,m=r-o,d=s*s+h*h,p=f*f+m*m,g=Math.sqrt(d),v=Math.sqrt(c),w=i*Math.tan((tr-Math.acos((d+c-p)/(2*g*v)))/2),y=w/v,x=w/g;Math.abs(y-1)>nr&&(this._+="L"+(t+y*l)+","+(e+y*u)),this._+="A"+i+","+i+",0,0,"+ +(u*f>l*m)+","+(this._x1=t+x*s)+","+(this._y1=e+x*h)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),h=t+o,l=e+s,u=1^a,c=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+h+","+l:(Math.abs(this._x1-h)>nr||Math.abs(this._y1-l)>nr)&&(this._+="L"+h+","+l),n&&(c<0&&(c=c%er+er),c>rr?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=h)+","+(this._y1=l):c>nr&&(this._+="A"+n+","+n+",0,"+ +(c>=tr)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var hr,lr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ur(t){if(!(e=lr.exec(t)))throw new Error("invalid format: "+t);var e;return new cr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function cr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function fr(t,e){var n=or(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}ur.prototype=cr.prototype,cr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var mr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fr(100*t,e),r:fr,s:function(t,e){var n=or(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(hr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+or(t,Math.max(0,e+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function dr(t){return t}var pr,gr,vr,wr=Array.prototype.map,yr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function xr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?dr:(e=wr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],h=0;i>0&&s>0&&(h+s+1>r&&(s=Math.max(1,r-h)),a.push(t.substring(i-=s,i+s)),!((h+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?dr:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(wr.call(t.numerals,String)),h=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=ur(t)).fill,n=t.align,c=t.sign,f=t.symbol,m=t.zero,d=t.width,p=t.comma,g=t.precision,v=t.trim,w=t.type;"n"===w?(p=!0,w="g"):mr[w]||(void 0===g&&(g=12),v=!0,w="g"),(m||"0"===e&&"="===n)&&(m=!0,e="0",n="=");var y="$"===f?i:"#"===f&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",x="$"===f?a:/[%p]/.test(w)?h:"",b=mr[w],$=/[defgprs%]/.test(w);function _(t){var i,a,h,f=y,_=x;if("c"===w)_=b(t)+_,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:b(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==c&&(M=!1),f=(M?"("===c?c:l:"-"===c||"("===c?"":c)+f,_=("s"===w?yr[8+hr/3]:"")+_+(M&&"("===c?")":""),$)for(i=-1,a=t.length;++i<a;)if(48>(h=t.charCodeAt(i))||h>57){_=(46===h?o+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}p&&!m&&(t=r(t,1/0));var T=f.length+t.length+_.length,E=T<d?new Array(d-T+1).join(e):"";switch(p&&m&&(t=r(E+t,E.length?d-_.length:1/0),E=""),n){case"<":t=f+t+_+E;break;case"=":t=f+E+t+_;break;case"^":t=E.slice(0,T=E.length>>1)+f+t+_+E.slice(T);break;default:t=E+f+t+_}return s(t)}return g=void 0===g?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return t+""},_}return{format:c,formatPrefix:function(t,e){var n=c(((t=ur(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(sr(e)/3))),i=Math.pow(10,-r),a=yr[8+r/3];return function(t){return n(i*t)+a}}}}function br(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function $r(t){return+t}pr=xr({thousands:",",grouping:[3],currency:["$",""]}),gr=pr.format,vr=pr.formatPrefix;var _r=[0,1];function Mr(t){return t}function Tr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Er(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=Tr(i,r),a=n(o,a)):(r=Tr(r,i),a=n(a,o)),function(t){return a(r(t))}}function kr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Tr(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=Ze(t,e,1,r)-1;return a[n](i[n](e))}}function Rr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ar(){var t,e,n,r,i,a,o=_r,s=_r,h=Jn,l=Mr;function u(){var t,e,n,h=Math.min(o.length,s.length);return l!==Mr&&(t=o[0],e=o[h-1],t>e&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),r=h>2?kr:Er,i=a=null,c}function c(e){return null==e||isNaN(e=+e)?n:(i||(i=r(o.map(t),s,h)))(t(l(e)))}return c.invert=function(n){return l(e((a||(a=r(s,o.map(t),Gn)))(n)))},c.domain=function(t){return arguments.length?(o=Array.from(t,$r),u()):o.slice()},c.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},c.rangeRound=function(t){return s=Array.from(t),h=Zn,u()},c.clamp=function(t){return arguments.length?(l=!!t||Mr,u()):l!==Mr},c.interpolate=function(t){return arguments.length?(h=t,u()):h},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,u()}}function Sr(){return Ar()(Mr,Mr)}function Cr(t,e,n,r){var i,a=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=tn?i*=10:a>=en?i*=5:a>=nn&&(i*=2),e<t?-i:i}(t,e,n);switch((r=ur(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(sr(e)/3)))-sr(Math.abs(t)))}(a,o))||(r.precision=i),vr(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,sr(e)-sr(t))+1}(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-sr(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return gr(r)}function jr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=rn(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),r=Math.round(e/o);for(n*o<t&&++n,r*o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)*o}else{o=-o;let n=Math.round(t*o),r=Math.round(e*o);for(n/o<t&&++n,r/o>e&&--r,a=new Array(i=r-n+1);++s<i;)a[s]=(n+s)/o}return r&&a.reverse(),a}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Cr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,a=e(),o=0,s=a.length-1,h=a[o],l=a[s],u=10;for(l<h&&(i=h,h=l,l=i,i=o,o=s,s=i);u-- >0;){if((i=rn(h,l,n))===r)return a[o]=h,a[s]=l,e(a);if(i>0)h=Math.floor(h/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;h=Math.ceil(h*i)/i,l=Math.floor(l*i)/i}r=i}return t},t}function Nr(){var t=Sr();return t.copy=function(){return Rr(t,Nr())},br.apply(t,arguments),jr(t)}function Ir(t){return function(){return t}}function Xr(t){this._context=t}function Vr(t){return new Xr(t)}function Br(t){return t[0]}function Pr(t){return t[1]}function Lr(t,e){var n=Ir(!0),r=null,i=Vr,a=null;function o(o){var s,h,l,u=(o=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(o)).length,c=!1;for(null==r&&(a=i(l=ar())),s=0;s<=u;++s)!(s<u&&n(h=o[s],s,o))===c&&((c=!c)?a.lineStart():a.lineEnd()),c&&a.point(+t(h,s,o),+e(h,s,o));if(l)return a=null,l+""||null}return t="function"==typeof t?t:void 0===t?Br:Ir(t),e="function"==typeof e?e:void 0===e?Pr:Ir(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ir(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Ir(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ir(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o}Xr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};class Ur{constructor(t,e){this.touch=0,this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width,this.unitToAlpha=Nr().domain([0,1]).range([-5,5]),this.n=e,this.kernels=[null,null],this.kernels[0]=new We,this.kernels[1]=new Ye(2),this.active_ker=0,this.pft=Rt.zeros(this.n,this.n),this.ppt=Rt.zeros(this.n,this.n),this.fft=Rt.zeros(this.n,this.n),this.invpft=Rt.zeros(this.n,this.n),this.curveCache=null,this.xCache=null,this.invertible=!0,this.populate()}get_xrange(){return[this.ctx.xmin,this.ctx.xmax]}init_metrics(){this.init_mat("ppt"),this.init_mat("pft"),this.init_mat("fft")}_init_mat(t,e,n){var r=Rt.zeros(this.n,this.n);for(let n=0;n!=this.n;n++)for(let i=0;i!=this.n;i++)r[n][i]=this.kernel(t[n],e[i]);this[n]=r}_update_mat(t,e,n,r){for(let i=0;i!=this.n;i++)this[r][n][i]=this.kernel(t[n],e[i]),this[r][i][n]=this.kernel(t[i],e[n])}init_mat(t,e){var n,r;if("ppt"==t)[n,r]=[this.mu,this.mu];else if("pft"==t)[n,r]=[this.mu,this.x];else{if("fft"!=t)throw`init_mat: invalid type ${t}`;[n,r]=[this.x,this.x]}void 0===e?this._init_mat(n,r,t):this._update_mat(n,r,e,t)}initXCache(){var t,e=[this.ctx.xmin,this.ctx.xmax];for(let t=0;t!=this.n;t++)e.push(...this.jumps(this.x[t]));e.sort(((t,e)=>t-e)),this.xCache=new Array(0);for(let n=0;n!=e.length-1;n++)t=an(e[n],e[n+1],.0125),this.xCache.push(t)}initCurveCache(){var t=this.n;this.initXCache(),this.curveCache=new Array(t);for(let e=0;e!=t;e++)this.updateCurveCache(e)}updateCurveCache(t){var e;this.curveCache[t]=new Array;for(let n=0;n!=this.xCache.length;n++)e=this.xCache[n].map((e=>this.kernel(this.mu[t],e))),this.curveCache[t].push(...e)}set_scramble(t){this.active_ker=t?1:0,this.init_metrics(),this.initCurveCache()}scrambled(){return 1==this.active_ker}cut_size(){return 2}resetAlpha(){this.alpha.fill(1)}set_sigma(t){for(let e=0;e!=this.kernels.length;e++)this.kernels[e].set_sigma(Math.pow(10,t));for(let t=0;t!=this.n;t++)this.updateCurveCache(t);this.init_metrics()}recenter_mu(){for(let t=0;t!=this.n;t++)this.mu[t]=this.x[t];this.init_metrics(),this.initCurveCache()}get_sigma2(){return this.kernels[this.active_ker].get_sigma2()}populate(){var t=this.n;this.x=new Array(t),this.y=new Array(t),this.mu=new Array(t),this.alpha=new Array(t);for(let e=0;e!=t;e++)this.x[e]=this.ctx.unitToX(Math.random()),this.mu[e]=this.x[e],this.y[e]=this.ctx.unitToY(Math.random());this.init_metrics(),this.initCurveCache(),this.alpha.fill(1)}setDataPoint(t,e,n){this.x[t]=this.ctx.x(e),this.y[t]=this.ctx.y(n),this.init_mat("pft",t),this.init_mat("fft",t),this.updateCurveCache(t)}setMu(t,e){this.mu[t]=this.ctx.x(e),this.init_mat("ppt",t),this.init_mat("pft",t),this.updateCurveCache(t)}kernel(t,e){return this.kernels[this.active_ker].call(t,e)}jumps(t){return this.kernels[this.active_ker].cuts(t,this.ctx.xmin,this.ctx.xmax)}solutionAlpha(){var t=new Rt([this.y]);try{var e=Ct(this.pft),n=t.mmul(e).flat();return self.invertible=!0,n}catch(t){return self.invertible=!1,this.alpha}}_fNorm2(){var t=new Rt([this.alpha]);return t.mmul(this.ppt).mmul(t.transpose()).flat()[0]}fNorm(){return Math.sqrt(this._fNorm2())}_fNormParallel2(){var t,e=new Rt([this.alpha]);try{var n=Ct(this.fft);t=e.mmul(this.pft).mmul(n)}catch(t){return console.log("Could not invert matrix"),NaN}return t.mmul(this.fft).mmul(t.transpose())}fNormParallel(){return Math.sqrt(this._fNormParallel2())}fNormPerp(){var t=this._fNorm2()-this._fNormParallel2();return t>-1e-8&&(t=Math.max(0,t)),Math.sqrt(t)}resize(t,e){this.ctx.setWidth(t),this.ctx.setHeight(e),this.width=this.ctx.width,this.height=this.ctx.height}updateContext(t){this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width}addPoint(){this.n++,this.populate()}delPoint(){1!=this.n&&(this.n--,this.populate())}updateAlpha(t,e){isNaN(t+this.alpha[e])?console.log(`updateAlpha got ${t} and ${this.alpha[e]}`):this.alpha[e]+=t}makeLine(t,e){var n=this.ctx.xToViewport,[r,i]=[this.ctx.ymin,this.ctx.ymax];return Lr()(hn(t.map(n),e.map((t=>this.ctx.yToViewport(Math.max(r-1,Math.min(i+1,t)))))))||""}makeLines(t){var e,n,r="",i=0;for(let a=0;a!=this.xCache.length;a++)n=(e=this.xCache[a]).length,r+=this.makeLine(e,t.slice(i,i+n)),i+=n;return r}curve(t){var e=this.alpha[t],n=this.curveCache[t].map((t=>e*t));return this.makeLines(n)}solutionCurve(){if(0==this.n)return"";var t=new Array(this.curveCache[0].length).fill(0);for(let r=0;r!=this.n;r++){var e=this.alpha[r],n=this.curveCache[r];for(let r=0;r!=n.length;r++)t[r]+=n[r]*e}return this.makeLines(t)}points(t){var e=this.alpha[t];return an(this.n).map((n=>[this.ctx.u(this.x[n]),this.ctx.v(e*this.pft.get(t,n))]))}data(){return hn(this.x,this.y).map((([t,e])=>[this.ctx.u(t),this.ctx.v(e)]))}getMuX(){return hn(this.mu,this.x).map((([t,e])=>[this.ctx.u(t),this.ctx.u(e)]))}solutionPoint(t){return an(this.n).map((e=>this.alpha[e]*this.pft.get(t,e))).reduce(((t,e)=>t+e),0)}u(t){return this.ctx.u(t)}v(t){return this.ctx.v(t)}}class Fr{constructor(t,e,[n,r],[i,a]){this.width=t,this.height=e,this.xmin=n,this.xmax=r,this.ymin=i,this.ymax=a,this.xToViewport=Nr().domain([n,r]).range([0,t]),this.yToViewport=Nr().domain([i,a]).range([e,0]),this.unitToX=Nr().domain([0,1]).range([n,r]),this.unitToY=Nr().domain([0,1]).range([i,a]),this.xToUnit=Nr().domain([n,r]).range([0,1])}setWidth(t){this.width=t,this.xToViewport.range([0,t])}setHeight(t){this.height=t,this.yToViewport.range([t,0])}x(t){return this.xToViewport.invert(t)}y(t){return this.yToViewport.invert(t)}u(t){return this.xToViewport(t)}v(t){return this.yToViewport(t)}xDomain(){return this.xToViewport.domain()}yDomain(){return this.yToViewport.domain()}}class zr{constructor(t,e,n){if(e=parseInt(e),isNaN(e)||e<=0)throw`sync.js: component_num must be integer > 0, got ${e}`;this.sig=t,this.cnum=e,this.sig.subscribe((t=>{Math.abs(t)!=this.cnum&&n()}))}notify(){this.sig.update((t=>-(Math.sign(t)||1)*this.cnum))}}function qr(t,e,n){const r=t.slice();return r[17]=e[n][0],r[18]=e[n][1],r[20]=n,r}function Dr(t,e,n){const r=t.slice();return r[20]=e[n],r}function Hr(t,e,n){const r=t.slice();return r[17]=e[n][0],r[18]=e[n][1],r}function Or(t,e,n){const r=t.slice();return r[25]=e[n][0],r[26]=e[n][1],r[20]=n,r}function Gr(t){let e,n,r,i,a;return{c(){e=c("use"),g(e,"class","marker draggable svelte-cs9siv"),g(e,"id",n="mu"+t[20]),g(e,"x",r=t[25]),g(e,"y","0"),v(e,"xlink:href","#mu-select")},m(n,r){s(n,e,r),i||(a=p(e,"mousedown",t[5]),i=!0)},p(t,n){2&n&&r!==(r=t[25])&&g(e,"x",r)},d(t){t&&h(e),i=!1,a()}}}function Kr(t){let e,n;return{c(){e=c("path"),g(e,"class","curve svelte-cs9siv"),g(e,"d",n=t[1].curve(t[20]))},m(t,n){s(t,e,n)},p(t,r){2&r&&n!==(n=t[1].curve(t[20]))&&g(e,"d",n)},d(t){t&&h(e)}}}function Wr(t){let e,n=t[1].points(t[20]),r=[];for(let e=0;e<n.length;e+=1)r[e]=Yr(Hr(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(2&i){let a;for(n=t[1].points(t[20]),a=0;a<n.length;a+=1){const o=Hr(t,n,a);r[a]?r[a].p(o,i):(r[a]=Yr(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Yr(t){let e,n,r;return{c(){e=c("circle"),g(e,"class","point svelte-cs9siv"),g(e,"cx",n=t[17]),g(e,"cy",r=t[18]),g(e,"r","4")},m(t,n){s(t,e,n)},p(t,i){2&i&&n!==(n=t[17])&&g(e,"cx",n),2&i&&r!==(r=t[18])&&g(e,"cy",r)},d(t){t&&h(e)}}}function Qr(t){let e,n,r=t[0].curves&&Kr(t),i=t[0].points&&Wr(t);return{c(){r&&r.c(),e=d(),i&&i.c(),n=d()},m(t,a){r&&r.m(t,a),s(t,e,a),i&&i.m(t,a),s(t,n,a)},p(t,a){t[0].curves?r?r.p(t,a):(r=Kr(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),t[0].points?i?i.p(t,a):(i=Wr(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(t){r&&r.d(t),t&&h(e),i&&i.d(t),t&&h(n)}}}function Jr(t){let e,n;return{c(){e=c("path"),g(e,"class","solution-curve svelte-cs9siv"),g(e,"d",n=t[1].solutionCurve())},m(t,n){s(t,e,n)},p(t,r){2&r&&n!==(n=t[1].solutionCurve())&&g(e,"d",n)},d(t){t&&h(e)}}}function Zr(t){let e,n=t[1].data(),r=[];for(let e=0;e<n.length;e+=1)r[e]=ti(qr(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(34&i){let a;for(n=t[1].data(),a=0;a<n.length;a+=1){const o=qr(t,n,a);r[a]?r[a].p(o,i):(r[a]=ti(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function ti(t){let e,n,r,i,a;return{c(){e=c("circle"),g(e,"id","xy"+t[20]),g(e,"class","marker draggable svelte-cs9siv"),g(e,"cx",n=t[17]),g(e,"cy",r=t[18]),g(e,"r","5")},m(n,r){s(n,e,r),i||(a=p(e,"mousedown",t[5]),i=!0)},p(t,i){2&i&&n!==(n=t[17])&&g(e,"cx",n),2&i&&r!==(r=t[18])&&g(e,"cy",r)},d(t){t&&h(e),i=!1,a()}}}function ei(e){let n,i,a,f,v,w,y,x,b,$,_,M,E,k=e[1].getMuX(),R=[];for(let t=0;t<k.length;t+=1)R[t]=Gr(Or(e,k,t));let A=an(e[1].n),S=[];for(let t=0;t<A.length;t+=1)S[t]=Qr(Dr(e,A,t));let C=e[0].solution&&Jr(e),j=e[0].show_data&&Zr(e);return{c(){n=u("div"),f=m(),v=c("svg"),w=c("defs"),y=c("polygon");for(let t=0;t<R.length;t+=1)R[t].c();x=d();for(let t=0;t<S.length;t+=1)S[t].c();b=d(),C&&C.c(),$=d(),j&&j.c(),g(n,"class",i="framed "+e[2]+" z3 svelte-cs9siv"),X((()=>e[10].call(n))),g(y,"id","mu-select"),g(y,"points","-6,0 6,0 0,12"),g(v,"class",_="framed "+e[2]+" svelte-cs9siv")},m(t,r){s(t,n,r),a=T(n,e[10].bind(n)),s(t,f,r),s(t,v,r),o(v,w),o(w,y);for(let t=0;t<R.length;t+=1)R[t].m(v,null);o(v,x);for(let t=0;t<S.length;t+=1)S[t].m(v,null);o(v,b),C&&C.m(v,null),o(v,$),j&&j.m(v,null),M||(E=[p(v,"mousemove",e[6]),p(v,"mouseup",e[7])],M=!0)},p(t,[e]){if(4&e&&i!==(i="framed "+t[2]+" z3 svelte-cs9siv")&&g(n,"class",i),34&e){let n;for(k=t[1].getMuX(),n=0;n<k.length;n+=1){const r=Or(t,k,n);R[n]?R[n].p(r,e):(R[n]=Gr(r),R[n].c(),R[n].m(v,x))}for(;n<R.length;n+=1)R[n].d(1);R.length=k.length}if(3&e){let n;for(A=an(t[1].n),n=0;n<A.length;n+=1){const r=Dr(t,A,n);S[n]?S[n].p(r,e):(S[n]=Qr(r),S[n].c(),S[n].m(v,b))}for(;n<S.length;n+=1)S[n].d(1);S.length=A.length}t[0].solution?C?C.p(t,e):(C=Jr(t),C.c(),C.m(v,$)):C&&(C.d(1),C=null),t[0].show_data?j?j.p(t,e):(j=Zr(t),j.c(),j.m(v,null)):j&&(j.d(1),j=null),4&e&&_!==(_="framed "+t[2]+" svelte-cs9siv")&&g(v,"class",_)},i:t,o:t,d(t){t&&h(n),a(),t&&h(f),t&&h(v),l(R,t),l(S,t),C&&C.d(),j&&j.d(),M=!1,r(E)}}}function ni(t,e,n){let r,{sig:i}=e,{cfg:a}=e,{plot:o}=e,{cn:s}=e,{gridarea:h}=e,l=0,u=0,c=null,f=!1;function m(t,e){if(console.log(`in solve: ${e}, do_solve=${t}`),!t)return;var i=o.alpha,a=o.solutionAlpha();console.log(`in solve: ${a}`),function t(e,s){if(e==s)n(1,o.alpha=a,o);else{var h=e/s;for(let t=0;t!=o.n;t++)n(1,o.alpha[t]=h*a[t]+(1-h)*i[t],o)}r.notify(),e!=s&&setTimeout((()=>t(e+1,s)),10)}(0,50)}function d(){if(f){var t=a.cmd;if(null==t)throw"got null cfg.cmd in Curves update";"reset_alpha"==t&&o.resetAlpha(),"del_point"==t&&o.delPoint(),"add_point"==t&&o.addPoint(),"new_data"==t&&o.populate(),"auto_solve"==t&&m(a.auto_solve),"mu_tracks_x"==t&&a.mu_tracks_x&&o.recenter_mu(),"scramble"==t&&o.set_scramble(a.scramble),"set_sigma"==t&&o.set_sigma(a.log_sigma),t.match(/update_alpha/)||("set_sigma"==t||"mu_xy_changed"==t?a.auto_solve&&n(1,o.alpha=o.solutionAlpha(),o):"reset_alpha"!=t&&m(a.auto_solve)),n(1,o.touch++,o),n(0,a.cmd=null,a),r.notify()}}function p(t,e){f&&(o.resize(t,e),n(1,o.touch++,o))}return R((()=>{r=new zr(i,s,d),f=!0,p(l,u)})),t.$$set=t=>{"sig"in t&&n(8,i=t.sig),"cfg"in t&&n(0,a=t.cfg),"plot"in t&&n(1,o=t.plot),"cn"in t&&n(9,s=t.cn),"gridarea"in t&&n(2,h=t.gridarea)},t.$$.update=()=>{24&t.$$.dirty&&p(l,u)},[a,o,h,l,u,function(t){c=t.target},function(t){if(null!=c){var e=c.id.match(/(?<code>\D+)(?<num>\d+)/).groups;"mu"==e.code?o.setMu(e.num,t.offsetX):"xy"==e.code&&(o.setDataPoint(e.num,t.offsetX,t.offsetY),a.mu_tracks_x&&o.setMu(e.num,t.offsetX)),n(0,a.cmd="mu_xy_changed",a),d()}},function(t){c=null},i,s,function(){l=this.clientWidth,u=this.clientHeight,n(3,l),n(4,u)}]}class ri extends K{constructor(t){super(),G(this,t,ni,ei,a,{sig:8,cfg:0,plot:1,cn:9,gridarea:2})}}function ii(t){var e=t=>Math.abs(t)>1e3||Math.abs(t)<.01?t.toExponential(2):t.toFixed(2);return t instanceof Array?t.map(e):e(t)}function ai(e){let n,i,a,l,c,d,v,w,b,$,_,M,T,k,R,A,S,C,j,N,I,X,V,B,P,L,U,F,z,q,D,H,O,G,K,W,Y,Q,J,Z,tt,et,nt,rt,it=(e[1].invertible?ii(e[1].fNorm()):"Could not solve")+"",at=(e[1].invertible?ii(e[1].fNormParallel()):"Could not solve")+"",ot=(e[1].invertible?ii(e[1].fNormPerp()):"Could not solve")+"",st=ii(Math.pow(10,e[0].log_sigma))+"";return{c(){n=u("div"),i=u("div"),a=u("span"),l=m(),c=f(it),d=m(),v=u("div"),w=u("span"),b=m(),$=f(at),_=m(),M=u("div"),T=u("span"),k=m(),R=f(ot),A=m(),S=u("div"),C=u("label"),j=u("input"),N=f("\n      auto solve"),I=m(),X=u("div"),V=u("label"),B=u("input"),P=m(),L=u("span"),U=new E,F=f(" tracks "),z=new E,q=m(),D=u("div"),H=u("label"),O=u("input"),G=f("\n      scramble"),K=m(),W=u("div"),Y=u("label"),Q=u("span"),J=f(": \n      "),Z=u("input"),tt=m(),et=f(st),g(i,"class","col1 line svelte-h0ylfy"),g(v,"class","col2 line svelte-h0ylfy"),g(M,"class","col2 row2 line svelte-h0ylfy"),g(j,"id","auto_solve"),g(j,"type","checkbox"),g(C,"class","ib"),g(S,"class","col4 row1 line svelte-h0ylfy"),g(B,"id","mu_tracks_x"),g(B,"type","checkbox"),U.a=F,z.a=null,g(V,"class","ib"),g(X,"class","col4 row2 line svelte-h0ylfy"),g(O,"id","scramble"),g(O,"type","checkbox"),g(H,"class","ib"),g(D,"class","col5 row1 line svelte-h0ylfy"),g(Z,"id","set_sigma"),g(Z,"class","short svelte-h0ylfy"),g(Z,"type","range"),g(Z,"min","-5"),g(Z,"max","2"),g(Z,"step","0.01"),g(Y,"class","ib"),g(W,"class","col5 row2 line svelte-h0ylfy"),g(n,"class","gb gi svelte-h0ylfy")},m(t,r){s(t,n,r),o(n,i),o(i,a),a.innerHTML="$\\|f\\| = $",o(i,l),o(i,c),o(n,d),o(n,v),o(v,w),w.innerHTML="$\\|f_\\parallel\\| = $",o(v,b),o(v,$),o(n,_),o(n,M),o(M,T),T.innerHTML="$\\|f_\\perp\\| = $",o(M,k),o(M,R),o(n,A),o(n,S),o(S,C),o(C,j),j.checked=e[0].auto_solve,o(C,N),o(n,I),o(n,X),o(X,V),o(V,B),B.checked=e[0].mu_tracks_x,o(V,P),o(V,L),U.m("$\\mu$",L),o(L,F),z.m("$x$",L),o(n,q),o(n,D),o(D,H),o(H,O),O.checked=e[0].scramble,o(H,G),o(n,K),o(n,W),o(W,Y),o(Y,Q),Q.innerHTML="$\\sigma$",o(Y,J),o(Y,Z),x(Z,e[0].log_sigma),o(Y,tt),o(Y,et),nt||(rt=[p(j,"change",e[5]),p(j,"change",e[2]),p(B,"change",e[6]),p(B,"change",e[2]),p(O,"change",e[7]),p(O,"change",e[2]),p(Z,"change",e[8]),p(Z,"input",e[8]),p(Z,"input",e[2])],nt=!0)},p(t,[e]){2&e&&it!==(it=(t[1].invertible?ii(t[1].fNorm()):"Could not solve")+"")&&y(c,it),2&e&&at!==(at=(t[1].invertible?ii(t[1].fNormParallel()):"Could not solve")+"")&&y($,at),2&e&&ot!==(ot=(t[1].invertible?ii(t[1].fNormPerp()):"Could not solve")+"")&&y(R,ot),1&e&&(j.checked=t[0].auto_solve),1&e&&(B.checked=t[0].mu_tracks_x),1&e&&(O.checked=t[0].scramble),1&e&&x(Z,t[0].log_sigma),1&e&&st!==(st=ii(Math.pow(10,t[0].log_sigma))+"")&&y(et,st)},i:t,o:t,d(t){t&&h(n),nt=!1,r(rt)}}}function oi(t,e,n){let{sig:r}=e,{cn:i}=e,{cfg:a}=e,{plot:o}=e;function s(){n(1,o.touch++,o)}var h=new zr(r,i,s);return t.$$set=t=>{"sig"in t&&n(3,r=t.sig),"cn"in t&&n(4,i=t.cn),"cfg"in t&&n(0,a=t.cfg),"plot"in t&&n(1,o=t.plot)},[a,o,function(t){n(0,a.cmd=t.target.id,a),s(),h.notify()},r,i,function(){a.auto_solve=this.checked,n(0,a)},function(){a.mu_tracks_x=this.checked,n(0,a)},function(){a.scramble=this.checked,n(0,a)},function(){a.log_sigma=w(this.value),n(0,a)}]}class si extends K{constructor(t){super(),G(this,t,oi,ai,a,{sig:3,cn:4,cfg:0,plot:1})}}function hi(t,e,n){const r=t.slice();return r[8]=e[n],r[9]=e,r[10]=n,r}function li(t){let e,n,i,a,l,c,d,v,w,b,$,_=ii(t[8])+"";function M(){t[5].call(l,t[9],t[10])}return{c(){e=u("div"),n=u("label"),i=u("span"),a=m(),l=u("input"),d=m(),v=u("div"),w=f(_),g(l,"id",c="update_alpha"+t[10]),g(l,"class","ib slider svelte-n9jner"),g(l,"type","range"),g(l,"min","-10"),g(l,"max","10"),g(l,"step","0.01"),g(v,"class","ib svelte-n9jner"),g(n,"class","ib svelte-n9jner"),g(e,"class","alpha svelte-n9jner")},m(r,h){s(r,e,h),o(e,n),o(n,i),i.innerHTML="$\\alpha_{i}$",o(n,a),o(n,l),x(l,t[8]),o(n,d),o(n,v),o(v,w),b||($=[p(l,"change",M),p(l,"input",M),p(l,"input",t[1])],b=!0)},p(e,n){t=e,1&n&&x(l,t[8]),1&n&&_!==(_=ii(t[8])+"")&&y(w,_)},d(t){t&&h(e),b=!1,r($)}}}function ui(e){let n,i,a,c,f,d,v,w,y,x,b,$=e[0].alpha,_=[];for(let t=0;t<$.length;t+=1)_[t]=li(hi(e,$,t));return{c(){n=u("div");for(let t=0;t<_.length;t+=1)_[t].c();i=m(),a=u("button"),a.textContent="New Data",c=m(),f=u("button"),f.innerHTML="Reset <d-math>\\\\alpha</d-math>",d=m(),v=u("button"),v.textContent="Del Point",w=m(),y=u("button"),y.textContent="Add Point",g(a,"id","new_data"),g(f,"id","reset_alpha"),g(v,"id","del_point"),g(y,"id","add_point"),g(n,"class","gb svelte-n9jner")},m(t,r){s(t,n,r);for(let t=0;t<_.length;t+=1)_[t].m(n,null);o(n,i),o(n,a),o(n,c),o(n,f),o(n,d),o(n,v),o(n,w),o(n,y),x||(b=[p(a,"click",e[1]),p(f,"click",e[1]),p(v,"click",e[1]),p(y,"click",e[1])],x=!0)},p(t,[e]){if(3&e){let r;for($=t[0].alpha,r=0;r<$.length;r+=1){const a=hi(t,$,r);_[r]?_[r].p(a,e):(_[r]=li(a),_[r].c(),_[r].m(n,i))}for(;r<_.length;r+=1)_[r].d(1);_.length=$.length}},i:t,o:t,d(t){t&&h(n),l(_,t),x=!1,r(b)}}}function ci(t,e,n){let{sig:r}=e,{cn:i}=e,{cfg:a}=e,{plot:o}=e;function s(){n(0,o.touch++,o)}var h=new zr(r,i,s);return t.$$set=t=>{"sig"in t&&n(3,r=t.sig),"cn"in t&&n(4,i=t.cn),"cfg"in t&&n(2,a=t.cfg),"plot"in t&&n(0,o=t.plot)},[o,function(t){n(2,a.cmd=t.target.id,a),h.notify(),s()},a,r,i,function(t,e){t[e]=w(this.value),n(0,o)}]}class fi extends K{constructor(t){super(),G(this,t,ci,ui,a,{sig:3,cn:4,cfg:2,plot:0})}}var mi="undefined"!=typeof window?window:void 0!==Vt?Vt:"undefined"!=typeof self?self:{},di=function(t){if(!t)return!1;var e=pi.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)},pi=Object.prototype.toString;var gi=function(t){return t.replace(/^\s+|\s+$/g,"")},vi=function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)wi.call(n,r)&&(t[r]=n[r])}return t},wi=Object.prototype.hasOwnProperty;var yi=$i,xi=$i;function bi(t,e,n){var r=t;return di(e)?(n=e,"string"==typeof t&&(r={uri:t})):r=vi(e,{uri:t}),r.callback=n,r}function $i(t,e,n){return _i(e=bi(t,e,n))}function _i(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,n=function(n,r,i){e||(e=!0,t.callback(n,r,i))};function r(){var t=void 0;if(t=h.response?h.response:h.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(t){}return null}(h),p)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(l),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,n(t,g)}function a(){if(!s){var e;clearTimeout(l),e=t.useXDR&&void 0===h.status?200:1223===h.status?204:h.status;var i=g,a=null;return 0!==e?(i={body:r(),statusCode:e,method:c,headers:{},url:u,rawRequest:h},h.getAllResponseHeaders&&(i.headers=function(t){if(!t)return{};for(var e,n={},r=gi(t).split("\n"),i=0;i<r.length;i++){var a=r[i],o=a.indexOf(":"),s=gi(a.slice(0,o)).toLowerCase(),h=gi(a.slice(o+1));void 0===n[s]?n[s]=h:(e=n[s],"[object Array]"===Object.prototype.toString.call(e)?n[s].push(h):n[s]=[n[s],h])}return n}(h.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,i,i.body)}}var o,s,h=t.xhr||null;h||(h=t.cors||t.useXDR?new $i.XDomainRequest:new $i.XMLHttpRequest);var l,u=h.url=t.uri||t.url,c=h.method=t.method||"GET",f=t.body||t.data,m=h.headers=t.headers||{},d=!!t.sync,p=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:h};if("json"in t&&!1!==t.json&&(p=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),h.onreadystatechange=function(){4===h.readyState&&setTimeout(a,0)},h.onload=a,h.onerror=i,h.onprogress=function(){},h.onabort=function(){s=!0},h.ontimeout=i,h.open(c,u,!d,t.username,t.password),d||(h.withCredentials=!!t.withCredentials),!d&&t.timeout>0&&(l=setTimeout((function(){if(!s){s=!0,h.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}}),t.timeout)),h.setRequestHeader)for(o in m)m.hasOwnProperty(o)&&h.setRequestHeader(o,m[o]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(h),h.send(f||null),h}$i.XMLHttpRequest=mi.XMLHttpRequest||function(){},$i.XDomainRequest="withCredentials"in new $i.XMLHttpRequest?$i.XMLHttpRequest:mi.XDomainRequest,function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(["get","put","post","patch","head","delete"],(function(t){$i["delete"===t?"del":t]=function(e,n,r){return(n=bi(e,n,r)).method=t.toUpperCase(),_i(n)}})),yi.default=xi;var Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ti=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Ei=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),ki=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},Ri="";function Ai(t,e,n){function r(e,r){var i,a;"function"==typeof n?n(e):(i=r,(a=t.parentNode)&&(a.innerHTML='\n<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>\n<td align="center">\n<div style="display: table-cell; vertical-align: middle;">\n<div style="">'+i+"</div>\n</div>\n</td></tr></table>\n"))}if(!window.WebGLRenderingContext)return r(1,'\n\tThis page requires a browser that supports WebGL.<br/>\n\t<a href="http://get.webgl.org">Click here to upgrade your browser.</a>\n'),null;var i=function(t,e){for(var n=["webgl","experimental-webgl"],r=null,i=0;i<n.length;++i)try{r=t.getContext(n[i],e)}catch(t){if(r)break}return r}(t,e);return i?i.getExtension("OES_standard_derivatives"):r(2,'\n\tIt does not appear your computer can support WebGL.<br/>\n\t<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>\n'),i}function Si(t,e,n,r){var i=t.gl,a=i.createShader(n);return i.shaderSource(a,e),i.compileShader(a),i.getShaderParameter(a,i.COMPILE_STATUS)?a:(Ri=i.getShaderInfoLog(a),console.error("*** Error compiling shader "+a+":"+Ri),t.trigger("error",{shader:a,source:e,type:n,error:Ri,offset:r||0}),i.deleteShader(a),null)}function Ci(t,e,n,r){for(var i=t.gl,a=i.createProgram(),o=0;o<e.length;++o)i.attachShader(a,e[o]);if(n)for(var s=0;s<n.length;++s)i.bindAttribLocation(a,r?r[s]:s,n[s]);return i.linkProgram(a),i.getProgramParameter(a,i.LINK_STATUS)?a:(Ri=i.getProgramInfoLog(a),console.log("Error in program linking:"+Ri),i.deleteProgram(a),null)}function ji(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];for(var r in t){var i=t[r],a=void 0;if(e&&(r=e+"."+r),"number"==typeof i)n.push({type:"float",method:"1f",name:r,value:i});else if(Array.isArray(i)){if("number"==typeof i[0])1===i.length?n.push({type:"float",method:"1f",name:r,value:i}):i.length>=2&&i.length<=4?n.push({type:"vec"+i.length,method:i.length+"fv",name:r,value:i}):i.length>4&&n.push({type:"float[]",method:"1fv",name:r+"[0]",value:i});else if("string"==typeof i[0])n.push({type:"sampler2D",method:"1i",name:r,value:i});else if(Array.isArray(i[0])&&"number"==typeof i[0][0]){if(i[0].length>=2&&i[0].length<=4)for(a=0;a<i.length;a++)n.push({type:"vec"+i[0].length,method:i[a].length+"fv",name:r+"["+a+"]",value:i[a]})}else if("object"===Mi(i[0]))for(a=0;a<i.length;a++)n.push.apply(n,ki(ji(i[a],r+"["+a+"]")))}else"boolean"==typeof i?n.push({type:"bool",method:"1i",name:r,value:i}):"string"==typeof i?n.push({type:"sampler2D",method:"1i",name:r,value:i}):"object"===(void 0===i?"undefined":Mi(i))&&n.push.apply(n,ki(ji(i,r)))}return n}function Ni(t){return 0==(t&t-1)}function Ii(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Xi(t,e){return!(!t||!e)&&t.toString()!==e.toString()}function Vi(t){var e=new Set;return Object.assign(t,{on:function(t,n){var r={};r[t]=n,e.add(r)},off:function(t,n){if(n){var r={};r[t]=n,e.delete(r)}else{var i=!0,a=!1,o=void 0;try{for(var s,h=e[Symbol.iterator]();!(i=(s=h.next()).done);i=!0){var l=s.value,u=!0,c=!1,f=void 0;try{for(var m,d=Object.keys(l)[Symbol.iterator]();!(u=(m=d.next()).done);u=!0){if(m.value===t)return void e.delete(l)}}catch(t){c=!0,f=t}finally{try{!u&&d.return&&d.return()}finally{if(c)throw f}}}}catch(t){a=!0,o=t}finally{try{!i&&h.return&&h.return()}finally{if(a)throw o}}}},listSubscriptions:function(){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;console.log(o)}}catch(t){n=!0,r=t}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}},subscribe:function(t){e.add(t)},unsubscribe:function(t){e.delete(t)},unsubscribeAll:function(){e.clear()},trigger:function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=!0,o=!1,s=void 0;try{for(var h,l=e[Symbol.iterator]();!(a=(h=l.next()).done);a=!0){var u=h.value;"function"==typeof u[t]&&u[t].apply(u,ki(r))}}catch(t){o=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(o)throw s}}}})}var Bi=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ti(this,t),Vi(this),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.bind(),this.name=n,this.source=null,this.sourceType=null,this.loading=null,this.setData(1,1,new Uint8Array([0,0,0,255]),{filtering:"linear"}),this.setFiltering(r.filtering),this.load(r)}return Ei(t,[{key:"destroy",value:function(){this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,this.valid=!1)}},{key:"bind",value:function(e){this.valid&&("number"==typeof e&&t.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),t.activeUnit=e),t.activeTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),t.activeTexture=this.texture))}},{key:"load",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=null,"string"==typeof t.url?void 0!==this.url&&t.url===this.url||this.setUrl(t.url,t):t.element?this.setElement(t.element,t):t.data&&t.width&&t.height&&this.setData(t.width,t.height,t.data,t)}},{key:"setUrl",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.valid)return this.url=t,this.source=this.url,this.sourceType="url",this.loading=new Promise((function(r,i){var a=t.split(".").pop().toLowerCase(),o="ogv"===a||"webm"===a||"mp4"===a,s=void 0;o?((s=document.createElement("video")).autoplay=!0,n.filtering="nearest"):s=new Image,s.onload=function(){try{e.setElement(s,n)}catch(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,n)}r(e)},s.onerror=function(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,n),r(e)},Ii()&&"data:"===e.source.slice(0,5)||(s.crossOrigin="anonymous"),s.src=e.source,o&&e.setElement(s,n)})),this.loading}},{key:"setData",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.width=t,this.height=e,this.source=n,this.sourceType="data",this.update(r),this.setFiltering(r),this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var n=this,r=t;if("string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)this.source=t,this.sourceType="element",t instanceof HTMLVideoElement?(t.addEventListener("canplaythrough",(function(){n.intervalID=setInterval((function(){n.update(e)}),15)}),!0),t.addEventListener("ended",(function(){t.currentTime=0,t.play()}),!0)):this.update(e),this.setFiltering(e);else{var i="the 'element' parameter (`element: "+JSON.stringify(r)+"`) must be a CSS ";i+="selector string, or a <canvas>, <image> or <video> object",console.log("Texture '"+this.name+"': "+i,e)}return this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.valid&&(this.bind(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==t.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),"element"===this.sourceType&&(this.source instanceof HTMLCanvasElement||this.source instanceof HTMLVideoElement||this.source instanceof HTMLImageElement&&this.source.complete)?(this.source instanceof HTMLVideoElement?(this.width=this.source.videoWidth,this.height=this.source.videoHeight):(this.width=this.source.width,this.height=this.source.height),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source)):"data"===this.sourceType&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.trigger("loaded",this))}},{key:"setFiltering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.valid){this.powerOf2=Ni(this.width)&&Ni(this.height);var e=this.powerOf2?"mipmap":"linear";this.filtering=t.filtering||e;var n=this.gl;this.bind(),this.powerOf2?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t.TEXTURE_WRAP_S||t.repeat&&n.REPEAT||n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t.TEXTURE_WRAP_T||t.repeat&&n.REPEAT||n.CLAMP_TO_EDGE),"mipmap"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.generateMipmap(n.TEXTURE_2D)):"linear"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)):"nearest"===this.filtering&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST))):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),"mipmap"===this.filtering&&(this.filtering="linear"),"nearest"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)))}}}]),t}();Bi.getMaxTextureSize=function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)},Bi.activeUnit=-1;var Pi=function(){function t(e,n,r){var i=this;Ti(this,t),Vi(this),n=n||{},r=r||{},this.width=e.clientWidth,this.height=e.clientHeight,this.canvas=e,this.gl=void 0,this.program=void 0,this.textures={},this.buffers={},this.uniforms={},this.vbo={},this.isValid=!1,this.BUFFER_COUNT=0,this.vertexString=n.vertexString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n",this.fragmentString=n.fragmentString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 v_texcoord;\n\nvoid main(){\n    gl_FragColor = vec4(0.0);\n}\n";var a=Ai(e,n,r.onError);if(a){if(this.gl=a,this.timeLoad=this.timePrev=performance.now(),this.timeDelta=0,this.forceRender=!0,this.paused=!1,this.realToCSSPixels=window.devicePixelRatio||1,e.style.backgroundColor=n.backgroundColor||"rgba(1,1,1,0)",e.hasAttribute("data-fragment"))this.fragmentString=e.getAttribute("data-fragment");else if(e.hasAttribute("data-fragment-url")){var o=e.getAttribute("data-fragment-url");yi.get(o,(function(t,e,n){i.load(n,i.vertexString)}))}if(e.hasAttribute("data-vertex"))this.vertexString=e.getAttribute("data-vertex");else if(e.hasAttribute("data-vertex-url")){var s=e.getAttribute("data-vertex-url");yi.get(s,(function(t,e,n){i.load(i.fragmentString,n)}))}if(this.load(),this.program){var h=a.getAttribLocation(this.program,"a_texcoord");this.vbo.texCoords=a.createBuffer(),this.gl.bindBuffer(a.ARRAY_BUFFER,this.vbo.texCoords),this.gl.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),a.STATIC_DRAW),this.gl.enableVertexAttribArray(h),this.gl.vertexAttribPointer(h,2,a.FLOAT,!1,0,0);var l=a.getAttribLocation(this.program,"a_position");if(this.vbo.vertices=a.createBuffer(),this.gl.bindBuffer(a.ARRAY_BUFFER,this.vbo.vertices),this.gl.bufferData(a.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),a.STATIC_DRAW),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,a.FLOAT,!1,0,0),e.hasAttribute("data-textures")){var u=e.getAttribute("data-textures").split(",");for(var c in u)this.setUniform("u_tex"+c,u[c])}var f={x:0,y:0};document.addEventListener("mousemove",(function(t){f.x=t.clientX||t.pageX,f.y=t.clientY||t.pageY}),!1);var m=this;return this.setMouse({x:0,y:0}),function t(){m.nMouse>1&&m.setMouse(f),m.resize()&&(m.forceRender=!0),m.render(),window.requestAnimationFrame(t)}(),this}}}return Ei(t,[{key:"destroy",value:function(){for(var t in this.animated=!1,this.isValid=!1,this.textures)t.destroy&&t.destroy();for(var e in this.textures={},this.attribs)this.gl.deleteBuffer(this.attribs[e]);for(var n in this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.buffers){var r=this.buffers[n];this.gl.deleteProgram(r.program)}this.program=null,this.gl=null}},{key:"load",value:function(t,e){if(e&&(this.vertexString=e),t&&(this.fragmentString=t),this.animated=!1,this.nDelta=(this.fragmentString.match(/u_delta/g)||[]).length,this.nTime=(this.fragmentString.match(/u_time/g)||[]).length,this.nDate=(this.fragmentString.match(/u_date/g)||[]).length,this.nMouse=(this.fragmentString.match(/u_mouse/g)||[]).length,this.animated=this.nDate>1||this.nTime>1||this.nMouse>1,this.fragmentString.search(/sampler2D/g))for(var n=this.fragmentString.split("\n"),r=0;r<n.length;r++){var i=n[r].match(/uniform\s*sampler2D\s*([\w]*);\s*\/\/\s*([\w|\:\/\/|\.|\-|\_]*)/i);if(i){var a=i[2].split(".").pop().toLowerCase();i[1]&&i[2]&&("jpg"===a||"jpeg"===a||"png"===a||"ogv"===a||"webm"===a||"mp4"===a)&&this.setUniform(i[1],i[2])}if(n[r].match(/\s*void\s*main\s*/g))break}var o=Si(this,this.vertexString,this.gl.VERTEX_SHADER),s=Si(this,this.fragmentString,this.gl.FRAGMENT_SHADER);s?this.isValid=!0:(s=Si(this,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",this.gl.FRAGMENT_SHADER),this.isValid=!1);var h=Ci(this,[o,s]);this.gl.useProgram(h),this.gl.deleteShader(o),this.gl.deleteShader(s),this.program=h,this.change=!0,this.BUFFER_COUNT=0;var l=this.getBuffers(this.fragmentString);Object.keys(l).length&&this.loadPrograms(l),this.buffers=l,this.texureIndex=this.BUFFER_COUNT,this.trigger("load",{}),this.forceRender=!0,this.render()}},{key:"test",value:function(t,e,n){var r=this.vertexString,i=this.fragmentString,a=this.paused,o=this.gl.getExtension("EXT_disjoint_timer_query"),s=o.createQueryEXT(),h=this.isValid;(e||n)&&(this.load(e,n),h=this.isValid,this.forceRender=!0,this.render()),this.paused=!0,o.beginQueryEXT(o.TIME_ELAPSED_EXT,s),this.forceRender=!0,this.render(),o.endQueryEXT(o.TIME_ELAPSED_EXT);var l=this;!function u(){l.forceRender=!0,l.render();var c=o.getQueryObjectEXT(s,o.QUERY_RESULT_AVAILABLE_EXT),f=l.gl.getParameter(o.GPU_DISJOINT_EXT);if(c&&!f){var m={wasValid:h,frag:e||l.fragmentString,vert:n||l.vertexString,timeElapsedMs:o.getQueryObjectEXT(s,o.QUERY_RESULT_EXT)/1e6};l.paused=a,(e||n)&&l.load(i,r),t(m)}else window.requestAnimationFrame(u)}()}},{key:"loadTexture",value:function(t,e,n){var r=this;n||(n={}),"string"==typeof e?n.url=e:"object"===(void 0===e?"undefined":Mi(e))&&e.data&&e.width&&e.height?(n.data=e.data,n.width=e.width,n.height=e.height):"object"===(void 0===e?"undefined":Mi(e))&&(n.element=e),this.textures[t]?this.textures[t]&&(this.textures[t].load(n),this.textures[t].on("loaded",(function(t){r.forceRender=!0}))):(this.textures[t]=new Bi(this.gl,t,n),this.textures[t].on("loaded",(function(t){r.forceRender=!0})))}},{key:"refreshUniforms",value:function(){this.uniforms={}}},{key:"setUniform",value:function(t){for(var e={},n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e[t]=r,this.setUniforms(e)}},{key:"setUniforms",value:function(t){var e=ji(t);for(var n in e)"sampler2D"===e[n].type?this.loadTexture(e[n].name,e[n].value[0]):this.uniform(e[n].method,e[n].type,e[n].name,e[n].value);this.forceRender=!0}},{key:"setMouse",value:function(t){var e=this.canvas.getBoundingClientRect();if(t&&t.x&&t.x>=e.left&&t.x<=e.right&&t.y&&t.y>=e.top&&t.y<=e.bottom){var n=(t.x-e.left)*this.realToCSSPixels,r=this.canvas.height-(t.y-e.top)*this.realToCSSPixels;this.uniform("2f","vec2","u_mouse",n,r)}}},{key:"uniform",value:function(t,e,n){this.uniforms[n]=this.uniforms[n]||{};for(var r=this.uniforms[n],i=arguments.length,a=Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var s=Xi(r.value,a);if(s||this.change||!r.location||!r.value)for(var h in r.name=n,r.type=e,r.value=a,r.method="uniform"+t,this.gl.useProgram(this.program),r.location=this.gl.getUniformLocation(this.program,n),this.gl[r.method].apply(this.gl,[r.location].concat(r.value)),this.buffers){var l=this.buffers[h];this.gl.useProgram(l.program);var u=this.gl.getUniformLocation(l.program,n);this.gl[r.method].apply(this.gl,[u].concat(r.value))}}},{key:"uniformTexture",value:function(t,e,n){if(void 0===this.textures[t])this.loadTexture(t,e,n);else{for(var r in this.uniform("1i","sampler2D",t,this.texureIndex),this.buffers){var i=this.buffers[r];this.gl.useProgram(i.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture)}this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture),this.uniform("2f","vec2",t+"Resolution",this.textures[t].width,this.textures[t].height)}}},{key:"resize",value:function(){if(this.width!==this.canvas.clientWidth||this.height!==this.canvas.clientHeight){this.realToCSSPixels=window.devicePixelRatio||1;var t=Math.floor(this.gl.canvas.clientWidth*this.realToCSSPixels),e=Math.floor(this.gl.canvas.clientHeight*this.realToCSSPixels);return this.gl.canvas.width===t&&this.gl.canvas.height===e||(this.gl.canvas.width=t,this.gl.canvas.height=e,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.resizeSwappableBuffers(),!0}return!1}},{key:"render",value:function(){var t;if(this.visible=(t=this.canvas).getBoundingClientRect().top+t.height>0&&t.getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight),this.forceRender||this.change||this.animated&&this.visible&&!this.paused){var e=new Date,n=performance.now();for(var r in this.timeDelta=(n-this.timePrev)/1e3,this.timePrev=n,this.nDelta>1&&this.uniform("1f","float","u_delta",this.timeDelta),this.nTime>1&&this.uniform("1f","float","u_time",(n-this.timeLoad)/1e3),this.nDate&&this.uniform("4f","float","u_date",e.getFullYear(),e.getMonth(),e.getDate(),3600*e.getHours()+60*e.getMinutes()+e.getSeconds()+.001*e.getMilliseconds()),this.uniform("2f","vec2","u_resolution",this.canvas.width,this.canvas.height),this.buffers){var i=this.buffers[r];this.uniform("1i","sampler2D",i.name,i.bundle.input.index)}for(var a in this.texureIndex=this.BUFFER_COUNT,this.textures)this.uniformTexture(a),this.texureIndex++;this.renderPrograms(),this.trigger("render",{}),this.change=!1,this.forceRender=!1}}},{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"renderPrograms",value:function(){var t=this.gl,e=t.canvas.width,n=t.canvas.height;for(var r in t.viewport(0,0,e,n),this.buffers){var i=this.buffers[r];i.bundle.render(e,n,i.program,i.name),t.bindFramebuffer(t.FRAMEBUFFER,null)}t.useProgram(this.program),t.drawArrays(t.TRIANGLES,0,6)}},{key:"getBuffers",value:function(t){var e={};return t&&t.replace(/(?:^\s*)((?:#if|#elif)(?:\s*)(defined\s*\(\s*BUFFER_)(\d+)(?:\s*\))|(?:#ifdef)(?:\s*BUFFER_)(\d+)(?:\s*))/gm,(function(){var n=arguments[3]||arguments[4];e["u_buffer"+n]={fragment:"#define BUFFER_"+n+"\n"+t}})),e}},{key:"loadPrograms",value:function(t){var e=this,n=this.gl,r=Si(e,e.vertexString,n.VERTEX_SHADER);for(var i in t){var a=t[i],o=Si(e,a.fragment,n.FRAGMENT_SHADER,1);o?e.isValid=!0:(o=Si(e,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",n.FRAGMENT_SHADER),e.isValid=!1);var s=Ci(e,[r,o]);a.name=i,a.program=s,a.bundle=e.createSwappableBuffer(e.canvas.width,e.canvas.height,s),n.deleteShader(o)}n.deleteShader(r)}},{key:"createSwappableBuffer",value:function(t,e,n){var r=this.createBuffer(t,e,n),i=this.createBuffer(t,e,n),a=this.gl;return{input:r,output:i,swap:function(){var t=r;r=i,i=t,this.input=r,this.output=i},render:function(t,e,n,r){a.useProgram(n),a.viewport(0,0,t,e),a.bindFramebuffer(a.FRAMEBUFFER,this.input.buffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.output.texture,0),a.drawArrays(a.TRIANGLES,0,6),this.swap()},resize:function(t,e,n,r){a.useProgram(n),a.viewport(0,0,t,e),this.input.resize(t,e),this.output.resize(t,e)}}}},{key:"createBuffer",value:function(t,e,n){var r=this.gl,i=this.BUFFER_COUNT;this.BUFFER_COUNT+=2,r.getExtension("OES_texture_float");var a=r.createTexture();r.activeTexture(r.TEXTURE0+i),r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.FLOAT,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var o=r.createFramebuffer();return{index:i,texture:a,buffer:o,W:t,H:e,resize:function(t,e){r.bindFramebuffer(r.FRAMEBUFFER,o);var n=Math.min(t,this.W),s=Math.min(e,this.H),h=new Float32Array(n*s*4);r.readPixels(0,0,n,s,r.RGBA,r.FLOAT,h),r.bindFramebuffer(r.FRAMEBUFFER,null);var l=i+1,u=r.createTexture();r.activeTexture(r.TEXTURE0+l),r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.FLOAT,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,n,s,r.RGBA,r.FLOAT,h);var c=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.activeTexture(r.TEXTURE0+i),r.bindTexture(r.TEXTURE_2D,u),i=this.index=i,a=this.texture=u,o=this.buffer=c,this.W=t,this.H=e}}}},{key:"resizeSwappableBuffers",value:function(){var t=this.gl,e=t.canvas.width,n=t.canvas.height;for(var r in t.viewport(0,0,e,n),this.buffers){var i=this.buffers[r];i.bundle.resize(e,n,i.program,i.name)}t.useProgram(this.program)}},{key:"version",value:function(){return"0.1.7"}}]),t}();window.addEventListener("load",(function(){!function(){var t=document.getElementsByClassName("glslCanvas");if(t.length>0){window.glslCanvases=[];for(var e=0;e<t.length;e++){var n=new Pi(t[e]);n.isValid&&window.glslCanvases.push(n)}}}()}));function Li(t,e,n){const r=t.slice();return r[19]=e[n],r}function Ui(t,e,n){const r=t.slice();return r[22]=e[n],r}function Fi(t){let e,n=t[0].x,r=[];for(let e=0;e<n.length;e+=1)r[e]=qi(Li(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(193&i){let a;for(n=t[0].x,a=0;a<n.length;a+=1){const o=Li(t,n,a);r[a]?r[a].p(o,i):(r[a]=qi(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function zi(t){let e,n,r;return{c(){e=c("circle"),g(e,"cx",n=t[6](t[19])),g(e,"cy",r=t[7](t[22])),g(e,"r","2"),g(e,"fill","rgba(255,0,0,1)")},m(t,n){s(t,e,n)},p(t,i){1&i&&n!==(n=t[6](t[19]))&&g(e,"cx",n),1&i&&r!==(r=t[7](t[22]))&&g(e,"cy",r)},d(t){t&&h(e)}}}function qi(t){let e,n=t[0].mu,r=[];for(let e=0;e<n.length;e+=1)r[e]=zi(Ui(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(193&i){let a;for(n=t[0].mu,a=0;a<n.length;a+=1){const o=Ui(t,n,a);r[a]?r[a].p(o,i):(r[a]=zi(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Di(e){let n,r,i,a,o,l,f,d,p,v=e[3]&&Fi(e);return{c(){n=u("div"),a=m(),o=u("canvas"),f=m(),d=c("svg"),v&&v.c(),g(n,"class",r=e[1]+" invis-framed svelte-1cp5z7m"),X((()=>e[10].call(n))),g(o,"class",l=e[1]+" framed z1 svelte-1cp5z7m"),g(d,"class",p=e[1]+" framed z2 svelte-1cp5z7m")},m(t,r){s(t,n,r),i=T(n,e[10].bind(n)),s(t,a,r),s(t,o,r),e[11](o),s(t,f,r),s(t,d,r),v&&v.m(d,null),e[12](d)},p(t,[e]){2&e&&r!==(r=t[1]+" invis-framed svelte-1cp5z7m")&&g(n,"class",r),2&e&&l!==(l=t[1]+" framed z1 svelte-1cp5z7m")&&g(o,"class",l),t[3]?v?v.p(t,e):(v=Fi(t),v.c(),v.m(d,null)):v&&(v.d(1),v=null),2&e&&p!==(p=t[1]+" framed z2 svelte-1cp5z7m")&&g(d,"class",p)},i:t,o:t,d(t){t&&h(n),i(),t&&h(a),t&&h(o),e[11](null),t&&h(f),t&&h(d),v&&v.d(),e[12](null)}}}function Hi(t,e,n){let r,i,a,o,s,h,{sig:l}=e,{cn:u}=e,{plot:c}=e,{gridarea:f}=e,m=!1;function d(t){return o.clientHeight*(t-r)/(i-r)}function p(t){if(m){var e=o.clientHeight;o.setAttribute("width",e),s.setAttribute("width",e),g()}}function g(){var t=Math.sqrt(c.get_sigma2()),e=c.scrambled(),o=c.cut_size();[r,i]=c.get_xrange(),a instanceof Pi&&(a.setUniform("u_sigma",t),a.setUniform("cut_size",o),a.setUniform("u_do_scramble",e?1:0),a.setUniform("u_xmin",r),a.setUniform("u_xmax",i)),n(0,c.touch++,c)}return R((()=>{new zr(l,u,g);var t=s.getContext("webgl")||s.getContext("experimental-webgl");t&&t instanceof WebGLRenderingContext&&(a=new Pi(s),a.load("precision mediump float;precision lowp int;\n#define GLSLIFY 1\nuniform vec2 u_resolution;uniform float u_sigma;uniform float cut_size;uniform bool u_do_scramble;uniform float u_xmin;uniform float u_xmax;const vec3 blue=vec3(0.0,0.0,1.0);const vec3 white=vec3(1.0,1.0,1.0);const float pi=3.1415926539;float slope=u_xmax-u_xmin;float intercept=u_xmin;float scramble(float x){float d=floor(x/cut_size);float r=x-d*cut_size;if(abs(mod(d,2.0))==1.0){x=x+cut_size-2.0*r;}return x;}float kernel(vec2 st){float fac=1.0/(u_sigma*sqrt(2.0*pi));return fac*exp(-0.5*pow((st.x-st.y)/u_sigma,2.0));}void main(){vec2 st=gl_FragCoord.xy/u_resolution;st=vec2(st.x,1.0-st.y)*slope+intercept;if(u_do_scramble){st=vec2(scramble(st.x),st.y);}float k=kernel(st)/kernel(vec2(0.0,0.0));vec3 color=k*blue+(1.0-k)*white;gl_FragColor=vec4(color,1.0);}")),n(3,m=!0),p()})),t.$$set=t=>{"sig"in t&&n(8,l=t.sig),"cn"in t&&n(9,u=t.cn),"plot"in t&&n(0,c=t.plot),"gridarea"in t&&n(1,f=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty&&p()},[c,f,h,m,o,s,d,function(t){return d(t)},l,u,function(){h=this.clientHeight,n(2,h)},function(t){S[t?"unshift":"push"]((()=>{s=t,n(5,s)}))},function(t){S[t?"unshift":"push"]((()=>{o=t,n(4,o)}))}]}class Oi extends K{constructor(t){super(),G(this,t,Hi,Di,a,{sig:8,cn:9,plot:0,gridarea:1})}}function Gi(t,e,n){const r=t.slice();return r[13]=e[n].x,r[14]=e[n].y,r[15]=e[n].v,r[16]=e[n].side,r}function Ki(t){let e,n=t[5](t[0]),r=[];for(let e=0;e<n.length;e+=1)r[e]=Wi(Gi(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(33&i){let a;for(n=t[5](t[0]),a=0;a<n.length;a+=1){const o=Gi(t,n,a);r[a]?r[a].p(o,i):(r[a]=Wi(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Wi(t){let e,n,r,i,a;return{c(){e=c("rect"),g(e,"width",n=t[16]),g(e,"height",r=t[16]),g(e,"x",i=t[13]),g(e,"y",a=t[14]),b(e,"fill",Qi(t[15]))},m(t,n){s(t,e,n)},p(t,o){1&o&&n!==(n=t[16])&&g(e,"width",n),1&o&&r!==(r=t[16])&&g(e,"height",r),1&o&&i!==(i=t[13])&&g(e,"x",i),1&o&&a!==(a=t[14])&&g(e,"y",a),1&o&&b(e,"fill",Qi(t[15]))},d(t){t&&h(e)}}}function Yi(e){let n,r,i,a,o,l,f=e[4]&&Ki(e);return{c(){n=u("div"),a=m(),o=c("svg"),f&&f.c(),g(n,"class",r="invis-framed "+e[1]+" svelte-29ayl0"),X((()=>e[8].call(n))),g(o,"class",l="framed "+e[1]+" svelte-29ayl0")},m(t,r){s(t,n,r),i=T(n,e[8].bind(n)),s(t,a,r),s(t,o,r),f&&f.m(o,null),e[9](o)},p(t,[e]){2&e&&r!==(r="invis-framed "+t[1]+" svelte-29ayl0")&&g(n,"class",r),t[4]?f?f.p(t,e):(f=Ki(t),f.c(),f.m(o,null)):f&&(f.d(1),f=null),2&e&&l!==(l="framed "+t[1]+" svelte-29ayl0")&&g(o,"class",l)},i:t,o:t,d(t){t&&h(n),i(),t&&h(a),t&&h(o),f&&f.d(),e[9](null)}}}function Qi(t){var e=255*t;return`rgba(${255-e}, ${255-e}, 255)`}function Ji(t,e,n){let r,i,{sig:a}=e,{cn:o}=e,{plot:s}=e,{gridarea:h}=e,l=!1;function u(t){if(l){var e=i.clientHeight;i.setAttribute("width",e),c()}}function c(){n(0,s.touch++,s)}return R((()=>{new zr(a,o,c),n(4,l=!0),u()})),t.$$set=t=>{"sig"in t&&n(6,a=t.sig),"cn"in t&&n(7,o=t.cn),"plot"in t&&n(0,s=t.plot),"gridarea"in t&&n(1,h=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty&&u()},[s,h,r,i,l,function(t){var e=[];if(0==t.n)return e;var n=i.clientHeight,r=1==t.n?n:.9*n,a=n-r,o=r/t.n,s=o+(t.n>1?a/(t.n-1):0);for(let n=0;n!=t.n;n++)for(let r=0;r!=t.n;r++)e.push({x:s*n,y:s*r,v:t.pft[n][r],side:o});return e},a,o,function(){r=this.clientHeight,n(2,r)},function(t){S[t?"unshift":"push"]((()=>{i=t,n(3,i)}))}]}class Zi extends K{constructor(t){super(),G(this,t,Ji,Yi,a,{sig:6,cn:7,plot:0,gridarea:1})}}function ta(e){let n,r,i,a,l,c,f,d,p,v,w,y,x,b,$,_,M,T,E,k,R,A,S,C,j;return i=new ri({props:{sig:e[3],cn:"1",cfg:e[1],plot:e[2],gridarea:"curves"}}),l=new fi({props:{sig:e[3],cn:"3",cfg:e[1],plot:e[2]}}),f=new si({props:{sig:e[3],cn:"2",cfg:e[1],plot:e[2]}}),y=new Oi({props:{sig:e[3],cn:"4",plot:e[2],gridarea:"cell2"}}),_=new Zi({props:{sig:e[3],cn:"5",plot:e[2],gridarea:"cell6"}}),{c(){n=u("div"),r=u("div"),q(i.$$.fragment),a=m(),q(l.$$.fragment),c=m(),q(f.$$.fragment),d=m(),p=u("div"),v=u("div"),w=m(),q(y.$$.fragment),x=m(),b=u("div"),$=m(),q(_.$$.fragment),M=m(),T=u("div"),E=m(),k=u("div"),R=m(),A=u("div"),S=m(),C=u("div"),g(r,"class","fi-upper gbox-upper svelte-frau4j"),g(v,"class","y1 svelte-frau4j"),g(b,"class","y2 svelte-frau4j"),g(T,"class","x1 svelte-frau4j"),g(k,"class","x2 svelte-frau4j"),g(A,"class","cap1 svelte-frau4j"),g(C,"class","cap2 svelte-frau4j"),g(p,"class","fi-lower gbox-lower svelte-frau4j"),g(n,"class",e[0]+" fb-vert svelte-frau4j")},m(t,e){s(t,n,e),o(n,r),D(i,r,null),o(r,a),D(l,r,null),o(r,c),D(f,r,null),o(n,d),o(n,p),o(p,v),v.innerHTML="$\\mu$",o(p,w),D(y,p,null),o(p,x),o(p,b),b.innerHTML="$\\mu_i$",o(p,$),D(_,p,null),o(p,M),o(p,T),T.innerHTML="$x$",o(p,E),o(p,k),k.innerHTML="$x_i$",o(p,R),o(p,A),A.innerHTML="$\\mathcal{N}(x; \\mu, \\sigma)$",o(p,S),o(p,C),C.innerHTML="$\\mathcal{N}(x_i; \\mu_i, \\sigma)$",j=!0},p:t,i(t){j||(F(i.$$.fragment,t),F(l.$$.fragment,t),F(f.$$.fragment,t),F(y.$$.fragment,t),F(_.$$.fragment,t),j=!0)},o(t){z(i.$$.fragment,t),z(l.$$.fragment,t),z(f.$$.fragment,t),z(y.$$.fragment,t),z(_.$$.fragment,t),j=!1},d(t){t&&h(n),H(i),H(l),H(f),H(y),H(_)}}}function ea(t,e,n){let{fullscreen:r=!1}=e,i=r?"screen100":"screen80",a=new Fr(0,0,[-4,4],[-4,4]),o=new Ur(a,3),s=Y(0);return t.$$set=t=>{"fullscreen"in t&&n(4,r=t.fullscreen)},[i,{cmd:null,points:!1,curves:!0,solution:!0,auto_solve:!1,mu_tracks_x:!0,scramble:!1,log_sigma:0,show_data:!0},o,s,r]}class na extends K{constructor(t){super(),G(this,t,ea,ta,a,{fullscreen:4})}}function ra(t,e){return t[0]*e[0]+t[1]*e[1]}function ia(t,e){return function(t,e){return[t[0]*e,t[1]*e]}(t,ra(t,e)/ra(n=t,n));var n}class aa{constructor(t){this.basis=new Rt([[1,0],[0,0]]),this.xTou=Nr().domain([-t,t]),this.yTov=Nr().domain([-t,t]);var e=new Fr(10,10,[-4,4],[-4,4]);this.plot=new Ur(e,2),this.updateBasis(),this.plot.init_metrics(),this.plot.initCurveCache()}toUV(t){return[this.xTou(t[0]),this.yTov(t[1])]}toXY(t){return[this.xTou.invert(t[0]),this.yTov.invert(t[1])]}resize(t,e){this.xTou.range([0,t]),this.yTov.range([e,0]),this.plot.resize(t,e)}updateBasis(){var t=this.plot.ppt[0][1],e=Math.acos(t);this.basis[1][0]=Math.cos(e),this.basis[1][1]=Math.sin(e)}updateF(t,e){var n=this.toXY([t,e]),r=new Rt([n]);this.plot.alpha=r.mmul(Ct(this.basis)).flat()}F(){var[t,e]=this.alpha().mmul(this.basis).flat(),[n,r]=[this.xTou(t),this.yTov(e)];return{u:n,v:r,deg:Math.atan2(e,t)*(-180/Math.PI)}}updateY(t,e){var n=new Rt([this.toXY([t,e])]).mmul(Ct(this.basis)).mmul(this.plot.pft);this.plot.y=n.flat()}_fHat(){return new Rt([this.plot.solutionAlpha()]).mmul(this.basis).flat()}fHat(){var t=this._fHat();return this.toUV(t)}fHatProj(t){var e=ia(this.basis[t],this._fHat());return this.toUV(e)}alpha(){return new Rt([this.plot.alpha])}scr(t){return this.toUV(this.basis[t])}}function oa(t,e,n){const r=t.slice();return r[17]=e[n].p1,r[18]=e[n].p2,r}function sa(t,e,n){const r=t.slice();return r[21]=e[n][0],r[22]=e[n][1],r}function ha(t,e,n){const r=t.slice();return r[25]=e[n][0],r[26]=e[n][1],r}function la(t,e,n){const r=t.slice();return r[21]=e[n][0],r[22]=e[n][1],r}function ua(t,e,n){const r=t.slice();return r[25]=e[n][0],r[26]=e[n][1],r}function ca(t){let e,n,r,i,a;return{c(){e=c("line"),g(e,"class","basis svelte-li3dzh"),g(e,"x1",n=t[21]),g(e,"y1",r=t[22]),g(e,"x2",i=t[25]),g(e,"y2",a=t[26]),g(e,"marker-end","url(#basis-arrow)")},m(t,n){s(t,e,n)},p(t,o){1&o[0]&&n!==(n=t[21])&&g(e,"x1",n),1&o[0]&&r!==(r=t[22])&&g(e,"y1",r),1&o[0]&&i!==(i=t[25])&&g(e,"x2",i),1&o[0]&&a!==(a=t[26])&&g(e,"y2",a)},d(t){t&&h(e)}}}function fa(t){let e,n=[t[0].scr(0),t[0].scr(1)],r=[];for(let e=0;e<2;e+=1)r[e]=ca(ua(t,n,e));return{c(){for(let t=0;t<2;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<2;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(1&i[0]){let a;for(n=[t[0].scr(0),t[0].scr(1)],a=0;a<2;a+=1){const o=ua(t,n,a);r[a]?r[a].p(o,i):(r[a]=ca(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<2;a+=1)r[a].d(1)}},d(t){l(r,t),t&&h(e)}}}function ma(t){let e,n,r,i,a,o,l,u,f,m;return{c(){e=c("line"),o=c("circle"),g(e,"class","perp svelte-li3dzh"),g(e,"x1",n=t[21]),g(e,"y1",r=t[22]),g(e,"x2",i=t[25]),g(e,"y2",a=t[26]),g(e,"stroke-dasharray","4 4"),g(o,"id","fhat"),g(o,"class","perp-target draggable svelte-li3dzh"),g(o,"r","6"),g(o,"cx",l=t[21]),g(o,"cy",u=t[22])},m(n,r){s(n,e,r),s(n,o,r),f||(m=p(o,"mousedown",t[4]),f=!0)},p(t,s){1&s[0]&&n!==(n=t[21])&&g(e,"x1",n),1&s[0]&&r!==(r=t[22])&&g(e,"y1",r),1&s[0]&&i!==(i=t[25])&&g(e,"x2",i),1&s[0]&&a!==(a=t[26])&&g(e,"y2",a),1&s[0]&&l!==(l=t[21])&&g(o,"cx",l),1&s[0]&&u!==(u=t[22])&&g(o,"cy",u)},d(t){t&&h(e),t&&h(o),f=!1,m()}}}function da(t){let e,n=[t[0].fHatProj(0),t[0].fHatProj(1)],r=[];for(let e=0;e<2;e+=1)r[e]=ma(ha(t,n,e));return{c(){for(let t=0;t<2;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<2;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(17&i[0]){let a;for(n=[t[0].fHatProj(0),t[0].fHatProj(1)],a=0;a<2;a+=1){const o=ha(t,n,a);r[a]?r[a].p(o,i):(r[a]=ma(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<2;a+=1)r[a].d(1)}},d(t){l(r,t),t&&h(e)}}}function pa(t){let e,n,r,i,a,o,l,u,f,m,d;return{c(){e=c("line"),o=c("use"),g(e,"class","solution-curve svelte-li3dzh"),g(e,"x1",n=t[17][0]),g(e,"y1",r=t[17][1]),g(e,"x2",i=t[18].u),g(e,"y2",a=t[18].v),g(o,"class","solution-arrow draggable svelte-li3dzh"),v(o,"xlink:href","#pointer"),g(o,"id","f"),g(o,"x",l=t[18].u),g(o,"y",u=t[18].v),g(o,"transform",f="rotate("+t[18].deg+", "+t[18].u+", "+t[18].v+")")},m(n,r){s(n,e,r),s(n,o,r),m||(d=p(o,"mousedown",t[4]),m=!0)},p(t,s){1&s[0]&&n!==(n=t[17][0])&&g(e,"x1",n),1&s[0]&&r!==(r=t[17][1])&&g(e,"y1",r),1&s[0]&&i!==(i=t[18].u)&&g(e,"x2",i),1&s[0]&&a!==(a=t[18].v)&&g(e,"y2",a),1&s[0]&&l!==(l=t[18].u)&&g(o,"x",l),1&s[0]&&u!==(u=t[18].v)&&g(o,"y",u),1&s[0]&&f!==(f="rotate("+t[18].deg+", "+t[18].u+", "+t[18].v+")")&&g(o,"transform",f)},d(t){t&&h(e),t&&h(o),m=!1,d()}}}function ga(e){let n,i,a,f,v,w,y,x,b,$,_,M,E,k,R=[e[0].toUV([0,0])],A=[];for(let t=0;t<1;t+=1)A[t]=fa(la(e,R,t));let S=function(t){let e,n=[t[0].fHat()],r=[];for(let e=0;e<1;e+=1)r[e]=da(sa(t,n,e));return{c(){for(let t=0;t<1;t+=1)r[t].c();e=d()},m(t,n){for(let e=0;e<1;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(17&i[0]){let a;for(n=[t[0].fHat()],a=0;a<1;a+=1){const o=sa(t,n,a);r[a]?r[a].p(o,i):(r[a]=da(o),r[a].c(),r[a].m(e.parentNode,e))}for(;a<1;a+=1)r[a].d(1)}},d(t){l(r,t),t&&h(e)}}}(e),C=[{p1:e[0].toUV([0,0]),p2:e[0].F()}],j=[];for(let t=0;t<1;t+=1)j[t]=pa(oa(e,C,t));return{c(){n=u("div"),f=m(),v=c("svg"),w=c("defs"),y=c("marker"),x=c("path"),b=c("polygon");for(let t=0;t<1;t+=1)A[t].c();$=d(),S&&S.c(),_=d();for(let t=0;t<1;t+=1)j[t].c();g(n,"class",i=e[1]+" framed z3 svelte-li3dzh"),X((()=>e[10].call(n))),g(x,"d","M 0 0 L 10 5 L 0 10 z"),g(y,"id","basis-arrow"),g(y,"class","basis-arrow svelte-li3dzh"),g(y,"viewBox","0 0 10 10"),g(y,"refX","10"),g(y,"refY","5"),g(y,"markerWidth","6"),g(y,"markerHeight","6"),g(y,"orient","auto-start-reverse"),g(b,"id","pointer"),g(b,"points","-10,-5 0,0 -10,5"),g(v,"class",M=e[1]+" framed svelte-li3dzh")},m(t,r){s(t,n,r),a=T(n,e[10].bind(n)),s(t,f,r),s(t,v,r),o(v,w),o(w,y),o(y,x),o(w,b);for(let t=0;t<1;t+=1)A[t].m(v,null);o(v,$),S&&S.m(v,null),o(v,_);for(let t=0;t<1;t+=1)j[t].m(v,null);e[11](v),E||(k=[p(v,"mousemove",e[5]),p(v,"mouseup",e[6])],E=!0)},p(t,e){if(2&e[0]&&i!==(i=t[1]+" framed z3 svelte-li3dzh")&&g(n,"class",i),1&e[0]){let n;for(R=[t[0].toUV([0,0])],n=0;n<1;n+=1){const r=la(t,R,n);A[n]?A[n].p(r,e):(A[n]=fa(r),A[n].c(),A[n].m(v,$))}for(;n<1;n+=1)A[n].d(1)}if(S.p(t,e),17&e[0]){let n;for(C=[{p1:t[0].toUV([0,0]),p2:t[0].F()}],n=0;n<1;n+=1){const r=oa(t,C,n);j[n]?j[n].p(r,e):(j[n]=pa(r),j[n].c(),j[n].m(v,null))}for(;n<1;n+=1)j[n].d(1)}2&e[0]&&M!==(M=t[1]+" framed svelte-li3dzh")&&g(v,"class",M)},i:t,o:t,d(t){t&&h(n),a(),t&&h(f),t&&h(v),l(A,t),S&&S.d(),l(j,t),e[11](null),E=!1,r(k)}}}function va(t,e,n){let r,i,a,{sig:o}=e,{cn:s}=e,{cfg:h}=e,{pp:l}=e,{gridarea:u}=e,c=!1,f=null;function m(){c&&(l.updateBasis(),n(0,l.plot.touch++,l),n(0,l.touch++,l))}function d(t){if(c){var e=a.clientHeight;a.setAttribute("width",e),l.resize(e,e),n(0,l.plot.touch++,l),n(0,l.touch++,l)}}return R((()=>{r=new zr(o,s,m),c=!0,d(),m()})),t.$$set=t=>{"sig"in t&&n(8,o=t.sig),"cn"in t&&n(9,s=t.cn),"cfg"in t&&n(7,h=t.cfg),"pp"in t&&n(0,l=t.pp),"gridarea"in t&&n(1,u=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty[0]&&d()},[l,u,i,a,function(t){f=t.target},function(t){null!=f&&("fhat"==f.id?(l.updateY(t.offsetX,t.offsetY),n(7,h.cmd="mu_xy_changed",h)):(l.updateF(t.offsetX,t.offsetY),n(7,h.cmd="update_alpha",h)),m(),r.notify())},function(t){f=null},h,o,s,function(){i=this.clientHeight,n(2,i)},function(t){S[t?"unshift":"push"]((()=>{a=t,n(3,a)}))}]}class wa extends K{constructor(t){super(),G(this,t,va,ga,a,{sig:8,cn:9,cfg:7,pp:0,gridarea:1},null,[-1,-1])}}function ya(e){let n,r,i,a,l,c,d,p,v,w,y,x,b;return r=new ri({props:{sig:e[2],cfg:e[0],cn:"1",plot:e[1].plot,gridarea:"curves"}}),a=new wa({props:{sig:e[2],cn:"2",cfg:e[0],pp:e[1],gridarea:"phi"}}),c=new si({props:{sig:e[2],cfg:e[0],cn:"3",plot:e[1].plot}}),{c(){n=u("div"),q(r.$$.fragment),i=m(),q(a.$$.fragment),l=m(),q(c.$$.fragment),d=m(),p=u("div"),v=f("Plane spanned by "),w=new E,y=f(" and "),x=new E,w.a=y,x.a=null,g(n,"class","gb screen svelte-h34vza")},m(t,e){s(t,n,e),D(r,n,null),o(n,i),D(a,n,null),o(n,l),D(c,n,null),o(n,d),o(n,p),o(p,v),w.m("$\\vec\\phi_\\sigma(\\mu_1)$",p),o(p,y),x.m("$\\vec\\phi_\\sigma(\\mu_2)$",p),b=!0},p:t,i(t){b||(F(r.$$.fragment,t),F(a.$$.fragment,t),F(c.$$.fragment,t),b=!0)},o(t){z(r.$$.fragment,t),z(a.$$.fragment,t),z(c.$$.fragment,t),b=!1},d(t){t&&h(n),H(r),H(a),H(c)}}}function xa(t){return[{cmd:null,points:!1,curves:!0,solution:!0,auto_solve:!1,mu_tracks_x:!0,scramble:!1,log_sigma:0,show_data:!0},new aa(4),Y(0)]}class ba extends K{constructor(t){super(),G(this,t,xa,ya,a,{})}}function $a(e){let n,r,i,a,l,c,d,p,v,w,y,x,b,$,_,M,T,k,R,A,S,C,j,N,I,X,V,B,P,L,U,O,G,K,W,Y,Q,J,Z,tt,et,nt,rt,it,at,ot,st,ht,lt,ut,ct,ft,mt,dt,pt,gt,vt,wt,yt,xt,bt,$t,_t,Mt,Tt,Et,kt,Rt,At,St,Ct,jt,Nt,It,Xt,Vt,Bt,Pt,Lt,Ut,Ft,zt,qt,Dt,Ht,Ot,Gt,Kt,Wt,Yt,Qt,Jt,Zt,te,ee,ne,re,ie,ae,oe,se,he,le,ue,ce,fe,me,de,pe,ge,ve,we,ye,xe,be,$e,_e,Me,Te,Ee,ke,Re,Ae,Se,Ce,je,Ne,Ie,Xe,Ve,Be,Pe,Le,Ue,Fe,ze,qe,De,He,Oe,Ge,Ke,We,Ye,Qe,Je,Ze,tn,en,nn,rn,an,on,sn,hn,ln,un,cn,fn,mn,dn,pn,gn,vn,wn,yn,xn,bn,$n,_n,Mn,Tn,En,kn,Rn,An,Sn,Cn,jn,Nn,In,Xn,Vn,Bn,Pn,Ln,Un,Fn,zn,qn,Dn,Hn,On,Gn,Kn,Wn,Yn,Qn,Jn,Zn,tr,er,nr,rr,ir,ar,or,sr,hr,lr,ur,cr,fr,mr,dr,pr,gr,vr,wr,yr,xr,br,$r,_r,Mr,Tr,Er,kr,Rr,Ar,Sr,Cr,jr,Nr,Ir,Xr,Vr,Br,Pr,Lr,Ur,Fr,zr,qr,Dr,Hr,Or,Gr,Kr,Wr,Yr,Qr,Jr,Zr,ti,ei,ni,ri,ii,ai,oi,si,hi,li,ui,ci,fi,mi,di,pi,gi,vi,wi,yi,xi,bi,$i,_i,Mi,Ti,Ei,ki,Ri,Ai,Si,Ci,ji,Ni,Ii,Xi,Vi,Bi,Pi,Li,Ui,Fi,zi,qi,Di,Hi,Oi,Gi,Ki,Wi,Yi,Qi,Ji,Zi,ta,ea,ra,ia,aa,oa,sa,ha,la,ua,ca,fa,ma,da,pa,ga,va,wa,ya,xa,$a,_a,Ma,Ta,Ea,ka,Ra,Aa,Sa,Ca,ja,Na,Ia,Xa,Va,Ba,Pa,La,Ua,Fa,za,qa,Da,Ha,Oa,Ga,Ka,Wa,Ya,Qa,Ja,Za,to,eo,no,ro,io,ao,oo,so,ho,lo,uo,co,fo,mo,po,go,vo,wo,yo,xo,bo,$o,_o,Mo,To,Eo,ko,Ro,Ao,So,Co,jo,No,Io,Xo,Vo,Bo,Po,Lo,Uo,Fo,zo,qo,Do,Ho,Oo,Go,Ko,Wo,Yo,Qo,Jo,Zo,ts,es,ns,rs,is,as,os,ss,hs,ls,us,cs,fs,ms,ds,ps,gs,vs,ws,ys,xs,bs,$s,_s,Ms,Ts,Es,ks,Rs,As,Ss,Cs,js,Ns,Is,Xs,Vs,Bs,Ps,Ls,Us,Fs,zs,qs,Ds,Hs,Os,Gs,Ks,Ws,Ys,Qs,Js,Zs,th,eh,nh,rh,ih,ah,oh,sh,hh,lh,uh,ch,fh,mh,dh,ph,gh,vh,wh,yh,xh,bh,$h,_h,Mh,Th,Eh,kh,Rh,Ah,Sh,Ch,jh,Nh,Ih,Xh,Vh,Bh,Ph,Lh,Uh,Fh,zh,qh,Dh,Hh,Oh,Gh,Kh,Wh,Yh,Qh,Jh,Zh,tl,el,nl,rl,il,al,ol,sl,hl,ll,ul,cl,fl,ml,dl,pl,gl,vl,wl,yl,xl,bl,$l,_l,Ml,Tl,El,kl,Rl,Al,Sl,Cl,jl,Nl,Il,Xl,Vl,Bl,Pl,Ll,Ul,Fl,zl,ql,Dl,Hl,Ol,Gl,Kl,Wl,Yl,Ql,Jl,Zl,tu,eu,nu,ru,iu,au,ou,su,hu,lu,uu,cu,fu,mu,du,pu,gu,vu,wu,yu,xu,bu,$u,_u,Mu,Tu,Eu,ku,Ru,Au,Su,Cu,ju,Nu,Iu,Xu,Vu,Bu,Pu,Lu,Uu,Fu,zu,qu,Du,Hu,Ou,Gu,Ku,Wu,Yu,Qu,Ju,Zu,tc,ec,nc,rc,ic,ac,oc,sc,hc,lc,uc,cc,fc,mc,dc,pc,gc,vc,wc,yc,xc,bc,$c,_c,Mc,Tc,Ec,kc,Rc,Ac,Sc,Cc,jc,Nc,Ic,Xc,Vc,Bc,Pc,Lc,Uc,Fc,zc,qc,Dc,Hc,Oc,Gc,Kc,Wc,Yc,Qc,Jc,Zc,tf,ef,nf,rf,af,of,sf,hf,lf,uf,cf,ff,mf,df,pf,gf,vf,wf,yf,xf,bf,$f,_f,Mf,Tf,Ef,kf,Rf,Af,Sf,Cf,jf,Nf,If,Xf,Vf,Bf,Pf,Lf,Uf,Ff,zf,qf,Df,Hf,Of,Gf,Kf,Wf,Yf,Qf,Jf,Zf,tm,em,nm,rm,im,am,om,sm,hm,lm,um,cm,fm,mm,dm,pm,gm,vm,wm,ym,xm,bm,$m,_m,Mm,Tm,Em,km,Rm,Am,Sm,Cm,jm,Nm,Im,Xm,Vm,Bm,Pm,Lm,Um,Fm,zm,qm,Dm,Hm,Om,Gm,Km,Wm,Ym,Qm,Jm,Zm,td,ed,nd,rd,id,ad,od,sd,hd,ld,ud,cd,fd,md,dd,pd,gd,vd,wd,yd,xd,bd,$d,_d,Md,Td,Ed,kd,Rd,Ad,Sd,Cd,jd,Nd,Id,Xd,Vd,Bd,Pd,Ld,Ud,Fd,zd,qd,Dd,Hd,Od,Gd,Kd,Wd,Yd,Qd,Jd,Zd,tp,ep,np,rp,ip,ap,op,sp,hp,lp,up,cp,fp,mp,dp,pp,gp,vp,wp,yp,xp,bp,$p,_p,Mp,Tp,Ep,kp,Rp,Ap,Sp,Cp,jp,Np,Ip,Xp,Vp,Bp,Pp,Lp,Up,Fp,zp,qp,Dp,Hp,Op,Gp,Kp,Wp,Yp,Qp,Jp,Zp,tg,eg,ng,rg,ig,ag,og,sg,hg,lg,ug,cg,fg,mg,dg,pg,gg,vg,wg,yg,xg,bg,$g,_g,Mg,Tg,Eg,kg,Rg,Ag,Sg,Cg,jg,Ng,Ig,Xg,Vg,Bg,Pg,Lg,Ug,Fg,zg,qg,Dg,Hg,Og,Gg,Kg,Wg,Yg,Qg,Jg,Zg,tv,ev,nv,rv,iv,av,ov,sv,hv,lv,uv,cv,fv,mv,dv,pv,gv,vv,wv,yv,xv,bv,$v,_v,Mv,Tv,Ev,kv,Rv,Av,Sv,Cv,jv,Nv,Iv,Xv,Vv,Bv,Pv,Lv,Uv,Fv,zv,qv,Dv,Hv,Ov,Gv,Kv,Wv,Yv,Qv,Jv,Zv,tw,ew,nw,rw,iw,aw,ow,sw,hw,lw,uw,cw,fw,mw,dw,pw,gw,vw,ww,yw,xw,bw,$w,_w,Mw,Tw,Ew,kw,Rw,Aw,Sw,Cw,jw,Nw,Iw,Xw,Vw,Bw,Pw,Lw,Uw,Fw,zw,qw,Dw,Hw,Ow,Gw,Kw,Ww,Yw,Qw,Jw,Zw,ty,ey,ny,ry,iy,ay,oy,sy,hy,ly,uy,cy,fy,my,dy,py,gy,vy,wy,yy,xy,by,$y,_y,My,Ty,Ey,ky,Ry,Ay,Sy,Cy,jy,Ny,Iy,Xy,Vy,By,Py,Ly,Uy,Fy,zy,qy,Dy,Hy,Oy,Gy,Ky,Wy,Yy,Qy,Jy,Zy,tx,ex,nx,rx,ix,ax,ox,sx,hx,lx,ux,cx,fx,mx,dx,px,gx,vx,wx,yx,xx,bx,$x,_x,Mx,Tx,Ex,kx,Rx,Ax,Sx,Cx,jx,Nx,Ix,Xx,Vx,Bx,Px,Lx,Ux,Fx,zx,qx,Dx,Hx,Ox,Gx,Kx;return ft=new na({}),$m=new ba({}),{c(){n=u("p"),r=m(),i=u("h1"),i.textContent="Introduction",a=m(),l=u("p"),l.textContent='In this article, I introduce the main mathematical apparatus at the core of all Kernel Methods.  To me, the apparatus is best introduced as the inevitable consequence of three design goals, in the same way that a bicycle is the consequence of design goals ("a thing the rider must be able to steer, sit on, accelerate, and stop").',c=m(),d=u("p"),d.textContent="I take a somewhat unconventional approach by first considering a slightly wider class, and then show that a narrower class (still with multiple choices) is the most optimal.  The Kernel method is one choice in this narrower class.  While any choice within this narrower class provides exactly the same solution to a problem, the Kernel method is the only computable member of this class.  This should hopefully make the Kernel Method seem less contrived and arbitrary.",p=m(),v=u("p"),v.textContent="There are two interactive visualizations in this article, using the 1-D Gaussian Kernel.  In writing it, I built a lot of intuition about these core concepts by fiddling with the two figures.",w=m(),y=u("p"),y.textContent="All Kernel methods, such as Kernel Regression, Kernel SVM, PCA, CCA, K-means use the same mathematical apparatus at the core, but solve a different linear problem.  In this article, I use the simplest among these, the perfect-fit Kernel Regression, as a worked example.  Since it is perfect-fit, it has the drawback of not using regularization.  Instead, I introduce the concept of regularization through function norm reduction while considering the design of the Kernel Method itself.   Imperfect-fit (least squares) regression, and other variations serve to further decrease the function norm, or achieve other objectives such as classification.",x=m(),b=u("p"),b.textContent='A core concept of Kernel Methods is the so-called "feature space" - a (possibly) infinite dimensional vector space, whose points correspond one-to-one with functions.  There is a distinct concept called the Reproducing Kernel Hilbert Space.  The RKHS is a more abstract concept; it is also a vector space whose points correspond to the points in the feature space, and the functions.  The feature space and the RKHS are distinct, but represent aspects of the same underlying mathematical object.  But often in the literature, they are spoken about interchangeably, which was a major source of confusion.  I only mention them here to help the reader avoid the same confusion.',$=m(),_=u("p"),_.textContent="Kernel methods, particularly SVMs, were for a time a dominant model used in Machine Learning, but have been eclipsed by deep Neural networks trained by stochastic gradient descent.  More recently, it was recognized that NNs trained by SGD approximate Kernel methods, and this has led to increased interest and new applications.",M=m(),T=u("h1"),T.textContent="An illustration of Kernel Regression",k=m(),R=u("p"),A=f("In the interactive figure, data points "),S=new E,C=f(" are shown as black dots.  There is one Gaussian centered at each "),j=new E,N=f(".  The blue curve is a linear combination "),I=new E,X=f(" of these Gaussians.  Each slider controls one of the "),V=new E,B=f("."),P=m(),L=u("p"),U=f("You can adjust the sliders to make the blue curve perfectly fit the "),O=new E,G=f(".  It may be surprising to note that a unique, perfect-fitting "),K=new E,W=f(" exists for any set of "),Y=new E,Q=f(" and for any number of points (click 'Add Points' and/or 'New Data' to adjust)."),J=m(),Z=u("p"),tt=f("To see why, note that each gray curve's set of values along the "),et=new E,nt=f(" produces a vector, which I call the function's "),rt=u("em"),rt.textContent="vector of evaluation",it=f(".  Denoting the j'th curve as "),at=new E,ot=f(", its vector of evaluation is "),st=new E,ht=f(", where the order of components is always the order of the "),lt=new E,ut=f("."),ct=m(),q(ft.$$.fragment),mt=m(),dt=u("p"),pt=f("Note that there isn't any rule that the "),gt=new E,vt=f(" need be monotonically increasing.  They are simply given in some arbitrary order from the dataset. In the plot, they aren't labeled.  You can adjust the i'th slider and see which curve moves.  The point located horizontally at the peak of that curve is "),wt=new E,yt=f(".  Ultimately it doesn't matter for the purposes of illustration.  The important thing is that all the gray functions' vectors of evaluation are in the same order."),xt=m(),bt=u("p"),bt.textContent="Also note, although Gaussians are most often interpreted as probability distributions, in this article, there is no such interpretation, and there is no process of sampling from Gaussians.  We are simply using them as curves, like splines, to generate more complex shapes.  So, there is no requirement that they be normalized.",$t=m(),_t=u("p"),Mt=f("Particularly for a collection of Gaussians all with the same "),Tt=new E,Et=f(", the set of these "),kt=new E,Rt=f(" vectors are linearly independent.  This is not at all obvious, but please accept it for now.  Then, by the linear algebra expansion theorem, they span "),At=new E,St=f(" and so can form any set of "),Ct=new E,jt=f("."),Nt=m(),It=u("p"),It.textContent="Explicitly:",Xt=m(),Vt=new E,Bt=u("p"),Pt=f("The "),Lt=new E,Ut=f(" that fits the data perfectly is found by inverting "),Ft=new E,zt=f(", which is possible because "),qt=new E,Dt=f(" is full-rank.  That is, its rows are linearly independent, due to the property of a collections of Gaussians of the same "),Ht=new E,Ot=f(".  Even though we are taking linear combinations of functions, it is only the vectors of evaluation "),Gt=new E,Kt=f(" which affect the choice of "),Wt=new E,Yt=f("."),Qt=m(),Jt=u("p"),Zt=f("Of course, the whole purpose is for the curve to specify desirable values at other points, by some criterion.  But, so far the discussion is only concerned with how to make the curve have desired values at the "),te=new E,ee=f("."),ne=m(),re=u("h2"),re.textContent="Some Observations",ie=m(),ae=u("p"),oe=u("strong"),se=f("This method can fit any set of data in "),he=new E,le=f("."),ue=f("  Given a "),ce=u("em"),ce.textContent="particular",fe=f(" set "),me=new E,de=f(", you could hand-pick a set of functions "),pe=new E,ge=f(" which happen to produce linearly independent vectors "),ve=new E,we=f(" of evaluation on that particular data set.  However, the procedure shown above can fit any data set "),ye=new E,xe=f(".  This is useful because it would be laborious to have to hand-pick functions for each new data set."),be=m(),$e=u("p"),_e=u("strong"),Me=f("There is nothing (yet) special about the Gaussians being centered at the "),Te=new E,Ee=f(".  It turns out that "),ke=u("em"),ke.textContent="any",Re=f(" choice of "),Ae=new E,Se=f(" Gaussians will span "),Ce=new E,je=f(" when evaluated at any "),Ne=new E,Ie=f(" values.  There "),Xe=u("em"),Xe.textContent="is",Ve=f(" indeed something special about the Gaussians being centered at the "),Be=new E,Pe=f(", but it has nothing to do with the ability to fit arbitrary data."),Le=m(),Ue=u("p"),Fe=u("strong"),Fe.textContent="Many functions have this infinite capacity",ze=f(".  Not just Gaussians, but many other families of functions have this capacity to perfectly fit any data, due to the vectors of evaluation being linearly independent.  Not only that, but families of functions can be found for many different domains, not just "),qe=new E,De=f(" as shown above.   Both discrete and continuous domains, and of arbitrary dimensions."),He=m(),Oe=u("p"),Ge=u("strong"),Ge.textContent="Linear independence is preserved under permutation of components",Ke=f(".  The Gaussians are able to fit any data because they produce vectors that are linearly independent.  But, note that vectors that are linearly independent would still be so, after you permute their elements all in the same way.  For vectors, there is no meaning to the ordering of the elements.  To illustrate, click the 'scramble' button.  This remaps all points in "),We=new E,Ye=f(" in one-to-one fashion by reversing the order of every other interval of some fixed size.  Or think of it as re-ordering the components of the Gaussian \"vectors\" all in the same way, preserving their linear independence.  You can still toggle 'auto solve' and see that a unique solution exists."),Qe=m(),Je=u("p"),Ze=f("Of course, these permuted Gaussians don't have the same relationship with the original data, so there will be a different "),tn=new E,en=f(" solution.  This is only to show that the continuity or shape of the original Gaussians is not what gives them this capacity to fit arbitrary data."),nn=m(),rn=u("h2"),rn.textContent="The three design choices underlying all Kernel methods",an=m(),on=u("p"),on.textContent='Underlying all Kernel methods are three choices for how to construct the function to fit a given data set.  Like all machine learning methods, these chocies are guided by classic requirements.  First, the approach must be a "universal approximator", or as I call it, have arbitrary model capacity.  This means, the ability to perfectly fit any data set.  Second, it should be possible to regularize, meaning that the function gives useful interpolation behavior.  Finally, it should be computationally tractable.  The three design choices serve these requirements as you will see.',sn=m(),hn=u("h3"),hn.textContent="First design choice",ln=m(),un=u("p"),cn=u("em"),fn=u("strong"),mn=f("Set of functions indexed by "),dn=new E,pn=f(".  We specify a set of functions "),gn=new E,vn=f(", such that there is exactly one member of the set, "),wn=new E,yn=f(", corresponding to each element "),xn=new E,bn=f(".  We then use the subset of this set corresponding to our "),$n=new E,_n=f(" in the dataset to build a solution function as a linear combination of them.  The fact that the functions are already indexed by elements of the domain "),Mn=new E,Tn=f(" makes the choice automatic.  There is no hand-specifying a set of functions tailor made for each new data set.  This choice also serves the purpose of regularization, to be proved later."),En=m(),kn=u("h3"),kn.textContent="Second design choice",Rn=m(),An=u("p"),Sn=u("em"),Sn.innerHTML="<strong>Members of the set exhibit linearly independent vectors of evaluation</strong>",Cn=f(". The members of the set have the following property:  For any value of "),jn=new E,Nn=f(", and for any "),In=new E,Xn=f(" functions from the set, and for any choice of "),Vn=new E,Bn=f(" evaluation points in "),Pn=new E,Ln=f(", the set of "),Un=new E,Fn=m(),zn=u("em"),zn.textContent="vectors of evaluation",qn=f(' of the chosen functions should be linearly independent.  A "vector of evaluation" as explained above is my term for the vector of function values in the order of data set points, '),Dn=new E,Hn=f(".  This design choice allows the approach to fit any data set, as argued above by appealing to the linear algebra expansion theorem.  This gives the approach arbitrary capacity.  As an aside, there are choices of families that don't have this property, but since we are speaking generally about the approach of Kernel methods, it is important that some families do exhibit this property."),On=m(),Gn=u("h3"),Gn.textContent="Third design choice",Kn=m(),Wn=u("p"),Yn=u("em"),Yn.innerHTML="<strong>The functions are in the form of dot products of feature vectors</strong>",Qn=f(".  This is the biggest leap.  The members of the set are of the form:  "),Jn=new E,Zn=f('.  That is, each function is identified by a distinct "parameter vector" '),tr=new E,er=f(', and the function is defined as the dot product between its parameter vector and some as-yet undefined vector-valued function of the input.  As I will show soon, this third choice provides a way to regularize the method, and makes finding the solution function readily computable.  It also maintains the first goal of having arbitrary capacity to fit any data.  For readers already familiar with literature on Kernel methods, the notion of a "parameter vector" is not conventional, but it is my device for motivating Kernels.'),nr=m(),rr=u("p"),ir=f("To motivate these ideas and make the discussion more concrete, I first show that the Gaussian set of functions, all with the same "),ar=new E,or=f(" and indexed over "),sr=new E,hr=f(", fit these three design choices."),lr=m(),ur=u("h2"),ur.textContent="Gaussians have a Dot-product form",cr=m(),fr=u("p"),mr=f("The values of the Gaussian function turn out to be a dot product between two infinite dimensional vectors.  The first vector is a vector-valued function of "),dr=new E,pr=f(", named as "),gr=new E,vr=f(".   The second, the same function of "),wr=new E,yr=f(", named as "),xr=new E,br=f(".  Note that the "),$r=new E,_r=f(" parameter to a Gaussian will determine "),Mr=new E,Tr=f(" itself.  "),Er=new E,kr=f(" is not an argument like "),Rr=new E,Ar=f(" is.  So, below we write the function as "),Sr=new E,Cr=f("."),jr=m(),Nr=u("p"),Ir=f("To show this, we first show how the simpler formula "),Xr=new E,Vr=f(" can be written as a dot product.  Then, using this first result, we show that "),Br=new E,Pr=f(" can also be written as a dot product.  The Gaussian is just a scaled version with a special choice for "),Lr=new E,Ur=f("."),Fr=m(),zr=new E,qr=u("p"),Dr=f("Now, using the first result for "),Hr=new E,Or=f(", and letting "),Gr=new E,Kr=f(":"),Wr=m(),Yr=new E,Qr=u("p"),Jr=f("So we have "),Zr=new E,ti=f(" and all that remains is to scale both vectors by "),ei=new E,ni=m(),ri=u("p"),ii=f("In particular, the Gaussian "),ai=new E,oi=f(" is reinterpreted as a two-argument function "),si=new E,hi=f(" parameterized by "),li=new E,ui=f(", symmetric in the roles of "),ci=new E,fi=f(" and "),mi=new E,di=f(", that is: "),pi=new E,gi=f(".  In the "),vi=u("em"),vi.textContent="first design choice",wi=f(", "),yi=new E,xi=f(" plays the role of indexing the family of functions.  The "),bi=u("em"),bi.textContent="third design choice",$i=f(" is proven.  The "),_i=u("em"),_i.textContent="second design choice",Mi=f(", that members of the family have arbitrary ability to produce linearly independent vectors of evaluation, has not been proven, but for the moment please accept it."),Ti=m(),Ei=u("p"),ki=f("Note that the height at the peak of every Gaussian, the location where "),Ri=new E,Ai=f(", is the value of "),Si=new E,Ci=f(", implying every feature vector has the same norm since peak heights are the same for all "),ji=new E,Ni=f(".  To simplify the example further, the family of functions used in the worked example are scaled so that peak height = 1.  In particular this means the values of the dot products are simply the cosine of the angle between the two feature vectors, "),Ii=new E,Xi=f("."),Vi=m(),Bi=u("p"),Pi=f("The value of the Gaussian as "),Li=new E,Ui=f(" moves far away from "),Fi=new E,zi=f(" approaches zero.  This indicates the angle between the feature vectors asymptotically approaches "),qi=new E,Di=f(", but never reaches it.  The Gaussian is positive everywhere, therefore the angle ranges in "),Hi=new E,Oi=f(" in the infinite dimensional feature space.  In particular, considering three far points "),Gi=new E,Ki=f(", their corresponding feature vectors "),Wi=new E,Yi=f(" are nearly mutually orthogonal while still having acute angles between them.  In the infinite dimensional feature space, it is possible to have arbitrarily many of these.  The vectors occupy some "),Qi=new E,Ji=f("-tant of the space (like an octant in "),Zi=new E,ta=f("), if you will."),ea=m(),ra=u("h2"),ra.textContent="The mapping between input and Feature Space",ia=m(),aa=u("p"),oa=f("There are two main aims of this article.  The first is to demonstrate that every aspect of Kernel methods is simply a consequence of the classic requirements acting through the three design choices.  The second is to use the worked example of the 1D Gaussian Kernel, and build the habit of simultaneously visualizing the shapes of the curves and their linear combinations in the data domain "),sa=new E,ha=f(", and their corresponding feature vectors in the feature space, visualizing angles, planes and lengths."),la=m(),ua=u("p"),ua.textContent="The following is a list of some of the facts tying the input to the geometry of the feature space.  It can be used as a reference while interacting with the visualizations.",ca=m(),fa=u("p"),ma=f("Denoting the family of Gaussians (all with the same "),da=new E,pa=f(") as "),ga=new E,va=f(", and the feature space as "),wa=new E,ya=f(":"),xa=m(),$a=u("ol"),_a=u("li"),Ma=u("p"),Ta=u("strong"),Ta.textContent="Every input has a feature vector",Ea=f(".  Every point "),ka=new E,Ra=f(" corresponds to a feature vector "),Aa=new E,Sa=f("."),Ca=m(),ja=u("li"),Na=u("p"),Ia=u("strong"),Ia.textContent="Every function has a feature vector",Xa=f(".  Every function "),Va=new E,Ba=f(" corresponds to feature vector "),Pa=new E,La=f("."),Ua=m(),Fa=u("li"),za=u("p"),qa=u("strong"),qa.textContent="Every evaluation is a dot product of feature vectors",Da=f(".  The evaluation "),Ha=new E,Oa=f(" corresponds to the dot product "),Ga=new E,Ka=f(".  It this worked example, since the feature vectors are unit norm, it is the cosine of the angle of feature vectors "),Wa=new E,Ya=f(" and "),Qa=new E,Ja=f(".  For example, "),Za=new E,to=f(" at the peak, and "),eo=new E,no=f(" asymptotically towards "),ro=new E,io=f(" or "),ao=new E,oo=f("."),so=m(),ho=u("p"),ho.textContent="And, some consequences from this:",lo=m(),uo=u("ol"),co=u("li"),fo=u("p"),mo=u("strong"),mo.textContent="A set of functions defines a linear subspace in feature space",po=f(".  For short, one could call this subspace the "),go=new E,vo=f("-span."),wo=m(),yo=u("li"),xo=u("p"),bo=u("strong"),$o=f("Every linear combination of those functions is a point in the "),_o=new E,Mo=f("-span"),To=f(".  The "),Eo=new E,ko=f(" linear combination of functions "),Ro=new E,Ao=f(" corresponds to the "),So=u("em"),So.textContent="same",Co=m(),jo=new E,No=f(" linear combination of feature vectors "),Io=new E,Xo=f(".  Although the family functions all have the same feature vector length, in general a linear combination will not.  The goal is to find a single point in the "),Vo=new E,Bo=f("-span which fits the data and has other desirable properties."),Po=m(),Lo=u("li"),Uo=u("p"),Fo=u("strong"),Fo.textContent="A set of inputs defines a linear subspace in feature space",zo=f(".  For short, one could call this subspace the "),qo=new E,Do=f("-span."),Ho=m(),Oo=u("li"),Go=u("p"),Ko=u("strong"),Ko.textContent="A set of input labels defines a point in that linear subspace",Wo=f(".  Every point "),Yo=new E,Qo=f(" in the "),Jo=new E,Zo=f("-span induces a tuple of dot-product values with the "),ts=new E,es=f(" of the "),ns=new E,rs=f("-span, which also corresponds to its projection "),is=new E,as=f(" onto the "),os=new E,ss=f("-span.  Those dot-product values correspond to the labels ("),hs=new E,ls=f(" values)."),us=m(),cs=u("p"),fs=f("As a spoiler, it will be shown that the "),ms=new E,ds=f("-span and "),ps=new E,gs=f("-span are chosen to be the same subspace.  The motivation for this choice will be made clear, but it is helpful to distinguish the two conceptually at first."),vs=m(),ws=u("h2"),ws.textContent="Interactive Figure 1",ys=m(),xs=u("p"),bs=f("Figure 1 has three coordinated panels with different views of the same information.  In the main plot at the top, each gray curve is an individual Gaussian with mean "),$s=new E,_s=f(" indicated by the triangle at the top edge.  They all share the same "),Ms=new E,Ts=f(", controlled by the slider.  Each gray curve is scaled by an "),Es=new E,ks=f(" shown in a slider to the right."),Rs=m(),As=u("p"),Ss=f("You may drag any triangle to change "),Cs=new E,js=f(" and the corresponding gray curve will follow.  The "),Ns=new E,Is=f(" points are shown as black circles.  You may change them as well.  If "),Xs=new E,Vs=f(" tracks "),Bs=new E,Ps=f(" is checked, the triangles will follow."),Ls=m(),Us=u("p"),Fs=f("The blue curve is simply the sum of the gray curves.  Its shape is thus controlled by choices of the "),zs=new E,qs=f(" and the "),Ds=new E,Hs=f(".  If auto solve is checked, the plot will set the "),Os=new E,Gs=f(" to values to fit the "),Ks=new E,Ws=f(" data.  While the sliders have a limited range for manual adjustment, the 'auto solve' may set them to very large values positive or negative values depending on the data."),Ys=m(),Qs=u("p"),Js=f("The heatmap at the lower left is a complete space showing where the information in the main plot is situated.  It shows the values of all Gaussian curves of a particular "),Zs=new E,th=f(", (0 to 1, white to blue scale).  Each horizontal line shows one curve centered at a particular "),eh=new E,nh=f(", with "),rh=new E,ih=f(" increasing downwards.  While the gray curves show the "),ah=new E,oh=f("-scaled Gaussian, the heatmap shows these Gaussians unscaled so their peak height is 1.  In this worked example of 1D Gaussians, the heatmap depicts the entire family of functions indexed by points in the input domain "),sh=new E,hh=m(),lh=u("p"),uh=f("The red dots show the current locations of all combinations of "),ch=new E,fh=f(" and "),mh=new E,dh=f(".  The heatmap values at the dots in a particular row denote the "),ph=u("em"),ph.textContent="vector of evaluation",gh=f(" of Gaussian at "),vh=new E,wh=f(" - that is, height of the gray curve if its "),yh=new E,xh=f(" were set to 1.  The matrix at the lower right shows these values, organized in the same way.  The same values can be seen as heights of the gray curves at each "),bh=new E,$h=f(".  Letting the matrix be "),_h=new E,Mh=f(", the vector of evalution of the blue curve is just "),Th=new E,Eh=f("."),kh=m(),Rh=u("p"),Ah=f("Notice that if all "),Sh=new E,Ch=f(" (check "),jh=new E,Nh=f(" tracks "),Ih=new E,Xh=f("), then the diagonals of this matrix are equal to 1 since each unscaled curve has a peak height of 1 at "),Vh=new E,Bh=f(".  Furthermore the matrix is symmetric since "),Ph=new E,Lh=f(".  It is not symmetric when "),Uh=new E,Fh=f(" in general."),zh=m(),qh=u("h3"),qh.textContent="Some experiments",Dh=m(),Hh=u("p"),Oh=f("Here are some experiments that I found are useful to build intuition.  In the experiments where "),Gh=new E,Kh=f(" is not the focus, I'll omit the mention of "),Wh=new E,Yh=f(" and abbreviate the feature vector notation "),Qh=new E,Jh=f(" as "),Zh=new E,tl=f(".  For linear combinations of feature vectors, I'll use the name of the corresponding function.  For example, "),el=new E,nl=f(", with feature vector "),rl=new E,il=f(" will be simply notated "),al=new E,ol=f("."),sl=m(),hl=u("p"),ll=u("strong"),ll.textContent="Interpolation behavior from a single point",ul=f(".  Click 'Del Point' until there is a single gray curve.  With 'auto solve' checked, drag the black point up and down, and observe how the other values change.  Obviously, points x near "),cl=new E,fl=f(" change almost the same, while more distant points don't change much.  The central idea here is that height of the gray curve at arbitrary "),ml=new E,dl=f(" defines defines a kind of similarity with "),pl=new E,gl=f(".  The "),vl=new E,wl=f(" scaled gray curve corresponds to the scaled feature vector "),yl=new E,xl=f(".  Because the evaluations are dot products, and the dot product is linear in each argument, the values of the function at every "),bl=new E,$l=f(" scale as well."),_l=m(),Ml=u("p"),Tl=f("Now, if you shrink "),El=new E,kl=f(", the similarity of a given point "),Rl=new E,Al=f(" with "),Sl=new E,Cl=f(" goes down.  Shrinking "),jl=new E,Nl=f(" results in the shape of the feature vectors changing, although their norm stays the same.  With a very low "),Il=new E,Xl=f(", a smaller neighborhood of points are considered similar, and the rest of them don't move much when the value at "),Vl=new E,Bl=f(" is scaled.  "),Pl=new E,Ll=f(" thus controls the similarity between "),Ul=new E,Fl=f(" and "),zl=new E,ql=f(" in relation to euclidean distance "),Dl=new E,Hl=f(".  In the "),Ol=new E,Gl=f(" limit, the gray curve interpolates nothing.  In the "),Kl=new E,Wl=f(" limit, every point is considered identical with "),Yl=new E,Ql=f("."),Jl=m(),Zl=u("p"),tu=f("Now, check 'scramble'.  The shape of the curve is now the same except that every other unit interval in "),eu=new E,nu=f(" has been reversed.  This new shape is piecewise continuous.  Positioning the black point near a discontinuity and move it up and down, you can see that even points very close in "),ru=new E,iu=f(" distance are not as influenced.  The relation between influence of "),au=new E,ou=f(" along the curve and euclidean distance from "),su=new E,hu=f(" is no longer monotonic."),lu=m(),uu=u("p"),cu=f("The notion that a similarity measure on pairs of points in "),fu=new E,mu=f(" may not be related to the geometry of "),du=new E,pu=f(" is a central idea in kernel methods.  "),gu=new E,vu=f(' need not be a continuous domain or even ordered in any way - the corresponding gray "curves" would not be curves in that case, but they would be capable of interpolating values assigned to points in the domain.  This gives kernel methods great flexibility.'),wu=m(),yu=u("p"),yu.innerHTML="<strong>Interaction between Two Points</strong>",xu=m(),bu=u("p"),$u=f("Now increase to two points.  With '"),_u=new E,Mu=f(" tracks "),Tu=new E,Eu=f("' and 'auto solve' checked, move the two data points well apart, and adjust "),ku=new E,Ru=f(" so the two gray curves are well separated - that is, such that the height at "),Au=new E,Su=f(" of "),Cu=new E,ju=f(" is near zero, and vice versa.  The off-diagonal elements of the matrix at the bottom right should be nearly white.  The feature vectors "),Nu=new E,Iu=f(" and "),Xu=new E,Vu=f(" corresponding to these two functions are approaching right angles with each other."),Bu=m(),Pu=u("p"),Lu=f("Now drag one of the data points up and down.  You'll notice that only one of the "),Uu=new E,Fu=f(" components moves to solve the curve.  In feature space terms, "),zu=new E,qu=f(" and "),Du=new E,Hu=f(" are nearly orthogonal.  The goal is to find some linear combination "),Ou=new E,Gu=f(" of them such that the signed length (displacement) of the projections "),Ku=new E,Wu=f(".   Since the "),Yu=new E,Qu=f(", "),Ju=new E,Zu=f(" and "),tc=new E,ec=f(" are the same.  So, scaling one component "),nc=new E,rc=f(" doesn't affect "),ic=new E,ac=f(" and vice versa."),oc=m(),sc=u("p"),hc=f("Now move the points closer together, or increase "),lc=new E,uc=f(", so that the off-diagonal elements are bluish.  Then, moving one of the points influences the other, and both "),cc=new E,fc=f(" need to be adjusted to find the solution.  A limited visualizatoin of this is available in the second interactive figure."),mc=m(),dc=u("p"),dc.innerHTML="<strong>Exploding Norm</strong>",pc=m(),gc=u("p"),vc=f("The blue curve "),wc=new E,yc=f("'s associated parameter vector's norm is also called the "),xc=u("em"),xc.textContent="function norm",bc=f(", shown as "),$c=new E,_c=f(" below the main plot.  For the moment, let's consider only "),Mc=new E,Tc=f(" and ignore "),Ec=new E,kc=f(" and "),Rc=new E,Ac=f("."),Sc=m(),Cc=u("p"),jc=f("If you move one of the points very close to the other in the "),Nc=new E,Ic=f(" direction, but differing in height, the slope of the curve explodes, as does the magnitude of the "),Xc=new E,Vc=f(" and "),Bc=new E,Pc=f(".  At a given setting for the "),Lc=new E,Uc=f(" with high norm, try reducing "),Fc=new E,zc=f(" until the curves are again well separated, and the function norm will shrink."),qc=m(),Dc=u("p"),Hc=f("In feature space terms, this situation is the opposite of when "),Oc=new E,Gc=f(" and "),Kc=new E,Wc=f(" were nearly orthogonal.  Now, they are nearly parallel.  In order for some solution vector "),Yc=new E,Qc=f(" to achieve very different projection lengths against nearly parallel vectors, it has to be very long to exploit the slight difference in angle."),Jc=m(),Zc=u("p"),tf=f("In semantic terms, one interpretation is, an exploding norm indicates the individual component curves overestimate the degree of similarity of that pair of data points, relative to their "),ef=u("em"),ef.textContent="actual",nf=f(" similarity which is a function of their "),rf=new E,af=f(" values.  Adjusting "),of=new E,sf=f(" remedies this problem, at the expense of less interpolation."),hf=m(),lf=u("p"),uf=f("Since this worked example is doing exact-fit linear regression, we aren't considering the possibility that the "),cf=new E,ff=f(" values may have noise.  If that is the case, the interpretation is more complicated."),mf=m(),df=u("p"),pf=u("strong"),gf=f("Changing "),vf=new E,wf=f("-span away from "),yf=new E,xf=f("-span"),bf=m(),$f=u("p"),_f=f("Recall that "),Mf=new E,Tf=f(" resides in the "),Ef=new E,kf=f("-span, the "),Rf=new E,Af=f("-dimensional linear subspace "),Sf=new E,Cf=f(".   and its projection, "),jf=new E,Nf=f(" resides in the "),If=new E,Xf=f("-span, "),Vf=new E,Bf=f(".  Up until now, "),Pf=new E,Lf=f(" and the two spans coincide.  In that case, "),Uf=new E,Ff=f(", and "),zf=new E,qf=f(".\nIf you unlock '"),Df=new E,Hf=f(" tracks x', you can drag the triangles ("),Of=new E,Gf=f(") or the data points and the two spans are allowed to differ, and the orthogonal decomposition of "),Kf=new E,Wf=f(" starts to show.  "),Yf=new E,Qf=f(" still shows the length of "),Jf=new E,Zf=f(" which exists in the "),tm=new E,em=f("-span, but the lengths of orthogonal decomposition "),nm=new E,rm=f(" taken relative to the "),im=new E,am=f("-span is also shown.  In the limit, the spans are nearly orthogonal, and the parallel component is extremely small, forcing "),om=new E,sm=f(" to grow without bound in order to project onto the "),hm=new E,lm=f("-span any particular solution."),um=m(),cm=u("p"),fm=f("As mentioned before, this experiment is only for didactic purposes since Kernel methods assign the "),mm=new E,dm=f("-span to the "),pm=new E,gm=f("-span.  But, it is worth noting that any new unseen data resides in general outside of the ");vm=new E,wm=f("-span which is derived from the dataset.  This is a good illustration of why off-manifold data is hard to predict."),ym=m(),xm=u("h1"),xm.textContent="Experiments to try with Figure 2",bm=m(),q($m.$$.fragment),_m=m(),Mm=u("caption"),Mm.innerHTML='Interctive plot.  You can drag the black $(x_i, y_i)$ data points and triangles\n($\\mu_i$ values).  <b>Top</b>: gray curves are Gaussians centered at the <d-math>\\mu_i</d-math>.  Blue curve is the $\\vec\\alpha4 linear combination of the gray curves.  <b>Bottom left</b>: A heatmap showing the family of Gaussians with the same $\\sigma$ at every $\\mu$ value.  Red dots show the locations of evaluation points.  <b>Bottom right</b>:  The matrix of values of evaluation points organized by $\\mu_i$ and $x_i$.  Other details provided in text.  <a href="full.html">Full Page Figure</a>.',Tm=m(),Em=u("p"),km=f("Figure 2 left panel shows the same plot with just two functions.  The right panel shows the 2d "),Rm=new E,Am=f("-span, with the gray vectors denoting "),Sm=new E,Cm=f(" and "),jm=new E,Nm=f(", and the blue vector "),Im=new E,Xm=f(".  The black dot on the right panel shows the parameter vector which fits the data.  Not shown are the "),Vm=new E,Bm=f("-span or the "),Pm=new E,Lm=f(".  However, when "),Um=new E,Fm=f(", they coincide.  In this case, the black dotted lines show the length of the projection of "),zm=new E,qm=f(" onto each of the "),Dm=new E,Hm=f(", which equals "),Om=new E,Gm=f(".  There are a few informative experiments to try."),Km=m(),Wm=u("p"),Ym=u("strong"),Qm=f("Changing the angle between "),Jm=new E,Zm=f(" and "),td=new E,ed=f(".  If you drag one of the "),nd=new E,rd=f(" close to the other one, notice the angle between the gray vectors change.  Dragging them apart causes the gray vectors to asymptotically approach right angles."),id=m(),ad=u("p"),od=u("strong"),sd=f("Nearly orthogonal "),hd=new E,ld=f(" and "),ud=new E,cd=f(" have independent contributions to the values of "),fd=new E,md=f(" at each "),dd=new E,pd=f(".  With 'auto solve' and '"),gd=new E,vd=f(" tracks x' checked, on the left panel, drag the black dots well apart on the "),wd=new E,yd=f(" axis.  Then, drag one dot up and down, observing the motion of the blue arrow on the right panel.  It moves back and forth in the direction of one of the "),xd=new E,bd=f(" while its projection against the other gray arrow remains nearly constant."),$d=m(),_d=u("p"),Md=u("strong"),Td=f("Nearly parallel "),Ed=new E,kd=f(" and "),Rd=new E,Ad=f(" have highly dependent contributions to the values of "),Sd=new E,Cd=f(" at each "),jd=new E,Nd=f(".  With 'auto solve' and '"),Id=new E,Xd=f(" tracks x' checked, on the left panel, drag the black dots close together on the "),Vd=new E,Bd=f(" axis.  Now, move one of the dots up and down.  Observe that as the "),Pd=new E,Ld=f(" values of the dots widen, the blue vector on the right panel must grow very long to achieve the differing projection lengths."),Ud=m(),Fd=u("h2"),zd=f("Proof that "),qd=new E,Dd=f(" is optimal"),Hd=m(),Od=u("p"),Gd=f("Having highlighted the separate notions of the "),Kd=new E,Wd=f("-span and "),Yd=new E,Qd=f("-span for conceptual reasons, we now show that the optimal choice is to set the "),Jd=new E,Zd=f("-span equal to it."),tp=m(),ep=u("p"),np=f("The matrix form for a function "),rp=new E,ip=f("'s associated parameter vector "),ap=new E,op=f(", with "),sp=new E,hp=f(" the matrix of row vectors "),lp=new E,up=f(".  "),cp=new E,fp=f("'s "),mp=u("em"),mp.textContent="vector of evaluation",dp=f(" on the "),pp=new E,gp=f(" is then given by "),vp=new E,wp=f(", where "),yp=new E,xp=f(" is similarly the matrix of row vectors "),bp=new E,$p=f(".  We now show why "),_p=new E,Mp=f(" is the optimal choice."),Tp=m(),Ep=u("p"),kp=f("Suppose "),Rp=new E,Ap=f(" for some "),Sp=new E,Cp=f(".  By the property of dot products:"),jp=m(),Np=new E,Ip=u("p"),Ip.textContent="In matrix form:",Xp=m(),Vp=new E,Bp=u("p"),Pp=new E,Lp=f(" spans either the same subspace as "),Up=new E,Fp=f(", or a subspace of it.  Thus, the choice of "),zp=new E,qp=f(" (or any choice of "),Dp=new E,Hp=f(" such that "),Op=new E,Gp=f(") will be able to fit any set of labels "),Kp=new E,Wp=f(" that any other choice of "),Yp=new E,Qp=f(" can fit, but possibly more."),Jp=m(),Zp=u("p"),tg=f("Furthermore, as will be argued in the next section, any two functions having the same vector of evaluation, the one with smaller parameter norm is preferable.  The squared norm "),eg=new E,ng=f(" is given by:"),rg=m(),ig=new E,ag=u("h2"),ag.textContent="Regularizing by Minimizing the Function Norm",og=m(),sg=u("p"),hg=f("There are two properties a function "),lg=new E,ug=f(" has related to its parameter vector norm "),cg=new E,fg=f(".  The first is the overall magnitude (positive and negative) of its values.  The second is the magnitude of the difference between pairs of points, relative to how similar those points are by the measure of the family of functions."),mg=m(),dg=u("p"),pg=f("To illustrate, consider two arbitrary inputs "),gg=new E,vg=f(".  How do  the magnitudes of values "),wg=new E,yg=f(" and difference in values "),xg=new E,bg=f(" relate to the norm of its parameter vector?"),$g=m(),_g=new E,Mg=u("p"),Tg=f("The first inequality tells us that the magnitude of values of the function "),Eg=new E,kg=f(" is bounded by a fixed multiple of "),Rg=new E,Ag=f(".  The multiple itself, "),Sg=new E,Cg=f(" we have no control over - it is determined by the choice of "),jg=new E,Ng=f(".  But by controlling "),Ig=new E,Xg=f(" we can control the range of values of "),Vg=new E,Bg=f("."),Pg=m(),Lg=u("p"),Ug=f("The second inequality tells us that the absolute difference in value between any two points is proportional to "),Fg=new E,zg=f(".  As the distance shrinks, the values will be equal.  By bounding "),qg=new E,Dg=f(", we can control how sensitive the function could be to distance between input feature vectors."),Hg=m(),Og=u("p"),Gg=f("Conversely, if you demand the solution function fit a particular set of fixed "),Kg=new E,Wg=f(" and "),Yg=new E,Qg=f(" values, that is, "),Jg=new E,Zg=f(", then "),tv=new E,ev=f(" must grow to compensate for small "),nv=new E,rv=f(".  This is the behavior you observe by dragging one of the black dots close on the "),iv=new E,av=f(" axis in 'auto solve' mode, while maintaining a fixed gap in height.  The norm of the function explodes."),ov=m(),sv=u("p"),hv=f("It also says something about the choice of "),lv=new E,uv=f(".  Ideally, we would like to choose a "),cv=new E,fv=f(" such that "),mv=new E,dv=f(" is roughy proportional to "),pv=new E,gv=f(" in the data set for all pairs "),vv=new E,wv=f("."),yv=m(),xv=u("h2"),xv.textContent="Finally, enter the Kernel",bv=m(),$v=u("p"),_v=f("Recall from the previous section that using "),Mv=new E,Tv=f(" as the set of parameter vectors ensures 1) the method has arbitrary fitting capacity and 2) the solution will be the lowest norm solution possible.  So we have the following:"),Ev=m(),kv=new E,Rv=u("p"),Av=f("To find "),Sv=new E,Cv=f(", solve:"),jv=m(),Nv=new E,Iv=u("p"),Iv.textContent="This will minimize to zero if the assumptions above hold.  To compromise between a perfectly fitting function and the bounds the norm provides, instead solve:",Xv=m(),Vv=new E,Bv=u("p"),Bv.textContent="Finally, to evaluate the function on new data:",Pv=m(),Lv=new E,Uv=u("p"),Fv=f("So we see that the only quantities dependent on the "),zv=new E,qv=f(" data are dot products "),Dv=new E,Hv=f(", appearing in the "),Ov=new E,Gv=f(' terms or the solution function.  Finally, we define a function called the "kernel" as:'),Kv=m(),Wv=new E,Yv=u("p"),Yv.textContent="Then, the general optimization formula simplifies to:",Qv=m(),Jv=new E,Zv=u("p"),Zv.textContent="and evaluating the solution function is now written as:",tw=m(),ew=new E,nw=u("p"),rw=f("Returning back to the plot, you can see that the blue curve evaluated at any given "),iw=new E,aw=f(" is the "),ow=new E,sw=f(" weighted sum of scaled gray curves - individual Gaussians with means equal to the "),hw=new E,lw=f("'s.  Since "),uw=new E,cw=f(", the expression above is precisely that."),fw=m(),mw=u("h1"),mw.textContent="Summary and Conclusion",dw=m(),pw=u("p"),gw=f("The Kernel Method allow discovering a function to fit an arbitrary data relationship "),vw=new E,ww=f(", while at the same time providing a computable means to bound the function's overall magnitude at individual inputs, and the magnitude of the difference at pairs of inputs."),yw=m(),xw=u("p"),bw=f("Kernel methods achieve this by automatically providing a library of functions, one for each "),$w=new E,_w=f(" in the data set.  When each is evaluated on the "),Mw=new E,Tw=f(", they provide linearly independent sets of values.  Thus a unique linear combination of these functions exists to fit any set of target values "),Ew=new E,kw=f(" at the "),Rw=new E,Aw=f("."),Sw=m(),Cw=u("p"),jw=f('The functions are defined as dot products between "feature vectors": '),Nw=new E,Iw=f(".  This has three main benefits:"),Xw=m(),Vw=u("ol"),Vw.innerHTML="<li><p>It is possible to prove, using linear algebra alone, that a perfect-fitting solution exists and is of minimal norm.</p></li> \n<li><p>For further regularization, the Cauchy Schwarz inequality shows the &quot;function norm&quot; provides bounds on magnitude of values and differences of pairs of values.</p></li> \n<li><p>Data fitting and regularization are now purely linear problems, and the arsenal of linear optimization techniques can be applied.</p></li>",Bw=m(),Pw=u("h1"),Pw.textContent="Recommended reading and Notes",Lw=m(),Uw=u("p"),Uw.textContent="In the above essay I intentionally avoided some of the terminology and names of theorems.  When I was learning about Kernel methods, I found that they seemed to hint at giving insight, but ultimately they did not.  Here are some of the concepts, linking them to the above, or a critique why I didn't include them in the main text.",Fw=m(),zw=u("h2"),zw.textContent="Positive (semi)Definite matrices",qw=m(),Dw=u("p"),Hw=f("It turns out that all square matrices, if they can be written as the product "),Ow=new E,Gw=f(" for some "),Kw=new E,Ww=f(", are either positive definite (if all rows of "),Yw=new E,Qw=f(" are linearly independent), or positive semidefinite (if the rank of "),Jw=new E,Zw=f(" is less than its number of rows).  Since the central idea of Kernel methods is constructing functions as dot products, it seemed much more of essence to focus on the construction "),ty=new E,ey=f(" itself.  This also makes clear why the definition of p.s.d, namely that "),ny=new E,ry=f(" for all "),iy=new E,ay=f(" implies that "),oy=new E,sy=f(" for some "),hy=new E,ly=f(":  The "),uy=new E,cy=f(" are simply a basis in a subspace, "),fy=new E,my=f(" is a vector, and "),dy=new E,py=f(" is the dot product of the vector with itself - its length squared."),gy=m(),vy=u("h2"),vy.textContent="The Kernel Trick",wy=m(),yy=u("p"),xy=f('The "kernel trick" is the idea that a kernel function '),by=new E,$y=f(" can be evaluated without actually evaluating the feature vectors and taking their dot product.  While this is important for computational efficiency, it ultimately is uninformative for the purposes of understanding Kernel methods.  Indeed, the Kernel trick doesn't magically allow one to compute exact Gaussian values - doing so would require an infinite amount of computation.  So, whether or not a given kernel has an infinite or finite dimensional feature space, and whether it is implemented approximately or exactly, doesn't really decide its usefulness as a kernel.  In short, the kernel trick is just one form of mathematical shortcut (if it exists), and doesn't really enlighten one as to the nature of Kernel methods.  One could use a Kernel that has only finite capacity and no known Kernel trick, and it could still be a valid Kernel."),_y=m(),My=u("h2"),My.textContent="Distinct between Feature Space and Reproducing Kernel Hilbert Space",Ty=m(),Ey=u("p"),Ey.textContent="In my reading, I found the discussion of feature space and the 'Hilbert space' (from the RHKS) blurred together.  They are distinct mathematical entities.  Although more subtle results in Kernel research are proved with the help of the RKHS, I didn't feel the basics were much helped by them.  But, in the theory elements in the RKHS map one-to-one to elements in feature space and to functions in input space, so they are sometimes spoken of interchangeably.",ky=m(),Ry=u("p"),Ay=f("In an effort to disambiguate them, here is a summary.  In Kernel Methods, functions "),Sy=new E,Cy=m(),jy=u("em"),jy.textContent="correspond one-to-one",Ny=f(" with feature vectors "),Iy=new E,Xy=f(", because of their definition as a dot product.  As any vector space, the feature space has an inner product defined on it, which is the simple dot product, and the "),Vy=u("em"),Vy.textContent="kernel matrix",By=m(),Py=new E,Ly=f(" is the matrix of inner products on a basis "),Uy=new E,Fy=f(", the "),zy=new E,qy=f(" from the dataset, in this feature space."),Dy=m(),Hy=u("p"),Oy=f("Separately from this, the function itself, "),Gy=new E,Ky=f(" associates one real value for each "),Wy=new E,Yy=f(".  This collection of values could be viewed as the components of "),Qy=u("em"),Qy.textContent="another",Jy=f(" infinite-dimensional vector.  In conventional notation, "),Zy=new E,tx=f(".  This is like "),ex=new E,nx=f(",  but instead of 3 real components, "),rx=new E,ix=f(" components.  Then, the function is not merely "),ax=u("em"),ax.textContent="corresponding to a vector",ox=f(" but "),sx=u("em"),sx.textContent="is",hx=f(" a vector.  The space "),lx=new E,ux=f(" of such functions-as-vectors is known as the Hilbert Space "),cx=new E,fx=f(".  It has a specific inner product defined on it which links it up to the original feature space: "),mx=new E,dx=f("."),px=m(),gx=u("p"),vx=f("Now that the Hilbert space has a set of basis vectors "),wx=new E,yx=f(", and an inner product, a Kernel matrix "),xx=new E,bx=f(" can be defined.  But now, note that the rows and columns of the Kernel matrix are vectors of values.  Unlike the feature space, where the rows of the kernel matrix were not of the same type as the vectors in the space itself, in the Hilbert space they are.  Therefore, "),$x=new E,_x=f(', because this is just a set of inner products between two rows.   This is what gives rise to the phrase "Reproducing Kernel".  See '),Mx=u("a"),Mx.textContent="https://arxiv.org/pdf/1408.0952.pdf",Tx=f("."),Ex=m(),kx=u("h2"),kx.textContent="Representer Theorem",Rx=m(),Ax=u("p"),Sx=f("In the parlance of RHKS theory, the point "),Cx=new E,jx=f(" corresponding to a given "),Nx=new E,Ix=f(" is called "),Xx=new E,Vx=f("'s "),Bx=u("em"),Bx.textContent="representer",Px=f(" of evaluation, and more generally, any point in "),Lx=new E,Ux=f(" is a "),Fx=u("em"),Fx.textContent="representation",zx=f(" of some function in an abstract way.  So, the Representer Theorem asserts that an optimal solution to a data fitting problem exists in the span of the representers of the data.  That is, in the span of "),qx=new E,Dx=f(".  The section on this article proving through orthogonal decomposition, that setting "),Hx=new E,Ox=f(" results in the minimum norm solution without any loss of expressive power, is a simplified version of this theorem.  For more detail, see:  "),Gx=u("a"),Gx.textContent="https://alex.smola.org/papers/2001/SchHerSmo01.pdf",g(i,"id","introduction"),g(T,"id","an-illustration-of-kernel-regression"),S.a=C,j.a=N,I.a=X,V.a=B,O.a=G,K.a=W,Y.a=Q,et.a=nt,at.a=ot,st.a=ht,lt.a=ut,gt.a=vt,wt.a=yt,Tt.a=Et,kt.a=Rt,At.a=St,Ct.a=jt,Vt.a=Bt,Lt.a=Ut,Ft.a=zt,qt.a=Dt,Ht.a=Ot,Gt.a=Kt,Wt.a=Yt,te.a=ee,g(re,"id","some-observations"),he.a=le,me.a=de,pe.a=ge,ve.a=we,ye.a=xe,Te.a=null,Ae.a=Se,Ce.a=je,Ne.a=Ie,Be.a=Pe,qe.a=De,We.a=Ye,tn.a=en,g(rn,"id","the-three-design-choices-underlying-all-kernel-methods"),g(hn,"id","first-design-choice"),dn.a=null,gn.a=vn,wn.a=yn,xn.a=bn,$n.a=_n,Mn.a=Tn,g(kn,"id","second-design-choice"),jn.a=Nn,In.a=Xn,Vn.a=Bn,Pn.a=Ln,Un.a=Fn,Dn.a=Hn,g(Gn,"id","third-design-choice"),Jn.a=Zn,tr.a=er,ar.a=or,sr.a=hr,g(ur,"id","gaussians-have-a-dot-product-form"),dr.a=pr,gr.a=vr,wr.a=yr,xr.a=br,$r.a=_r,Mr.a=Tr,Er.a=kr,Rr.a=Ar,Sr.a=Cr,Xr.a=Vr,Br.a=Pr,Lr.a=Ur,zr.a=qr,Hr.a=Or,Gr.a=Kr,Yr.a=Qr,Zr.a=ti,ei.a=null,ai.a=oi,si.a=hi,li.a=ui,ci.a=fi,mi.a=di,pi.a=gi,yi.a=xi,Ri.a=Ai,Si.a=Ci,ji.a=Ni,Ii.a=Xi,Li.a=Ui,Fi.a=zi,qi.a=Di,Hi.a=Oi,Gi.a=Ki,Wi.a=Yi,Qi.a=Ji,Zi.a=ta,g(ra,"id","the-mapping-between-input-and-feature-space"),sa.a=ha,da.a=pa,ga.a=va,wa.a=ya,ka.a=Ra,Aa.a=Sa,Va.a=Ba,Pa.a=La,Ha.a=Oa,Ga.a=Ka,Wa.a=Ya,Qa.a=Ja,Za.a=to,eo.a=no,ro.a=io,ao.a=oo,go.a=vo,_o.a=Mo,Eo.a=ko,Ro.a=Ao,jo.a=No,Io.a=Xo,Vo.a=Bo,qo.a=Do,Yo.a=Qo,Jo.a=Zo,ts.a=es,ns.a=rs,is.a=as,os.a=ss,hs.a=ls,g(uo,"start","4"),ms.a=ds,ps.a=gs,g(ws,"id","interactive-figure-1"),$s.a=_s,Ms.a=Ts,Es.a=ks,Cs.a=js,Ns.a=Is,Xs.a=Vs,Bs.a=Ps,zs.a=qs,Ds.a=Hs,Os.a=Gs,Ks.a=Ws,Zs.a=th,eh.a=nh,rh.a=ih,ah.a=oh,sh.a=null,ch.a=fh,mh.a=dh,vh.a=wh,yh.a=xh,bh.a=$h,_h.a=Mh,Th.a=Eh,Sh.a=Ch,jh.a=Nh,Ih.a=Xh,Vh.a=Bh,Ph.a=Lh,Uh.a=Fh,g(qh,"id","some-experiments"),Gh.a=Kh,Wh.a=Yh,Qh.a=Jh,Zh.a=tl,el.a=nl,rl.a=il,al.a=ol,cl.a=fl,ml.a=dl,pl.a=gl,vl.a=wl,yl.a=xl,bl.a=$l,El.a=kl,Rl.a=Al,Sl.a=Cl,jl.a=Nl,Il.a=Xl,Vl.a=Bl,Pl.a=Ll,Ul.a=Fl,zl.a=ql,Dl.a=Hl,Ol.a=Gl,Kl.a=Wl,Yl.a=Ql,eu.a=nu,ru.a=iu,au.a=ou,su.a=hu,fu.a=mu,du.a=pu,gu.a=vu,_u.a=Mu,Tu.a=Eu,ku.a=Ru,Au.a=Su,Cu.a=ju,Nu.a=Iu,Xu.a=Vu,Uu.a=Fu,zu.a=qu,Du.a=Hu,Ou.a=Gu,Ku.a=Wu,Yu.a=Qu,Ju.a=Zu,tc.a=ec,nc.a=rc,ic.a=ac,lc.a=uc,cc.a=fc,wc.a=yc,$c.a=_c,Mc.a=Tc,Ec.a=kc,Rc.a=Ac,Nc.a=Ic,Xc.a=Vc,Bc.a=Pc,Lc.a=Uc,Fc.a=zc,Oc.a=Gc,Kc.a=Wc,Yc.a=Qc,rf.a=af,of.a=sf,cf.a=ff,vf.a=wf,yf.a=xf,Mf.a=Tf,Ef.a=kf,Rf.a=Af,Sf.a=Cf,jf.a=Nf,If.a=Xf,Vf.a=Bf,Pf.a=Lf,Uf.a=Ff,zf.a=qf,Df.a=Hf,Of.a=Gf,Kf.a=Wf,Yf.a=Qf,Jf.a=Zf,tm.a=em,nm.a=rm,im.a=am,om.a=sm,hm.a=lm,mm.a=dm,pm.a=gm,vm.a=wm,g(xm,"id","experiments-to-try-with-figure-2"),Rm.a=Am,Sm.a=Cm,jm.a=Nm,Im.a=Xm,Vm.a=Bm,Pm.a=Lm,Um.a=Fm,zm.a=qm,Dm.a=Hm,Om.a=Gm,Jm.a=Zm,td.a=null,nd.a=rd,hd.a=ld,ud.a=cd,fd.a=md,dd.a=null,gd.a=vd,wd.a=yd,xd.a=bd,Ed.a=kd,Rd.a=Ad,Sd.a=Cd,jd.a=null,Id.a=Xd,Vd.a=Bd,Pd.a=Ld,qd.a=Dd,g(Fd,"id","proof-that-html-mu_i--x_i-is-optimal"),Kd.a=Wd,Yd.a=Qd,Jd.a=Zd,rp.a=ip,ap.a=op,sp.a=hp,lp.a=up,cp.a=fp,pp.a=gp,vp.a=wp,yp.a=xp,bp.a=$p,_p.a=Mp,Rp.a=Ap,Sp.a=Cp,Np.a=Ip,Vp.a=Bp,Pp.a=Lp,Up.a=Fp,zp.a=qp,Dp.a=Hp,Op.a=Gp,Kp.a=Wp,Yp.a=Qp,eg.a=ng,ig.a=ag,g(ag,"id","regularizing-by-minimizing-the-function-norm"),lg.a=ug,cg.a=fg,gg.a=vg,wg.a=yg,xg.a=bg,_g.a=Mg,Eg.a=kg,Rg.a=Ag,Sg.a=Cg,jg.a=Ng,Ig.a=Xg,Vg.a=Bg,Fg.a=zg,qg.a=Dg,Kg.a=Wg,Yg.a=Qg,Jg.a=Zg,tv.a=ev,nv.a=rv,iv.a=av,lv.a=uv,cv.a=fv,mv.a=dv,pv.a=gv,vv.a=wv,g(xv,"id","finally-enter-the-kernel"),Mv.a=Tv,kv.a=Rv,Sv.a=Cv,Nv.a=Iv,Vv.a=Bv,Lv.a=Uv,zv.a=qv,Dv.a=Hv,Ov.a=Gv,Wv.a=Yv,Jv.a=Zv,ew.a=nw,iw.a=aw,ow.a=sw,hw.a=lw,uw.a=cw,g(mw,"id","summary-and-conclusion"),vw.a=ww,$w.a=_w,Mw.a=Tw,Ew.a=kw,Rw.a=Aw;Nw.a=Iw,g(Pw,"id","recommended-reading-and-notes"),g(zw,"id","positive-semidefinite-matrices"),Ow.a=Gw,Kw.a=Ww,Yw.a=Qw,Jw.a=Zw,ty.a=ey,ny.a=ry,iy.a=ay,oy.a=sy,hy.a=ly,uy.a=cy,fy.a=my,dy.a=py,g(vy,"id","the-kernel-trick"),by.a=$y,g(My,"id","distinct-between-feature-space-and-reproducing-kernel-hilbert-space"),Sy.a=Cy,Iy.a=Xy,Py.a=Ly,Uy.a=Fy,zy.a=qy,Gy.a=Ky,Wy.a=Yy,Zy.a=tx,ex.a=nx,rx.a=ix,lx.a=ux,cx.a=fx,mx.a=dx,wx.a=yx,xx.a=bx,$x.a=_x,g(Mx,"href","https://arxiv.org/pdf/1408.0952.pdf"),g(kx,"id","representer-theorem"),Cx.a=jx,Nx.a=Ix,Xx.a=Vx,Lx.a=Ux,qx.a=Dx,Hx.a=Ox,g(Gx,"href","https://alex.smola.org/papers/2001/SchHerSmo01.pdf")},m(t,e){s(t,n,e),n.innerHTML="$\n\\newcommand\\B[1]{\\boldsymbol{#1}}\n\\newcommand\\norm[1]{\\|#1\\|}\n\\newcommand\\ang[1]{\\theta_{#1}}\n\\newcommand\\dist{\\mathrm{dist}}\n\\newcommand\\half{{\\small {1 \\over 2}}}\n\\newcommand\\FeatSpace{\\mathcal{\\Phi}}\n\\newcommand\\GSpace{\\mathcal{G}_\\sigma}\n\\newcommand\\proj[2]{#1_{\\small \\parallel #2}}\n\\newcommand\\rej[2]{#1_{\\small \\perp #2}}\n\\newcommand\\V[1]{\\vec{#1}}\n\\newcommand\\len[1]{\\mathrm{len}(#1)}\n\\newcommand\\disp[1]{\\mathrm{disp}(#1)}\n$",s(t,r,e),s(t,i,e),s(t,a,e),s(t,l,e),s(t,c,e),s(t,d,e),s(t,p,e),s(t,v,e),s(t,w,e),s(t,y,e),s(t,x,e),s(t,b,e),s(t,$,e),s(t,_,e),s(t,M,e),s(t,T,e),s(t,k,e),s(t,R,e),o(R,A),S.m("$(x_i, y_i)$",R),o(R,C),j.m("$x_i$",R),o(R,N),I.m("$(\\alpha_1, \\cdots, \\alpha_n)$",R),o(R,X),V.m("$\\alpha_i$",R),o(R,B),s(t,P,e),s(t,L,e),o(L,U),O.m("$y_i$",L),o(L,G),K.m("$\\alpha$",L),o(L,W),Y.m("$(x_i, y_i)$",L),o(L,Q),s(t,J,e),s(t,Z,e),o(Z,tt),et.m("$x_i$",Z),o(Z,nt),o(Z,rt),o(Z,it),at.m("$k_j(x)$",Z),o(Z,ot),st.m("$(k_j(x_1), k_j(x_2), \\cdots, k_j(x_n))$",Z),o(Z,ht),lt.m("$(x_1, x_2, \\cdots, x_n)$",Z),o(Z,ut),s(t,ct,e),D(ft,t,e),s(t,mt,e),s(t,dt,e),o(dt,pt),gt.m("$x_i$",dt),o(dt,vt),wt.m("$(x_i, y_i)$",dt),o(dt,yt),s(t,xt,e),s(t,bt,e),s(t,$t,e),s(t,_t,e),o(_t,Mt),Tt.m("$\\sigma$",_t),o(_t,Et),kt.m("$n$",_t),o(_t,Rt),At.m("$\\mathbb{R}^n$",_t),o(_t,St),Ct.m("$(y_i)$",_t),o(_t,jt),s(t,Nt,e),s(t,It,e),s(t,Xt,e),Vt.m("$$\n\\begin{aligned}\nk_j(x) & & \\text{Gaussians centered at $x_j$, $j = 1 .. n$} \\\\\nf(x) & \\equiv \\sum_j { \\alpha_j k_j(x) } & \\text{the blue curve}\\\\\nf(x_i) & = \\sum_j { \\alpha_j k_j(x_i) } = y_i & \\text{fitting the blue curve to the black points} \\\\\n\\B{\\alpha K} & = \\B{y} , & \\text{$\\B{K}$: rows are vectors of evaluation} \\\\\n\\end{aligned}\n$$",t,e),s(t,Bt,e),o(Bt,Pt),Lt.m("$\\B{\\alpha}$",Bt),o(Bt,Ut),Ft.m("$\\B{K}$",Bt),o(Bt,zt),qt.m("$\\B{K}$",Bt),o(Bt,Dt),Ht.m("$\\sigma$",Bt),o(Bt,Ot),Gt.m("$(f_j(x_1), \\cdots, f_j(x_n))$",Bt),o(Bt,Kt),Wt.m("$\\B{\\alpha}$",Bt),o(Bt,Yt),s(t,Qt,e),s(t,Jt,e),o(Jt,Zt),te.m("$x_i$",Jt),o(Jt,ee),s(t,ne,e),s(t,re,e),s(t,ie,e),s(t,ae,e),o(ae,oe),o(oe,se),he.m("$\\mathbb{R} \\times \\mathbb{R}$",oe),o(oe,le),o(ae,ue),o(ae,ce),o(ae,fe),me.m("$x_i$",ae),o(ae,de),pe.m("$k_j(\\cdot)$",ae),o(ae,ge),ve.m("$(k_j(x_i))$",ae),o(ae,we),ye.m("$(x_i, y_i)$",ae),o(ae,xe),s(t,be,e),s(t,$e,e),o($e,_e),o(_e,Me),Te.m("$x_i$",_e),o($e,Ee),o($e,ke),o($e,Re),Ae.m("$n$",$e),o($e,Se),Ce.m("$\\mathbb{R}^n$",$e),o($e,je),Ne.m("$n$",$e),o($e,Ie),o($e,Xe),o($e,Ve),Be.m("$x_i$",$e),o($e,Pe),s(t,Le,e),s(t,Ue,e),o(Ue,Fe),o(Ue,ze),qe.m("$\\mathbb{R}$",Ue),o(Ue,De),s(t,He,e),s(t,Oe,e),o(Oe,Ge),o(Oe,Ke),We.m("$\\mathcal{X}$",Oe),o(Oe,Ye),s(t,Qe,e),s(t,Je,e),o(Je,Ze),tn.m("$\\B{\\alpha}$",Je),o(Je,en),s(t,nn,e),s(t,rn,e),s(t,an,e),s(t,on,e),s(t,sn,e),s(t,hn,e),s(t,ln,e),s(t,un,e),o(un,cn),o(cn,fn),o(fn,mn),dn.m("$\\mathcal{X}$",fn),o(un,pn),gn.m("$f_i: \\mathcal{X} \\mapsto \\mathcal{Y}$",un),o(un,vn),wn.m("$f_i$",un),o(un,yn),xn.m("$x_i \\in \\mathcal{X}$",un),o(un,bn),$n.m("$x_i$",un),o(un,_n),Mn.m("$\\mathcal{X}$",un),o(un,Tn),s(t,En,e),s(t,kn,e),s(t,Rn,e),s(t,An,e),o(An,Sn),o(An,Cn),jn.m("$n$",An),o(An,Nn),In.m("$n$",An),o(An,Xn),Vn.m("$n$",An),o(An,Bn),Pn.m("$\\mathcal{X}$",An),o(An,Ln),Un.m("$n$",An),o(An,Fn),o(An,zn),o(An,qn),Dn.m("$(f_i(x_1), f_i(x_2), \\cdots, f_i(x_n))$",An),o(An,Hn),s(t,On,e),s(t,Gn,e),s(t,Kn,e),s(t,Wn,e),o(Wn,Yn),o(Wn,Qn),Jn.m("$f_i(x) \\equiv \\V{\\phi_f}_i \\cdot \\B{\\phi}(x)$",Wn),o(Wn,Zn),tr.m("$\\V{\\phi_f}_i$",Wn),o(Wn,er),s(t,nr,e),s(t,rr,e),o(rr,ir),ar.m("$\\sigma$",rr),o(rr,or),sr.m("$\\mu \\in \\mathcal{X}$",rr),o(rr,hr),s(t,lr,e),s(t,ur,e),s(t,cr,e),s(t,fr,e),o(fr,mr),dr.m("$\\mu$",fr),o(fr,pr),gr.m("$\\vec{\\phi}(\\mu)$",fr),o(fr,vr),wr.m("$x$",fr),o(fr,yr),xr.m("$\\vec{\\phi}(x)$",fr),o(fr,br),$r.m("$\\sigma$",fr),o(fr,_r),Mr.m("$\\vec{\\phi}(\\cdot)$",fr),o(fr,Tr),Er.m("$\\sigma$",fr),o(fr,kr),Rr.m("$\\mu$",fr),o(fr,Ar),Sr.m("$\\vec{\\phi_\\sigma}(\\cdot)$",fr),o(fr,Cr),s(t,jr,e),s(t,Nr,e),o(Nr,Ir),Xr.m("$e^{axy}$",Nr),o(Nr,Vr),Br.m("$e^{-\\half a(x-y)^2}$",Nr),o(Nr,Pr),Lr.m("$a$",Nr),o(Nr,Ur),s(t,Fr,e),zr.m("$$\n\\begin{aligned}\ne^{axy} & = \\sum_{i=0} { \\dfrac{a^i(xy)^i}{i!} } & \\text{Taylor expansion} \\\\\n& = \\sum_{i=0} { \\dfrac{(a^\\half x)^i}{(i!)^\\half} \\dfrac{(a^\\half y)^i}{(i!)^\\half} } & \\text{Separate $x$ and $y$ terms to symmetric roles} \\\\\n& = \\sum_{i=0} { \\psi_{a,i}(x) \\psi_{a,i}(y) } & \\text{Let $\\psi_{a,i}(p) \\equiv \\dfrac{(a^\\half p)^i}{(i!)^\\half}$ }\\\\\n& = \\vec{\\psi_a}(x) \\cdot \\vec{\\psi_a}(y) & \\text{Let $\\vec{\\psi_a}(p) \\equiv (\\psi_{a,1}(p), \\psi_{a,2}(p), \\cdots)$ } \\\\\n\\end{aligned}\n$$",t,e),s(t,qr,e),o(qr,Dr),Hr.m("$e^{axy}$",qr),o(qr,Or),Gr.m("$y = \\mu$",qr),o(qr,Kr),s(t,Wr,e),Yr.m("$$\n\\begin{aligned}\ne^{-\\half a(x-\\mu)^2} & = e^{-\\half a(x^2-2x\\mu+\\mu^2)} \\\\[1em]\n& = e^{-\\half a x^2} e^{ax\\mu} e^{-\\half a \\mu^2} \\\\[1em]\n& = e^{-\\half a x^2} ( \\vec{\\psi_a}(x) \\cdot \\vec{\\psi_a}(\\mu) ) e^{-\\half a \\mu^2} & \\text{substitute formula above} \\\\[1em]\n& = (e^{-\\half a x^2} \\vec{\\psi_a}(x) \\cdot e^{-\\half a \\mu^2} \\vec{\\psi_a}(\\mu)) & \\text{By bilinearity of dot product} \\\\[1em]\n& = \\vec{\\phi_{\\sigma}}(x) \\cdot \\vec{\\phi_{\\sigma}}(\\mu) & \\text{Let $\\vec{\\phi_{\\sigma}}(p) \\equiv e^{-\\half a p^2} \\vec{\\psi_a}(p)$ with $a = {\\small 1 \\over \\sigma^2}$} \\\\\n\\end{aligned}\n$$",t,e),s(t,Qr,e),o(Qr,Jr),Zr.m("$e^{-\\tfrac{1}{2} {(\\tfrac{x - \\mu}{\\sigma})}^2 }$",Qr),o(Qr,ti),ei.m("$\\dfrac{1}{\\sigma^\\half (2 \\pi)^{\\small 1 \\over 4}}$",Qr),s(t,ni,e),s(t,ri,e),o(ri,ii),ai.m("$\\mathcal{N}(x; \\mu, \\sigma)$",ri),o(ri,oi),si.m("$k(x, \\mu)$",ri),o(ri,hi),li.m("$\\sigma$",ri),o(ri,ui),ci.m("$x$",ri),o(ri,fi),mi.m("$\\mu$",ri),o(ri,di),pi.m("$\\mathcal{N}(x;\\sigma,\\mu) = \\mathcal{N}(\\mu;\\sigma, x)$",ri),o(ri,gi),o(ri,vi),o(ri,wi),yi.m("$\\mu \\in \\mathcal{X}$",ri),o(ri,xi),o(ri,bi),o(ri,$i),o(ri,_i),o(ri,Mi),s(t,Ti,e),s(t,Ei,e),o(Ei,ki),Ri.m("$x = \\mu$",Ei),o(Ei,Ai),Si.m("$\\vec{\\phi_\\sigma}(\\mu) \\cdot \\vec{\\phi_\\sigma}(\\mu) \\equiv \\norm{\\vec{\\phi_\\sigma}(x)}^2$",Ei),o(Ei,Ci),ji.m("$x$",Ei),o(Ei,Ni),Ii.m("$\\cos \\theta_{\\vec{\\phi}(x), \\vec{\\phi}(\\mu)}$",Ei),o(Ei,Xi),s(t,Vi,e),s(t,Bi,e),o(Bi,Pi),Li.m("$x$",Bi),o(Bi,Ui),Fi.m("$\\mu$",Bi),o(Bi,zi),qi.m("$90^\\circ$",Bi),o(Bi,Di),Hi.m("$[0^\\circ, 90^\\circ)$",Bi),o(Bi,Oi),Gi.m("$x_1, x_2, x_3$",Bi),o(Bi,Ki),Wi.m("$\\vec{\\phi}(x_1), \\vec{\\phi}(x_2), \\vec{\\phi}(x_3)$",Bi),o(Bi,Yi),Qi.m("$\\infty$",Bi),o(Bi,Ji),Zi.m("$\\mathbb{R}^3$",Bi),o(Bi,ta),s(t,ea,e),s(t,ra,e),s(t,ia,e),s(t,aa,e),o(aa,oa),sa.m("$\\mathcal{X} \\times \\mathcal{Y}$",aa),o(aa,ha),s(t,la,e),s(t,ua,e),s(t,ca,e),s(t,fa,e),o(fa,ma),da.m("$\\sigma$",fa),o(fa,pa),ga.m("$\\GSpace$",fa),o(fa,va),wa.m("$\\FeatSpace$",fa),o(fa,ya),s(t,xa,e),s(t,$a,e),o($a,_a),o(_a,Ma),o(Ma,Ta),o(Ma,Ea),ka.m("$x \\in \\mathcal{X}$",Ma),o(Ma,Ra),Aa.m("$\\vec{\\phi_\\sigma}(x) \\in \\FeatSpace$",Ma),o(Ma,Sa),o($a,Ca),o($a,ja),o(ja,Na),o(Na,Ia),o(Na,Xa),Va.m("$f_{\\mu_i}(\\cdot) \\in \\GSpace$",Na),o(Na,Ba),Pa.m("$\\vec{\\phi_\\sigma}(\\mu_i) \\in \\FeatSpace$",Na),o(Na,La),o($a,Ua),o($a,Fa),o(Fa,za),o(za,qa),o(za,Da),Ha.m("$f_{\\mu_i}(x)$",za),o(za,Oa),Ga.m("$\\vec{\\phi_\\sigma}(\\mu_i) \\cdot \\vec{\\phi_\\sigma}(x)$",za),o(za,Ka),Wa.m("$\\vec{\\phi}(\\mu_i)$",za),o(za,Ya),Qa.m("$\\vec{\\phi}(x)$",za),o(za,Ja),Za.m("$\\theta = 0$",za),o(za,to),eo.m("$\\theta \\rightarrow 90^\\circ$",za),o(za,no),ro.m("$+ \\infty$",za),o(za,io),ao.m("$- \\infty$",za),o(za,oo),s(t,so,e),s(t,ho,e),s(t,lo,e),s(t,uo,e),o(uo,co),o(co,fo),o(fo,mo),o(fo,po),go.m("$\\mu$",fo),o(fo,vo),o(uo,wo),o(uo,yo),o(yo,xo),o(xo,bo),o(bo,$o),_o.m("$\\mu$",bo),o(bo,Mo),o(xo,To),Eo.m("$\\vec{\\alpha}$",xo),o(xo,ko),Ro.m("$f_{\\mu_i}(\\cdot) \\in \\GSpace$",xo),o(xo,Ao),o(xo,So),o(xo,Co),jo.m("$\\vec{\\alpha}$",xo),o(xo,No),Io.m("$\\vec{\\phi_\\sigma}(\\mu_i)$",xo),o(xo,Xo),Vo.m("$\\mu$",xo),o(xo,Bo),o(uo,Po),o(uo,Lo),o(Lo,Uo),o(Uo,Fo),o(Uo,zo),qo.m("$x$",Uo),o(Uo,Do),o(uo,Ho),o(uo,Oo),o(Oo,Go),o(Go,Ko),o(Go,Wo),Yo.m("$f$",Go),o(Go,Qo),Jo.m("$\\mu$",Go),o(Go,Zo),ts.m("$\\vec{\\phi_\\sigma}(x_i)$",Go),o(Go,es),ns.m("$x$",Go),o(Go,rs),is.m("$f_\\parallel$",Go),o(Go,as),os.m("$x$",Go),o(Go,ss),hs.m("$y_i$",Go),o(Go,ls),s(t,us,e),s(t,cs,e),o(cs,fs),ms.m("$\\mu$",cs),o(cs,ds),ps.m("$x$",cs),o(cs,gs),s(t,vs,e),s(t,ws,e),s(t,ys,e),s(t,xs,e),o(xs,bs),$s.m("$\\mu_i$",xs),o(xs,_s),Ms.m("$\\sigma$",xs),o(xs,Ts),Es.m("$\\alpha_i$",xs),o(xs,ks),s(t,Rs,e),s(t,As,e),o(As,Ss),Cs.m("$\\mu_i$",As),o(As,js),Ns.m("$(x_i, y_i)$",As),o(As,Is),Xs.m("$\\mu$",As),o(As,Vs),Bs.m("$x$",As),o(As,Ps),s(t,Ls,e),s(t,Us,e),o(Us,Fs),zs.m("$\\alpha_i$",Us),o(Us,qs),Ds.m("$\\mu_i$",Us),o(Us,Hs),Os.m("$\\alpha_i$",Us),o(Us,Gs),Ks.m("$(x_i, y_i)$",Us),o(Us,Ws),s(t,Ys,e),s(t,Qs,e),o(Qs,Js),Zs.m("$\\sigma$",Qs),o(Qs,th),eh.m("$\\mu$",Qs),o(Qs,nh),rh.m("$\\mu$",Qs),o(Qs,ih),ah.m("$\\alpha_i$",Qs),o(Qs,oh),sh.m("$\\mathcal{X}$",Qs),s(t,hh,e),s(t,lh,e),o(lh,uh),ch.m("$\\mu_i$",lh),o(lh,fh),mh.m("$x_i$",lh),o(lh,dh),o(lh,ph),o(lh,gh),vh.m("$\\mu_i$",lh),o(lh,wh),yh.m("$\\alpha_i$",lh),o(lh,xh),bh.m("$x_i$",lh),o(lh,$h),_h.m("$\\mathrm{K}$",lh),o(lh,Mh),Th.m("$\\alpha \\mathrm{K}$",lh),o(lh,Eh),s(t,kh,e),s(t,Rh,e),o(Rh,Ah),Sh.m("$\\mu_i = x_i$",Rh),o(Rh,Ch),jh.m("$\\mu$",Rh),o(Rh,Nh),Ih.m("$x$",Rh),o(Rh,Xh),Vh.m("$x_i = \\mu_i$",Rh),o(Rh,Bh),Ph.m("$\\mathcal{N}(x; \\mu, \\sigma) = \\mathcal{N}(\\mu; x, \\sigma)$",Rh),o(Rh,Lh),Uh.m("$\\mu_i \\ne x_i$",Rh),o(Rh,Fh),s(t,zh,e),s(t,qh,e),s(t,Dh,e),s(t,Hh,e),o(Hh,Oh),Gh.m("$\\sigma$",Hh),o(Hh,Kh),Wh.m("$\\sigma$",Hh),o(Hh,Yh),Qh.m("$\\vec{\\phi_\\sigma}(x)$",Hh),o(Hh,Jh),Zh.m("$\\vec{\\phi_x}$",Hh),o(Hh,tl),el.m("$f = \\sum_i { \\alpha_i f_{\\mu_i} }$",Hh),o(Hh,nl),rl.m("$\\sum_i { \\alpha_i \\V{\\phi_{\\mu_i}}}$",Hh),o(Hh,il),al.m("$\\vec{\\phi_f}$",Hh),o(Hh,ol),s(t,sl,e),s(t,hl,e),o(hl,ll),o(hl,ul),cl.m("$\\mu$",hl),o(hl,fl),ml.m("$x$",hl),o(hl,dl),pl.m("$\\mu_i$",hl),o(hl,gl),vl.m("$\\alpha_i$",hl),o(hl,wl),yl.m("$\\alpha_i \\vec{\\phi_\\sigma}(\\mu_i)$",hl),o(hl,xl),bl.m("$x$",hl),o(hl,$l),s(t,_l,e),s(t,Ml,e),o(Ml,Tl),El.m("$\\sigma$",Ml),o(Ml,kl),Rl.m("$x$",Ml),o(Ml,Al),Sl.m("$\\mu_i$",Ml),o(Ml,Cl),jl.m("$\\sigma$",Ml),o(Ml,Nl),Il.m("$\\sigma$",Ml),o(Ml,Xl),Vl.m("$\\mu_i$",Ml),o(Ml,Bl),Pl.m("$\\sigma$",Ml),o(Ml,Ll),Ul.m("$\\mu_i$",Ml),o(Ml,Fl),zl.m("$x$",Ml),o(Ml,ql),Dl.m("$|\\mu_i - x|$",Ml),o(Ml,Hl),Ol.m("$\\sigma \\rightarrow 0$",Ml),o(Ml,Gl),Kl.m("$\\sigma \\rightarrow \\infty$",Ml),o(Ml,Wl),Yl.m("$\\mu$",Ml),o(Ml,Ql),s(t,Jl,e),s(t,Zl,e),o(Zl,tu),eu.m("$\\mathcal{X}$",Zl),o(Zl,nu),ru.m("$|\\mu - x|$",Zl),o(Zl,iu),au.m("$\\mu$",Zl),o(Zl,ou),su.m("$\\mu$",Zl),o(Zl,hu),s(t,lu,e),s(t,uu,e),o(uu,cu),fu.m("$\\mathcal{X}$",uu),o(uu,mu),du.m("$\\mathcal{X}$",uu),o(uu,pu),gu.m("$\\mathcal{X}$",uu),o(uu,vu),s(t,wu,e),s(t,yu,e),s(t,xu,e),s(t,bu,e),o(bu,$u),_u.m("$\\mu$",bu),o(bu,Mu),Tu.m("$x$",bu),o(bu,Eu),ku.m("$\\sigma$",bu),o(bu,Ru),Au.m("$\\mu_2$",bu),o(bu,Su),Cu.m("$f_1$",bu),o(bu,ju),Nu.m("$\\vec{\\phi_{\\mu_1}}$",bu),o(bu,Iu),Xu.m("$\\vec{\\phi_{\\mu_1}}$",bu),o(bu,Vu),s(t,Bu,e),s(t,Pu,e),o(Pu,Lu),Uu.m("$\\alpha_i$",Pu),o(Pu,Fu),zu.m("$\\vec{\\phi_{\\mu_1}}$",Pu),o(Pu,qu),Du.m("$\\vec{\\phi_{\\mu_1}}$",Pu),o(Pu,Hu),Ou.m("$\\vec{\\phi_f}$",Pu),o(Pu,Gu),Ku.m("$\\disp{\\proj{\\V{\\phi_f}}{\\V{\\phi_{x_i}}}} = y_i$",Pu),o(Pu,Wu),Yu.m("$x_i = \\mu_i$",Pu),o(Pu,Qu),Ju.m("$\\vec{\\phi_{x_1}}$",Pu),o(Pu,Zu),tc.m("$\\vec{\\phi_{x_2}}$",Pu),o(Pu,ec),nc.m("$\\alpha_1$",Pu),o(Pu,rc),ic.m("$\\disp{\\proj{\\V{\\phi_f}}{\\V{\\phi_{x_2}}}}$",Pu),o(Pu,ac),s(t,oc,e),s(t,sc,e),o(sc,hc),lc.m("$\\sigma$",sc),o(sc,uc),cc.m("$\\alpha_i$",sc),o(sc,fc),s(t,mc,e),s(t,dc,e),s(t,pc,e),s(t,gc,e),o(gc,vc),wc.m("$f$",gc),o(gc,yc),o(gc,xc),o(gc,bc),$c.m("$\\norm{f}$",gc),o(gc,_c),Mc.m("$\\norm{f}$",gc),o(gc,Tc),Ec.m("$\\norm{f_\\parallel}$",gc),o(gc,kc),Rc.m("$\\norm{f_\\perp}$",gc),o(gc,Ac),s(t,Sc,e),s(t,Cc,e),o(Cc,jc),Nc.m("$x$",Cc),o(Cc,Ic),Xc.m("$\\alpha_i$",Cc),o(Cc,Vc),Bc.m("$\\|f\\|$",Cc),o(Cc,Pc),Lc.m("$(x_i, y_i)$",Cc),o(Cc,Uc),Fc.m("$\\sigma$",Cc),o(Cc,zc),s(t,qc,e),s(t,Dc,e),o(Dc,Hc),Oc.m("$\\V{\\phi_{\\mu_1}}$",Dc),o(Dc,Gc),Kc.m("$\\V{\\phi_{\\mu_2}}$",Dc),o(Dc,Wc),Yc.m("$\\V{\\phi_f}$",Dc),o(Dc,Qc),s(t,Jc,e),s(t,Zc,e),o(Zc,tf),o(Zc,ef),o(Zc,nf),rf.m("$y_i$",Zc),o(Zc,af),of.m("$\\sigma$",Zc),o(Zc,sf),s(t,hf,e),s(t,lf,e),o(lf,uf),cf.m("$y_i$",lf),o(lf,ff),s(t,mf,e),s(t,df,e),o(df,pf),o(pf,gf),vf.m("$\\mu$",pf),o(pf,wf),yf.m("$x$",pf),o(pf,xf),s(t,bf,e),s(t,$f,e),o($f,_f),Mf.m("$\\V{\\phi_f}$",$f),o($f,Tf),Ef.m("$\\mu$",$f),o($f,kf),Rf.m("$n$",$f),o($f,Af),Sf.m("$\\mathbb{span}(\\V{\\phi_{\\mu_i}})$",$f),o($f,Cf),jf.m("$\\proj{\\V{\\phi_f}}{\\mathbb{x-span}}$",$f),o($f,Nf),If.m("$x$",$f),o($f,Xf),Vf.m("$\\mathbb{span}(\\V{\\phi_{x_i}})$",$f),o($f,Bf),Pf.m("$\\mu_i = x_i$",$f),o($f,Lf),Uf.m("$\\V{\\phi_f} = \\V{\\phi_{f_\\parallel}}$",$f),o($f,Ff),zf.m("$\\V{\\phi_{f_\\perp}} = \\V{0}$",$f),o($f,qf),Df.m("$\\mu$",$f),o($f,Hf),Of.m("$\\mu_i$",$f),o($f,Gf),Kf.m("$f$",$f),o($f,Wf),Yf.m("$\\norm{f}$",$f),o($f,Qf),Jf.m("$\\V{\\phi_f}$",$f),o($f,Zf),tm.m("$\\mu$",$f),o($f,em),nm.m("$\\V{\\phi_f} = \\V{\\phi_{f_\\parallel}} + \\V{\\phi_{f_\\perp}}$",$f),o($f,rm),im.m("$x$",$f),o($f,am),om.m("$\\norm{f}$",$f),o($f,sm),hm.m("$x$",$f),o($f,lm),s(t,um,e),s(t,cm,e),o(cm,fm),mm.m("$\\mu$",cm),o(cm,dm),pm.m("$x$",cm),o(cm,gm),vm.m("$x$",cm),o(cm,wm),s(t,ym,e),s(t,xm,e),s(t,bm,e),D($m,t,e),s(t,_m,e),s(t,Mm,e),s(t,Tm,e),s(t,Em,e),o(Em,km),Rm.m("$\\mu$",Em),o(Em,Am),Sm.m("$\\V{\\phi_{\\mu_1}}$",Em),o(Em,Cm),jm.m("$\\V{\\phi_{\\mu_2}}$",Em),o(Em,Nm),Im.m("$\\V{\\phi_f} = \\sum_i { \\alpha_i \\V{\\phi_{\\mu_i}}}$",Em),o(Em,Xm),Vm.m("$x$",Em),o(Em,Bm),Pm.m("$\\V{\\phi_{x_i}}$",Em),o(Em,Lm),Um.m("$\\mu_i = x_i$",Em),o(Em,Fm),zm.m("$\\V{\\phi_f}$",Em),o(Em,qm),Dm.m("$\\V{\\phi_{\\mu_i}}$",Em),o(Em,Hm),Om.m("$f(x_i)$",Em),o(Em,Gm),s(t,Km,e),s(t,Wm,e),o(Wm,Ym),o(Ym,Qm),Jm.m("$\\V{\\phi_{\\mu_1}}$",Ym),o(Ym,Zm),td.m("$\\V{\\phi_{\\mu_2}}$",Ym),o(Wm,ed),nd.m("$\\mu_i$",Wm),o(Wm,rd),s(t,id,e),s(t,ad,e),o(ad,od),o(od,sd),hd.m("$\\V{\\phi_{\\mu_1}}$",od);o(od,ld),ud.m("$\\V{\\phi_{\\mu_2}}$",od),o(od,cd),fd.m("$f(\\cdot)$",od),o(od,md),dd.m("$\\mu_i$",od),o(ad,pd),gd.m("$\\mu$",ad),o(ad,vd),wd.m("$x$",ad),o(ad,yd),xd.m("$\\V{\\phi_{\\mu_i}}$",ad),o(ad,bd),s(t,$d,e),s(t,_d,e),o(_d,Md),o(Md,Td),Ed.m("$\\V{\\phi_{\\mu_1}}$",Md),o(Md,kd),Rd.m("$\\V{\\phi_{\\mu_2}}$",Md),o(Md,Ad),Sd.m("$f(\\cdot)$",Md),o(Md,Cd),jd.m("$\\mu_i$",Md),o(_d,Nd),Id.m("$\\mu$",_d),o(_d,Xd),Vd.m("$x$",_d),o(_d,Bd),Pd.m("$y$",_d),o(_d,Ld),s(t,Ud,e),s(t,Fd,e),o(Fd,zd),qd.m("$\\mu_i = x_i$",Fd),o(Fd,Dd),s(t,Hd,e),s(t,Od,e),o(Od,Gd),Kd.m("$\\mu$",Od),o(Od,Wd),Yd.m("$x$",Od),o(Od,Qd),Jd.m("$\\mu$",Od),o(Od,Zd),s(t,tp,e),s(t,ep,e),o(ep,np),rp.m("$f$",ep),o(ep,ip),ap.m("$\\V{\\phi_f} = \\B{\\alpha M}$",ep),o(ep,op),sp.m("$\\B{M}$",ep),o(ep,hp),lp.m("$\\V{\\phi_{\\mu_i}}$",ep),o(ep,up),cp.m("$f$",ep),o(ep,fp),o(ep,mp),o(ep,dp),pp.m("$x_i$",ep),o(ep,gp),vp.m("$\\B{\\alpha M X}^T$",ep),o(ep,wp),yp.m("$\\B{X}$",ep),o(ep,xp),bp.m("$\\V{\\phi_{x_i}}$",ep),o(ep,$p),_p.m("$\\B{M} = \\B{X}$",ep),o(ep,Mp),s(t,Tp,e),s(t,Ep,e),o(Ep,kp),Rp.m("$\\B{\\alpha M X}^T = \\B{y}$",Ep),o(Ep,Ap),Sp.m("$\\B{\\alpha}$",Ep),o(Ep,Cp),s(t,jp,e),Np.m("$$\n\\begin{aligned}\n\\B{a} \\cdot \\B{b} & = (\\proj{\\B{a}}{\\B{b}} + \\rej{\\B{a}}{\\B{b}}) \\cdot \\B{b} & \\text{orthogonal decomposition}\\\\\n& = \\proj{\\B{a}}{\\B{b}} \\cdot \\B{b} + \\rej{\\B{a}}{\\B{b}} \\cdot \\B{b} & \\text{linearity of dot product}\\\\\n& = \\proj{\\B{a}}{\\B{b}} \\cdot \\B{b} & \\text{zero orthogonal contribution} \\\\\n\\end{aligned}\n$$",t,e),s(t,Ip,e),s(t,Xp,e),Vp.m("$$\n\\begin{aligned}\n\\B{\\alpha M X}^T & = \\B{\\alpha} (\\proj{\\B{M}}{\\texttt{span}(\\B{X})} + \\rej{\\B{M}}{\\texttt{span}(\\B{X})}) \\B{X}^T \\\\\n& = \\B{\\alpha} \\proj{\\B{M}}{\\texttt{span}(\\B{X})} \\B{X}^T\n\\end{aligned}\n$$",t,e),s(t,Bp,e),Pp.m("$\\proj{\\B{M}}{}$",Bp),o(Bp,Lp),Up.m("$\\texttt{span}(\\B{X})$",Bp),o(Bp,Fp),zp.m("$\\mu_i = x_i$",Bp),o(Bp,qp),Dp.m("$\\mu_i$",Bp),o(Bp,Hp),Op.m("$\\texttt{span}(\\B{M}) = \\texttt{span}(\\B{X})$",Bp),o(Bp,Gp),Kp.m("$\\B{y}$",Bp),o(Bp,Wp),Yp.m("$\\mu_i$",Bp),o(Bp,Qp),s(t,Jp,e),s(t,Zp,e),o(Zp,tg),eg.m("$\\norm{\\V{\\phi_f}}^2$",Zp),o(Zp,ng),s(t,rg,e),ig.m("$$\n\\begin{aligned}\n\\B{\\alpha M X}^T & = \\B{\\beta X X}^T = \\B{y} &\\text{a $\\B{\\beta}$ exists, by previous argument}\\\\\n\\norm{\\V{\\phi_f}}^2 & = \\B{\\alpha M M}^T \\B{\\alpha}^T \\\\\n& = \\B{\\alpha} (\\proj{\\B{M}}{} + \\rej{\\B{M}}{}) (\\proj{\\B{M}}{} + \\rej{\\B{M}}{})^T \\B{\\alpha}^T \\\\\n& = \\B{\\alpha} \\proj{\\B{M}}{} \\proj{\\B{M}}{}^T \\B{\\alpha}^T\n+ 2 \\B{\\alpha} \\proj{\\B{M}}{} \\rej{\\B{M}}{}^T \\B{\\alpha}^T\n+ \\B{\\alpha} \\rej{\\B{M}}{} \\rej{\\B{M}}{}^T \\B{\\alpha}^T \\\\\n& \\ge \\B{\\alpha} \\proj{\\B{M}}{} \\proj{\\B{M}}{}^T \\B{\\alpha}^T \\\\[1em]\n& = \\B{\\beta X X}^T \\B{\\beta}^T & \\text{by uniqueness of span}\\\\\n\\end{aligned}\n$$",t,e),s(t,ag,e),s(t,og,e),s(t,sg,e),o(sg,hg),lg.m("$f$",sg),o(sg,ug),cg.m("$\\norm{\\V{\\phi_f}}$",sg),o(sg,fg),s(t,mg,e),s(t,dg,e),o(dg,pg),gg.m("$a, b \\in \\mathcal{X}$",dg),o(dg,vg),wg.m("$|f(a)|$",dg),o(dg,yg),xg.m("$|f(a) - f(b)|$",dg),o(dg,bg),s(t,$g,e),_g.m("$$\n\\begin{aligned}\nf(a) & = \\V{\\phi_f} \\cdot \\V{\\phi_a} & \\text{definition of $f(x)$} \\\\\n& = \\norm{\\V{\\phi_f}} \\|\\V{\\phi_a}\\| \\cos \\theta_{\\V{\\phi_f},\\V{\\phi_a}} & \\text{definition of dot product} \\\\\n\\implies |f(a)| & \\le \\norm{\\V{\\phi_f}}\\|\\V{\\phi_a}\\| & \\text{Cauchy Schwarz inequality} \\\\[2em]\nf(a) - f(b) & = \\V{\\phi_f} \\cdot \\V{\\phi_a} - \\V{\\phi_f} \\cdot \\V{\\phi_b} &\\text{definition of $f(x)$} \\\\\n& = \\V{\\phi_f} \\cdot (\\V{\\phi_a} - \\V{\\phi_b}) & \\text{bilinearity of dot product} \\\\\n& = \\norm{\\V{\\phi_f}} \\|\\V{\\phi_a} - \\V{\\phi_b}\\| \\cos \\theta_{\\V{\\phi_f}, \\V{\\phi_a} - \\V{\\phi_b}} & \\text{definition of dot product} \\\\\n\\implies |f(a) - f(b)| & \\le \\norm{\\V{\\phi_f}} \\|\\V{\\phi_a} - \\V{\\phi_b}\\| & \\text{Cauchy Schwarz inequality} \\\\\n\\end{aligned}\n$$",t,e),s(t,Mg,e),o(Mg,Tg),Eg.m("$f$",Mg),o(Mg,kg),Rg.m("$\\norm{\\V{\\phi_f}}$",Mg),o(Mg,Ag),Sg.m("$\\norm{\\V{\\phi_a}}$",Mg),o(Mg,Cg),jg.m("$\\B{\\phi}(\\cdot)$",Mg),o(Mg,Ng),Ig.m("$\\norm{\\V{\\phi_f}}$",Mg),o(Mg,Xg),Vg.m("$f$",Mg),o(Mg,Bg),s(t,Pg,e),s(t,Lg,e),o(Lg,Ug),Fg.m("$\\norm{\\V{\\phi_a} - \\V{\\phi_b}}$",Lg),o(Lg,zg),qg.m("$\\norm{\\V{\\phi_f}}$",Lg),o(Lg,Dg),s(t,Hg,e),s(t,Og,e),o(Og,Gg),Kg.m("$y_a$",Og),o(Og,Wg),Yg.m("$y_b$",Og),o(Og,Qg),Jg.m("$|f(a) - f(b)| = |y_a - y_b|$",Og),o(Og,Zg),tv.m("$\\|\\V{\\phi_f}\\|$",Og),o(Og,ev),nv.m("$\\|\\V{\\phi_a} - \\V{\\phi_b}\\|$",Og),o(Og,rv),iv.m("$x$",Og),o(Og,av),s(t,ov,e),s(t,sv,e),o(sv,hv),lv.m("$\\B{\\phi}(\\cdot)$",sv),o(sv,uv),cv.m("$\\B{\\phi}(\\cdot)$",sv),o(sv,fv),mv.m("$\\norm{\\V{\\phi_a} - \\V{\\phi_b}}$",sv),o(sv,dv),pv.m("$|y_a - y_b|$",sv),o(sv,gv),vv.m("$(a, b) \\in \\mathcal{X}$",sv),o(sv,wv),s(t,yv,e),s(t,xv,e),s(t,bv,e),s(t,$v,e),o($v,_v),Mv.m("$\\B{M} \\equiv \\B{X}$",$v),o($v,Tv),s(t,Ev,e),kv.m("$$\n\\begin{aligned}\n\\B{X} & & \\text{matrix of rows of $\\V{\\phi_{x_i}}$ as defined before} \\\\\n\\V{\\phi_f} & = \\B{\\alpha X} & \\text{$f$'s parameter vector}\\\\\n(f(x_i))_{(1..n)} &= \\B{\\alpha X X}^T & \\text{$f$'s vector of evaluation } \\\\\n\\end{aligned}\n$$",t,e),s(t,Rv,e),o(Rv,Av),Sv.m("$\\B{\\hat \\alpha}$",Rv),o(Rv,Cv),s(t,jv,e),Nv.m("$$\n\\begin{aligned}\n\\B{\\hat{\\alpha}} & = \\min_{\\alpha} { \\norm{\\B{\\alpha X X}^T - \\B{y}}^2 }\n\\end{aligned}\n$$",t,e),s(t,Iv,e),s(t,Xv,e),Vv.m("$$\n\\begin{aligned}\n\\B{\\hat{\\alpha}} & = \\min_{\\alpha} ( \\norm{\\B{\\alpha X X}^T - \\B{y}}^2 + \\lambda \\norm{\\B{\\alpha X}}^2 ) & \\text{sum of squared error, regularized by norm of $\\V{\\phi_f}$}\\\\\n& = \\min_{\\alpha} ( \\norm{\\B{\\alpha X X}^T - \\B{y}}^2 + \\lambda \\B{\\alpha X X}^T \\B{\\alpha}^T )\n\\end{aligned}\n$$",t,e),s(t,Bv,e),s(t,Pv,e),Lv.m("$$\n\\begin{aligned}\nf(x) & = \\V{\\phi_f} \\cdot \\V{\\phi_x} \\\\\n& = \\B{\\hat{\\alpha} X} \\cdot \\V{\\phi_x} \\\\\n& = \\sum_i { \\hat{\\alpha}_i \\V{\\phi_{x_i}} \\cdot \\V{\\phi_x} } \\\\\n\\end{aligned}\n$$",t,e),s(t,Uv,e),o(Uv,Fv),zv.m("$\\mathcal{X}$",Uv),o(Uv,qv),Dv.m("$\\V{\\phi_{x_i}} \\cdot \\V{\\phi_{x_j}}$",Uv),o(Uv,Hv),Ov.m("$\\B{X X}^T$",Uv),o(Uv,Gv),s(t,Kv,e),Wv.m("$$\n\\begin{aligned}\nk(x,x') & \\equiv \\V{\\phi_x} \\cdot \\V{\\phi_{x'}} & \\text{The kernel function} \\\\\n\\B{K} & \\equiv [ \\B{K}_{ij} = k(x_i, x_j) ] & \\text{The Kernel matrix, metric matrix or Gram matrix} \\\\\n& = \\B{X X}^T & \\text{from above}\n\\end{aligned}\n$$",t,e),s(t,Yv,e),s(t,Qv,e),Jv.m("$$\n\\begin{aligned}\n\\B{\\hat{\\alpha}} & = \\min_{\\alpha} ( \\norm{\\B{\\alpha K}- \\B{y}}^2 + \\lambda \\B{\\alpha K} \\B{\\alpha}^T )\n\\end{aligned}\n$$",t,e),s(t,Zv,e),s(t,tw,e),ew.m("$$\n\\begin{aligned}\nf(x) & = \\sum_i { \\hat{\\alpha}_i k(x_i, x) } \\\\\n\\end{aligned}\n$$",t,e),s(t,nw,e),o(nw,rw),iw.m("$x$",nw),o(nw,aw),ow.m("$\\B{\\alpha}$",nw),o(nw,sw),hw.m("$x_i$",nw),o(nw,lw),uw.m("$k(x, x') \\equiv \\mathcal{N}(x; x', \\sigma) = \\mathcal{N}(x'; x, \\sigma)$",nw),o(nw,cw),s(t,fw,e),s(t,mw,e),s(t,dw,e),s(t,pw,e),o(pw,gw),vw.m("$\\mathcal{X} \\times \\mathbb{R}$",pw),o(pw,ww),s(t,yw,e),s(t,xw,e),o(xw,bw),$w.m("$x_i$",xw),o(xw,_w),Mw.m("$x_i$",xw),o(xw,Tw),Ew.m("$y_i$",xw),o(xw,kw),Rw.m("$x_i$",xw),o(xw,Aw),s(t,Sw,e),s(t,Cw,e),o(Cw,jw),Nw.m("$f_{x_i}(x) \\equiv \\V{\\phi_{x_i}} \\cdot \\V{\\phi_x}$",Cw),o(Cw,Iw),s(t,Xw,e),s(t,Vw,e),s(t,Bw,e),s(t,Pw,e),s(t,Lw,e),s(t,Uw,e),s(t,Fw,e),s(t,zw,e),s(t,qw,e),s(t,Dw,e),o(Dw,Hw),Ow.m("$XX^T$",Dw),o(Dw,Gw),Kw.m("$X$",Dw),o(Dw,Ww),Yw.m("$X$",Dw),o(Dw,Qw),Jw.m("$X$",Dw),o(Dw,Zw),ty.m("$XX^T$",Dw),o(Dw,ey),ny.m("$\\alpha K \\alpha^T \\ge 0$",Dw),o(Dw,ry),iy.m("$\\alpha$",Dw),o(Dw,ay),oy.m("$K = XX^T$",Dw),o(Dw,sy),hy.m("$X$",Dw),o(Dw,ly),uy.m("$X$",Dw),o(Dw,cy),fy.m("$\\alpha X$",Dw),o(Dw,my),dy.m("$\\alpha X X^T \\alpha^T$",Dw),o(Dw,py),s(t,gy,e),s(t,vy,e),s(t,wy,e),s(t,yy,e),o(yy,xy),by.m("$k(x, x') \\equiv \\V{\\phi_x} \\cdot \\V{\\phi_x'}$",yy),o(yy,$y),s(t,_y,e),s(t,My,e),s(t,Ty,e),s(t,Ey,e),s(t,ky,e),s(t,Ry,e),o(Ry,Ay),Sy.m("$f_{x_i}(\\cdot): \\mathcal{X} \\mapsto \\mathbb{R}$",Ry),o(Ry,Cy),o(Ry,jy),o(Ry,Ny),Iy.m("$\\V{\\phi_{x_i}}: \\mathbb{R}^\\infty \\equiv \\mathcal{F}$",Ry),o(Ry,Xy),o(Ry,Vy),o(Ry,By),Py.m("$K$",Ry),o(Ry,Ly),Uy.m("$(\\V{\\phi_{x_i}})$",Ry),o(Ry,Fy),zy.m("$x_i$",Ry),o(Ry,qy),s(t,Dy,e),s(t,Hy,e),o(Hy,Oy),Gy.m("$f_{x_i}(\\cdot)$",Hy),o(Hy,Ky),Wy.m("$x \\in \\mathcal{X}$",Hy),o(Hy,Yy),o(Hy,Qy),o(Hy,Jy),Zy.m("$f_{x_i}(\\cdot): \\mathbb{R}^\\mathcal{X}$",Hy),o(Hy,tx),ex.m("$\\mathbb{R}^3$",Hy),o(Hy,nx),rx.m("$|\\mathcal{X}|$",Hy),o(Hy,ix),o(Hy,ax),o(Hy,ox),o(Hy,sx),o(Hy,hx),lx.m("$\\mathbb{R}^\\mathcal{X}$",Hy),o(Hy,ux),cx.m("$\\mathcal{H}$",Hy),o(Hy,fx),mx.m("$\\langle f_{x_i}, f_{x_j} \\rangle \\equiv \\V{\\phi_{x_i}} \\cdot \\V{\\phi_{x_j}} \\equiv f_{x_i}(x_j) \\equiv f_{x_j}(x_i)$",Hy),o(Hy,dx),s(t,px,e),s(t,gx,e),o(gx,vx),wx.m("$(f_{x_i})$",gx),o(gx,yx),xx.m("$K:[K_{ij} = f_{x_i}(x_j)]$",gx),o(gx,bx),$x.m("$KK^T = K$",gx),o(gx,_x),o(gx,Mx),o(gx,Tx),s(t,Ex,e),s(t,kx,e),s(t,Rx,e),s(t,Ax,e),o(Ax,Sx),Cx.m("$f_x \\in \\mathcal{H}$",Ax),o(Ax,jx),Nx.m("$x \\in \\mathcal{X}$",Ax),o(Ax,Ix),Xx.m("$x$",Ax),o(Ax,Vx),o(Ax,Bx),o(Ax,Px),Lx.m("$\\mathcal{H}$",Ax),o(Ax,Ux),o(Ax,Fx),o(Ax,zx),qx.m("$(f_{x_i})$",Ax),o(Ax,Dx),Hx.m("$\\B{M} = \\B{X}$",Ax),o(Ax,Ox),o(Ax,Gx),Kx=!0},p:t,i(t){Kx||(F(ft.$$.fragment,t),F($m.$$.fragment,t),Kx=!0)},o(t){z(ft.$$.fragment,t),z($m.$$.fragment,t),Kx=!1},d(t){t&&h(n),t&&h(r),t&&h(i),t&&h(a),t&&h(l),t&&h(c),t&&h(d),t&&h(p),t&&h(v),t&&h(w),t&&h(y),t&&h(x),t&&h(b),t&&h($),t&&h(_),t&&h(M),t&&h(T),t&&h(k),t&&h(R),t&&h(P),t&&h(L),t&&h(J),t&&h(Z),t&&h(ct),H(ft,t),t&&h(mt),t&&h(dt),t&&h(xt),t&&h(bt),t&&h($t),t&&h(_t),t&&h(Nt),t&&h(It),t&&h(Xt),t&&Vt.d(),t&&h(Bt),t&&h(Qt),t&&h(Jt),t&&h(ne),t&&h(re),t&&h(ie),t&&h(ae),t&&h(be),t&&h($e),t&&h(Le),t&&h(Ue),t&&h(He),t&&h(Oe),t&&h(Qe),t&&h(Je),t&&h(nn),t&&h(rn),t&&h(an),t&&h(on),t&&h(sn),t&&h(hn),t&&h(ln),t&&h(un),t&&h(En),t&&h(kn),t&&h(Rn),t&&h(An),t&&h(On),t&&h(Gn),t&&h(Kn),t&&h(Wn),t&&h(nr),t&&h(rr),t&&h(lr),t&&h(ur),t&&h(cr),t&&h(fr),t&&h(jr),t&&h(Nr),t&&h(Fr),t&&zr.d(),t&&h(qr),t&&h(Wr),t&&Yr.d(),t&&h(Qr),t&&h(ni),t&&h(ri),t&&h(Ti),t&&h(Ei),t&&h(Vi),t&&h(Bi),t&&h(ea),t&&h(ra),t&&h(ia),t&&h(aa),t&&h(la),t&&h(ua),t&&h(ca),t&&h(fa),t&&h(xa),t&&h($a),t&&h(so),t&&h(ho),t&&h(lo),t&&h(uo),t&&h(us),t&&h(cs),t&&h(vs),t&&h(ws),t&&h(ys),t&&h(xs),t&&h(Rs),t&&h(As),t&&h(Ls),t&&h(Us),t&&h(Ys),t&&h(Qs),t&&h(hh),t&&h(lh),t&&h(kh),t&&h(Rh),t&&h(zh),t&&h(qh),t&&h(Dh),t&&h(Hh),t&&h(sl),t&&h(hl),t&&h(_l),t&&h(Ml),t&&h(Jl),t&&h(Zl),t&&h(lu),t&&h(uu),t&&h(wu),t&&h(yu),t&&h(xu),t&&h(bu),t&&h(Bu),t&&h(Pu),t&&h(oc),t&&h(sc),t&&h(mc),t&&h(dc),t&&h(pc),t&&h(gc),t&&h(Sc),t&&h(Cc),t&&h(qc),t&&h(Dc),t&&h(Jc),t&&h(Zc),t&&h(hf),t&&h(lf),t&&h(mf),t&&h(df),t&&h(bf),t&&h($f),t&&h(um),t&&h(cm),t&&h(ym),t&&h(xm),t&&h(bm),H($m,t),t&&h(_m),t&&h(Mm),t&&h(Tm),t&&h(Em),t&&h(Km),t&&h(Wm),t&&h(id),t&&h(ad),t&&h($d),t&&h(_d),t&&h(Ud),t&&h(Fd),t&&h(Hd),t&&h(Od),t&&h(tp),t&&h(ep),t&&h(Tp),t&&h(Ep),t&&h(jp),t&&Np.d(),t&&h(Ip),t&&h(Xp),t&&Vp.d(),t&&h(Bp),t&&h(Jp),t&&h(Zp),t&&h(rg),t&&ig.d(),t&&h(ag),t&&h(og),t&&h(sg),t&&h(mg),t&&h(dg),t&&h($g),t&&_g.d(),t&&h(Mg),t&&h(Pg),t&&h(Lg),t&&h(Hg),t&&h(Og),t&&h(ov),t&&h(sv),t&&h(yv),t&&h(xv),t&&h(bv),t&&h($v),t&&h(Ev),t&&kv.d(),t&&h(Rv),t&&h(jv),t&&Nv.d(),t&&h(Iv),t&&h(Xv),t&&Vv.d(),t&&h(Bv),t&&h(Pv),t&&Lv.d(),t&&h(Uv),t&&h(Kv),t&&Wv.d(),t&&h(Yv),t&&h(Qv),t&&Jv.d(),t&&h(Zv),t&&h(tw),t&&ew.d(),t&&h(nw),t&&h(fw),t&&h(mw),t&&h(dw),t&&h(pw),t&&h(yw),t&&h(xw),t&&h(Sw),t&&h(Cw),t&&h(Xw),t&&h(Vw),t&&h(Bw),t&&h(Pw),t&&h(Lw),t&&h(Uw),t&&h(Fw),t&&h(zw),t&&h(qw),t&&h(Dw),t&&h(gy),t&&h(vy),t&&h(wy),t&&h(yy),t&&h(_y),t&&h(My),t&&h(Ty),t&&h(Ey),t&&h(ky),t&&h(Ry),t&&h(Dy),t&&h(Hy),t&&h(px),t&&h(gx),t&&h(Ex),t&&h(kx),t&&h(Rx),t&&h(Ax)}}}class _a extends K{constructor(t){super(),G(this,t,null,$a,a,{})}}function Ma(e){let n,r;return n=new _a({}),{c(){q(n.$$.fragment)},m(t,e){D(n,t,e),r=!0},p:t,i(t){r||(F(n.$$.fragment,t),r=!0)},o(t){z(n.$$.fragment,t),r=!1},d(t){H(n,t)}}}var Ta;return new class extends K{constructor(t){super(),G(this,t,null,Ma,a,{})}}({target:(Ta=location.hostname.endsWith("ghost.io")?"main > article > section":"main",document.querySelector(Ta)),props:{}})}();
//# sourceMappingURL=bundle.js.map
