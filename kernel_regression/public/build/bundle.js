var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function c(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function m(){return f("")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:g(t,e,n)}function b(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function w(t,e){t.value=null==e?"":e}function y(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let _,M;function T(){if(void 0===_){_=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){_=!0}}return _}function E(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=u("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=T();let i;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=p(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=p(n.contentWindow,"resize",e)}),a(t,n),()=>{(r||i&&n.contentWindow)&&i(),h(n)}}function L(t){M=t}function k(t){(function(){if(!M)throw new Error("Function called outside component initialization");return M})().$$.on_mount.push(t)}const H=[],R=[],A=[],S=[],C=Promise.resolve();let $=!1;function P(t){A.push(t)}let j=!1;const I=new Set;function F(){if(!j){j=!0;do{for(let t=0;t<H.length;t+=1){const e=H[t];L(e),N(e.$$)}for(L(null),H.length=0;R.length;)R.pop()();for(let t=0;t<A.length;t+=1){const e=A[t];I.has(e)||(I.add(e),e())}A.length=0}while(H.length);for(;S.length;)S.pop()();$=!1,j=!1,I.clear()}}function N(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(P)}}const U=new Set;function X(t,e){t&&t.i&&(U.delete(t),t.i(e))}function q(t,e,n,r){if(t&&t.o){if(U.has(t))return;U.add(t),undefined.c.push((()=>{U.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function D(t){t&&t.c()}function z(t,n,o,a){const{fragment:s,on_mount:h,on_destroy:l,after_update:u}=t.$$;s&&s.m(n,o),a||P((()=>{const n=h.map(e).filter(i);l?l.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(P)}function O(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function V(t,e){-1===t.$$.dirty[0]&&(H.push(t),$||($=!0,C.then(F)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function K(e,i,o,a,s,l,u,c=[-1]){const f=M;L(e);const d=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:i.context||[]),callbacks:n(),dirty:c,skip_bound:!1,root:i.target||f.$$.root};u&&u(d.root);let m=!1;if(d.ctx=o?o(e,i.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return d.ctx&&s(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),m&&V(e,t)),n})):[],d.update(),m=!0,r(d.before_update),d.fragment=!!a&&a(d.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);d.fragment&&d.fragment.l(t),t.forEach(h)}else d.fragment&&d.fragment.c();i.intro&&X(e.$$.fragment),z(e,i.target,i.anchor,i.customElement),F()}L(f)}class B{$destroy(){O(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function G(e){let n,r,i,o,l,c,m,p,b,x,w,y,_,M,T,E,L,k,H,R,A,S,C,$,P,j,I,F,N,U,X,q,D,z,O,V,K,B,G,W,Y,Q,J,Z,tt,et,nt,rt,it,ot,at,st,ht,lt,ut,ct,ft,dt,mt,pt,gt,vt,bt,xt,wt,yt,_t,Mt,Tt,Et,Lt,kt,Ht,Rt,At,St,Ct,$t,Pt,jt,It,Ft,Nt,Ut,Xt,qt,Dt,zt,Ot,Vt,Kt,Bt,Gt,Wt,Yt,Qt,Jt,Zt,te,ee,ne,re,ie,oe,ae,se,he,le,ue,ce,fe,de,me,pe,ge,ve,be,xe,we,ye,_e,Me,Te,Ee,Le,ke,He,Re,Ae,Se,Ce,$e,Pe,je,Ie,Fe,Ne,Ue,Xe,qe,De,ze,Oe,Ve,Ke,Be,Ge,We,Ye,Qe,Je,Ze,tn,en,nn,rn,on,an,sn,hn,ln,un,cn,fn,dn,mn,pn,gn,vn,bn,xn,wn,yn,_n,Mn,Tn,En,Ln,kn,Hn,Rn,An,Sn,Cn,$n,Pn,jn,In,Fn,Nn,Un,Xn,qn,Dn,zn,On,Vn,Kn,Bn,Gn,Wn,Yn,Qn,Jn,Zn,tr,er,nr,rr,ir,or,ar,sr,hr,lr,ur,cr,fr,dr,mr,pr,gr,vr,br,xr,wr,yr,_r,Mr,Tr,Er,Lr,kr,Hr,Rr,Ar,Sr,Cr,$r,Pr,jr,Ir,Fr,Nr,Ur,Xr,qr,Dr,zr,Or,Vr,Kr,Br,Gr,Wr,Yr,Qr,Jr,Zr,ti,ei,ni,ri,ii,oi,ai,si,hi,li,ui,ci,fi,di,mi,pi,gi,vi,bi,xi,wi,yi,_i,Mi,Ti,Ei,Li,ki,Hi,Ri,Ai,Si,Ci,$i,Pi,ji,Ii,Fi,Ni,Ui,Xi,qi,Di,zi,Oi,Vi,Ki,Bi,Gi,Wi,Yi,Qi,Ji,Zi,to,eo,no,ro,io,oo,ao,so,ho,lo,uo,co,fo,mo,po,go,vo,bo,xo,wo,yo,_o,Mo,To,Eo,Lo,ko,Ho,Ro,Ao,So,Co,$o,Po,jo,Io,Fo,No,Uo,Xo,qo,Do,zo,Oo,Vo,Ko,Bo,Go,Wo,Yo,Qo,Jo,Zo,ta,ea,na,ra,ia,oa,aa,sa,ha,la,ua,ca,fa,da,ma,pa,ga,va,ba,xa,wa,ya,_a,Ma,Ta,Ea,La,ka,Ha,Ra,Aa,Sa,Ca,$a,Pa,ja,Ia,Fa,Na,Ua,Xa,qa,Da,za,Oa,Va,Ka,Ba,Ga,Wa,Ya,Qa,Ja,Za,ts,es,ns,rs,is,os,as,ss,hs,ls,us,cs,fs,ds,ms,ps,gs,vs,bs,xs,ws,ys,_s,Ms,Ts,Es,Ls,ks,Hs,Rs,As,Ss,Cs,$s,Ps,js,Is,Fs,Ns,Us,Xs,qs,Ds,zs,Os,Vs,Ks,Bs,Gs,Ws,Ys,Qs,Js,Zs,th,eh,nh,rh,ih,oh,ah,sh,hh,lh,uh,ch,fh,dh,mh,ph,gh,vh,bh,xh,wh,yh,_h,Mh,Th,Eh,Lh,kh,Hh,Rh,Ah,Sh,Ch,$h,Ph,jh,Ih,Fh,Nh,Uh,Xh,qh,Dh,zh,Oh,Vh,Kh,Bh,Gh,Wh,Yh,Qh,Jh,Zh,tl,el,nl,rl,il,ol,al,sl,hl,ll,ul,cl,fl,dl,ml,pl,gl,vl,bl,xl,wl,yl,_l,Ml,Tl,El,Ll,kl,Hl,Rl,Al,Sl,Cl,$l,Pl,jl,Il,Fl,Nl,Ul,Xl,ql,Dl,zl,Ol,Vl,Kl,Bl,Gl,Wl,Yl,Ql,Jl,Zl,tu,eu,nu,ru,iu,ou,au,su,hu,lu,uu,cu,fu,du,mu,pu,gu,vu,bu,xu,wu,yu,_u,Mu,Tu,Eu,Lu,ku,Hu,Ru,Au,Su,Cu,$u,Pu,ju,Iu,Fu,Nu,Uu,Xu,qu,Du,zu,Ou,Vu,Ku,Bu,Gu,Wu,Yu,Qu,Ju,Zu,tc,ec,nc,rc,ic,oc,ac,sc,hc,lc,uc,cc,fc,dc,mc,pc,gc,vc,bc,xc,wc,yc,_c,Mc,Tc,Ec,Lc,kc,Hc,Rc,Ac,Sc,Cc,$c,Pc,jc,Ic,Fc,Nc,Uc,Xc,qc,Dc,zc,Oc,Vc,Kc,Bc,Gc,Wc,Yc,Qc,Jc,Zc,tf,ef,nf,rf,of,af,sf,hf,lf,uf,cf,ff,df,mf,pf,gf,vf,bf,xf,wf,yf,_f,Mf,Tf,Ef,Lf,kf,Hf,Rf,Af,Sf,Cf,$f,Pf,jf,If,Ff,Nf,Uf,Xf,qf,Df,zf,Of,Vf,Kf,Bf,Gf,Wf,Yf,Qf,Jf,Zf,td,ed,nd,rd,id,od,ad,sd,hd,ld,ud,cd,fd,dd,md,pd,gd,vd,bd,xd,wd,yd,_d,Md,Td,Ed,Ld,kd,Hd,Rd,Ad,Sd,Cd,$d,Pd,jd,Id,Fd,Nd,Ud,Xd,qd,Dd,zd,Od,Vd,Kd,Bd,Gd,Wd,Yd,Qd,Jd,Zd,tm,em,nm,rm,im,om,am,sm,hm,lm,um,cm,fm,dm,mm,pm,gm,vm,bm,xm,wm,ym,_m,Mm,Tm,Em,Lm,km,Hm,Rm,Am,Sm,Cm,$m,Pm,jm,Im;return{c(){n=u("h1"),n.textContent="An illustration of Kernel Regression",r=d(),i=u("p"),o=u("d-math"),l=d(),c=u("p"),m=f("In the interactive figure, data points \n"),p=u("d-math"),b=f(" are shown as black dots.  There is one Gaussian centered at each \n"),x=u("d-math"),w=f(".  The blue curve is a linear combination \n"),y=u("d-math"),_=f(" of these Gaussians.  Each slider controls one of the \n"),M=u("d-math"),T=f("."),E=d(),L=u("p"),k=f("You can adjust the sliders to make the blue curve perfectly fit the \n"),H=u("d-math"),R=f(".  It may be surprising to note that a unique, perfect-fitting \n"),A=u("d-math"),S=f(" exists for any set of \n"),C=u("d-math"),$=f(" and for any number of points."),P=d(),j=u("p"),I=f("To see why, note that each gray curve's set of values along the \n"),F=u("d-math"),N=f(" produces a vector.  (You can toggle the 'points' checkbox to see these.  Denoting the j'th curve as \n"),U=u("d-math"),X=f(", the set of values it produces is \n"),q=u("d-math"),D=f(".  Particularly for a collection of Gaussians all with the same \n"),z=u("d-math"),O=f(", the set of these \n"),V=u("d-math"),K=f(" vectors are linearly independent.  This is not at all obvious, but please accept it for now.  Then, by the linear algebra expansion theorem, they span \n"),B=u("d-math"),G=f(" and so can form any set of \n"),W=u("d-math"),Y=f("."),Q=d(),J=u("p"),J.textContent="Explicitly:",Z=d(),tt=u("d-math"),et=d(),nt=u("p"),rt=f("The \n"),it=u("d-math"),ot=f(" that fits the data perfectly is found by inverting \n"),at=u("d-math"),st=f(", which is possible because \n"),ht=u("d-math"),lt=f(" is full-rank.  That is, its rows are linearly independent, due to the property of a collections of Gaussians of the same \n"),ut=u("d-math"),ct=f(".  Even though we are taking linear combinations of functions, it is only the tuple of function values \n"),ft=u("d-math"),dt=f(" which affects the choice of \n"),mt=u("d-math"),pt=f("."),gt=d(),vt=u("h2"),vt.textContent="Some Observations",bt=d(),xt=u("p"),wt=u("strong"),yt=f("This method can fit any set of data in \n"),_t=u("d-math"),Mt=f("."),Tt=f("  Given a "),Et=u("em"),Et.textContent="particular",Lt=f(" set \n"),kt=u("d-math"),Ht=f(", you could hand-pick a set of functions \n"),Rt=u("d-math"),At=f(" which happen to produce linearly independent vectors \n"),St=u("d-math"),Ct=f(" of evaluation on that particular data set.  However, the procedure shown above can fit any data set \n"),$t=u("d-math"),Pt=f(".  This is useful because it would be laborious to have to hand-pick functions for each new data set."),jt=d(),It=u("p"),Ft=u("strong"),Nt=f("There is nothing (yet) special about the Gaussians being centered at the \n"),Ut=u("d-math"),Xt=f(".  It turns out that "),qt=u("em"),qt.textContent="any",Dt=f(" choice of \n"),zt=u("d-math"),Ot=f(" Gaussians will span \n"),Vt=u("d-math"),Kt=f(" when evaluated at any \n"),Bt=u("d-math"),Gt=f(" values.  There "),Wt=u("em"),Wt.textContent="is",Yt=f(" indeed something special about the Gaussians being centered at the \n"),Qt=u("d-math"),Jt=f(", but it has nothing to do with the ability to fit arbitrary data."),Zt=d(),te=u("p"),ee=u("strong"),ee.textContent="Many functions have this infinite capacity",ne=f(".  Not just Gaussians, but many other families of functions have this capacity to perfectly fit any data, due to the vectors of evaluation being linearly independent.  Not only that, but families of functions can be found for many different domains, not just \n"),re=u("d-math"),ie=f(" as shown above.   Both discrete and continuous domains, and of arbitrary dimensions."),oe=d(),ae=u("p"),ae.innerHTML="<strong>Linear independence is preserved under permutation of components</strong>.  The Gaussians are able to fit any data because they produce vectors that are linearly independent.  But, note that vectors that are linearly independent would still be so, after you permute their elements all in the same way.  For vectors, there is no meaning to the ordering of the elements.  To illustrate, click the &#39;scramble&#39; button.  This reorders the x-axis in one-to-one fashion by reversing the order of every other interval of some fixed size.  Or think of it as re-ordering the components of the Gaussian &quot;vectors&quot; all in the same way, preserving their linear independence.  You can still click &#39;solve&#39; and a unique solution exists.",se=d(),he=u("p"),le=f("Of course, these permuted Gaussians don't have the same relationship with the original data, so there will be a different \n"),ue=u("d-math"),ce=f(" solution.  This is only to show that the continuity or shape of the original Gaussians is not what gives them this capacity to fit arbitrary data."),fe=d(),de=u("h2"),de.textContent="The three design choices underlying all Kernel methods",me=d(),pe=u("p"),pe.textContent='Underlying all Kernel methods are three choices for how to construct the function to fit a given data set.  Like all machine learning methods, these chocies are guided by classic requirements.  First, the approach must be a "universal approximator", thus be able to fit any data set.  Second, it should be possible to regularize.  Finally, it should be computationally tractable.  The three design choices serve these requirements as you will see.',ge=d(),ve=u("p"),be=f("The "),xe=u("strong"),xe.textContent="first design choice",we=f(" is, we specify a family of functions \n"),ye=u("d-math"),_e=f(", such that there is exactly one member of the family, \n"),Me=u("d-math"),Te=f(", corresponding to each element \n"),Ee=u("d-math"),Le=f(".  We then use the subset of this family corresponding to our \n"),ke=u("d-math"),He=f(" to build a solution function as a linear combination of them.  The fact that the functions are already indexed makes the approach automatic.  There is no hand-specifying a set of functions tailor made for each new data set.  This choice also serves the purpose of regularization, to be proved later."),Re=d(),Ae=u("p"),Se=f("The "),Ce=u("strong"),Ce.textContent="second choice",$e=f(" is that the family of functions should have the following property:  For any value of \n"),Pe=u("d-math"),je=f(", and for any \n"),Ie=u("d-math"),Fe=f(" functions from the family, and for any choice of \n"),Ne=u("d-math"),Ue=f(" evaluation points in \n"),Xe=u("d-math"),qe=f(", the set of \n"),De=u("d-math"),ze=d(),Oe=u("em"),Oe.textContent="vectors of evaluation",Ve=f(' of the chosen functions should be linearly independent.  A "vector of evaluation" is my term for the vector of function values in some order of data set points.  For example, \n'),Ke=u("d-math"),Be=f(" is function \n"),Ge=u("d-math"),We=f("'s vector of evaluation.  This choice allows the approach to fit any data set, as argued above by appealing to the linear algebra expansion theorem.  This makes the approach a \"universal approximator\".  As an aside, there are choices of families that don't have this property, but since we are speaking generally about the approach of Kernel methods, it is important that some families do exhibit this property."),Ye=d(),Qe=u("p"),Je=f("The "),Ze=u("strong"),Ze.textContent="third choice",tn=f(" is the biggest leap.  It is that the functions in the family have the following form:"),en=u("br"),nn=u("d-math"),rn=f('.  That is, each function is identified by a distinct "parameter vector" \n'),on=u("d-math"),an=f(", and the function is defined as the dot product between its parameter vector and some as-yet undefined vector-valued function of the input.  As I will show soon, this third provides a way to regularize the method, and makes finding the solution function readily computable.  It also maintains the first goal of having arbitrary capacity to fit any data."),sn=d(),hn=u("p"),ln=f("To motivate these ideas and make the discussion more concrete, I will show that the gaussian family of functions, all with the same \n"),un=u("d-math"),cn=f(" and indexed over \n"),fn=u("d-math"),dn=f(", fit these three design requirements."),mn=d(),pn=u("h2"),gn=f("The set of gaussians sharing the same "),vn=u("d-math"),bn=d(),xn=u("p"),wn=f("The values of the gaussian distribution turn out to be a dot product between two infinite dimensional vectors.  The first vector is a function of \n"),yn=u("d-math"),_n=f(", and the second, the same function of \n"),Mn=u("d-math"),Tn=f(".  To show this, we first show how the simpler formula \n"),En=u("d-math"),Ln=f(" can be written as a dot product.  Then, using this first result, we show that \n"),kn=u("d-math"),Hn=f(" can also be written as a dot product.  The gaussian is just a scaled version with a special choice for \n"),Rn=u("d-math"),An=f("."),Sn=d(),Cn=u("d-math"),$n=d(),Pn=u("p"),jn=f("We've shown that \n"),In=u("d-math"),Fn=f(" can be written as a dot product between the vector valued function of \n"),Nn=u("d-math"),Un=f(" and the same function of \n"),Xn=u("d-math"),qn=f(".  Now:"),Dn=d(),zn=u("d-math"),On=d(),Vn=u("p"),Kn=f("Letting \n"),Bn=u("d-math"),Gn=f(", we have \n"),Wn=u("d-math"),Yn=f(" and all that remains is to scale both vectors by \n"),Qn=u("d-math"),Jn=d(),Zn=u("p"),tr=f("In particular, this emphasizes the symmetric roles of \n"),er=u("d-math"),nr=f(" and \n"),rr=u("d-math"),ir=f(" in a gaussian:  evaluating a gaussian centered at \n"),or=u("d-math"),ar=f(" at \n"),sr=u("d-math"),hr=f(" is the same as one centered at \n"),lr=u("d-math"),ur=f(" evaluated at \n"),cr=u("d-math"),fr=f(".  So, each member of the family of gaussians corresponds to some \n"),dr=u("d-math"),mr=f(".  This doesn't prove that gaussians have an arbitrary ability to produce linearly independent vectors of evaluation, but for the moment, just accept it."),pr=d(),gr=u("p"),vr=f("Another thing that is apparent from this is that the height at the peak of every gaussian, the location where \n"),br=u("d-math"),xr=f(", is the value of \n"),wr=u("d-math"),yr=f(".  Since all the heights are the same, this means all the feature vectors are the same length.  The value of the gaussian as you move away from the peak approaches zero.  This represents the angle between two vectors \n"),_r=u("d-math"),Mr=f(" and \n"),Tr=u("d-math"),Er=f(" approaching \n"),Lr=u("d-math"),kr=f(".  And, since the gaussian is positive everywhere, the angle ranges in \n"),Hr=u("d-math"),Rr=f(" in the infinite dimensional feature space."),Ar=d(),Sr=u("p"),Cr=f("Note also that, although \n"),$r=u("d-math"),Pr=f(' is also called a "parameter" of the gaussian, \n'),jr=u("d-math"),Ir=f("'s role here is a constant baked into the \n"),Fr=u("d-math"),Nr=f(" function induced by the gaussian, while \n"),Ur=u("d-math"),Xr=f(" is an "),qr=u("em"),qr.textContent="argument",Dr=f(" to the function, and treated in a symmetric role with the \n"),zr=u("d-math"),Or=f("."),Vr=d(),Kr=u("h2"),Kr.textContent="Things to do in the plot to build intuition",Br=d(),Gr=u("ol"),Gr.innerHTML="<li><p>Illustrate in the Kernel figure how a selection of data induces a matrix</p></li> \n<li><p>Describe tasks to try on the interactive chart:\nA.  Function Norm</p> \n<ul><li>Shrink sigma until the gray curves are well separated, so that at each\ncurve&#39;s peak, all the other curves are near zero</li> \n<li>Reset the alphas to 1.0</li> \n<li>Notice that the function norm for that function is just sqrt(num points)\nB.  Exploding Norm</li> \n<li>Start with a data set that has a reasonable norm solution</li> \n<li>In auto-solve mode, drag one of the data points circularly around another\npoint</li> \n<li>Notice that the function norm explodes as the second point passes over\nthe first</li> \n<li>Adjust the sigma to be small, and notice that, with smaller sigma, the\nnorm doesn&#39;t explode as fast\nC.</li></ul></li>",Wr=d(),Yr=u("h2"),Yr.textContent="Consequences of the choice of a Kernel",Qr=d(),Jr=u("p"),Jr.innerHTML="There are a few exercises you can do in the interactive chart that are illuminating.  Try dragging one of the black dots while <em>auto solve</em> is checked.  You will notice that if you drag the dot near another dot, the blue curve is forced to become almost vertical, and the function norm explodes.  In kernel terms, what is happening is that two data points that are extremely close according to the kernel, are in fact distant in terms of their y-values.  The kernel&#39;s idea of distance is mismatched with that of the data labels.",Zr=d(),ti=u("p"),ti.textContent='Leaving one pair of black dots close to each other on the X-axis, you can reduce the function norm by reducing the Sigma slider.  This changes the kernel so that it considers those two data points far apart.  This allows a smaller norm function to fit the data.  In the limit of small sigma, the kernel considers every pair of points to be maximally far away (orthogonal in feature space).  Thus, the contributions of each individual curve to the overall function have no influence on each other.  But, the function also doesn\'t interpolate at all.  In other words, if you consider a particular pair of points to be "close", you would then expect their y-values to be similar, but the kernel does not, so the resulting solution function will be useless for predicting values of unseen data.',ei=d(),ni=u("p"),ni.textContent="When you hit the 'scramble' button, you can see that the kernel has a definition of distance that runs counter to the spatial distance of the graph.  A pair of points that are nearly adjacent along the X-axis, but span a jump in the kernel values are considered distant, while a pair of points separated along the X-axis might have nearly the same kernel value.  Consequently, with this \"kernel\" (it is actually not a proper kernel, but it still is capable of perfectly fitting the data), one can set a pair of points such that they are far in X-axis distance, but very close in kernel distance.  In that case, the function norm will be very sensitive to the difference in y-values of the two points.  And, you can adjust a pair of points to be on either side of a discontinuity.  In that case, the two points may have very different y-values and still allow to be fit with a small-norm solution function (blue curve).",ri=d(),ii=u("p"),ii.textContent="All of this is to emphasize that it is the Kernel's notion of distance which determines the interpolation behavior of kernel methods.",oi=d(),ai=u("h2"),ai.textContent="A Natural choice for parameter vectors",si=d(),hi=u("p"),li=f("Below we write the vectors of evaluation of the \n"),ui=u("d-math"),ci=f(" as row vectors.  We would like them to be linearly independent.  Given the definition of the functions as dot products of feature vectors, this expression is simply a product of matrices."),fi=d(),di=u("d-math"),mi=d(),pi=u("p"),gi=f("It is apparent that we need the \n"),vi=u("d-math"),bi=f(" to be linearly independent at least.  Indeed, the arbitrary capacity of this family of functions to fit any data comes directly from the capacity of \n"),xi=u("d-math"),wi=f(" to generate linearly independent vectors for any set of \n"),yi=u("d-math"),_i=f(", however large.  To achieve this, \n"),Mi=u("d-math"),Ti=f(" must be infinite-dimensional.  If, for example, \n"),Ei=u("d-math"),Li=f(" were 10-dimensional, the resulting family would only have the capacity to perfectly fit up to 10 data points."),ki=d(),Hi=u("p"),Ri=f("Besides this property of \n"),Ai=u("d-math"),Si=f(", we need to choose the \n"),Ci=u("d-math"),$i=f(" such that their projection onto \n"),Pi=u("d-math"),ji=f(" is also linearly independent.  Explicitly:"),Ii=d(),Fi=u("d-math"),Ni=d(),Ui=u("p"),Xi=f("Explicitly, the above is decomposing each \n"),qi=u("d-math"),Di=f(", relative to \n"),zi=u("d-math"),Oi=f(".   In order for the vectors of evaluation to be linearly independent and thus achieve the goal of arbitrary fitting capacity, the \n"),Vi=u("d-math"),Ki=f(" must be chosen such that \n"),Bi=u("d-math"),Gi=f(".  Furthermore, for any function in the space, any values of \n"),Wi=u("d-math"),Yi=f(" has zero contribution to the vectors of evaluation.  Although it will have a non-zero contribution to values elsewhere, since we have no labeled data, we have no criterion for preferring one choice over another."),Qi=d(),Ji=u("p"),Zi=f("Finally, we want to find some linear combination \n"),to=u("d-math"),eo=f(" of the vectors of evaluation \n"),no=u("d-math"),ro=f(" that equals the target values \n"),io=u("d-math"),oo=f(".  If \n"),ao=u("d-math"),so=f(" is full rank, must exist for any \n"),ho=u("d-math"),lo=f(".  Notice that, because the functions \n"),uo=u("d-math"),co=f(" are defined as dot products of feature vectors, a linear combination of functions is equivalent to the function whose parameter vector is the "),fo=u("em"),fo.textContent="same",mo=f(" linear combination of the combining functions' feature vectors:"),po=d(),go=u("d-math"),vo=d(),bo=u("p"),xo=f("So, the parameter vector associated with the solution function \n"),wo=u("d-math"),yo=f(" is of the form \n"),_o=u("d-math"),Mo=f(".  The vector of evaluation of \n"),To=u("d-math"),Eo=f(" on each \n"),Lo=u("d-math"),ko=f(" is simply \n"),Ho=u("d-math"),Ro=f("."),Ao=d(),So=u("p"),Co=f("But notice that because we are restricted to choose \n"),$o=u("d-math"),Po=f(" to satisfy \n"),jo=u("d-math"),Io=f(", \n"),Fo=u("d-math"),No=f(" can be written as \n"),Uo=u("d-math"),Xo=f(" for some \n"),qo=u("d-math"),Do=f(" transformation matrix \n"),zo=u("d-math"),Oo=f(".  But, that means we could express the evaluation as:"),Vo=d(),Ko=u("d-math"),Bo=d(),Go=u("p"),Wo=f("Any solution \n"),Yo=u("d-math"),Qo=f(" one finds using \n"),Jo=u("d-math"),Zo=f(" as a set of parameter vectors, is equivalent to the solution \n"),ta=u("d-math"),ea=f(" found using \n"),na=u("d-math"),ra=f(" as the set of parameter vectors.  In fact, any permutation of the rows of \n"),ia=u("d-math"),oa=f(" would also produce an equivalent solution."),aa=d(),sa=u("p"),ha=f("Kernel methods then choose \n"),la=u("d-math"),ua=f(" as the set of parameter vectors, thus choosing to set the perpendicular component of all parameter vectors to zero.  It is still not justified why it is actually "),ca=u("em"),ca.textContent="preferable",fa=f(" to have \n"),da=u("d-math"),ma=f(" itself be in the span.  But, setting \n"),pa=u("d-math"),ga=f(' turns out to find the minimum norm parameter vector for any given set of target values.  It turns out that certain "smoothness" properties of the function are related to the norm of its parameter vector.'),va=d(),ba=u("h2"),ba.textContent="Function Norm as a regularizer",xa=d(),wa=u("p"),ya=f('In Kernel parlance, the term "function norm" just means "norm of the function\'s associated parameter vector".  Our solution function \n'),_a=u("d-math"),Ma=f(" has associated parameter vector \n"),Ta=u("d-math"),Ea=f(".  Consider two arbitrary inputs \n"),La=u("d-math"),ka=f(".  How do the values \n"),Ha=u("d-math"),Ra=f(" and absolute difference in values \n"),Aa=u("d-math"),Sa=f(" relate to the norm of its parameter vector?"),Ca=d(),$a=u("d-math"),Pa=d(),ja=u("p"),Ia=f("The first inequality tells us that the magnitude of values of the function \n"),Fa=u("d-math"),Na=f(" is bounded by a fixed multiple of \n"),Ua=u("d-math"),Xa=f(".  The multiple itself, \n"),qa=u("d-math"),Da=f(" we have no control over - it is determined by the choice of \n"),za=u("d-math"),Oa=f(".  But by controlling \n"),Va=u("d-math"),Ka=f(" we can control the range of values of \n"),Ba=u("d-math"),Ga=f("."),Wa=d(),Ya=u("p"),Qa=f("The second inequality tells us that the absolute difference in value between any two points is proportional to \n"),Ja=u("d-math"),Za=f(".  As the distance shrinks, the values will be equal.  By bounding \n"),ts=u("d-math"),es=f(", we can control how sensitive the function could be to distance between input feature vectors."),ns=d(),rs=u("p"),is=f("It also says something about the choice of \n"),os=u("d-math"),as=f(".  Ideally, we would like to choose a \n"),ss=u("d-math"),hs=f(" such that \n"),ls=u("d-math"),us=f(" is roughy proportional to \n"),cs=u("d-math"),fs=f(" in the data set for all pairs \n"),ds=u("d-math"),ms=f("."),ps=d(),gs=u("p"),vs=f("It is not yet explained visually how the distance \n"),bs=u("d-math"),xs=f(" relates to the curves on the plot.  But recall that each gray curve shows one of the \n"),ws=u("d-math"),ys=f(" functions, defined as:"),_s=d(),Ms=u("d-math"),Ts=d(),Es=u("p"),Ls=f("It has not been shown yet, (see below section) but the gaussian curves are indeed of this form.  Each gaussian centered at \n"),ks=u("d-math"),Hs=f(" has parameter vector \n"),Rs=u("d-math"),As=f(" and in fact, the \n"),Ss=u("d-math"),Cs=f(" function dictated by the gaussian has the same norm for all inputs \n"),$s=u("d-math"),Ps=f(".  Therefore, each gaussian attains its peak when \n"),js=u("d-math"),Is=f(", because then the two feature vectors are facing in the same direction."),Fs=d(),Ns=u("p"),Ns.textContent="The distance in feature space thus is given indirectly by the height of the gaussian:",Us=d(),Xs=u("d-math"),qs=d(),Ds=u("p"),zs=f("Here, the interactive plot is useful to build intuition.  Selecting 'auto-solve', drag one of the data points, let's call it \n"),Os=u("d-math"),Vs=f(", in a path from one side to the other side of another data point, say \n"),Ks=u("d-math"),Bs=f(", passing over it by some non-negligible distance \n"),Gs=u("d-math"),Ws=f(".  Because 'auto-solve' is checked, the system is updating \n"),Ys=u("d-math"),Qs=f(" so that \n"),Js=u("d-math"),Zs=f(".  But, as \n"),th=u("d-math"),eh=f(" approaches \n"),nh=u("d-math"),rh=f(", \n"),ih=u("d-math"),oh=f(" shrinks to zero, so \n"),ah=u("d-math"),sh=f(" must be magnified to infinity to maintain the spread.  It is a case in which the distance as defined by \n"),hh=u("d-math"),lh=f(" is a gross underestimate of the difference in labels."),uh=d(),ch=u("h2"),ch.textContent="Finally, enter the Kernel",fh=d(),dh=u("p"),mh=f("Recall from the previous section that using \n"),ph=u("d-math"),gh=f(" as the set of parameter vectors ensures 1) the method has arbitrary fitting capacity and 2) the solution will be the lowest norm solution possible.  So we have the following:"),vh=d(),bh=u("d-math"),xh=d(),wh=u("p"),yh=f("To find \n"),_h=u("d-math"),Mh=f(", solve:"),Th=d(),Eh=u("d-math"),Lh=d(),kh=u("p"),kh.textContent="This will minimize to zero if the assumptions above hold.  To compromise between a perfectly fitting function and its smoothness, instead solve:",Hh=d(),Rh=u("d-math"),Ah=d(),Sh=u("p"),Sh.textContent="Finally, to evaluate the function on new data:",Ch=d(),$h=u("d-math"),Ph=d(),jh=u("p"),Ih=f("So we see that the only quantities dependent on the \n"),Fh=u("d-math"),Nh=f(" data are dot products \n"),Uh=u("d-math"),Xh=f(", appearing in the \n"),qh=u("d-math"),Dh=f(' terms or the solution function.  Finally, we define a function called the "kernel" as:'),zh=d(),Oh=u("d-math"),Vh=d(),Kh=u("p"),Kh.textContent="Then, the general optimization formula simplifies to:",Bh=d(),Gh=u("d-math"),Wh=d(),Yh=u("p"),Yh.textContent="and evaluating the solution function is now written as:",Qh=d(),Jh=u("d-math"),Zh=d(),tl=u("h2"),tl.textContent="Geometric Considerations of choice of Kernel",el=d(),nl=u("p"),rl=f("To apply a Kernel method to data \n"),il=u("d-math"),ol=f(" is to adopt the assumption that there is a metric defined on the input domain \n"),al=u("d-math"),sl=f(".  "),hl=u("em"),hl.textContent="Metric",ll=f(" means a definition of distances and angles between any two points in \n"),ul=u("d-math"),cl=f(".  This idea in itself is remarkable.  Although we are used to thinking of the vectors in \n"),fl=u("d-math"),dl=f(" as having lengths, and pairs of vectors having an angle between them, this idea is even more general.  It does not require \n"),ml=u("d-math"),pl=f(" to have any particular structure at all."),gl=u("br"),vl=u("d-math"),bl=f(" may be continuous or discrete, or mixed.  And it can have any natural ordering of its elements, or none.  And, even if \n"),xl=u("d-math"),wl=f(" is naturally ordered, such as \n"),yl=u("d-math"),_l=f(", the metric need not be consistent with that ordering at all."),Ml=d(),Tl=u("p"),El=f('Indeed, the very notion of "ordering" itself is a weak concept once you go past one dimension.  Ordering of elements in \n'),Ll=u("d-math"),kl=f(" is simply a result of a notion of the length of each element.  Although, the angle is always either zero or \n"),Hl=u("d-math"),Rl=f("."),Al=d(),Sl=u("p"),Cl=f('But, this is worth meditating on, because it is precisely this notion which is the foundation of kernel methods.  A Kernel merely quantifies this intuitive notion.  Most discussions about Kernels say they are a measure of "similarity" between two points.  However, I don\'t like that word since it has no standing in geometry.  It is possible, for instance for \n'),$l=u("d-math"),Pl=f(" for some \n"),jl=u("d-math"),Il=f(" and \n"),Fl=u("d-math"),Nl=f(".  If we called \n"),Ul=u("d-math"),Xl=f(' a "similarity measure", then \n'),ql=u("d-math"),Dl=f(" would be more similar to \n"),zl=u("d-math"),Ol=f(" than to itself."),Vl=d(),Kl=u("p"),Bl=f("Rather, a kernel defines the "),Gl=u("em"),Gl.textContent="inner product",Wl=f(" on a set \n"),Yl=u("d-math"),Ql=f(", and the notions of length and angle follow indirectly from that:"),Jl=d(),Zl=u("d-math"),tu=d(),eu=u("h1"),eu.textContent="Geometric Justification for the inner product as a concept",nu=d(),ru=u("p"),ru.textContent="This is due to MathTheBeautiful Youtube Channel.",iu=d(),ou=u("p"),ou.textContent="The geometric justification for the inner product proceeds in five steps:",au=d(),su=u("ul"),hu=u("li"),lu=f("Given abstract vectors "),uu=u("d-math"),cu=f(" and "),fu=u("d-math"),du=f(", write the Pythagorean formula for "),mu=u("d-math"),pu=d(),gu=u("li"),gu.textContent="Expand the terms to the same form",vu=d(),bu=u("li"),bu.textContent="define the expression for the inner product",xu=d(),wu=u("li"),wu.textContent="Notice that it is symmetric and bilinear, by definition",yu=d(),_u=u("li"),_u.textContent="Use these to rewrite and simplify the formula",Mu=d(),Tu=u("p"),Eu=f("Without a visualization, assume we have abstract vectors \n"),Lu=u("d-math"),ku=f(" and \n"),Hu=u("d-math"),Ru=f(", and we know their lengths \n"),Au=u("d-math"),Su=f(" and \n"),Cu=u("d-math"),$u=f(" and the angle \n"),Pu=u("d-math"),ju=f(" between them, but nothing else.  We do not have any notion of the vectors as tuples of coordinates, for example.  They are purely geometric concepts.  Then we have:"),Iu=d(),Fu=u("d-math"),Nu=d(),Uu=u("p"),Xu=f("So, by defining \n"),qu=u("d-math"),Du=f(" in terms of the length of \n"),zu=u("d-math"),Ou=f(" and \n"),Vu=u("d-math"),Ku=f(", and the angle between them, we can write the distance between two elements purely in terms of the inner product.  It is completely abstract, not requiring any assumption about internal structure of the elements themselves.  This abstraction of the notion of distance on arbitrary objects is perhaps the key insight of Kernel methods."),Bu=d(),Gu=u("d-math"),Wu=d(),Yu=u("h2"),Yu.textContent="Distinction between Feature Space and Hilbert Space",Qu=d(),Ju=u("p"),Zu=f("Second, an inner product on the space of functions is defined to be \n"),tc=u("d-math"),ec=f("."),nc=d(),rc=u("p"),ic=f("The form of the source functions \n"),oc=u("d-math"),ac=f(' is a dot product between two vectors in a so-called "feature space".  The vector valued function \n'),sc=u("d-math"),hc=f(" is determined at the beginning, and is a fixed function throughout the procedure with no trainable parameters.  Therefore, there is a one-to-one correspondence between the parameters \n"),lc=u("d-math"),uc=f(" in this feature space, and the resulting functions \n"),cc=u("d-math"),fc=f(" in the function space."),dc=d(),mc=u("p"),pc=f("The feature space will be denoted \n"),gc=u("d-math"),vc=f(", equipped with an inner product defined as the dot product.  If we think of \n"),bc=u("d-math"),xc=f(", then each \n"),wc=u("d-math"),yc=f(" defines a feature and indexes a different component of the vectors in \n"),_c=u("d-math"),Mc=f(".  So we write \n"),Tc=u("d-math"),Ec=f("."),Lc=d(),kc=u("p"),Hc=f("A different space, the space of functions \n"),Rc=u("d-math"),Ac=f(" will be denoted \n"),Sc=u("d-math"),Cc=f(", for "),$c=u("em"),$c.textContent="Hilbert",Pc=f(" space.  So, \n"),jc=u("d-math"),Ic=f(".  As mentioned, it is endowed with inner product \n"),Fc=u("d-math"),Nc=f('.  Note that our "solution function" which fits the data will lie in an \n'),Uc=u("d-math"),Xc=f("-dimensional linear subspace of \n"),qc=u("d-math"),Dc=f(" spanned by a set of \n"),zc=u("d-math"),Oc=f(' "basis functions", which we define below.'),Vc=d(),Kc=u("p"),Bc=f("Note that some literature takes \n"),Gc=u("d-math"),Wc=f(" to be "),Yc=u("em"),Yc.textContent="the",Qc=f(" Hilbert space, and implicitly treats the points in that space as functions on the domain \n"),Jc=u("d-math"),Zc=f(" even though they are over the domain of features.  Technically, \n"),tf=u("d-math"),ef=d(),nf=u("em"),nf.textContent="is",rf=f(" a Hilbert space, because it is a vector space endowed with an inner product.  But, it is not the Hilbert space where we search for a function.  But as it turns out, there is a bijection between elements in the linear span of basis functions in \n"),of=u("d-math"),af=f(" with the linear span of basis parameter vectors in \n"),sf=u("d-math"),hf=f(".  So, authors speak as though they are the same.  For example, see Learning with Kernels, Smola and Scholkopf."),lf=d(),uf=u("p"),cf=f("Other authors, especially those focused on the theory of RKHS, speak of the Hilbert space as \n"),ff=u("d-math"),df=f('.  For example, see "A Primer on Reproducing Kernel Hilbert Spaces" by Manton and Amblard.  I prefer to distinguish \n'),mf=u("d-math"),pf=f(" from \n"),gf=u("d-math"),vf=f(" to avoid confusion."),bf=d(),xf=u("h2"),wf=f("A set of spanning functions for general "),yf=u("d-math"),_f=d(),Mf=u("p"),Tf=f("In the plot above, our input domain happened to be \n"),Ef=u("d-math"),Lf=f(".  But for an arbitrary data set with input domain \n"),kf=u("d-math"),Hf=f(", we need a source of arbitrarily many distinct functions - as many as there are elements of \n"),Rf=u("d-math"),Af=f(".  So it is natural then, that each function correspond to some \n"),Sf=u("d-math"),Cf=f(".  We could plot all of the functions' values on \n"),$f=u("d-math"),Pf=f(" in a heatmap \n"),jf=u("d-math"),If=f(".  In the example above, the individual functions \n"),Ff=u("d-math"),Nf=f(" were unit \n"),Uf=u("d-math"),Xf=f(" Gaussians centered at \n"),qf=u("d-math"),Df=f(".  So, the curves above would correspond to rows in this heatmap:"),zf=d(),Of=u("p"),Of.textContent="[Show heatmap]",Vf=d(),Kf=u("p"),Bf=f("Recall the statement earlier that any \n"),Gf=u("d-math"),Wf=f(" Gaussians of the same \n"),Yf=u("d-math"),Qf=f(" produce linearly independent vectors when evaluated at any \n"),Jf=u("d-math"),Zf=f(" points.  From the heatmap, this means that, if you choose any \n"),td=u("d-math"),ed=f(" rows and any \n"),nd=u("d-math"),rd=f(" columns, the matrix produced from the intersections will be full-rank, thus will allow a unique solution for any set of desired target values."),id=d(),od=u("h2"),od.textContent="Part 2 - Examples of linear problems",ad=d(),sd=u("p"),sd.textContent="Kernel methods are used for PCA, CCA, K-means, Regression, separating hyperplanes (SVM).  All of these involve finding an optimal point in a space using linear optimization methods.  If possible, show how the inner product is used in some of these formulas.";hd=d(),ld=u("h2"),ld.textContent="Kernel Ridge Regression",ud=d(),cd=u("h2"),cd.textContent="Kernel Linear Regression",fd=d(),dd=u("h2"),dd.textContent="Kernel PCA",md=d(),pd=u("p"),pd.textContent="Mairal Lecture 9",gd=d(),vd=u("h2"),vd.textContent="Kernel K-means and CCA",bd=d(),xd=u("p"),xd.textContent="Mairal Lecture 10",wd=d(),yd=u("p"),_d=u("d-math"),Md=d(),Td=u("p"),Td.innerHTML='See Gong and Lazebnik:  <a href="https://arxiv.org/pdf/1212.4522.pdf">https://arxiv.org/pdf/1212.4522.pdf</a>',Ed=d(),Ld=u("h2"),Ld.textContent="Large Margin Classifiers",kd=d(),Hd=u("p"),Rd=f("In binary classification, the "),Ad=u("em"),Ad.textContent="margin",Sd=f(" of the function \n"),Cd=u("d-math"),$d=f(" for \n"),Pd=u("d-math"),jd=f(" is \n"),Id=u("d-math"),Fd=f(".  The loss is a decreasing function of the margin: \n"),Nd=u("d-math"),Ud=f("."),Xd=d(),qd=u("table"),Dd=u("thead"),zd=u("tr"),Od=u("th"),Od.textContent="Method",Vd=d(),Kd=u("th"),Bd=u("d-math"),Gd=d(),Wd=u("tbody"),Yd=u("tr"),Qd=u("td"),Qd.textContent="Kernel Logistic Regression",Jd=d(),Zd=u("td"),tm=u("d-math"),em=d(),nm=u("tr"),rm=u("td"),rm.textContent="1-SVM (hinge loss)",im=d(),om=u("td"),am=u("d-math"),sm=d(),hm=u("tr"),lm=u("td"),lm.textContent="2-SVM",um=d(),cm=u("td"),fm=u("d-math"),dm=d(),mm=u("tr"),pm=u("td"),pm.textContent="Boosting",gm=d(),vm=u("td"),bm=u("d-math"),xm=d(),wm=u("p"),wm.textContent="In all these, we solve:",ym=d(),_m=u("d-math"),Mm=d(),Tm=u("p"),Em=f("The idea of support vectors is to make \n"),Lm=u("d-math"),km=f(" sparse, and only non-zero components for samples that are hard to classify (close to the separating hyperplane):"),Hm=d(),Rm=u("p"),Am=u("d-math"),Sm=d(),Cm=u("p"),Cm.textContent="Kernel Logistic Regression is a large-margin classifier.",$m=d(),Pm=u("h2"),Pm.textContent="Neural Tangent Kernel",jm=d(),Im=u("p"),Im.innerHTML='See <a href="https://arxiv.org/abs/1806.07572">https://arxiv.org/abs/1806.07572</a>',g(n,"id","an-illustration-of-kernel-regression"),v(tt,"block",""),g(vt,"id","some-observations"),g(de,"id","the-three-design-choices-underlying-all-kernel-methods"),g(pn,"id","the-set-of-gaussians-sharing-the-same-html-sigma"),v(Cn,"block",""),v(zn,"block",""),g(Kr,"id","things-to-do-in-the-plot-to-build-intuition"),g(Gr,"start","3"),g(Yr,"id","consequences-of-the-choice-of-a-kernel"),g(ai,"id","a-natural-choice-for-parameter-vectors"),v(di,"block",""),v(Fi,"block",""),v(go,"block",""),v(Ko,"block",""),g(ba,"id","function-norm-as-a-regularizer"),v($a,"block",""),v(Ms,"block",""),v(Xs,"block",""),g(ch,"id","finally-enter-the-kernel"),v(bh,"block",""),v(Eh,"block",""),v(Rh,"block",""),v($h,"block",""),v(Oh,"block",""),v(Gh,"block",""),v(Jh,"block",""),g(tl,"id","geometric-considerations-of-choice-of-kernel"),v(Zl,"block",""),g(eu,"id","geometric-justification-for-the-inner-product-as-a-concept"),v(Fu,"block",""),v(Gu,"block",""),g(Yu,"id","distinction-between-feature-space-and-hilbert-space"),g(xf,"id","a-set-of-spanning-functions-for-general-html-mathcalx"),g(od,"id","part-2---examples-of-linear-problems"),g(ld,"id","kernel-ridge-regression"),g(cd,"id","kernel-linear-regression"),g(dd,"id","kernel-pca"),g(vd,"id","kernel-k-means-and-cca"),g(Ld,"id","large-margin-classifiers"),v(_m,"block",""),g(Pm,"id","neural-tangent-kernel")},m(t,e){s(t,n,e),s(t,r,e),s(t,i,e),a(i,o),o.innerHTML="\\small {1 \\over 2}\n",s(t,l,e),s(t,c,e),a(c,m),a(c,p),p.innerHTML="(x_i, y_i)\n",a(c,b),a(c,x),x.innerHTML="x_i\n",a(c,w),a(c,y),y.innerHTML="(\\alpha_1, \\cdots, \\alpha_n)\n",a(c,_),a(c,M),M.innerHTML="\\alpha_i\n",a(c,T),s(t,E,e),s(t,L,e),a(L,k),a(L,H),H.innerHTML="y_i\n",a(L,R),a(L,A),A.innerHTML="\\alpha\n",a(L,S),a(L,C),C.innerHTML="(x_i, y_i)\n",a(L,$),s(t,P,e),s(t,j,e),a(j,I),a(j,F),F.innerHTML="x_i\n",a(j,N),a(j,U),U.innerHTML="k_j(x)\n",a(j,X),a(j,q),q.innerHTML="(k_j(x_1), k_j(x_2), \\cdots, k_j(x_n))\n",a(j,D),a(j,z),z.innerHTML="\\sigma\n",a(j,O),a(j,V),V.innerHTML="n\n",a(j,K),a(j,B),B.innerHTML="\\mathbb{R}^n\n",a(j,G),a(j,W),W.innerHTML="(y_i)\n",a(j,Y),s(t,Q,e),s(t,J,e),s(t,Z,e),s(t,tt,e),tt.innerHTML="\n\\begin{aligned}\nk_j(x) & & \\text{Gaussians centered at $x_j$, $j = 1 .. n$} \\\\\nf(x) & \\equiv \\sum_j { \\alpha_j k_j(x) } & \\text{the blue curve}\\\\\nf(x_i) & = \\sum_j { \\alpha_j k_j(x_i) } = y_i & \\text{fitting the blue curve to the black points} \\\\\n\\bold{\\alpha K} & = \\bold{y} , & \\text{defining $K_{ji} \\equiv k_j(x_i)$, same equations, in matrix form} \\\\\n\\end{aligned}\n",s(t,et,e),s(t,nt,e),a(nt,rt),a(nt,it),it.innerHTML="\\bold{\\alpha}\n",a(nt,ot),a(nt,at),at.innerHTML="\\bold{K}\n",a(nt,st),a(nt,ht),ht.innerHTML="\\bold{K}\n",a(nt,lt),a(nt,ut),ut.innerHTML="\\sigma\n",a(nt,ct),a(nt,ft),ft.innerHTML="(f_j(x_1), \\cdots, f_j(x_n))\n",a(nt,dt),a(nt,mt),mt.innerHTML="\\bold{\\alpha}\n",a(nt,pt),s(t,gt,e),s(t,vt,e),s(t,bt,e),s(t,xt,e),a(xt,wt),a(wt,yt),a(wt,_t),_t.innerHTML="\\mathbb{R} \\times \\mathbb{R}\n",a(wt,Mt),a(xt,Tt),a(xt,Et),a(xt,Lt),a(xt,kt),kt.innerHTML="x_i\n",a(xt,Ht),a(xt,Rt),Rt.innerHTML="k_j(\\cdot)\n",a(xt,At),a(xt,St),St.innerHTML="(k_j(x_i))\n",a(xt,Ct),a(xt,$t),$t.innerHTML="(x_i, y_i)\n",a(xt,Pt),s(t,jt,e),s(t,It,e),a(It,Ft),a(Ft,Nt),a(Ft,Ut),Ut.innerHTML="x_i\n",a(It,Xt),a(It,qt),a(It,Dt),a(It,zt),zt.innerHTML="n\n",a(It,Ot),a(It,Vt),Vt.innerHTML="\\mathbb{R}^n\n",a(It,Kt),a(It,Bt),Bt.innerHTML="n\n",a(It,Gt),a(It,Wt),a(It,Yt),a(It,Qt),Qt.innerHTML="x_i\n",a(It,Jt),s(t,Zt,e),s(t,te,e),a(te,ee),a(te,ne),a(te,re),re.innerHTML="\\mathbb{R}\n",a(te,ie),s(t,oe,e),s(t,ae,e),s(t,se,e),s(t,he,e),a(he,le),a(he,ue),ue.innerHTML="\\bold{\\alpha}\n",a(he,ce),s(t,fe,e),s(t,de,e),s(t,me,e),s(t,pe,e),s(t,ge,e),s(t,ve,e),a(ve,be),a(ve,xe),a(ve,we),a(ve,ye),ye.innerHTML="f_i: \\mathcal{X} \\mapsto \\mathcal{Y}\n",a(ve,_e),a(ve,Me),Me.innerHTML="f_i\n",a(ve,Te),a(ve,Ee),Ee.innerHTML="x_i \\in \\mathcal{X}\n",a(ve,Le),a(ve,ke),ke.innerHTML="x_i\n",a(ve,He),s(t,Re,e),s(t,Ae,e),a(Ae,Se),a(Ae,Ce),a(Ae,$e),a(Ae,Pe),Pe.innerHTML="n\n",a(Ae,je),a(Ae,Ie),Ie.innerHTML="n\n",a(Ae,Fe),a(Ae,Ne),Ne.innerHTML="n\n",a(Ae,Ue),a(Ae,Xe),Xe.innerHTML="\\mathcal{X}\n",a(Ae,qe),a(Ae,De),De.innerHTML="n\n",a(Ae,ze),a(Ae,Oe),a(Ae,Ve),a(Ae,Ke),Ke.innerHTML="(f_i(x_1), f_i(x_2), \\cdots, f_i(x_n))\n",a(Ae,Be),a(Ae,Ge),Ge.innerHTML="f_i(x)\n",a(Ae,We),s(t,Ye,e),s(t,Qe,e),a(Qe,Je),a(Qe,Ze),a(Qe,tn),a(Qe,en),a(Qe,nn),nn.innerHTML="f_i(x) \\equiv \\bold{p}_i \\cdot \\bold{\\phi}(x)\n",a(Qe,rn),a(Qe,on),on.innerHTML="\\bold{p}_i\n",a(Qe,an),s(t,sn,e),s(t,hn,e),a(hn,ln),a(hn,un),un.innerHTML="\\sigma\n",a(hn,cn),a(hn,fn),fn.innerHTML="\\mu\n",a(hn,dn),s(t,mn,e),s(t,pn,e),a(pn,gn),a(pn,vn),vn.innerHTML="\\sigma",s(t,bn,e),s(t,xn,e),a(xn,wn),a(xn,yn),yn.innerHTML="\\mu\n",a(xn,_n),a(xn,Mn),Mn.innerHTML="x\n",a(xn,Tn),a(xn,En),En.innerHTML="e^{axy}\n",a(xn,Ln),a(xn,kn),kn.innerHTML="e^{-{\\small {1 \\over 2}} a(x-y)^2}\n",a(xn,Hn),a(xn,Rn),Rn.innerHTML="a\n",a(xn,An),s(t,Sn,e),s(t,Cn,e),Cn.innerHTML="\n\\begin{aligned}\ne^{axy} & = \\sum_{i=0} { \\dfrac{a^i(xy)^i}{i!} } & \\text{Taylor expansion} \\\\\n& = \\sum_{i=0} { \\dfrac{(a^{\\small {1 \\over 2}} x)^i}{(i!)^{\\small {1 \\over 2}}} \\dfrac{(a^{\\small {1 \\over 2}} y)^i}{(i!)^{\\small {1 \\over 2}}} } & \\text{Separate $x$ and $y$ terms to symmetric roles} \\\\\n& = \\sum_{i=0} { \\psi_{a,i}(x) \\psi_{a,i}(y) } & \\text{Let $\\psi_{a,i}(p) \\equiv \\dfrac{(a^{\\small {1 \\over 2}} p)^i}{(i!)^{\\small {1 \\over 2}}}$ }\\\\\n& = \\vec{\\psi_a}(x) \\cdot \\vec{\\psi_a}(y) & \\text{Let $\\vec{\\psi_a}(p) \\equiv (\\psi_{a,1}(p), \\psi_{a,2}(p), \\cdots)$ } \\\\\n\\end{aligned}\n",s(t,$n,e),s(t,Pn,e),a(Pn,jn),a(Pn,In),In.innerHTML="e^{axy}\n",a(Pn,Fn),a(Pn,Nn),Nn.innerHTML="x\n",a(Pn,Un),a(Pn,Xn),Xn.innerHTML="y\n",a(Pn,qn),s(t,Dn,e),s(t,zn,e),zn.innerHTML="\n\\begin{aligned}\ne^{-{\\small {1 \\over 2}} a(x-y)^2} & = e^{-{\\small {1 \\over 2}} a(x^2-2xy+y^2)} \\\\[1em]\n& = e^{-{\\small {1 \\over 2}} a x^2} e^{axy} e^{-{\\small {1 \\over 2}} a y^2} \\\\[1em]\n& = e^{-{\\small {1 \\over 2}} a x^2} ( \\vec{\\psi_a}(x) \\cdot \\vec{\\psi_a}(y) ) e^{-{\\small {1 \\over 2}} a y^2} & \\text{substitute formula above} \\\\[1em]\n& = (e^{-{\\small {1 \\over 2}} a x^2} \\vec{\\psi_a}(x) \\cdot e^{-{\\small {1 \\over 2}} a y^2} \\vec{\\psi_a}(y)) & \\text{By bilinearity of dot product} \\\\[1em]\n& = \\vec{\\phi_a}(x) \\cdot \\vec{\\phi_a}(y) & \\text{Let $\\vec{\\phi_a}(p) \\equiv e^{-{\\small {1 \\over 2}} ap^2} \\vec{\\psi_a}(p)$} \\\\\n\\end{aligned}\n",s(t,On,e),s(t,Vn,e),a(Vn,Kn),a(Vn,Bn),Bn.innerHTML="a = \\tfrac{1}{\\sigma^2}\n",a(Vn,Gn),a(Vn,Wn),Wn.innerHTML="e^{-\\tfrac{1}{2} {(\\tfrac{x - \\mu}{\\sigma})}^2 }\n",a(Vn,Yn),a(Vn,Qn),Qn.innerHTML="\\dfrac{1}{\\sigma^{\\small {1 \\over 2}} (2 \\pi)^{\\small 1 \\over 4}}\n",s(t,Jn,e),s(t,Zn,e),a(Zn,tr),a(Zn,er),er.innerHTML="x\n",a(Zn,nr),a(Zn,rr),rr.innerHTML="\\mu\n",a(Zn,ir),a(Zn,or),or.innerHTML="\\mu\n",a(Zn,ar),a(Zn,sr),sr.innerHTML="x\n",a(Zn,hr),a(Zn,lr),lr.innerHTML="x\n",a(Zn,ur),a(Zn,cr),cr.innerHTML="\\mu\n",a(Zn,fr),a(Zn,dr),dr.innerHTML="\\mu \\in \\mathcal{X}\n",a(Zn,mr),s(t,pr,e),s(t,gr,e),a(gr,vr),a(gr,br),br.innerHTML="x = \\mu\n",a(gr,xr),a(gr,wr),wr.innerHTML="\\vec{\\phi_a}(\\mu) \\cdot \\vec{\\phi_a}(\\mu)\n",a(gr,yr),a(gr,_r),_r.innerHTML="\\vec{\\phi_a}(x)\n",a(gr,Mr),a(gr,Tr),Tr.innerHTML="\\vec{\\phi_a}(\\mu)\n",a(gr,Er),a(gr,Lr),Lr.innerHTML="90^\\circ\n",a(gr,kr),a(gr,Hr),Hr.innerHTML="[0^\\circ, 90^\\circ)\n",a(gr,Rr),s(t,Ar,e),s(t,Sr,e),a(Sr,Cr),a(Sr,$r),$r.innerHTML="\\sigma\n",a(Sr,Pr),a(Sr,jr),jr.innerHTML="\\sigma\n",a(Sr,Ir),a(Sr,Fr),Fr.innerHTML="\\vec{\\phi_a}(\\cdot)\n",a(Sr,Nr),a(Sr,Ur),Ur.innerHTML="\\mu\n",a(Sr,Xr),a(Sr,qr),a(Sr,Dr),a(Sr,zr),zr.innerHTML="x\n",a(Sr,Or),s(t,Vr,e),s(t,Kr,e),s(t,Br,e),s(t,Gr,e),s(t,Wr,e),s(t,Yr,e),s(t,Qr,e),s(t,Jr,e),s(t,Zr,e),s(t,ti,e),s(t,ei,e),s(t,ni,e),s(t,ri,e),s(t,ii,e),s(t,oi,e),s(t,ai,e),s(t,si,e),s(t,hi,e),a(hi,li),a(hi,ui),ui.innerHTML="f_i(x)\n",a(hi,ci),s(t,fi,e),s(t,di,e),di.innerHTML="\n\\begin{aligned}\n\\bold{E} & \\equiv\n\\begin{bmatrix}\nf_1(x_1) & f_1(x_2) & \\cdots & f_1(x_n) \\\\\nf_2(x_1) & f_2(x_2) & \\cdots & f_2(x_n) \\\\\n& & \\cdots & \\\\\nf_n(x_1) & f_n(x_2) & \\cdots & f_n(x_n) \\\\\n\\end{bmatrix}\n& \\text{The matrix of row vectors of evaluation on the $x_i$} \\\\[1em]\n\\bold{E} & =\n\\begin{bmatrix}\n\\bold{p}_1 \\cdot \\bold{\\phi}(x_1) &\n\\bold{p}_1 \\cdot \\bold{\\phi}(x_2) &\n\\cdots & \n\\bold{p}_1 \\cdot \\bold{\\phi}(x_n) \\\\\n\\bold{p}_2 \\cdot \\bold{\\phi}(x_1) &\n\\bold{p}_2 \\cdot \\bold{\\phi}(x_2) &\n\\cdots &\n\\bold{p}_2 \\cdot \\bold{\\phi}(x_n) \\\\\n& & \\cdots \\\\\n\\bold{p}_n \\cdot \\bold{\\phi}(x_1) &\n\\bold{p}_n \\cdot \\bold{\\phi}(x_2) &\n\\cdots &\n\\bold{p}_n \\cdot \\bold{\\phi}(x_n) \\\\\n\\end{bmatrix} & \\text{By definition of the $f_i(x)$} \\\\[1em]\n& =\n\\begin{bmatrix}\n- \\bold{p}_1 - \\\\\n- \\bold{p}_2 - \\\\\n\\cdots \\\\\n- \\bold{p}_n - \\\\\n\\end{bmatrix} \n\\begin{bmatrix}\n- \\bold{\\phi}(x_1) - \\\\\n- \\bold{\\phi}(x_2) - \\\\\n\\cdots \\\\\n- \\bold{\\phi}(x_n) - \\\\\n\\end{bmatrix}^T \\\\[1.5em]\n& = \\bold{P F}^T & \\text{Defining matrices $\\bold{P}$ and $\\bold{F}$ appropriately} \\\\\n\\end{aligned}\n",s(t,mi,e),s(t,pi,e),a(pi,gi),a(pi,vi),vi.innerHTML="\\bold{\\phi}(x_i)\n",a(pi,bi),a(pi,xi),xi.innerHTML="\\bold{\\phi}(\\cdot)\n",a(pi,wi),a(pi,yi),yi.innerHTML="x_i\n",a(pi,_i),a(pi,Mi),Mi.innerHTML="\\bold{\\phi}(\\cdot)\n",a(pi,Ti),a(pi,Ei),Ei.innerHTML="\\bold{\\phi}(\\cdot)\n",a(pi,Li),s(t,ki,e),s(t,Hi,e),a(Hi,Ri),a(Hi,Ai),Ai.innerHTML="\\bold{\\phi}(\\cdot)\n",a(Hi,Si),a(Hi,Ci),Ci.innerHTML="\\bold{p}_i\n",a(Hi,$i),a(Hi,Pi),Pi.innerHTML="\\texttt{span}(\\bold{\\phi}(x_i))\n",a(Hi,ji),s(t,Ii,e),s(t,Fi,e),Fi.innerHTML="\n\\begin{aligned}\n\\bold{PF}^T & = (\\bold{P}_\\parallel + \\bold{P}_\\perp) \\bold{F}^T & \\text{by bilinearity of dot product} \\\\\n& = \\bold{P}_\\parallel \\bold{F}^T & \\text{since $\\bold{P}_\\perp$ has zero contribution} \\\\[2em]\n\\text{where: }\n\\bold{P}_\\parallel & \\equiv\n\\begin{bmatrix}\n- \\bold{p}_{\\parallel,1} - \\\\\n- \\bold{p}_{\\parallel,2} - \\\\\n\\cdots \\\\\n- \\bold{p}_{\\parallel,n} - \\\\\n\\end{bmatrix} & \\text{matrix of parallel parts, relative to $\\texttt{span}(\\bold{\\phi}(x_i))$} \\\\\n\\end{aligned}\n",s(t,Ni,e),s(t,Ui,e),a(Ui,Xi),a(Ui,qi),qi.innerHTML="\\bold{p}_i = \\bold{p}_{\\parallel i} + \\bold{p}_{\\perp i}\n",a(Ui,Di),a(Ui,zi),zi.innerHTML="\\texttt{span}(\\bold{F})\n",a(Ui,Oi),a(Ui,Vi),Vi.innerHTML="\\bold{p}_i\n",a(Ui,Ki),a(Ui,Bi),Bi.innerHTML="\\texttt{span}(\\bold{P}_\\parallel) = \\texttt{span}(\\bold{F})\n",a(Ui,Gi),a(Ui,Wi),Wi.innerHTML="\\bold{P}_\\perp\n",a(Ui,Yi),s(t,Qi,e),s(t,Ji,e),a(Ji,Zi),a(Ji,to),to.innerHTML="\\bold{\\alpha}\n",a(Ji,eo),a(Ji,no),no.innerHTML="\\bold{E}\n",a(Ji,ro),a(Ji,io),io.innerHTML="\\bold{y}\n",a(Ji,oo),a(Ji,ao),ao.innerHTML="\\bold{E}\n",a(Ji,so),a(Ji,ho),ho.innerHTML="\\bold{y}\n",a(Ji,lo),a(Ji,uo),uo.innerHTML="y_i(x)\n",a(Ji,co),a(Ji,fo),a(Ji,mo),s(t,po,e),s(t,go,e),go.innerHTML="\n\\begin{aligned}\nf(x) & \\equiv \\sum_i { \\alpha_i f_i(x) } \\\\\n& = \\sum_i {\\alpha_i (\\bold{p}_i \\cdot \\bold{\\phi}(x)) } & \\text{by definition of the $f_i(x)$} \\\\\n& = (\\sum_i {\\alpha_i \\bold{p}_i}) \\cdot \\bold{\\phi}(x) & \\text{by linearity of dot product} \\\\\n& = \\bold{\\alpha P} \\cdot \\bold{\\phi}(x) & \\text{in matrix form} \\\\\n\\end{aligned}\n",s(t,vo,e),s(t,bo,e),a(bo,xo),a(bo,wo),wo.innerHTML="f(x)\n",a(bo,yo),a(bo,_o),_o.innerHTML="\\bold{\\alpha P}\n",a(bo,Mo),a(bo,To),To.innerHTML="f(x)\n",a(bo,Eo),a(bo,Lo),Lo.innerHTML="x_i\n",a(bo,ko),a(bo,Ho),Ho.innerHTML="\\bold{\\alpha P F}^T\n",a(bo,Ro),s(t,Ao,e),s(t,So,e),a(So,Co),a(So,$o),$o.innerHTML="\\bold{P}\n",a(So,Po),a(So,jo),jo.innerHTML="\\texttt{span}(\\bold{P}_\\parallel) = \\texttt{span}(\\bold{F})\n",a(So,Io),a(So,Fo),Fo.innerHTML="\\bold{P_\\parallel}\n",a(So,No),a(So,Uo),Uo.innerHTML="\\bold{P_\\parallel} = \\bold{T} \\bold{F}\n",a(So,Xo),a(So,qo),qo.innerHTML="n \\times n\n",a(So,Do),a(So,zo),zo.innerHTML="\\bold{T}\n",a(So,Oo),s(t,Vo,e),s(t,Ko,e),Ko.innerHTML="\n\\begin{aligned}\n\\bold{\\alpha P F}^T & = \\bold{\\alpha (P_\\parallel + P_\\perp) F}^T & \\text{orthogonal decomposition}\\\\\n& = \\bold{\\alpha P_\\parallel F}^T & \\text{perpendicular component has zero contribution} \\\\\n& = \\bold{\\alpha TFF}^T & \\text{substituting from above} \\\\\n& = (\\bold{\\alpha T}) \\bold{FF}^T & \\text{reexpressing using a transformed $\\bold{\\alpha}$} \\\\\n\\end{aligned}\n",s(t,Bo,e),s(t,Go,e),a(Go,Wo),a(Go,Yo),Yo.innerHTML="\\bold{\\alpha}\n",a(Go,Qo),a(Go,Jo),Jo.innerHTML="\\bold{P}\n",a(Go,Zo),a(Go,ta),ta.innerHTML="\\bold{\\alpha T}\n",a(Go,ea),a(Go,na),na.innerHTML="\\bold{F}\n",a(Go,ra),a(Go,ia),ia.innerHTML="\\bold{F}\n",a(Go,oa),s(t,aa,e),s(t,sa,e),a(sa,ha),a(sa,la),la.innerHTML="\\bold{P} \\equiv \\bold{F}\n",a(sa,ua),a(sa,ca),a(sa,fa),a(sa,da),da.innerHTML="\\bold{P}\n",a(sa,ma),a(sa,pa),pa.innerHTML="\\bold{P} \\equiv \\bold{F}\n",a(sa,ga),s(t,va,e),s(t,ba,e),s(t,xa,e),s(t,wa,e),a(wa,ya),a(wa,_a),_a.innerHTML="f(x) = \\sum_i { \\alpha_i f_i(x) }\n",a(wa,Ma),a(wa,Ta),Ta.innerHTML="\\bold{p} = \\sum_i { \\alpha_i \\bold{p}_i }\n",a(wa,Ea),a(wa,La),La.innerHTML="a, b \\in \\mathcal{X}\n",a(wa,ka),a(wa,Ha),Ha.innerHTML="f(a)\n",a(wa,Ra),a(wa,Aa),Aa.innerHTML="|f(a) - f(b)|\n",a(wa,Sa),s(t,Ca,e),s(t,$a,e),$a.innerHTML="\n\\begin{aligned}\n\\bold{\\phi}_{a} & \\equiv \\bold{\\phi}(a) & \\text{notation} \\\\\nf(a) & = \\bold{p} \\cdot \\bold{\\phi}_{a} & \\text{definition of $f(x)$} \\\\\n& = \\|\\bold{p}\\| \\|\\bold{\\phi}_{a}\\| \\cos \\theta_{\\bold{p},\\bold{\\phi}_{a}} & \\text{definition of dot product} \\\\\n\\implies |f(a)| & \\le \\|\\bold{p}\\|\\|\\bold{\\phi}_{a}\\| & \\text{Cauchy Schwarz inequality} \\\\[2em]\nf(a) - f(b) & = \\bold{p} \\cdot \\bold{\\phi}_{a} - \\bold{p} \\cdot \\bold{\\phi}_{b} &\\text{definition of $f(x)$} \\\\\n& = \\bold{p} \\cdot (\\bold{\\phi}_{a} - \\bold{\\phi}_{b}) & \\text{bilinearity of dot product} \\\\\n& = \\|\\bold{p}\\| \\|\\bold{\\phi}_{a} - \\bold{\\phi}_{b}\\| \\cos \\theta_{\\bold{p}, \\bold{\\phi}_{a} - \\bold{\\phi}_{b}} & \\text{definition of dot product} \\\\\n\\implies |f(a) - f(b)| & \\le \\|\\bold{p}\\| \\|\\bold{\\phi}_{a} - \\bold{\\phi}_{b}\\| & \\text{Cauchy Schwarz inequality} \\\\\n\\end{aligned}\n",s(t,Pa,e),s(t,ja,e),a(ja,Ia),a(ja,Fa),Fa.innerHTML="f\n",a(ja,Na),a(ja,Ua),Ua.innerHTML="\\|\\bold{p\\|}\n",a(ja,Xa),a(ja,qa),qa.innerHTML="\\|\\bold{\\phi\\|_{a}}\n",a(ja,Da),a(ja,za),za.innerHTML="\\bold{\\phi}(\\cdot)\n",a(ja,Oa),a(ja,Va),Va.innerHTML="\\|\\bold{p\\|}\n",a(ja,Ka),a(ja,Ba),Ba.innerHTML="f\n",a(ja,Ga),s(t,Wa,e),s(t,Ya,e),a(Ya,Qa),a(Ya,Ja),Ja.innerHTML="\\|\\bold{\\phi\\|_{a} - \\bold{\\phi}_{b}}\n",a(Ya,Za),a(Ya,ts),ts.innerHTML="\\|\\bold{p\\|}\n",a(Ya,es),s(t,ns,e),s(t,rs,e),a(rs,is),a(rs,os),os.innerHTML="\\bold{\\phi}(\\cdot)\n",a(rs,as),a(rs,ss),ss.innerHTML="\\bold{\\phi}(\\cdot)\n",a(rs,hs),a(rs,ls),ls.innerHTML="\\|\\bold{\\phi\\|_{a} - \\bold{\\phi}_{b}}\n",a(rs,us),a(rs,cs),cs.innerHTML="|y_a - y_b|\n",a(rs,fs),a(rs,ds),ds.innerHTML="(a, b) \\in \\mathcal{X}\n",a(rs,ms),s(t,ps,e),s(t,gs,e),a(gs,vs),a(gs,bs),bs.innerHTML="\\|\\bold{\\phi\\|_{a} - \\bold{\\phi}_{b}}\n",a(gs,xs),a(gs,ws),ws.innerHTML="f_i(x)\n",a(gs,ys),s(t,_s,e),s(t,Ms,e),Ms.innerHTML="\n\\begin{aligned}\nf_i(x) & = \\bold{p}_i \\cdot \\bold{\\phi}(x) \\\\\n& = \\bold{\\phi}(x_i) \\cdot \\bold{\\phi}(x)\n\\end{aligned}\n",s(t,Ts,e),s(t,Es,e),a(Es,Ls),a(Es,ks),ks.innerHTML="\\mu\n",a(Es,Hs),a(Es,Rs),Rs.innerHTML="\\bold{\\phi}(\\mu)\n",a(Es,As),a(Es,Ss),Ss.innerHTML="\\bold{\\phi}(\\cdot)\n",a(Es,Cs),a(Es,$s),$s.innerHTML="x \\in \\mathcal{X}\n",a(Es,Ps),a(Es,js),js.innerHTML="x = \\mu\n",a(Es,Is),s(t,Fs,e),s(t,Ns,e),s(t,Us,e),s(t,Xs,e),Xs.innerHTML="\n\\begin{aligned}\n\\|\\bold{\\phi\\|_{\\mu} - \\bold{\\phi}_{x}}^2 & = (\\bold{\\phi}_{\\mu} - \\bold{\\phi}_{x}) \\cdot (\\bold{\\phi}_{\\mu} - \\bold{\\phi}_{x}) \\\\\n& = \\bold{\\phi}_{\\mu} \\cdot \\bold{\\phi}_{\\mu} - 2 \\bold{\\phi}_{\\mu} \\cdot \\bold{\\phi}_{x} + \\bold{\\phi}_{x} \\cdot \\bold{\\phi}_{x} \\\\\n\\bold{\\phi}_{\\mu} \\cdot \\bold{\\phi}_{x} & & \\text{height of gaussian with location $\\mu$ at $x$} \\\\\n\\bold{\\phi}_{\\mu} \\cdot \\bold{\\phi}_{\\mu}, \\,\\, \\bold{\\phi}_{x} \\cdot \\bold{\\phi}_{x} & & \\text{height of any gaussian at peak}\n\\end{aligned}\n",s(t,qs,e),s(t,Ds,e),a(Ds,zs),a(Ds,Os),Os.innerHTML="(x_b, y_b)\n",a(Ds,Vs),a(Ds,Ks),Ks.innerHTML="(x_a, y_a)\n",a(Ds,Bs),a(Ds,Gs),Gs.innerHTML="|y_b - y_a|\n",a(Ds,Ws),a(Ds,Ys),Ys.innerHTML="\\bold{p}\n",a(Ds,Qs),a(Ds,Js),Js.innerHTML="f(x_a) = y_a, f(x_b) = y_b\n",a(Ds,Zs),a(Ds,th),th.innerHTML="x_a\n",a(Ds,eh),a(Ds,nh),nh.innerHTML="x_b\n",a(Ds,rh),a(Ds,ih),ih.innerHTML="\\|\\bold{\\phi\\|_{x_a} - \\bold{\\phi}_{x_b}}\n",a(Ds,oh),a(Ds,ah),ah.innerHTML="\\|\\bold{b\\|}\n",a(Ds,sh),a(Ds,hh),hh.innerHTML="\\bold{\\phi}(\\cdot)\n",a(Ds,lh),s(t,uh,e),s(t,ch,e),s(t,fh,e),s(t,dh,e),a(dh,mh),a(dh,ph),ph.innerHTML="\\bold{P} \\equiv \\bold{F}\n",a(dh,gh),s(t,vh,e),s(t,bh,e),bh.innerHTML="\n\\begin{aligned}\n\\bold{F} & \\equiv \n\\begin{bmatrix}\n- \\bold{\\phi}(x_1) - \\\\\n- \\bold{\\phi}(x_2) - \\\\\n\\cdots \\\\\n- \\bold{\\phi}(x_n) - \\\\\n\\end{bmatrix} & \\text{definition from before} \\\\\n\\bold{\\alpha F} & & \\text{The parameter vector for the solution function $f(\\cdot)$}\\\\\n\\bold{\\alpha F F}^T & & \\text{vector of evaluation of the solution function $f(\\cdot)$} \\\\\n\\end{aligned}\n",s(t,xh,e),s(t,wh,e),a(wh,yh),a(wh,_h),_h.innerHTML="\\bold{\\alpha}\n",a(wh,Mh),s(t,Th,e),s(t,Eh,e),Eh.innerHTML="\n\\begin{aligned}\n\\bold{\\hat{\\alpha}} & = \\min_{\\alpha} { \\|\\bold{\\alpha F F\\|^T - \\bold{y}}^2 }\n\\end{aligned}\n",s(t,Lh,e),s(t,kh,e),s(t,Hh,e),s(t,Rh,e),Rh.innerHTML="\n\\begin{aligned}\n\\bold{\\hat{\\alpha}} & = \\min_{\\alpha} ( \\|\\bold{\\alpha F F\\|^T - \\bold{y}}^2 + \\lambda \\|\\bold{\\alpha F\\|}^2 ) & \\text{sum of squared error, regularized by norm of $\\bold{p}$}\\\\\n& = \\min_{\\alpha} ( \\|\\bold{\\alpha F F\\|^T - \\bold{y}}^2 + \\lambda \\bold{\\alpha F F}^T \\bold{\\alpha}^T )\n\\end{aligned}\n",s(t,Ah,e),s(t,Sh,e),s(t,Ch,e),s(t,$h,e),$h.innerHTML="\n\\begin{aligned}\nf(x) & = \\bold{p} \\cdot \\bold{\\phi}(x) \\\\\n& = \\bold{\\hat{\\alpha} F} \\cdot \\bold{\\phi}(x)\n\\end{aligned}\n",s(t,Ph,e),s(t,jh,e),a(jh,Ih),a(jh,Fh),Fh.innerHTML="\\mathcal{X}\n",a(jh,Nh),a(jh,Uh),Uh.innerHTML="\\bold{\\phi}(x_i) \\cdot \\bold{\\phi}(x_j)\n",a(jh,Xh),a(jh,qh),qh.innerHTML="\\bold{F F}^T\n",a(jh,Dh),s(t,zh,e),s(t,Oh,e),Oh.innerHTML="\n\\begin{aligned}\nk(x,x') & \\equiv \\bold{\\phi}(x) \\cdot \\bold{\\phi}(x') & \\text{The kernel function} \\\\\n\\bold{K} & \\equiv [ \\bold{K}_{ij} = k(x_i, x_j) ] & \\text{The Kernel matrix, metric matrix or Gramm matrix} \\\\\n& = \\bold{F F}^T & \\text{from above}\n\\end{aligned}\n",s(t,Vh,e),s(t,Kh,e),s(t,Bh,e),s(t,Gh,e),Gh.innerHTML="\n\\begin{aligned}\n\\bold{\\hat{\\alpha}} & = \\min_{\\alpha} ( \\|\\bold{\\alpha K\\|- \\bold{y}}^2 + \\lambda \\bold{\\alpha K} \\bold{\\alpha}^T )\n\\end{aligned}\n",s(t,Wh,e),s(t,Yh,e),s(t,Qh,e),s(t,Jh,e),Jh.innerHTML="\n\\begin{aligned}\nf(x) & = \\sum_i { \\hat{\\alpha}_i k(x_i, x) } \\\\\n\\end{aligned}\n",s(t,Zh,e),s(t,tl,e),s(t,el,e),s(t,nl,e),a(nl,rl),a(nl,il),il.innerHTML="\\mathcal{X} \\times \\mathcal{Y}\n",a(nl,ol),a(nl,al),al.innerHTML="\\mathcal{X}\n",a(nl,sl),a(nl,hl),a(nl,ll),a(nl,ul),ul.innerHTML="\\mathcal{X}\n",a(nl,cl),a(nl,fl),fl.innerHTML="\\mathbb{R}^n\n",a(nl,dl),a(nl,ml),ml.innerHTML="\\mathcal{X}\n",a(nl,pl),a(nl,gl),a(nl,vl),vl.innerHTML="\\mathcal{X}\n",a(nl,bl),a(nl,xl),xl.innerHTML="\\mathcal{X}\n",a(nl,wl),a(nl,yl),yl.innerHTML="\\mathbb{R}^n\n",a(nl,_l),s(t,Ml,e),s(t,Tl,e),a(Tl,El),a(Tl,Ll),Ll.innerHTML="\\mathbb{R}\n",a(Tl,kl),a(Tl,Hl),Hl.innerHTML="\\pi\n",a(Tl,Rl),s(t,Al,e),s(t,Sl,e),a(Sl,Cl),a(Sl,$l),$l.innerHTML="K(a,b) \\gt K(a,a)\n",a(Sl,Pl),a(Sl,jl),jl.innerHTML="a\n",a(Sl,Il),a(Sl,Fl),Fl.innerHTML="b\n",a(Sl,Nl),a(Sl,Ul),Ul.innerHTML="K(\\cdot, \\cdot)\n",a(Sl,Xl),a(Sl,ql),ql.innerHTML="a\n",a(Sl,Dl),a(Sl,zl),zl.innerHTML="b\n",a(Sl,Ol),s(t,Vl,e),s(t,Kl,e),a(Kl,Bl),a(Kl,Gl),a(Kl,Wl),a(Kl,Yl),Yl.innerHTML="\\mathcal{X}\n",a(Kl,Ql),s(t,Jl,e),s(t,Zl,e),Zl.innerHTML="\n\\begin{aligned}\na, b \\in \\mathcal{X} \\\\\nK(a, b) & \\equiv \\|a\\| \\|b\\| \\cos\\theta_{ab} & \\text{The Kernel defines the value of the inner product} \\\\\n\\implies \\|a\\| & = K(a,a)^{\\small {1 \\over 2}} \\\\\n\\implies \\cos \\theta_{ab} & = \\dfrac{K(a, b)}{K(a, a)^\\frac{1}{2} K(b, b)^\\frac{1}{2}} \\\\[1em]\n\\implies \\mathrm{dist}(a, b)^2 & = K(a, a) - 2K(a, b) + K(b, b) \\\\\n\\end{aligned}\n",s(t,tu,e),s(t,eu,e),s(t,nu,e),s(t,ru,e),s(t,iu,e),s(t,ou,e),s(t,au,e),s(t,su,e),a(su,hu),a(hu,lu),a(hu,uu),uu.innerHTML="a",a(hu,cu),a(hu,fu),fu.innerHTML="b",a(hu,du),a(hu,mu),mu.innerHTML="\\|a-b\\|",a(su,pu),a(su,gu),a(su,vu),a(su,bu),a(su,xu),a(su,wu),a(su,yu),a(su,_u);s(t,Mu,e),s(t,Tu,e),a(Tu,Eu),a(Tu,Lu),Lu.innerHTML="a\n",a(Tu,ku),a(Tu,Hu),Hu.innerHTML="b\n",a(Tu,Ru),a(Tu,Au),Au.innerHTML="\\|a\\|\n",a(Tu,Su),a(Tu,Cu),Cu.innerHTML="\\|b\\|\n",a(Tu,$u),a(Tu,Pu),Pu.innerHTML="\\theta_{ab}\n",a(Tu,ju),s(t,Iu,e),s(t,Fu,e),Fu.innerHTML='\n\\begin{aligned}\n\\|b\\| \\cos\\theta_{ab} & \\equiv \\|\\mathrm{proj}_a b\\| & \\text{geometric definition of cosine} \\\\\n\\|b\\| \\sin\\theta_{ab} & \\equiv \\|\\mathrm{proj}_{a\\bot\\| b} & \\text{geometric definition of sin} \\\\[1em]\n\\|a-b\\|^2 & = (\\|a\\| - \\|\\mathrm{proj}_a b\\|)^2 + \\|\\mathrm{proj}_{a\\bot\\| b})^2 & \\text{Pythagoras definition of distance}\\\\\n& = (\\|a\\| - \\|b\\|\\cos\\theta_{ab})^2 + (\\|b\\|\\sin\\theta_{ab})^2 \\\\\n& = \\|a\\|^2 - 2\\|a\\|\\|b\\|\\cos\\theta_{ab} + \\|b\\|^2\\cos^2\\theta_{ab} + \\|b\\|^2\\sin^2\\theta_{ab} \\\\\n& = \\|a\\|^2 - 2\\|a\\|\\|b\\|\\cos\\theta_{ab} + \\|b\\|^2 \\\\[1em]\n& = \\|a\\|\\|a\\|\\cos\\theta_{aa} - 2\\|a\\|\\|b\\|\\cos\\theta_{ab} + \\|b\\|\\|b\\|\\cos\\theta_{bb} & \\text{Expand terms to same form} \\\\[1em]\nf(a,b) & \\equiv \\|a\\|\\|b\\|\\cos\\theta_{ab} & \\text{Define $f$, the "inner product"} \\\\[1em]\n\\|a-b\\|^2 & = f(a,a) -2f(a,b) + f(b,b) & \\text{Substituting in $f$} \\\\[1em]\n\\end{aligned}\n',s(t,Nu,e),s(t,Uu,e),a(Uu,Xu),a(Uu,qu),qu.innerHTML="f(a,b)\n",a(Uu,Du),a(Uu,zu),zu.innerHTML="a\n",a(Uu,Ou),a(Uu,Vu),Vu.innerHTML="b\n",a(Uu,Ku),s(t,Bu,e),s(t,Gu,e),Gu.innerHTML="\n\\begin{aligned}\n& = f(a,a) -f(a,b) + f(-a,b) + f(b,b) & \\text{f is symmetric and bilinear} \\\\\n& = f(a,a-b) + f(b-a,b) \\\\\n& = f(a,a-b) + f(-b,a-b) \\\\\n& = f(a-b,a-b) \\\\[1em]\n\\|a-b\\|^2 & = f(a,a) - 2f(a,b) + f(b,b) & \\text{Formula that doesn't require any expression $a-b$} \\\\\n\\end{aligned}\n",s(t,Wu,e),s(t,Yu,e),s(t,Qu,e),s(t,Ju,e),a(Ju,Zu),a(Ju,tc),tc.innerHTML="\\langle f_\\bold{p}, f_\\bold{q} \\rangle \\equiv \\bold{p} \\cdot \\bold{q}\n",a(Ju,ec),s(t,nc,e),s(t,rc,e),a(rc,ic),a(rc,oc),oc.innerHTML="f_\\bold{p}(\\cdot)\n",a(rc,ac),a(rc,sc),sc.innerHTML="\\bold{\\phi}(\\cdot)\n",a(rc,hc),a(rc,lc),lc.innerHTML="\\bold{p}\n",a(rc,uc),a(rc,cc),cc.innerHTML="f_\\bold{p}(\\cdot)\n",a(rc,fc),s(t,dc,e),s(t,mc,e),a(mc,pc),a(mc,gc),gc.innerHTML="\\mathcal{F}\n",a(mc,vc),a(mc,bc),bc.innerHTML="\\bold{\\phi}(\\cdot) = \\{\\phi_1(\\cdot), \\phi_2(\\cdot), \\cdots\\}\n",a(mc,xc),a(mc,wc),wc.innerHTML="\\phi_i(\\cdot)\n",a(mc,yc),a(mc,_c),_c.innerHTML="\\mathcal{F}\n",a(mc,Mc),a(mc,Tc),Tc.innerHTML="\\mathcal{F} = \\mathbb{R}^{\\{\\phi_1(\\cdot), \\phi_2(\\cdot), \\cdots\\}}\n",a(mc,Ec),s(t,Lc,e),s(t,kc,e),a(kc,Hc),a(kc,Rc),Rc.innerHTML="f: \\mathcal{X} \\mapsto \\mathbb{R}\n",a(kc,Ac),a(kc,Sc),Sc.innerHTML="\\mathcal{H}\n",a(kc,Cc),a(kc,$c),a(kc,Pc),a(kc,jc),jc.innerHTML="\\mathcal{H} = \\mathbb{R}^\\mathcal{X}\n",a(kc,Ic),a(kc,Fc),Fc.innerHTML="\\langle f_\\bold{p}, f_\\bold{q} \\rangle_\\mathcal{H} \\equiv \\bold{p} \\cdot \\bold{q}\n",a(kc,Nc),a(kc,Uc),Uc.innerHTML="n\n",a(kc,Xc),a(kc,qc),qc.innerHTML="\\mathcal{H}\n",a(kc,Dc),a(kc,zc),zc.innerHTML="n\n",a(kc,Oc),s(t,Vc,e),s(t,Kc,e),a(Kc,Bc),a(Kc,Gc),Gc.innerHTML="\\mathcal{F} \\equiv \\mathbb{R}^{\\{\\phi_1(\\cdot), \\phi_2(\\cdot), \\cdots\\}}\n",a(Kc,Wc),a(Kc,Yc),a(Kc,Qc),a(Kc,Jc),Jc.innerHTML="\\mathcal{X}\n",a(Kc,Zc),a(Kc,tf),tf.innerHTML="\\mathcal{F}\n",a(Kc,ef),a(Kc,nf),a(Kc,rf),a(Kc,of),of.innerHTML="\\mathcal{H}\n",a(Kc,af),a(Kc,sf),sf.innerHTML="\\mathcal{F}\n",a(Kc,hf),s(t,lf,e),s(t,uf,e),a(uf,cf),a(uf,ff),ff.innerHTML="\\mathcal{H} \\equiv \\mathbb{R}^\\mathcal{X}\n",a(uf,df),a(uf,mf),mf.innerHTML="\\mathcal{F}\n",a(uf,pf),a(uf,gf),gf.innerHTML="\\mathcal{H}\n",a(uf,vf),s(t,bf,e),s(t,xf,e),a(xf,wf),a(xf,yf),yf.innerHTML="\\mathcal{X}",s(t,_f,e),s(t,Mf,e),a(Mf,Tf),a(Mf,Ef),Ef.innerHTML="\\mathbb{R}\n",a(Mf,Lf),a(Mf,kf),kf.innerHTML="\\mathcal{X}\n",a(Mf,Hf),a(Mf,Rf),Rf.innerHTML="\\mathcal{X}\n",a(Mf,Af),a(Mf,Sf),Sf.innerHTML="x \\in \\mathcal{X}\n",a(Mf,Cf),a(Mf,$f),$f.innerHTML="\\mathcal{X}\n",a(Mf,Pf),a(Mf,jf),jf.innerHTML="\\mathcal{X} \\times \\mathcal{X} \\mapsto \\mathbb{R}\n",a(Mf,If),a(Mf,Ff),Ff.innerHTML="k_i(x)\n",a(Mf,Nf),a(Mf,Uf),Uf.innerHTML="\\sigma\n",a(Mf,Xf),a(Mf,qf),qf.innerHTML="x_i\n",a(Mf,Df),s(t,zf,e),s(t,Of,e),s(t,Vf,e),s(t,Kf,e),a(Kf,Bf),a(Kf,Gf),Gf.innerHTML="n\n",a(Kf,Wf),a(Kf,Yf),Yf.innerHTML="\\sigma\n",a(Kf,Qf),a(Kf,Jf),Jf.innerHTML="n\n",a(Kf,Zf),a(Kf,td),td.innerHTML="n\n",a(Kf,ed),a(Kf,nd),nd.innerHTML="n\n",a(Kf,rd),s(t,id,e),s(t,od,e),s(t,ad,e),s(t,sd,e),s(t,hd,e),s(t,ld,e),s(t,ud,e),s(t,cd,e),s(t,fd,e),s(t,dd,e),s(t,md,e),s(t,pd,e),s(t,gd,e),s(t,vd,e),s(t,bd,e),s(t,xd,e),s(t,wd,e),s(t,yd,e),a(yd,_d),_d.innerHTML="\\max\\limits_{\\alpha \\in \\mathbb{R}^n, \\beta \\in \\mathbb{R}^n} \\dfrac{\\alpha^T K_\\alpha K_\\beta \\beta}{(\\alpha^TK_\\alpha^2 \\alpha)^{\\frac{1}{2}} (\\beta^T K_\\beta^2 \\beta)^{\\frac{1}{2}} }\n",s(t,Md,e),s(t,Td,e),s(t,Ed,e),s(t,Ld,e),s(t,kd,e),s(t,Hd,e),a(Hd,Rd),a(Hd,Ad),a(Hd,Sd),a(Hd,Cd),Cd.innerHTML="f\n",a(Hd,$d),a(Hd,Pd),Pd.innerHTML="(x, y)\n",a(Hd,jd),a(Hd,Id),Id.innerHTML="\\mu = y f(x)\n",a(Hd,Fd),a(Hd,Nd),Nd.innerHTML="\\phi(\\mu)\n",a(Hd,Ud),s(t,Xd,e),s(t,qd,e),a(qd,Dd),a(Dd,zd),a(zd,Od),a(zd,Vd),a(zd,Kd),a(Kd,Bd),Bd.innerHTML="\\phi(\\mu)",a(qd,Gd),a(qd,Wd),a(Wd,Yd),a(Yd,Qd),a(Yd,Jd),a(Yd,Zd),a(Zd,tm),tm.innerHTML="\\log(1 + e^{-\\mu}",a(Wd,em),a(Wd,nm),a(nm,rm),a(nm,im),a(nm,om),a(om,am),am.innerHTML="\\max(1-\\mu, 0)",a(Wd,sm),a(Wd,hm),a(hm,lm),a(hm,um),a(hm,cm),a(cm,fm),fm.innerHTML=" \\max(1-\\mu, 0)^2",a(Wd,dm),a(Wd,mm),a(mm,pm),a(mm,gm),a(mm,vm),a(vm,bm),bm.innerHTML="e^{-\\mu}",s(t,xm,e),s(t,wm,e),s(t,ym,e),s(t,_m,e),_m.innerHTML="\n\\begin{aligned}\n& \\min_{f \\in \\mathcal{H}} { \\dfrac{1}{\\mu} \\sum { \\phi(y_i f(x_i)) + \\lambda \\|f\\|^2_{\\mathcal{H}} } } \\\\\nf(x) & = \\sum { \\alpha_i K(x_i, x) } & \\text{By representer theorem}\\\\\n& \\min_{\\alpha \\in \\mathbb{R}^n} { \\dfrac{1}{n} \\sum { \\phi(y_i [K\\alpha]_i) + \\lambda \\alpha^T K \\alpha } } & \\text{plugging in}\\\\\n\\end{aligned}\n",s(t,Mm,e),s(t,Tm,e),a(Tm,Em),a(Tm,Lm),Lm.innerHTML="\\alpha\n",a(Tm,km),s(t,Hm,e),s(t,Rm,e),a(Rm,Am),Am.innerHTML="f(x) = \\sum { \\alpha_i K(x_i, x) } = \\sum\\limits_{i \\in SV} { \\alpha_i K(x_i, x) }\n",s(t,Sm,e),s(t,Cm,e),s(t,$m,e),s(t,Pm,e),s(t,jm,e),s(t,Im,e)},p:t,i:t,o:t,d(t){t&&h(n),t&&h(r),t&&h(i),t&&h(l),t&&h(c),t&&h(E),t&&h(L),t&&h(P),t&&h(j),t&&h(Q),t&&h(J),t&&h(Z),t&&h(tt),t&&h(et),t&&h(nt),t&&h(gt),t&&h(vt),t&&h(bt),t&&h(xt),t&&h(jt),t&&h(It),t&&h(Zt),t&&h(te),t&&h(oe),t&&h(ae),t&&h(se),t&&h(he),t&&h(fe),t&&h(de),t&&h(me),t&&h(pe),t&&h(ge),t&&h(ve),t&&h(Re),t&&h(Ae),t&&h(Ye),t&&h(Qe),t&&h(sn),t&&h(hn),t&&h(mn),t&&h(pn),t&&h(bn),t&&h(xn),t&&h(Sn),t&&h(Cn),t&&h($n),t&&h(Pn),t&&h(Dn),t&&h(zn),t&&h(On),t&&h(Vn),t&&h(Jn),t&&h(Zn),t&&h(pr),t&&h(gr),t&&h(Ar),t&&h(Sr),t&&h(Vr),t&&h(Kr),t&&h(Br),t&&h(Gr),t&&h(Wr),t&&h(Yr),t&&h(Qr),t&&h(Jr),t&&h(Zr),t&&h(ti),t&&h(ei),t&&h(ni),t&&h(ri),t&&h(ii),t&&h(oi),t&&h(ai),t&&h(si),t&&h(hi),t&&h(fi),t&&h(di),t&&h(mi),t&&h(pi),t&&h(ki),t&&h(Hi),t&&h(Ii),t&&h(Fi),t&&h(Ni),t&&h(Ui),t&&h(Qi),t&&h(Ji),t&&h(po),t&&h(go),t&&h(vo),t&&h(bo),t&&h(Ao),t&&h(So),t&&h(Vo),t&&h(Ko),t&&h(Bo),t&&h(Go),t&&h(aa),t&&h(sa),t&&h(va),t&&h(ba),t&&h(xa),t&&h(wa),t&&h(Ca),t&&h($a),t&&h(Pa),t&&h(ja),t&&h(Wa),t&&h(Ya),t&&h(ns),t&&h(rs),t&&h(ps),t&&h(gs),t&&h(_s),t&&h(Ms),t&&h(Ts),t&&h(Es),t&&h(Fs),t&&h(Ns),t&&h(Us),t&&h(Xs),t&&h(qs),t&&h(Ds),t&&h(uh),t&&h(ch),t&&h(fh),t&&h(dh),t&&h(vh),t&&h(bh),t&&h(xh),t&&h(wh),t&&h(Th),t&&h(Eh),t&&h(Lh),t&&h(kh),t&&h(Hh),t&&h(Rh),t&&h(Ah),t&&h(Sh),t&&h(Ch),t&&h($h),t&&h(Ph),t&&h(jh),t&&h(zh),t&&h(Oh),t&&h(Vh),t&&h(Kh),t&&h(Bh),t&&h(Gh),t&&h(Wh),t&&h(Yh),t&&h(Qh),t&&h(Jh),t&&h(Zh),t&&h(tl),t&&h(el),t&&h(nl),t&&h(Ml),t&&h(Tl),t&&h(Al),t&&h(Sl),t&&h(Vl),t&&h(Kl),t&&h(Jl),t&&h(Zl),t&&h(tu),t&&h(eu),t&&h(nu),t&&h(ru),t&&h(iu),t&&h(ou),t&&h(au),t&&h(su),t&&h(Mu),t&&h(Tu),t&&h(Iu),t&&h(Fu),t&&h(Nu),t&&h(Uu),t&&h(Bu),t&&h(Gu),t&&h(Wu),t&&h(Yu),t&&h(Qu),t&&h(Ju),t&&h(nc),t&&h(rc),t&&h(dc),t&&h(mc),t&&h(Lc),t&&h(kc),t&&h(Vc),t&&h(Kc),t&&h(lf),t&&h(uf),t&&h(bf),t&&h(xf),t&&h(_f),t&&h(Mf),t&&h(zf),t&&h(Of),t&&h(Vf),t&&h(Kf),t&&h(id),t&&h(od),t&&h(ad),t&&h(sd),t&&h(hd),t&&h(ld),t&&h(ud),t&&h(cd),t&&h(fd),t&&h(dd),t&&h(md),t&&h(pd),t&&h(gd),t&&h(vd),t&&h(bd),t&&h(xd),t&&h(wd),t&&h(yd),t&&h(Md),t&&h(Td),t&&h(Ed),t&&h(Ld),t&&h(kd),t&&h(Hd),t&&h(Xd),t&&h(qd),t&&h(xm),t&&h(wm),t&&h(ym),t&&h(_m),t&&h(Mm),t&&h(Tm),t&&h(Hm),t&&h(Rm),t&&h(Sm),t&&h(Cm),t&&h($m),t&&h(Pm),t&&h(jm),t&&h(Im)}}}class W extends B{constructor(t){super(),K(this,t,null,G,o,{})}}const Y=[];function Q(e,n=t){let r;const i=new Set;function a(t){if(o(e,t)&&(e=t,r)){const t=!Y.length;for(const t of i)t[1](),Y.push(t,e);if(t){for(let t=0;t<Y.length;t+=2)Y[t][0](Y[t+1]);Y.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(o,s=t){const h=[o,s];return i.add(h),1===i.size&&(r=n(a)||t),o(e),()=>{i.delete(h),0===i.size&&(r(),r=null)}}}}const J=Object.prototype.toString;function Z(t){return J.call(t).endsWith("Array]")}function tt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Z(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]>a&&(a=t[s]);return a}function et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Z(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],s=r+1;s<o;s++)t[s]<a&&(a=t[s]);return a}function nt(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Z(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!Z(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=et(t),i=tt(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,a=void 0===o?n.autoMinMax?r:0:o,s=n.max,h=void 0===s?n.autoMinMax?i:1:s;if(a>=h)throw new RangeError("min option must be smaller than max option");for(var l=(h-a)/(i-r),u=0;u<t.length;u++)e[u]=(t[u]-r)*l+a;return e}class rt{constructor(t){var e,n,r,i,o,a,s,h,l,u=(t=At.checkMatrix(t)).clone(),c=u.rows,f=u.columns,d=new Array(c),m=1;for(e=0;e<c;e++)d[e]=e;for(h=new Array(c),n=0;n<f;n++){for(e=0;e<c;e++)h[e]=u.get(e,n);for(e=0;e<c;e++){for(l=Math.min(e,n),o=0,r=0;r<l;r++)o+=u.get(e,r)*h[r];h[e]-=o,u.set(e,n,h[e])}for(i=n,e=n+1;e<c;e++)Math.abs(h[e])>Math.abs(h[i])&&(i=e);if(i!==n){for(r=0;r<f;r++)a=u.get(i,r),u.set(i,r,u.get(n,r)),u.set(n,r,a);s=d[i],d[i]=d[n],d[n]=s,m=-m}if(n<c&&0!==u.get(n,n))for(e=n+1;e<c;e++)u.set(e,n,u.get(e,n)/u.get(n,n))}this.LU=u,this.pivotVector=d,this.pivotSign=m}isSingular(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1}solve(t){t=Rt.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,o=t.columns,a=t.subMatrixRow(this.pivotVector,0,o-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<o;r++)a[n][r]-=a[i][r]*e[n][i];for(i=s-1;i>=0;i--){for(r=0;r<o;r++)a[i][r]/=e[i][i];for(n=0;n<i;n++)for(r=0;r<o;r++)a[n][r]-=a[i][r]*e[n][i]}return a}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new Rt(e,n),i=0;i<e;i++)for(var o=0;o<n;o++)r[i][o]=i>o?t[i][o]:i===o?1:0;return r}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new Rt(e,n),i=0;i<e;i++)for(var o=0;o<n;o++)r[i][o]=i<=o?t[i][o]:0;return r}get pivotPermutationVector(){return this.pivotVector.slice()}}function it(t,e){var n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}function ot(t,e,n){for(var r=new Array(t),i=0;i<t;i++){r[i]=new Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}class at{constructor(t,e={}){var n=(t=At.checkMatrix(t)).rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:a=!1}=e;var s,h=Boolean(i),l=Boolean(o),u=!1;if(n<r)if(a){n=(s=t.transpose()).rows,r=s.columns,u=!0;var c=h;h=l,l=c}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();var f=Math.min(n,r),d=Math.min(n+1,r),m=new Array(d),p=ot(n,f,0),g=ot(r,r,0),v=new Array(r),b=new Array(n),x=new Array(d);for(let t=0;t<d;t++)x[t]=t;var w=Math.min(n-1,r),y=Math.max(0,Math.min(r-2,n)),_=Math.max(w,y);for(let t=0;t<_;t++){if(t<w){m[t]=0;for(let e=t;e<n;e++)m[t]=it(m[t],s[e][t]);if(0!==m[t]){s[t][t]<0&&(m[t]=-m[t]);for(let e=t;e<n;e++)s[e][t]/=m[t];s[t][t]+=1}m[t]=-m[t]}for(let e=t+1;e<r;e++){if(t<w&&0!==m[t]){let r=0;for(let i=t;i<n;i++)r+=s[i][t]*s[i][e];r=-r/s[t][t];for(let i=t;i<n;i++)s[i][e]+=r*s[i][t]}v[e]=s[t][e]}if(h&&t<w)for(let e=t;e<n;e++)p[e][t]=s[e][t];if(t<y){v[t]=0;for(let e=t+1;e<r;e++)v[t]=it(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<r;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<n&&0!==v[t]){for(let e=t+1;e<n;e++)b[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)b[e]+=v[n]*s[e][n];for(let e=t+1;e<r;e++){let r=-v[e]/v[t+1];for(let i=t+1;i<n;i++)s[i][e]+=r*b[i]}}if(l)for(let e=t+1;e<r;e++)g[e][t]=v[e]}}let M=Math.min(r,n+1);if(w<r&&(m[w]=s[w][w]),n<M&&(m[M-1]=0),y+1<M&&(v[y]=s[y][M-1]),v[M-1]=0,h){for(let t=w;t<f;t++){for(let e=0;e<n;e++)p[e][t]=0;p[t][t]=1}for(let t=w-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<f;e++){let r=0;for(let i=t;i<n;i++)r+=p[i][t]*p[i][e];r=-r/p[t][t];for(let i=t;i<n;i++)p[i][e]+=r*p[i][t]}for(let e=t;e<n;e++)p[e][t]=-p[e][t];p[t][t]=1+p[t][t];for(let e=0;e<t-1;e++)p[e][t]=0}else{for(let e=0;e<n;e++)p[e][t]=0;p[t][t]=1}}if(l)for(let t=r-1;t>=0;t--){if(t<y&&0!==v[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=g[i][t]*g[i][e];n=-n/g[t+1][t];for(let i=t+1;i<r;i++)g[i][e]+=n*g[i][t]}for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}for(var T=M-1,E=Number.EPSILON;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+E*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===M-2)e=4;else{let n;for(n=M-1;n>=t&&n!==t;n--){let e=(n!==M?Math.abs(v[n]):0)+(n!==t+1?Math.abs(v[n-1]):0);if(Math.abs(m[n])<=E*e){m[n]=0;break}}n===t?e=3:n===M-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=v[M-2];v[M-2]=0;for(let n=M-2;n>=t;n--){let i=it(m[n],e),o=m[n]/i,a=e/i;if(m[n]=i,n!==t&&(e=-a*v[n-1],v[n-1]=o*v[n-1]),l)for(let t=0;t<r;t++)i=o*g[t][n]+a*g[t][M-1],g[t][M-1]=-a*g[t][n]+o*g[t][M-1],g[t][n]=i}break}case 2:{let e=v[t-1];v[t-1]=0;for(let r=t;r<M;r++){let i=it(m[r],e),o=m[r]/i,a=e/i;if(m[r]=i,e=-a*v[r],v[r]=o*v[r],h)for(let e=0;e<n;e++)i=o*p[e][r]+a*p[e][t-1],p[e][t-1]=-a*p[e][r]+o*p[e][t-1],p[e][r]=i}break}case 3:{const e=Math.max(Math.abs(m[M-1]),Math.abs(m[M-2]),Math.abs(v[M-2]),Math.abs(m[t]),Math.abs(v[t])),i=m[M-1]/e,o=m[M-2]/e,a=v[M-2]/e,s=m[t]/e,u=v[t]/e,c=((o+i)*(o-i)+a*a)/2,f=i*a*(i*a);let d=0;0===c&&0===f||(d=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),d=f/(c+d));let b=(s+i)*(s-i)+d,x=s*u;for(let e=t;e<M-1;e++){let i=it(b,x);0===i&&(i=Number.MIN_VALUE);let o=b/i,a=x/i;if(e!==t&&(v[e-1]=i),b=o*m[e]+a*v[e],v[e]=o*v[e]-a*m[e],x=a*m[e+1],m[e+1]=o*m[e+1],l)for(let t=0;t<r;t++)i=o*g[t][e]+a*g[t][e+1],g[t][e+1]=-a*g[t][e]+o*g[t][e+1],g[t][e]=i;if(i=it(b,x),0===i&&(i=Number.MIN_VALUE),o=b/i,a=x/i,m[e]=i,b=o*v[e]+a*m[e+1],m[e+1]=-a*v[e]+o*m[e+1],x=a*v[e+1],v[e+1]=o*v[e+1],h&&e<n-1)for(let t=0;t<n;t++)i=o*p[t][e]+a*p[t][e+1],p[t][e+1]=-a*p[t][e]+o*p[t][e+1],p[t][e]=i}v[M-2]=b;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,l))for(let e=0;e<=T;e++)g[e][t]=-g[e][t];for(;t<T&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,l&&t<r-1)for(let n=0;n<r;n++)e=g[n][t+1],g[n][t+1]=g[n][t],g[n][t]=e;if(h&&t<n-1)for(let r=0;r<n;r++)e=p[r][t+1],p[r][t+1]=p[r][t],p[r][t]=e;t++}M--}}if(u){var L=g;g=p,p=L}this.m=n,this.n=r,this.s=m,this.U=p,this.V=g}solve(t){var e=t,n=this.threshold,r=this.s.length,i=Rt.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i[t][t]=0:i[t][t]=1/this.s[t];var o=this.U,a=this.rightSingularVectors,s=a.mmul(i),h=a.rows,l=o.length,u=Rt.zeros(h,l);for(let t=0;t<h;t++)for(let e=0;e<l;e++){let n=0;for(let i=0;i<r;i++)n+=s[t][i]*o[e][i];u[t][e]=n}return u.mmul(e)}solveForDiagonal(t){return this.solve(Rt.diag(t))}inverse(){var t=this.V,e=this.threshold,n=t.length,r=t[0].length,i=new Rt(n,this.s.length);for(let o=0;o<n;o++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e?i[o][n]=t[o][n]/this.s[n]:i[o][n]=0;var o=this.U,a=o.length,s=o[0].length,h=new Rt(n,a);for(let t=0;t<n;t++)for(let e=0;e<a;e++){let n=0;for(let r=0;r<s;r++)n+=i[t][r]*o[e][r];h[t][e]=n}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return Rt.isMatrix(this.U)||(this.U=new Rt(this.U)),this.U}get rightSingularVectors(){return Rt.isMatrix(this.V)||(this.V=new Rt(this.V)),this.V}get diagonalMatrix(){return Rt.diag(this.s)}}function st(t,e,n){var r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function ht(t,e,n){var r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function lt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function ut(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function ct(t,e,n){return{row:ft(t,e),column:dt(t,n)}}function ft(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function dt(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function mt(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(vt("startRow",e),vt("endRow",n),vt("startColumn",r),vt("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function pt(t){for(var e=Rt.zeros(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(n,0,e.get(n,0)+t.get(n,r));return e}function gt(t){for(var e=Rt.zeros(1,t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(0,r,e.get(0,r)+t.get(n,r));return e}function vt(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class bt extends(Ht()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return Rt}}class xt extends bt{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}class wt extends bt{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}class yt extends bt{constructor(t,e,n,r,i){mt(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class _t extends bt{constructor(t,e,n){var r=ct(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class Mt extends bt{constructor(t,e){super(t,(e=ft(t,e)).length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class Tt extends bt{constructor(t,e){e=dt(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class Et extends bt{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}class Lt extends bt{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class kt extends bt{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function Ht(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var a=0;a<e;a++){var s=Math.floor(r()*n);i.set(o,a,s)}return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=Math.min(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=Math.min(r,e,n),o=this.zeros(e,n),a=0;a<i;a++)o.set(a,a,t[a]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,Math.min(t.get(o,a),e.get(o,a)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var a=0;a<r;a++)i.set(o,a,Math.max(t.get(o,a),e.get(o,a)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}set(t,e,n){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){st(this,t);for(var e=new Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){st(this,t),e=lt(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){st(this,t),st(this,e);for(var n=0;n<this.columns;n++){var r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){ht(this,t);for(var e=new Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){ht(this,t),e=ut(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){ht(this,t),ht(this,e);for(var n=0;n<this.rows;n++){var r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){st(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){ht(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){st(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){st(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){st(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){st(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){ht(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){ht(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){ht(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){ht(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){switch(t){case"row":return pt(this);case"column":return gt(this);default:return function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)e+=this.get(n,r)*this.get(n,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var n=this.to1DArray();if(n.length!==t.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*t[i];return r}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=new Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)o[s]=t.get(s,a);for(var h=0;h<e;h++){var l=0;for(s=0;s<n;s++)l+=this.get(h,s)*o[s];i.set(h,a,l)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),a=this.get(1,0),s=t.get(1,0),h=this.get(1,1),l=t.get(1,1),u=(n+h)*(r+l),c=(a+h)*r,f=n*(o-l),d=h*(s-r),m=(n+i)*l,p=u+d-m+(i-h)*(s+l),g=f+m,v=c+d,b=u-c+f+(a-n)*(r+o);return e.set(0,0,p),e.set(0,1,g),e.set(1,0,v),e.set(1,1,b),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),a=this.get(1,1),s=this.get(1,2),h=this.get(2,0),l=this.get(2,1),u=this.get(2,2),c=t.get(0,0),f=t.get(0,1),d=t.get(0,2),m=t.get(1,0),p=t.get(1,1),g=t.get(1,2),v=t.get(2,0),b=t.get(2,1),x=t.get(2,2),w=(n-o)*(-f+p),y=(-n+o+a)*(c-f+p),_=(o+a)*(-c+f),M=n*c,T=(-n+h+l)*(c-d+g),E=(-n+h)*(d-g),L=(h+l)*(-c+d),k=(-i+l+u)*(p+v-b),H=(i-u)*(p-b),R=i*v,A=(l+u)*(-v+b),S=(-i+a+s)*(g+v-x),C=(i-s)*(g-x),$=(a+s)*(-v+x),P=M+R+r*m,j=(n+r+i-o-a-l-u)*p+y+_+M+k+R+A,I=M+T+L+(n+r+i-a-s-h-l)*g+R+S+$,F=w+a*(-c+f+m-p-g-v+x)+y+M+R+S+C,N=w+y+_+M+s*b,U=R+S+C+$+o*d,X=M+T+E+l*(-c+d+m-p-g-v+b)+k+H+R,q=k+H+R+A+h*f,D=M+T+E+L+u*x;return e.set(0,0,P),e.set(0,1,j),e.set(0,2,I),e.set(1,0,F),e.set(1,1,N),e.set(1,2,U),e.set(2,0,X),e.set(2,1,q),e.set(2,2,D),e}mmulStrassen(t){var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,a=t.columns;function s(t,n,r){var i=t.rows,o=t.columns;if(i===n&&o===r)return t;var a=e.zeros(n,r);return a=a.setSubMatrix(t,0,0)}i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${a} matrix: dimensions do not match.`);var h=Math.max(r,o),l=Math.max(i,a);return function t(n,r,i,o){if(i<=512||o<=512)return n.mmul(r);i%2==1&&o%2==1?(n=s(n,i+1,o+1),r=s(r,i+1,o+1)):i%2==1?(n=s(n,i+1,o),r=s(r,i+1,o)):o%2==1&&(n=s(n,i,o+1),r=s(r,i,o+1));var a=parseInt(n.rows/2,10),h=parseInt(n.columns/2,10),l=n.subMatrix(0,a-1,0,h-1),u=r.subMatrix(0,a-1,0,h-1),c=n.subMatrix(0,a-1,h,n.columns-1),f=r.subMatrix(0,a-1,h,r.columns-1),d=n.subMatrix(a,n.rows-1,0,h-1),m=r.subMatrix(a,r.rows-1,0,h-1),p=n.subMatrix(a,n.rows-1,h,n.columns-1),g=r.subMatrix(a,r.rows-1,h,r.columns-1),v=t(e.add(l,p),e.add(u,g),a,h),b=t(e.add(d,p),u,a,h),x=t(l,e.sub(f,g),a,h),w=t(p,e.sub(m,u),a,h),y=t(e.add(l,c),g,a,h),_=t(e.sub(d,l),e.add(u,f),a,h),M=t(e.sub(c,p),e.add(m,g),a,h),T=e.add(v,w);T.sub(y),T.add(M);var E=e.add(x,y),L=e.add(b,w),k=e.sub(v,b);k.add(x),k.add(_);var H=e.zeros(2*T.rows,2*T.columns);return(H=(H=(H=(H=H.setSubMatrix(T,0,0)).setSubMatrix(E,T.rows,0)).setSubMatrix(L,0,T.columns)).setSubMatrix(k,T.rows,T.columns)).subMatrix(0,i-1,0,o-1)}(n=s(n,h,l),t=s(t,h,l),h,l)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.rows;r++){var i=nt(this.getRow(r),{min:t,max:e});n.setRow(r,i)}return n}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.columns;r++){var i=nt(this.getColumn(r),{min:t,max:e});n.setColumn(r,i)}return n}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),a=0;a<e;a++)for(var s=0;s<n;s++)for(var h=0;h<r;h++)for(var l=0;l<i;l++)o[r*a+h][i*s+l]=this.get(a,s)*t.get(h,l);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){mt(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var a=n;a<=r;a++)i[o-t][a-n]=this.get(o,a);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){mt(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n=ct(this,t,e),r=new this.constructor[Symbol.species](t.length,e.length),i=0;i<n.row.length;i++)for(var o=n.row[i],a=0;a<n.column.length;a++){var s=n.column[a];r[i][a]=this.get(o,s)}return r}trace(){for(var t=Math.min(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new xt(this)}rowView(t){return st(this,t),new wt(this,t)}columnView(t){return ht(this,t),new Et(this,t)}flipRowView(){return new Lt(this)}flipColumnView(){return new kt(this)}subMatrixView(t,e,n,r){return new yt(this,t,e,n,r)}selectionView(t,e){return new _t(this,t,e)}rowSelectionView(t){return new Mt(this,t)}columnSelectionView(t){return new Tt(this,t)}det(){var t,e,n,r,i,o;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),o=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*o.det()):new rt(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new at(this,{autoTranspose:!0}),n=e.leftSingularVectors,r=e.rightSingularVectors,i=e.diagonal,o=0;o<i.length;o++)Math.abs(i[o])>t?i[o]=1/i[o]:i[o]=0;return i=this.constructor[Symbol.species].diag(i),r.mmul(i.mmul(n.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}}function n(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var r,i="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",o=eval;for(var a of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var s=o(T("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:a[1],op:a[0]})),h=o(T("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${a[1]}S`,op:a[0]})),l=o(T("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${a[1]}M`,op:a[0]})),u=o(T("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:a[1]}));for(r=1;r<a.length;r++)e.prototype[a[r]]=s,e.prototype[`${a[r]}S`]=h,e.prototype[`${a[r]}M`]=l,e[a[r]]=u}var c=[["~","not"]];for(var f of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){c.push([`Math.${t}`,t])})),c)){var d=o(T("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:f[1],method:f[0]})),m=o(T("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:f[1]}));for(r=1;r<f.length;r++)e.prototype[f[r]]=d,e[f[r]]=m}for(var p of[["Math.pow",1,"pow"]]){var g="arg0";for(r=1;r<p[1];r++)g+=`, arg${r}`;if(1!==p[1]){var v=o(T("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:p[2],method:p[0],args:g})),b=o(T(i,{name:p[2],args:g}));for(r=2;r<p.length;r++)e.prototype[p[r]]=v,e[p[r]]=b}else{var x={name:p[2],args:g,method:p[0]},w=o(T("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",x)),y=o(T("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",x)),_=o(T("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",x)),M=o(T("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",x));for(r=2;r<p.length;r++)e.prototype[p[r]]=w,e.prototype[`${p[r]}M`]=_,e.prototype[`${p[r]}S`]=y,e[p[r]]=M}}function T(t,e){for(var n in e)t=t.replace(new RegExp(`%${n}%`,"g"),e[n]);return t}return e}class Rt extends(Ht(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(Rt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}removeRow(t){if(st(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),st(this,t,!0),e=lt(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(ht(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),ht(this,t,!0),e=ut(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}Ht(),Symbol.species;class At extends(Ht()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return Rt}}class St{constructor(t){var e,n,r,i,o=(t=At.checkMatrix(t)).clone(),a=t.rows,s=t.columns,h=new Array(s);for(r=0;r<s;r++){var l=0;for(e=r;e<a;e++)l=it(l,o.get(e,r));if(0!==l){for(o.get(r,r)<0&&(l=-l),e=r;e<a;e++)o.set(e,r,o.get(e,r)/l);for(o.set(r,r,o.get(r,r)+1),n=r+1;n<s;n++){for(i=0,e=r;e<a;e++)i+=o.get(e,r)*o.get(e,n);for(i=-i/o.get(r,r),e=r;e<a;e++)o.set(e,n,o.get(e,n)+i*o.get(e,r))}}h[r]=-l}this.QR=o,this.Rdiag=h}solve(t){t=Rt.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,o,a,s=t.columns,h=t.clone(),l=e.columns;for(o=0;o<l;o++)for(i=0;i<s;i++){for(a=0,r=o;r<n;r++)a+=e[r][o]*h[r][i];for(a=-a/e[o][o],r=o;r<n;r++)h[r][i]+=a*e[r][o]}for(o=l-1;o>=0;o--){for(i=0;i<s;i++)h[o][i]/=this.Rdiag[o];for(r=0;r<o;r++)for(i=0;i<s;i++)h[r][i]-=h[o][i]*e[r][o]}return h.subMatrix(0,l-1,0,s-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,i=new Rt(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)i[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,n,r,i=this.QR,o=i.rows,a=i.columns,s=new Rt(o,a);for(n=a-1;n>=0;n--){for(t=0;t<o;t++)s[t][n]=0;for(s[n][n]=1,e=n;e<a;e++)if(0!==i[n][n]){for(r=0,t=n;t<o;t++)r+=i[t][n]*s[t][e];for(r=-r/i[n][n],t=n;t<o;t++)s[t][e]+=r*i[t][n]}}return s}}function Ct(t,e=!1){return t=At.checkMatrix(t),e?new at(t).inverse():$t(t,Rt.eye(t.rows))}function $t(t,e,n=!1){return t=At.checkMatrix(t),e=At.checkMatrix(e),n?new at(t).solve(e):t.isSquare()?new rt(t).solve(e):new St(t).solve(e)}class Pt{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=At.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var r,i,o=t.columns,a=ot(o,o,0),s=new Array(o),h=new Array(o),l=t;if(!!n||t.isSymmetric()){for(r=0;r<o;r++)for(i=0;i<o;i++)a[r][i]=l.get(r,i);!function(t,e,n,r){var i,o,a,s,h,l,u,c;for(h=0;h<t;h++)n[h]=r[t-1][h];for(s=t-1;s>0;s--){for(c=0,a=0,l=0;l<s;l++)c+=Math.abs(n[l]);if(0===c)for(e[s]=n[s-1],h=0;h<s;h++)n[h]=r[s-1][h],r[s][h]=0,r[h][s]=0;else{for(l=0;l<s;l++)n[l]/=c,a+=n[l]*n[l];for(i=n[s-1],o=Math.sqrt(a),i>0&&(o=-o),e[s]=c*o,a-=i*o,n[s-1]=i-o,h=0;h<s;h++)e[h]=0;for(h=0;h<s;h++){for(i=n[h],r[h][s]=i,o=e[h]+r[h][h]*i,l=h+1;l<=s-1;l++)o+=r[l][h]*n[l],e[l]+=r[l][h]*i;e[h]=o}for(i=0,h=0;h<s;h++)e[h]/=a,i+=e[h]*n[h];for(u=i/(a+a),h=0;h<s;h++)e[h]-=u*n[h];for(h=0;h<s;h++){for(i=n[h],o=e[h],l=h;l<=s-1;l++)r[l][h]-=i*e[l]+o*n[l];n[h]=r[s-1][h],r[s][h]=0}}n[s]=a}for(s=0;s<t-1;s++){if(r[t-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(l=0;l<=s;l++)n[l]=r[l][s+1]/a;for(h=0;h<=s;h++){for(o=0,l=0;l<=s;l++)o+=r[l][s+1]*r[l][h];for(l=0;l<=s;l++)r[l][h]-=o*n[l]}}for(l=0;l<=s;l++)r[l][s+1]=0}for(h=0;h<t;h++)n[h]=r[t-1][h],r[t-1][h]=0;r[t-1][t-1]=1,e[0]=0}(o,h,s,a),function(t,e,n,r){var i,o,a,s,h,l,u,c,f,d,m,p,g,v,b,x;for(a=1;a<t;a++)e[a-1]=e[a];e[t-1]=0;var w=0,y=0,_=Number.EPSILON;for(l=0;l<t;l++){for(y=Math.max(y,Math.abs(n[l])+Math.abs(e[l])),u=l;u<t&&!(Math.abs(e[u])<=_*y);)u++;if(u>l)do{for(i=n[l],f=it(c=(n[l+1]-i)/(2*e[l]),1),c<0&&(f=-f),n[l]=e[l]/(c+f),n[l+1]=e[l]*(c+f),d=n[l+1],o=i-n[l],a=l+2;a<t;a++)n[a]-=o;for(w+=o,c=n[u],p=m=1,g=m,v=e[l+1],b=0,x=0,a=u-1;a>=l;a--)for(g=p,p=m,x=b,i=m*e[a],o=m*c,f=it(c,e[a]),e[a+1]=b*f,b=e[a]/f,c=(m=c/f)*n[a]-b*i,n[a+1]=o+b*(m*i+b*n[a]),h=0;h<t;h++)o=r[h][a+1],r[h][a+1]=b*r[h][a]+m*o,r[h][a]=m*r[h][a]-b*o;c=-b*x*g*v*e[l]/d,e[l]=b*c,n[l]=m*c}while(Math.abs(e[l])>_*y);n[l]=n[l]+w,e[l]=0}for(a=0;a<t-1;a++){for(h=a,c=n[a],s=a+1;s<t;s++)n[s]<c&&(h=s,c=n[s]);if(h!==a)for(n[h]=n[a],n[a]=c,s=0;s<t;s++)c=r[s][a],r[s][a]=r[s][h],r[s][h]=c}}(o,h,s,a)}else{var u=ot(o,o,0),c=new Array(o);for(i=0;i<o;i++)for(r=0;r<o;r++)u[r][i]=l.get(r,i);!function(t,e,n,r){var i,o,a,s,h,l,u,c=0,f=t-1;for(l=c+1;l<=f-1;l++){for(u=0,s=l;s<=f;s++)u+=Math.abs(e[s][l-1]);if(0!==u){for(a=0,s=f;s>=l;s--)n[s]=e[s][l-1]/u,a+=n[s]*n[s];for(o=Math.sqrt(a),n[l]>0&&(o=-o),a-=n[l]*o,n[l]=n[l]-o,h=l;h<t;h++){for(i=0,s=f;s>=l;s--)i+=n[s]*e[s][h];for(i/=a,s=l;s<=f;s++)e[s][h]-=i*n[s]}for(s=0;s<=f;s++){for(i=0,h=f;h>=l;h--)i+=n[h]*e[s][h];for(i/=a,h=l;h<=f;h++)e[s][h]-=i*n[h]}n[l]=u*n[l],e[l][l-1]=u*o}}for(s=0;s<t;s++)for(h=0;h<t;h++)r[s][h]=s===h?1:0;for(l=f-1;l>=c+1;l--)if(0!==e[l][l-1]){for(s=l+1;s<=f;s++)n[s]=e[s][l-1];for(h=l;h<=f;h++){for(o=0,s=l;s<=f;s++)o+=n[s]*r[s][h];for(o=o/n[l]/e[l][l-1],s=l;s<=f;s++)r[s][h]+=o*n[s]}}}(o,u,c,a),function(t,e,n,r,i){var o,a,s,h,l,u,c,f,d,m,p,g,v,b,x,w=t-1,y=0,_=t-1,M=Number.EPSILON,T=0,E=0,L=0,k=0,H=0,R=0,A=0,S=0;for(o=0;o<t;o++)for((o<y||o>_)&&(n[o]=i[o][o],e[o]=0),a=Math.max(o-1,0);a<t;a++)E+=Math.abs(i[o][a]);for(;w>=y;){for(h=w;h>y&&(0===(R=Math.abs(i[h-1][h-1])+Math.abs(i[h][h]))&&(R=E),!(Math.abs(i[h][h-1])<M*R));)h--;if(h===w)i[w][w]=i[w][w]+T,n[w]=i[w][w],e[w]=0,w--,S=0;else if(h===w-1){if(c=i[w][w-1]*i[w-1][w],k=(L=(i[w-1][w-1]-i[w][w])/2)*L+c,A=Math.sqrt(Math.abs(k)),i[w][w]=i[w][w]+T,i[w-1][w-1]=i[w-1][w-1]+T,f=i[w][w],k>=0){for(A=L>=0?L+A:L-A,n[w-1]=f+A,n[w]=n[w-1],0!==A&&(n[w]=f-c/A),e[w-1]=0,e[w]=0,L=(f=i[w][w-1])/(R=Math.abs(f)+Math.abs(A)),k=A/R,L/=H=Math.sqrt(L*L+k*k),k/=H,a=w-1;a<t;a++)A=i[w-1][a],i[w-1][a]=k*A+L*i[w][a],i[w][a]=k*i[w][a]-L*A;for(o=0;o<=w;o++)A=i[o][w-1],i[o][w-1]=k*A+L*i[o][w],i[o][w]=k*i[o][w]-L*A;for(o=y;o<=_;o++)A=r[o][w-1],r[o][w-1]=k*A+L*r[o][w],r[o][w]=k*r[o][w]-L*A}else n[w-1]=f+L,n[w]=f+L,e[w-1]=A,e[w]=-A;w-=2,S=0}else{if(f=i[w][w],d=0,c=0,h<w&&(d=i[w-1][w-1],c=i[w][w-1]*i[w-1][w]),10===S){for(T+=f,o=y;o<=w;o++)i[o][o]-=f;f=d=.75*(R=Math.abs(i[w][w-1])+Math.abs(i[w-1][w-2])),c=-.4375*R*R}if(30===S&&(R=(R=(d-f)/2)*R+c)>0){for(R=Math.sqrt(R),d<f&&(R=-R),R=f-c/((d-f)/2+R),o=y;o<=w;o++)i[o][o]-=R;T+=R,f=d=c=.964}for(S+=1,l=w-2;l>=h&&(L=((H=f-(A=i[l][l]))*(R=d-A)-c)/i[l+1][l]+i[l][l+1],k=i[l+1][l+1]-A-H-R,H=i[l+2][l+1],L/=R=Math.abs(L)+Math.abs(k)+Math.abs(H),k/=R,H/=R,l!==h)&&!(Math.abs(i[l][l-1])*(Math.abs(k)+Math.abs(H))<M*(Math.abs(L)*(Math.abs(i[l-1][l-1])+Math.abs(A)+Math.abs(i[l+1][l+1]))));)l--;for(o=l+2;o<=w;o++)i[o][o-2]=0,o>l+2&&(i[o][o-3]=0);for(s=l;s<=w-1&&(b=s!==w-1,s!==l&&(L=i[s][s-1],k=i[s+1][s-1],H=b?i[s+2][s-1]:0,0!==(f=Math.abs(L)+Math.abs(k)+Math.abs(H))&&(L/=f,k/=f,H/=f)),0!==f);s++)if(R=Math.sqrt(L*L+k*k+H*H),L<0&&(R=-R),0!==R){for(s!==l?i[s][s-1]=-R*f:h!==l&&(i[s][s-1]=-i[s][s-1]),f=(L+=R)/R,d=k/R,A=H/R,k/=L,H/=L,a=s;a<t;a++)L=i[s][a]+k*i[s+1][a],b&&(L+=H*i[s+2][a],i[s+2][a]=i[s+2][a]-L*A),i[s][a]=i[s][a]-L*f,i[s+1][a]=i[s+1][a]-L*d;for(o=0;o<=Math.min(w,s+3);o++)L=f*i[o][s]+d*i[o][s+1],b&&(L+=A*i[o][s+2],i[o][s+2]=i[o][s+2]-L*H),i[o][s]=i[o][s]-L,i[o][s+1]=i[o][s+1]-L*k;for(o=y;o<=_;o++)L=f*r[o][s]+d*r[o][s+1],b&&(L+=A*r[o][s+2],r[o][s+2]=r[o][s+2]-L*H),r[o][s]=r[o][s]-L,r[o][s+1]=r[o][s+1]-L*k}}}if(0===E)return;for(w=t-1;w>=0;w--)if(L=n[w],0===(k=e[w]))for(h=w,i[w][w]=1,o=w-1;o>=0;o--){for(c=i[o][o]-L,H=0,a=h;a<=w;a++)H+=i[o][a]*i[a][w];if(e[o]<0)A=c,R=H;else if(h=o,0===e[o]?i[o][w]=0!==c?-H/c:-H/(M*E):(f=i[o][o+1],d=i[o+1][o],u=(f*R-A*H)/(k=(n[o]-L)*(n[o]-L)+e[o]*e[o]),i[o][w]=u,i[o+1][w]=Math.abs(f)>Math.abs(A)?(-H-c*u)/f:(-R-d*u)/A),M*(u=Math.abs(i[o][w]))*u>1)for(a=o;a<=w;a++)i[a][w]=i[a][w]/u}else if(k<0)for(h=w-1,Math.abs(i[w][w-1])>Math.abs(i[w-1][w])?(i[w-1][w-1]=k/i[w][w-1],i[w-1][w]=-(i[w][w]-L)/i[w][w-1]):(x=jt(0,-i[w-1][w],i[w-1][w-1]-L,k),i[w-1][w-1]=x[0],i[w-1][w]=x[1]),i[w][w-1]=0,i[w][w]=1,o=w-2;o>=0;o--){for(m=0,p=0,a=h;a<=w;a++)m+=i[o][a]*i[a][w-1],p+=i[o][a]*i[a][w];if(c=i[o][o]-L,e[o]<0)A=c,H=m,R=p;else if(h=o,0===e[o]?(x=jt(-m,-p,c,k),i[o][w-1]=x[0],i[o][w]=x[1]):(f=i[o][o+1],d=i[o+1][o],g=(n[o]-L)*(n[o]-L)+e[o]*e[o]-k*k,v=2*(n[o]-L)*k,0===g&&0===v&&(g=M*E*(Math.abs(c)+Math.abs(k)+Math.abs(f)+Math.abs(d)+Math.abs(A))),x=jt(f*H-A*m+k*p,f*R-A*p-k*m,g,v),i[o][w-1]=x[0],i[o][w]=x[1],Math.abs(f)>Math.abs(A)+Math.abs(k)?(i[o+1][w-1]=(-m-c*i[o][w-1]+k*i[o][w])/f,i[o+1][w]=(-p-c*i[o][w]-k*i[o][w-1])/f):(x=jt(-H-d*i[o][w-1],-R-d*i[o][w],A,k),i[o+1][w-1]=x[0],i[o+1][w]=x[1])),M*(u=Math.max(Math.abs(i[o][w-1]),Math.abs(i[o][w])))*u>1)for(a=o;a<=w;a++)i[a][w-1]=i[a][w-1]/u,i[a][w]=i[a][w]/u}for(o=0;o<t;o++)if(o<y||o>_)for(a=o;a<t;a++)r[o][a]=i[o][a];for(a=t-1;a>=y;a--)for(o=y;o<=_;o++){for(A=0,s=y;s<=Math.min(a,_);s++)A+=r[o][s]*i[s][a];r[o][a]=A}}(o,h,s,a,u)}this.n=o,this.e=h,this.d=s,this.V=a}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return Rt.isMatrix(this.V)||(this.V=new Rt(this.V)),this.V}get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new Rt(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],r[t]>0?o[t][t+1]=r[t]:r[t]<0&&(o[t][t-1]=r[t])}return o}}function jt(t,e,n,r){var i,o;return Math.abs(n)>Math.abs(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}class It{constructor(t){if(!(t=At.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,r,i=t,o=i.rows,a=new Rt(o,o),s=!0;for(n=0;n<o;n++){var h=a[n],l=0;for(r=0;r<n;r++){var u=a[r],c=0;for(e=0;e<r;e++)c+=u[e]*h[e];h[r]=c=(i.get(n,r)-c)/a[r][r],l+=c*c}for(s&=(l=i.get(n,n)-l)>0,a[n][n]=Math.sqrt(Math.max(l,0)),r=n+1;r<o;r++)a[n][r]=0}if(!s)throw new Error("Matrix is not positive definite");this.L=a}solve(t){t=At.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,i,o,a=t.columns,s=t.clone();for(o=0;o<n;o++)for(i=0;i<a;i++){for(r=0;r<o;r++)s[o][i]-=s[r][i]*e[o][r];s[o][i]/=e[o][o]}for(o=n-1;o>=0;o--)for(i=0;i<a;i++){for(r=o+1;r<n;r++)s[o][i]-=s[r][i]*e[r][o];s[o][i]/=e[o][o]}return s}get lowerTriangularMatrix(){return this.L}}var Ft="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Nt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}function Ut(t){var e={exports:{}};return t(e,e.exports),e.exports}var Xt={func:Symbol("func"),validate:Symbol("validate")};const{func:qt}=Xt;var Dt={predicates:{positive:t=>t>0,negative:t=>t<0,nonNegative:t=>t>=0,integer:t=>t===(0|t),[qt]:{is:t=>t,eq:t=>e=>e===t,gt:t=>e=>e>t,gte:t=>e=>e>=t,lt:t=>e=>e<t,lte:t=>e=>e<=t}},validator:t=>"number"==typeof t};const{func:zt}=Xt;var Ot={predicates:{empty:t=>""===t,nonEmpty:t=>""!==t,[zt]:{is:t=>t,eq:t=>e=>e===t,length:t=>e=>e.length===t,minLength:t=>e=>e.length>=t,maxLength:t=>e=>e.length<=t,matches:t=>e=>t.test(e),startsWith:t=>e=>e.startsWith(t),endsWith:t=>e=>e.endsWith(t)}},validator:t=>"string"==typeof t};const{func:Vt}=Xt;const Kt={number:Dt,string:Ot,object:{predicates:{plain:t=>{if("object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.getPrototypeOf({})},empty:t=>0===Object.keys(t).length,nonEmpty:t=>Object.keys(t).length>0,[Vt]:{is:t=>t,instanceOf:t=>e=>e instanceof t}},validator:t=>"object"==typeof t}},Bt=({validators:t=[],predicates:e=Kt,type:n=null}={})=>{const r=new Proxy((function(){}),{get:(i,o)=>{if(o===Xt.validate)return(e,r="argument")=>{if(!n)return new Error("missing required type specifier");for(let i=0;i<t.length;++i){const o=t[i];if(!o.fn(e))throw 0===i?new Error(`Expected ${r} \`${e}\` to be of type \`${n}\`, but received type \`${typeof e}\``):new Error(`Expected ${n} \`${r}\` \`${e}\` failed predicate \`${o.key}\``)}};const a=e[o];if(a)return"function"==typeof a?(t.push({key:o,fn:a}),r):Bt({type:o,validators:[{key:o,fn:a.validator}],predicates:a.predicates});{const n=e[Xt.func]&&e[Xt.func][o];return n?new Proxy((function(){}),{get:()=>{throw new Error(`invalid use of functional predicate "${o}"`)},apply:(e,i,a)=>(t.push({key:o,fn:n(...a)}),r)}):r}},apply:(t,e,n)=>{if(2!==n.length&&3!==n.length)throw new Error('invalid number of arguments to "ow"');n[1][Xt.validate](n[0],n[2])}});return r};var Gt=Bt(),Wt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Wt(t,[{key:"next",value:function(){throw new Error("RNG.next must be overridden")}},{key:"seed",value:function(t,e){throw new Error("RNG.seed must be overridden")}},{key:"clone",value:function(t,e){throw new Error("RNG.clone must be overridden")}},{key:"_seed",value:function(t,e){if(t===(0|t))return t;for(var n=""+t,r=0,i=0;i<n.length;++i)r^=0|n.charCodeAt(i);return r}},{key:"name",get:function(){throw new Error("RNG.name must be overridden")}}]),t}(),Qt=Object.defineProperty({default:Yt},"__esModule",{value:!0}),Jt=Ut((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.alea=o}(0,t,!1)})),Zt=Ut((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor128=o}(0,t,!1)})),te=Ut((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorwow=o}(0,t,!1)})),ee=Ut((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.x&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorshift7=o}(0,t,!1)})),ne=Ut((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],h=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,h=Math.max(h,e.length)),i=0,o=-32;o<h;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=a,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.X&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor4096=o}(0,t,!1)})),re=Ut((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.tychei=o}(0,t,!1)})),ie=Nt(Object.freeze({__proto__:null,default:{}})),oe=Ut((function(t){!function(e,n,r){var i,o=256,a=r.pow(o,6),s=r.pow(2,52),h=2*s,l=255;function u(t,l,u){var g=[],v=m(d((l=1==l?{entropy:!0}:l||{}).entropy?[t,p(n)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),p(t)}catch(t){var r=e.navigator,a=r&&r.plugins;return[+new Date,e,a,e.screen,p(n)]}}():t,3),g),b=new c(g),x=function(){for(var t=b.g(6),e=a,n=0;t<s;)t=(t+n)*o,e*=o,n=b.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,m(p(b.S),n),(l.pass||u||function(t,e,n,i){return i&&(i.S&&f(i,b),t.state=function(){return f(b,{})}),n?(r.random=t,e):t})(x,v,"global"in l?l.global:this==r,l.state)}function c(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<o;)s[i]=i++;for(i=0;i<o;i++)s[i]=s[a=l&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=l&i+1],n=n*o+s[l&(s[i]=s[a=l&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(o)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(d(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[l&i]=l&(n^=19*e[l&i])+r.charCodeAt(i++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),n),t.exports){t.exports=u;try{i=ie}catch(t){}}else r.seedrandom=u}("undefined"!=typeof self?self:Ft,[],Math)}));oe.alea=Jt,oe.xor128=Zt,oe.xorwow=te,oe.xorshift7=ee,oe.xor4096=ne,oe.tychei=re;var ae=oe,se=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),he=le(Gt);function le(t){return t&&t.__esModule?t:{default:t}}var ue=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.seed(t,n),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),se(e,[{key:"next",value:function(){return this._rng()}},{key:"seed",value:function(t){(0,he.default)(t,he.default.function),this._rng=t}},{key:"clone",value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return new(Function.prototype.bind.apply(e,[null].concat([this._rng],n)))}},{key:"name",get:function(){return"function"}}]),e}(le(Qt).default),ce=Object.defineProperty({default:ue},"__esModule",{value:!0}),fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de=ge(ae),me=ge(Qt),pe=ge(ce);function ge(t){return t&&t.__esModule?t:{default:t}}function ve(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var be,xe=Object.defineProperty({default:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=void 0===r?"default":r,o=e.slice(1);switch(void 0===i?"undefined":fe(i)){case"object":if(i instanceof me.default)return i;break;case"function":return new pe.default(i);case"string":case"number":return new pe.default(de.default.apply(void 0,ve(o)))}throw new Error('invalid RNG "'+i+'"')}},"__esModule",{value:!0}),we=(be=Gt)&&be.__esModule?be:{default:be};var ye=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,we.default)(e,we.default.number),(0,we.default)(n,we.default.number),function(){return t.next()*(n-e)+e}}},"__esModule",{value:!0}),_e=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Me=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,_e.default)(e,_e.default.number.integer),(0,_e.default)(n,_e.default.number.integer),function(){return t.next()*(n-e+1)+e|0}}},"__esModule",{value:!0}),Te=Object.defineProperty({default:function(t){return function(){return t.next()>=.5}}},"__esModule",{value:!0}),Ee=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Le=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Ee.default)(e,Ee.default.number),(0,Ee.default)(n,Ee.default.number),function(){var r=void 0,i=void 0,o=void 0;do{o=(r=2*t.next()-1)*r+(i=2*t.next()-1)*i}while(!o||o>1);return e+n*i*Math.sqrt(-2*Math.log(o)/o)}}},"__esModule",{value:!0}),ke=Object.defineProperty({default:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=t.normal.apply(t,n);return function(){return Math.exp(i())}}},"__esModule",{value:!0}),He=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Re=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,He.default)(e,He.default.number.gte(0).lt(1)),function(){return t.next()+e|0}}},"__esModule",{value:!0}),Ae=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Se=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return(0,Ae.default)(e,Ae.default.number.positive.integer),(0,Ae.default)(n,Ae.default.number.gte(0).lte(1)),function(){for(var r=0,i=0;r++<e;)i+=t.next()<n;return i}}},"__esModule",{value:!0}),Ce=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var $e=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;(0,Ce.default)(e,Ce.default.number.gt(0).lte(1));var n=1/Math.log(1-e);return function(){return 1+Math.log(t.next())*n|0}}},"__esModule",{value:!0}),Pe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var je=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Ie=function(t){return je[t]},Fe=.9189385332046727,Ne=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,Pe.default)(e,Pe.default.number.positive),e<10){var n=Math.exp(-e);return function(){for(var r=n,i=0,o=t.next();o>r;)o-=r,r=e*r/++i;return i}}var r=Math.sqrt(e),i=.931+2.53*r,o=.02483*i-.059,a=1.1239+1.1328/(i-3.4),s=.9277-3.6224/(i-2);return function(){for(;;){var n=void 0,h=t.next();if(h<=.86*s)return n=h/s-.43,Math.floor((2*o/(.5-Math.abs(n))+i)*n+e+.445);h>=s?n=t.next()-.5:(n=((n=h/s-.93)<0?-.5:.5)-n,h=t.next()*s);var l=.5-Math.abs(n);if(!(l<.013&&h>l)){var u=0|Math.floor((2*o/l+i)*n+e+.445);if(h=h*a/(o/(l*l)+i),u>=10){var c=(u+.5)*Math.log(e/u)-e-Fe+u-(1/12-(1/360-1/(1260*u*u))/(u*u))/u;if(Math.log(h*r)<=c)return u}else if(u>=0&&Math.log(h)<=u*Math.log(e)-e-Ie(u))return u}}}}},"__esModule",{value:!0}),Ue=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Xe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Ue.default)(e,Ue.default.number.positive),function(){return-Math.log(1-t.next())/e}}},"__esModule",{value:!0}),qe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var De=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,qe.default)(e,qe.default.number.integer.gte(0)),function(){for(var n=0,r=0;r<e;++r)n+=t.next();return n}}},"__esModule",{value:!0}),ze=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Oe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,ze.default)(e,ze.default.number.integer.positive);var n=t.irwinHall(e);return function(){return n()/e}}},"__esModule",{value:!0}),Ve=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Ke=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Ve.default)(e,Ve.default.number.gte(0));var n=1/e;return function(){return 1/Math.pow(1-t.next(),n)}}},"__esModule",{value:!0}),Be=Ut((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RNGFactory=e.RNG=void 0;var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=x(Gt),i=x(Qt),o=x(xe),a=x(ye),s=x(Me),h=x(Te),l=x(Le),u=x(ke),c=x(Re),f=x(Se),d=x($e),m=x(Ne),p=x(Xe),g=x(De),v=x(Oe),b=x(Ke);function x(t){return t&&t.__esModule?t:{default:t}}e.RNG=i.default,e.RNGFactory=o.default;var w=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(0,r.default)(e,r.default.object.instanceOf(i.default)),this._cache={},this.use(e)}return n(t,[{key:"clone",value:function(){return new t(arguments.length?o.default.apply(void 0,arguments):this.rng.clone())}},{key:"use",value:function(){this._rng=o.default.apply(void 0,arguments)}},{key:"patch",value:function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}},{key:"unpatch",value:function(){this._patch&&(Math.random=this._patch,delete this._patch)}},{key:"next",value:function(){return this._rng.next()}},{key:"float",value:function(t,e){return this.uniform(t,e)()}},{key:"int",value:function(t,e){return this.uniformInt(t,e)()}},{key:"integer",value:function(t,e){return this.uniformInt(t,e)()}},{key:"bool",value:function(){return this.uniformBoolean()()}},{key:"boolean",value:function(){return this.uniformBoolean()()}},{key:"uniform",value:function(t,e){return this._memoize("uniform",a.default,t,e)}},{key:"uniformInt",value:function(t,e){return this._memoize("uniformInt",s.default,t,e)}},{key:"uniformBoolean",value:function(){return this._memoize("uniformBoolean",h.default)}},{key:"normal",value:function(t,e){return(0,l.default)(this,t,e)}},{key:"logNormal",value:function(t,e){return(0,u.default)(this,t,e)}},{key:"bernoulli",value:function(t){return(0,c.default)(this,t)}},{key:"binomial",value:function(t,e){return(0,f.default)(this,t,e)}},{key:"geometric",value:function(t){return(0,d.default)(this,t)}},{key:"poisson",value:function(t){return(0,m.default)(this,t)}},{key:"exponential",value:function(t){return(0,p.default)(this,t)}},{key:"irwinHall",value:function(t){return(0,g.default)(this,t)}},{key:"bates",value:function(t){return(0,v.default)(this,t)}},{key:"pareto",value:function(t){return(0,b.default)(this,t)}},{key:"_memoize",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=""+r.join(";"),a=this._cache[t];return void 0!==a&&a.key===o||(a={key:o,distribution:e.apply(void 0,[this].concat(r))},this._cache[t]=a),a.distribution}},{key:"rng",get:function(){return this._rng}}]),t}();e.default=new w})).default;class Ge{constructor(t,e){t instanceof Rt&&e instanceof Rt?(this.mean=t,this.cov=e):(this.mean=new Rt([t]).transpose(),this.cov=new Rt(e))}at(t){const e=new Rt([t]).transpose().sub(this.mean);return e.transpose().mmul(Ct(this.cov)).mmul(e).mul(-.5).exp()*(1/Math.sqrt(Math.pow(2*Math.PI,this.mean.rows)*this.cov.det()))}marginalize(t){const e=We(this.mean,0,0,t,1),n=We(this.mean,t,0,this.mean.rows,1),r=We(this.cov,0,0,t,t),i=We(this.cov,t,t,this.mean.rows,this.mean.rows);return[new Ge(e,r),new Ge(n,i)]}condition(t){const e=t.length,n=new Rt([t]).transpose(),r=We(this.cov,0,0,e,e),i=We(this.cov,0,e,e,this.mean.rows),o=i.transpose(),a=We(this.cov,e,e,this.mean.rows,this.mean.rows),s=new It(r).lowerTriangularMatrix,h=$t(s,n),l=$t(s,i).transpose().mmul(h),u=a.sub(o.mmul(Ct(r)).mmul(i));return new Ge(l,u)}transformationMatrix(){const t=new Pt(this.cov),e=t.eigenvectorMatrix,n=Rt.zeros(e.rows,e.columns);for(let e=0;e<n.rows;++e)n.set(e,e,Math.sqrt(t.realEigenvalues[e]));return e.mmul(n)}sample(){const t=Rt.zeros(this.mean.rows,1),e=Be.normal();for(let n=0;n<this.mean.rows;++n)t.set(n,0,e());return Rt.add(this.mean,this.transformationMatrix().mmul(t))}getMean(){return this.mean.transpose()[0]}getSd(){return this.cov.diag().map((t=>Math.sqrt(t)))}}function We(t,e,n,r,i){const o=new Rt(r-e,i-n);for(let a=e;a<r;++a)for(let r=n;r<i;++r)o.set(a-e,r-n,t.get(a,r));return o}class Ye{constructor(){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0])}call(t,e){return this.g.at([t-e])*this.scale}inv0(t){var e=this.get_sigma2(),n=t/this.scale;const r=Math.sqrt(2*e*Math.PI),i=-2*e;return Math.sqrt(i*Math.log(n*r))}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,n){return[]}}class Qe{constructor(t){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0]),this.cut_size=t}call(t,e){var n=this.cut_size,r=Math.floor(e/n),i=e-r*n;return 1==Math.abs(r%2)&&(e+=n-2*i),this.g.at([e-t])*this.scale}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,n){for(var r=e,i=[];r<n;)i.push(r),r+=this.cut_size;return i}}function Je(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ze(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>Je(t(e),n)}(t)),{left:r,center:function(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const a=r(t,n,i,o-1);return a>i&&e(t[a-1],n)>-e(t[a],n)?a-1:a},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}}const tn=Ze(Je).right;Ze((function(t){return null===t?NaN:+t})).center;var en=Math.sqrt(50),nn=Math.sqrt(10),rn=Math.sqrt(2);function on(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=en?10:o>=nn?5:o>=rn?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=en?10:o>=nn?5:o>=rn?2:1)}function an(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function sn(t){if(!(i=t.length))return[];for(var e=-1,n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}(t,hn),r=new Array(n);++e<n;)for(var i,o=-1,a=r[e]=new Array(i);++o<i;)a[o]=t[o][e];return r}function hn(t){return t.length}function ln(){return sn(arguments)}function un(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function cn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function fn(){}var dn=.7,mn=1/dn,pn="\\s*([+-]?\\d+)\\s*",gn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",vn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bn=/^#([0-9a-f]{3,8})$/,xn=new RegExp("^rgb\\("+[pn,pn,pn]+"\\)$"),wn=new RegExp("^rgb\\("+[vn,vn,vn]+"\\)$"),yn=new RegExp("^rgba\\("+[pn,pn,pn,gn]+"\\)$"),_n=new RegExp("^rgba\\("+[vn,vn,vn,gn]+"\\)$"),Mn=new RegExp("^hsl\\("+[gn,vn,vn]+"\\)$"),Tn=new RegExp("^hsla\\("+[gn,vn,vn,gn]+"\\)$"),En={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ln(){return this.rgb().formatHex()}function kn(){return this.rgb().formatRgb()}function Hn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=bn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Rn(e):3===n?new $n(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?An(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?An(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=xn.exec(t))?new $n(e[1],e[2],e[3],1):(e=wn.exec(t))?new $n(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=yn.exec(t))?An(e[1],e[2],e[3],e[4]):(e=_n.exec(t))?An(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Mn.exec(t))?Fn(e[1],e[2]/100,e[3]/100,1):(e=Tn.exec(t))?Fn(e[1],e[2]/100,e[3]/100,e[4]):En.hasOwnProperty(t)?Rn(En[t]):"transparent"===t?new $n(NaN,NaN,NaN,0):null}function Rn(t){return new $n(t>>16&255,t>>8&255,255&t,1)}function An(t,e,n,r){return r<=0&&(t=e=n=NaN),new $n(t,e,n,r)}function Sn(t){return t instanceof fn||(t=Hn(t)),t?new $n((t=t.rgb()).r,t.g,t.b,t.opacity):new $n}function Cn(t,e,n,r){return 1===arguments.length?Sn(t):new $n(t,e,n,null==r?1:r)}function $n(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Pn(){return"#"+In(this.r)+In(this.g)+In(this.b)}function jn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function In(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Fn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Un(t,e,n,r)}function Nn(t){if(t instanceof Un)return new Un(t.h,t.s,t.l,t.opacity);if(t instanceof fn||(t=Hn(t)),!t)return new Un;if(t instanceof Un)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,h=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=h<.5?o+i:2-o-i,a*=60):s=h>0&&h<1?0:a,new Un(a,s,h,t.opacity)}function Un(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Xn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}un(fn,Hn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Ln,formatHex:Ln,formatHsl:function(){return Nn(this).formatHsl()},formatRgb:kn,toString:kn}),un($n,Cn,cn(fn,{brighter:function(t){return t=null==t?mn:Math.pow(mn,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?dn:Math.pow(dn,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pn,formatHex:Pn,formatRgb:jn,toString:jn})),un(Un,(function(t,e,n,r){return 1===arguments.length?Nn(t):new Un(t,e,n,null==r?1:r)}),cn(fn,{brighter:function(t){return t=null==t?mn:Math.pow(mn,t),new Un(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?dn:Math.pow(dn,t),new Un(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new $n(Xn(t>=240?t-240:t+120,i,r),Xn(t,i,r),Xn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var qn=t=>()=>t;function Dn(t){return 1==(t=+t)?zn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):qn(isNaN(e)?n:e)}}function zn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):qn(isNaN(t)?e:t)}var On=function t(e){var n=Dn(e);function r(t,e){var r=n((t=Cn(t)).r,(e=Cn(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=zn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function Vn(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Kn(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Zn(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}function Bn(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Gn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Wn(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Zn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var Yn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qn=new RegExp(Yn.source,"g");function Jn(t,e){var n,r,i,o=Yn.lastIndex=Qn.lastIndex=0,a=-1,s=[],h=[];for(t+="",e+="";(n=Yn.exec(t))&&(r=Qn.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,h.push({i:a,x:Gn(n,r)})),o=Qn.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var n,r=0;r<e;++r)s[(n=h[r]).i]=n.x(t);return s.join("")})}function Zn(t,e){var n,r=typeof e;return null==e||"boolean"===r?qn(e):("number"===r?Gn:"string"===r?(n=Hn(e))?(e=n,On):Jn:e instanceof Hn?On:e instanceof Date?Bn:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Vn:Array.isArray(e)?Kn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Wn:Gn)(t,e)}function tr(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}const er=Math.PI,nr=2*er,rr=1e-6,ir=nr-rr;function or(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ar(){return new or}function sr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function hr(t){return(t=sr(Math.abs(t)))?t[1]:NaN}or.prototype=ar.prototype={constructor:or,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,h=r-e,l=o-t,u=a-e,c=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>rr)if(Math.abs(u*s-h*l)>rr&&i){var f=n-o,d=r-a,m=s*s+h*h,p=f*f+d*d,g=Math.sqrt(m),v=Math.sqrt(c),b=i*Math.tan((er-Math.acos((m+c-p)/(2*g*v)))/2),x=b/v,w=b/g;Math.abs(x-1)>rr&&(this._+="L"+(t+x*l)+","+(e+x*u)),this._+="A"+i+","+i+",0,0,"+ +(u*f>l*d)+","+(this._x1=t+w*s)+","+(this._y1=e+w*h)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),h=t+a,l=e+s,u=1^o,c=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+h+","+l:(Math.abs(this._x1-h)>rr||Math.abs(this._y1-l)>rr)&&(this._+="L"+h+","+l),n&&(c<0&&(c=c%nr+nr),c>ir?this._+="A"+n+","+n+",0,1,"+u+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=h)+","+(this._y1=l):c>rr&&(this._+="A"+n+","+n+",0,"+ +(c>=er)+","+u+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var lr,ur=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cr(t){if(!(e=ur.exec(t)))throw new Error("invalid format: "+t);var e;return new fr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function fr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function dr(t,e){var n=sr(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}cr.prototype=fr.prototype,fr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var mr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>dr(100*t,e),r:dr,s:function(t,e){var n=sr(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(lr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+sr(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function pr(t){return t}var gr,vr,br,xr=Array.prototype.map,wr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function yr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?pr:(e=xr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],h=0;i>0&&s>0&&(h+s+1>r&&(s=Math.max(1,r-h)),o.push(t.substring(i-=s,i+s)),!((h+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?pr:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(xr.call(t.numerals,String)),h=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=cr(t)).fill,n=t.align,c=t.sign,f=t.symbol,d=t.zero,m=t.width,p=t.comma,g=t.precision,v=t.trim,b=t.type;"n"===b?(p=!0,b="g"):mr[b]||(void 0===g&&(g=12),v=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===f?o:/[%p]/.test(b)?h:"",y=mr[b],_=/[defgprs%]/.test(b);function M(t){var i,o,h,f=x,M=w;if("c"===b)M=y(t)+M,t="";else{var T=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:y(Math.abs(t),g),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),T&&0==+t&&"+"!==c&&(T=!1),f=(T?"("===c?c:l:"-"===c||"("===c?"":c)+f,M=("s"===b?wr[8+lr/3]:"")+M+(T&&"("===c?")":""),_)for(i=-1,o=t.length;++i<o;)if(48>(h=t.charCodeAt(i))||h>57){M=(46===h?a+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}p&&!d&&(t=r(t,1/0));var E=f.length+t.length+M.length,L=E<m?new Array(m-E+1).join(e):"";switch(p&&d&&(t=r(L+t,L.length?m-M.length:1/0),L=""),n){case"<":t=f+t+M+L;break;case"=":t=f+L+t+M;break;case"^":t=L.slice(0,E=L.length>>1)+f+t+M+L.slice(E);break;default:t=L+f+t+M}return s(t)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,e){var n=c(((t=cr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(hr(e)/3))),i=Math.pow(10,-r),o=wr[8+r/3];return function(t){return n(i*t)+o}}}}function _r(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Mr(t){return+t}gr=yr({thousands:",",grouping:[3],currency:["$",""]}),vr=gr.format,br=gr.formatPrefix;var Tr=[0,1];function Er(t){return t}function Lr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function kr(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Lr(i,r),o=n(a,o)):(r=Lr(r,i),o=n(o,a)),function(t){return o(r(t))}}function Hr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Lr(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=tn(t,e,1,r)-1;return o[n](i[n](e))}}function Rr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ar(){var t,e,n,r,i,o,a=Tr,s=Tr,h=Zn,l=Er;function u(){var t,e,n,h=Math.min(a.length,s.length);return l!==Er&&(t=a[0],e=a[h-1],t>e&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),r=h>2?Hr:kr,i=o=null,c}function c(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),s,h)))(t(l(e)))}return c.invert=function(n){return l(e((o||(o=r(s,a.map(t),Gn)))(n)))},c.domain=function(t){return arguments.length?(a=Array.from(t,Mr),u()):a.slice()},c.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},c.rangeRound=function(t){return s=Array.from(t),h=tr,u()},c.clamp=function(t){return arguments.length?(l=!!t||Er,u()):l!==Er},c.interpolate=function(t){return arguments.length?(h=t,u()):h},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,u()}}function Sr(){return Ar()(Er,Er)}function Cr(t,e,n,r){var i,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=en?i*=10:o>=nn?i*=5:o>=rn&&(i*=2),e<t?-i:i}(t,e,n);switch((r=cr(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(hr(e)/3)))-hr(Math.abs(t)))}(o,a))||(r.precision=i),br(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,hr(e)-hr(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-hr(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return vr(r)}function $r(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=on(t,e,n))||!isFinite(a))return[];if(a>0){let n=Math.round(t/a),r=Math.round(e/a);for(n*a<t&&++n,r*a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)*a}else{a=-a;let n=Math.round(t*a),r=Math.round(e*a);for(n/a<t&&++n,r/a>e&&--r,o=new Array(i=r-n+1);++s<i;)o[s]=(n+s)/a}return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Cr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,s=o.length-1,h=o[a],l=o[s],u=10;for(l<h&&(i=h,h=l,l=i,i=a,a=s,s=i);u-- >0;){if((i=on(h,l,n))===r)return o[a]=h,o[s]=l,e(o);if(i>0)h=Math.floor(h/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;h=Math.ceil(h*i)/i,l=Math.floor(l*i)/i}r=i}return t},t}function Pr(){var t=Sr();return t.copy=function(){return Rr(t,Pr())},_r.apply(t,arguments),$r(t)}function jr(t){return function(){return t}}function Ir(t){this._context=t}function Fr(t){return new Ir(t)}function Nr(t){return t[0]}function Ur(t){return t[1]}function Xr(t,e){var n=jr(!0),r=null,i=Fr,o=null;function a(a){var s,h,l,u=(a=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(a)).length,c=!1;for(null==r&&(o=i(l=ar())),s=0;s<=u;++s)!(s<u&&n(h=a[s],s,a))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+t(h,s,a),+e(h,s,a));if(l)return o=null,l+""||null}return t="function"==typeof t?t:void 0===t?Nr:jr(t),e="function"==typeof e?e:void 0===e?Ur:jr(e),a.x=function(e){return arguments.length?(t="function"==typeof e?e:jr(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:jr(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:jr(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}Ir.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};class qr{constructor(t,e){this.touch=0,this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width,this.unitToAlpha=Pr().domain([0,1]).range([-5,5]),this.n=e,this.kernels=[null,null],this.kernels[0]=new Ye,this.kernels[1]=new Qe(2),this.active_ker=0,this.K=Rt.zeros(this.n,this.n),this.invK=Rt.zeros(this.n,this.n),this.validInv=!0,this.curveCache=null,this.xCache=null,this.populate()}get_xrange(){return[this.ctx.xmin,this.ctx.xmax]}initK(){var t,e=this.n;this.K=Rt.zeros(this.n,this.n);for(let n=0;n!=e;n++)for(let r=0;r!=e;r++)t=this.kernel(this.mu[n],this.x[r]),this.K.set(n,r,t);this.initInvK()}initInvK(){try{var t=Ct(this.K);this.invK=t,this.validInv=!0}catch(t){console.log("could not invert K.  leaving as-is"),this.validInv=!1}}initXCache(){var t,e=[this.ctx.xmin,this.ctx.xmax];for(let t=0;t!=this.n;t++)e.push(...this.jumps(this.x[t]));e.sort(((t,e)=>t-e)),this.xCache=new Array(0);for(let n=0;n!=e.length-1;n++)t=an(e[n],e[n+1],.0125),this.xCache.push(t)}initCurveCache(){var t=this.n;this.initXCache(),this.curveCache=new Array(t);for(let e=0;e!=t;e++)this.updateCurveCache(e)}updateCurveCache(t){var e;this.curveCache[t]=new Array;for(let n=0;n!=this.xCache.length;n++)e=this.xCache[n].map((e=>this.kernel(this.mu[t],e))),this.curveCache[t].push(...e)}toggle_scramble(){this.active_ker=1-this.active_ker,this.initK(),this.initCurveCache()}scrambled(){return 1==this.active_ker}cut_size(){return 2}resetAlpha(){this.alpha.fill(1)}set_sigma(t){for(let e=0;e!=this.kernels.length;e++)this.kernels[e].set_sigma(Math.pow(10,t));for(let t=0;t!=this.n;t++)this.updateCurveCache(t);this.initK()}recenter_mu(){for(let t=0;t!=this.n;t++)this.mu[t]=this.x[t];this.initK(),this.initInvK(),this.initCurveCache()}get_sigma2(){return this.kernels[this.active_ker].get_sigma2()}populate(){var t=this.n;this.x=new Array(t),this.y=new Array(t),this.mu=new Array(t),this.alpha=new Array(t);for(let e=0;e!=t;e++)this.x[e]=this.ctx.unitToX(Math.random()),this.mu[e]=this.x[e],this.alpha[e]=this.unitToAlpha(Math.random());this.initK(),this.initCurveCache();for(let e=0;e!=t;e++)this.y[e]=this.solutionPoint(e);this.alpha.fill(1)}setDataPoint(t,e,n){this.x[t]=this.ctx.x(e),this.y[t]=this.ctx.y(n),this.initK(),this.initInvK(),this.updateCurveCache(t)}setMu(t,e){this.mu[t]=this.ctx.x(e),this.initK(),this.initInvK(),this.updateCurveCache(t)}kernel(t,e){return this.kernels[this.active_ker].call(t,e)}kernelInv0(t){return this.kernels[this.active_ker].inv0(t)}jumps(t){return this.kernels[this.active_ker].cuts(t,this.ctx.xmin,this.ctx.xmax)}solutionAlpha(){return new Rt([this.y]).mmul(this.invK).flat()}functionNorm(){var t,e=new Rt([this.alpha]),n=this.n,r=Rt.zeros(this.n,this.n);for(let e=0;e!=n;e++)for(let i=0;i!=n;i++)t=this.kernel(this.mu[e],this.mu[i]),r.set(e,i,t),r.set(i,e,t);var i=e.mmul(r).mmul(e.transpose()).flat()[0];return Math.sqrt(i)}resize(t,e){this.ctx.setWidth(t),this.ctx.setHeight(e),this.width=this.ctx.width,this.height=this.ctx.height}updateContext(t){this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width}addPoint(){this.n++,this.populate()}delPoint(){0!=this.n&&(this.n--,this.populate())}updateAlpha(t,e){this.alpha[e]+=t}makeLine(t,e){return Xr().x((t=>this.ctx.u(t[0]))).y((t=>this.ctx.v(t[1])))(ln(t,e))||""}makeLines(t){var e,n,r="",i=0;for(let o=0;o!=this.xCache.length;o++)n=(e=this.xCache[o]).length,r+=this.makeLine(e,t.slice(i,i+n)),i+=n;return r}curve(t){var e=this.alpha[t],n=this.curveCache[t].map((t=>e*t));return this.makeLines(n)}solutionCurve(){if(0==this.n)return"";var t=new Array(this.curveCache[0].length).fill(0);for(let r=0;r!=this.n;r++){var e=this.alpha[r],n=this.curveCache[r];for(let r=0;r!=n.length;r++)t[r]+=n[r]*e}return this.makeLines(t)}points(t){var e=this.alpha[t];return an(this.n).map((n=>[this.ctx.u(this.x[n]),this.ctx.v(e*this.K.get(t,n))]))}data(){return ln(this.x,this.y).map((([t,e])=>[this.ctx.u(t),this.ctx.v(e)]))}getMuX(){return ln(this.mu,this.x).map((([t,e])=>[this.ctx.u(t),this.ctx.u(e)]))}solutionPoint(t){return an(this.n).map((e=>this.alpha[e]*this.K.get(t,e))).reduce(((t,e)=>t+e),0)}u(t){return this.ctx.u(t)}v(t){return this.ctx.v(t)}}class Dr{constructor(t,e,[n,r],[i,o]){this.width=t,this.height=e,this.xmin=n,this.xmax=r,this.ymin=i,this.ymax=o,this.xToViewport=Pr().domain([n,r]).range([0,t]),this.yToViewport=Pr().domain([i,o]).range([e,0]),this.unitToX=Pr().domain([0,1]).range([n,r]),this.unitToY=Pr().domain([0,1]).range([i,o]),this.xToUnit=Pr().domain([n,r]).range([0,1])}setWidth(t){this.width=t,this.xToViewport.range([0,t])}setHeight(t){this.height=t,this.yToViewport.range([t,0])}x(t){return this.xToViewport.invert(t)}y(t){return this.yToViewport.invert(t)}u(t){return this.xToViewport(t)}v(t){return this.yToViewport(t)}xDomain(){return this.xToViewport.domain()}yDomain(){return this.yToViewport.domain()}}class zr{constructor(t,e,n){if(e=parseInt(e),isNaN(e)||e<=0)throw`sync.js: component_num must be integer > 0, got ${e}`;this.sig=t,this.cnum=e,this.sig.subscribe((t=>{Math.abs(t)!=this.cnum&&n()}))}notify(){this.sig.update((t=>-(Math.sign(t)||1)*this.cnum))}}function Or(t,e,n){const r=t.slice();return r[13]=e[n][0],r[14]=e[n][1],r[16]=n,r}function Vr(t,e,n){const r=t.slice();return r[16]=e[n],r}function Kr(t,e,n){const r=t.slice();return r[13]=e[n][0],r[14]=e[n][1],r}function Br(t,e,n){const r=t.slice();return r[21]=e[n][0],r[22]=e[n][1],r[16]=n,r}function Gr(t){let e,n,r,i,o;return{c(){var i,o;e=c("use"),g(e,"class","marker draggable svelte-igsjpl"),g(e,"id",n="mu"+t[16]),g(e,"x",r=t[21]),g(e,"y","0"),i="xlink:href",o="#mu-select",e.setAttributeNS("http://www.w3.org/1999/xlink",i,o)},m(n,r){s(n,e,r),i||(o=p(e,"mousedown",t[3]),i=!0)},p(t,n){2&n&&r!==(r=t[21])&&g(e,"x",r)},d(t){t&&h(e),i=!1,o()}}}function Wr(t){let e,n;return{c(){e=c("path"),g(e,"class","curve svelte-igsjpl"),g(e,"d",n=t[1].curve(t[16]))},m(t,n){s(t,e,n)},p(t,r){2&r&&n!==(n=t[1].curve(t[16]))&&g(e,"d",n)},d(t){t&&h(e)}}}function Yr(t){let e,n=t[1].points(t[16]),r=[];for(let e=0;e<n.length;e+=1)r[e]=Qr(Kr(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(2&i){let o;for(n=t[1].points(t[16]),o=0;o<n.length;o+=1){const a=Kr(t,n,o);r[o]?r[o].p(a,i):(r[o]=Qr(a),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Qr(t){let e,n,r;return{c(){e=c("circle"),g(e,"class","point svelte-igsjpl"),g(e,"cx",n=t[13]),g(e,"cy",r=t[14]),g(e,"r","4")},m(t,n){s(t,e,n)},p(t,i){2&i&&n!==(n=t[13])&&g(e,"cx",n),2&i&&r!==(r=t[14])&&g(e,"cy",r)},d(t){t&&h(e)}}}function Jr(t){let e,n,r=t[2].show_scaled&&Wr(t),i=t[2].show_points&&Yr(t);return{c(){r&&r.c(),e=m(),i&&i.c(),n=m()},m(t,o){r&&r.m(t,o),s(t,e,o),i&&i.m(t,o),s(t,n,o)},p(t,o){t[2].show_scaled?r?r.p(t,o):(r=Wr(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),t[2].show_points?i?i.p(t,o):(i=Yr(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(t){r&&r.d(t),t&&h(e),i&&i.d(t),t&&h(n)}}}function Zr(t){let e,n;return{c(){e=c("path"),g(e,"class","solution-curve svelte-igsjpl"),g(e,"d",n=t[1].solutionCurve())},m(t,n){s(t,e,n)},p(t,r){2&r&&n!==(n=t[1].solutionCurve())&&g(e,"d",n)},d(t){t&&h(e)}}}function ti(t){let e,n=t[1].data(),r=[];for(let e=0;e<n.length;e+=1)r[e]=ei(Or(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(10&i){let o;for(n=t[1].data(),o=0;o<n.length;o+=1){const a=Or(t,n,o);r[o]?r[o].p(a,i):(r[o]=ei(a),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function ei(t){let e,n,r,i,o;return{c(){e=c("circle"),g(e,"id","xy"+t[16]),g(e,"class","marker draggable svelte-igsjpl"),g(e,"cx",n=t[13]),g(e,"cy",r=t[14]),g(e,"r","5")},m(n,r){s(n,e,r),i||(o=p(e,"mousedown",t[3]),i=!0)},p(t,i){2&i&&n!==(n=t[13])&&g(e,"cx",n),2&i&&r!==(r=t[14])&&g(e,"cy",r)},d(t){t&&h(e),i=!1,o()}}}function ni(e){let n,i,o,f,d,v,b,x,w,y,_=e[1].getMuX(),M=[];for(let t=0;t<_.length;t+=1)M[t]=Gr(Br(e,_,t));let T=an(e[1].n),L=[];for(let t=0;t<T.length;t+=1)L[t]=Jr(Vr(e,T,t));let k=e[2].show_solution&&Zr(e),H=e[2].show_data&&ti(e);return{c(){n=u("div"),i=c("svg"),o=c("defs"),f=c("polygon");for(let t=0;t<M.length;t+=1)M[t].c();d=m();for(let t=0;t<L.length;t+=1)L[t].c();v=m(),k&&k.c(),b=m(),H&&H.c(),g(f,"id","mu-select"),g(f,"points","-5,0 5,0 0,10"),g(i,"class","inner-plot full svelte-igsjpl"),g(n,"class","svg-wrap svelte-igsjpl"),P((()=>e[8].call(n)))},m(t,r){s(t,n,r),a(n,i),a(i,o),a(o,f);for(let t=0;t<M.length;t+=1)M[t].m(i,null);a(i,d);for(let t=0;t<L.length;t+=1)L[t].m(i,null);a(i,v),k&&k.m(i,null),a(i,b),H&&H.m(i,null),x=E(n,e[8].bind(n)),w||(y=[p(i,"mousemove",e[4]),p(i,"mouseup",e[5])],w=!0)},p(t,[e]){if(10&e){let n;for(_=t[1].getMuX(),n=0;n<_.length;n+=1){const r=Br(t,_,n);M[n]?M[n].p(r,e):(M[n]=Gr(r),M[n].c(),M[n].m(i,d))}for(;n<M.length;n+=1)M[n].d(1);M.length=_.length}if(6&e){let n;for(T=an(t[1].n),n=0;n<T.length;n+=1){const r=Vr(t,T,n);L[n]?L[n].p(r,e):(L[n]=Jr(r),L[n].c(),L[n].m(i,v))}for(;n<L.length;n+=1)L[n].d(1);L.length=T.length}t[2].show_solution?k?k.p(t,e):(k=Zr(t),k.c(),k.m(i,b)):k&&(k.d(1),k=null),t[2].show_data?H?H.p(t,e):(H=ti(t),H.c(),H.m(i,null)):H&&(H.d(1),H=null)},i:t,o:t,d(t){t&&h(n),l(M,t),l(L,t),k&&k.d(),H&&H.d(),x(),w=!1,r(y)}}}function ri(t,e,n){let{sig:r}=e,{box:i}=e,{cfg:o}=e,{plot:a}=e,{cn:s}=e,h=null;function l(){n(1,a.touch++,a)}var u=new zr(r,s,l);function c(t,e){console.log(`in resize with ${t} x ${e}`),a.resize(t,e),l()}return k((()=>{c(i.w,i.h)})),t.$$set=t=>{"sig"in t&&n(6,r=t.sig),"box"in t&&n(0,i=t.box),"cfg"in t&&n(2,o=t.cfg),"plot"in t&&n(1,a=t.plot),"cn"in t&&n(7,s=t.cn)},t.$$.update=()=>{1&t.$$.dirty&&c(i.w,i.h)},[i,a,o,function(t){h=t.target},function(t){if(null!=h){var e=h.id.match(/(?<code>\D+)(?<num>\d+)/).groups;"mu"==e.code?a.setMu(e.num,t.offsetX):"xy"==e.code?a.setDataPoint(e.num,t.offsetX,t.offsetY):console.log(`got drag_point id ${h.id}`),o.auto_solve&&n(1,a.alpha=a.solutionAlpha(),a),l(),u.notify()}},function(t){h=null},r,s,function(){i.w=this.clientWidth,i.h=this.clientHeight,n(0,i)}]}class ii extends B{constructor(t){super(),K(this,t,ri,ni,o,{sig:6,box:0,cfg:2,plot:1,cn:7})}}function oi(t){return Math.abs(t)>1e3?t.toExponential(2):t.toFixed(2)}function ai(e){let n,i,o,l,c,m,v,b,_,M,T,E,L,k,H,R,A,S,C,$,P,j,I,F,N,U,X,q,D,z,O,V,K,B,G,W,Y,Q,J,Z,tt,et,nt,rt,it,ot,at,st,ht,lt,ut,ct,ft,dt=Math.pow(10,e[2]).toFixed(3)+"",mt=(e[1].validInv?oi(e[1].functionNorm()):"Error: non-singular K")+"",pt=e[1].scrambled()?"Unscramble":"Scramble";return{c(){n=u("div"),i=u("div"),o=u("div"),l=u("button"),l.textContent="New Data",c=d(),m=u("div"),v=u("label"),b=f("Sigma: \n        "),_=u("input"),M=d(),T=f(dt),E=d(),L=u("div"),k=u("d-math"),H=d(),R=f(mt),A=d(),S=u("div"),C=u("div"),$=u("button"),$.textContent="Solve",P=d(),j=u("div"),I=u("button"),F=f("Recenter "),N=u("d-math"),U=f("'s"),X=d(),q=u("div"),D=u("button"),z=f(pt),O=d(),V=u("div"),K=u("div"),B=u("label"),G=u("input"),W=f("points"),Y=d(),Q=u("div"),J=u("label"),Z=u("input"),tt=f("curves"),et=d(),nt=u("div"),rt=u("label"),it=u("input"),ot=f("solution"),at=d(),st=u("div"),ht=u("label"),lt=u("input"),ut=f("auto solve"),g(l,"id","newdata"),g(o,"class","pad-small svelte-165jjul"),g(_,"id","sigma"),g(_,"type","range"),g(_,"min","-5"),g(_,"max","2"),g(_,"step","0.1"),g(m,"class","pad-small svelte-165jjul"),g(L,"class","pad-small svelte-165jjul"),y(i,"flex-grow","1"),g($,"id","solve"),g(C,"class","pad-small svelte-165jjul"),g(I,"id","recenter_mu"),g(j,"class","pad-small svelte-165jjul"),g(D,"id","scramble"),g(q,"class","pad-small svelte-165jjul"),y(S,"flex-grow","1"),g(G,"type","checkbox"),g(Z,"type","checkbox"),g(it,"type","checkbox"),g(lt,"type","checkbox"),y(V,"flex-grow","1: align: right"),g(n,"class","row control pad svelte-165jjul")},m(t,r){s(t,n,r),a(n,i),a(i,o),a(o,l),a(i,c),a(i,m),a(m,v),a(v,b),a(v,_),w(_,e[2]),a(v,M),a(v,T),a(i,E),a(i,L),a(L,k),k.innerHTML="\\|f\\| = ",a(L,H),a(L,R),a(n,A),a(n,S),a(S,C),a(C,$),a(S,P),a(S,j),a(j,I),a(I,F),a(I,N),N.innerHTML="\\mu",a(I,U),a(S,X),a(S,q),a(q,D),a(D,z),a(n,O),a(n,V),a(V,K),a(K,B),a(B,G),G.checked=e[0].show_points,a(B,W),a(V,Y),a(V,Q),a(Q,J),a(J,Z),Z.checked=e[0].show_scaled,a(J,tt),a(V,et),a(V,nt),a(nt,rt),a(rt,it),it.checked=e[0].show_solution,a(rt,ot),a(V,at),a(V,st),a(st,ht),a(ht,lt),lt.checked=e[0].auto_solve,a(ht,ut),ct||(ft=[p(l,"click",e[3]),p(_,"change",e[6]),p(_,"input",e[6]),p(_,"input",e[3]),p($,"click",e[3]),p(I,"click",e[3]),p(D,"click",e[3]),p(G,"change",e[7]),p(Z,"change",e[8]),p(it,"change",e[9]),p(lt,"change",e[10])],ct=!0)},p(t,[e]){4&e&&w(_,t[2]),4&e&&dt!==(dt=Math.pow(10,t[2]).toFixed(3)+"")&&x(T,dt),2&e&&mt!==(mt=(t[1].validInv?oi(t[1].functionNorm()):"Error: non-singular K")+"")&&x(R,mt),2&e&&pt!==(pt=t[1].scrambled()?"Unscramble":"Scramble")&&x(z,pt),1&e&&(G.checked=t[0].show_points),1&e&&(Z.checked=t[0].show_scaled),1&e&&(it.checked=t[0].show_solution),1&e&&(lt.checked=t[0].auto_solve)},i:t,o:t,d(t){t&&h(n),ct=!1,r(ft)}}}function si(t,e,n){let{sig:r}=e,{cn:i}=e,{cfg:o}=e,{plot:a}=e,s=0;function h(){n(1,a.touch++,a)}var l=new zr(r,i,h);function u(t,e){if(t){var r=a.alpha,i=a.solutionAlpha();!function t(e,o){var s=e/o;for(let t=0;t!=a.n;t++)n(1,a.alpha[t]=s*i[t]+(1-s)*r[t],a);l.notify(),e!=o&&setTimeout((()=>t(e+1,o)),10)}(0,50)}}return t.$$set=t=>{"sig"in t&&n(4,r=t.sig),"cn"in t&&n(5,i=t.cn),"cfg"in t&&n(0,o=t.cfg),"plot"in t&&n(1,a=t.plot)},[o,a,s,function(t){var e,r=t.target.id;"solve"==r&&u(!0),"recenter_mu"==r&&(a.recenter_mu(),u(o.auto_solve)),"scramble"==r&&(a.toggle_scramble(),u(o.auto_solve)),"newdata"==r&&a.populate(),"sigma"==r&&(e=s,a.set_sigma(e),o.auto_solve&&n(1,a.alpha=a.solutionAlpha(),a)),h(),l.notify()},r,i,function(){s=b(this.value),n(2,s)},function(){o.show_points=this.checked,n(0,o)},function(){o.show_scaled=this.checked,n(0,o)},function(){o.show_solution=this.checked,n(0,o)},function(){o.auto_solve=this.checked,n(0,o)}]}class hi extends B{constructor(t){super(),K(this,t,si,ai,o,{sig:4,cn:5,cfg:0,plot:1})}}function li(t,e,n){const r=t.slice();return r[7]=e[n],r[8]=e,r[9]=n,r}function ui(t){let e,n,i,o,l,c,m,v,b,y=oi(t[7])+"";function _(){t[4].call(n,t[8],t[9])}return{c(){e=u("div"),n=u("input"),o=d(),l=u("code"),c=f(y),m=d(),g(n,"id",i="update-alpha"+t[9]),g(n,"type","range"),g(n,"min","-10"),g(n,"max","10"),g(n,"step","0.01"),g(l,"class","alphas svelte-eznsce"),g(e,"class","row pad-small svelte-eznsce")},m(r,i){s(r,e,i),a(e,n),w(n,t[7]),a(e,o),a(e,l),a(l,c),a(e,m),v||(b=[p(n,"change",_),p(n,"input",_),p(n,"input",t[1])],v=!0)},p(e,r){t=e,1&r&&w(n,t[7]),1&r&&y!==(y=oi(t[7])+"")&&x(c,y)},d(t){t&&h(e),v=!1,r(b)}}}function ci(e){let n,i,o,c,f,m,v,b,x,w,y,_,M,T=e[0].alpha,E=[];for(let t=0;t<T.length;t+=1)E[t]=ui(li(e,T,t));return{c(){n=u("div"),i=u("div"),o=u("button"),o.textContent="Reset Alpha",c=d(),f=u("div"),m=u("div"),v=u("button"),v.textContent="Del Point",b=d(),x=u("div"),w=u("button"),w.textContent="Add Point",y=d();for(let t=0;t<E.length;t+=1)E[t].c();g(o,"id","reset-alpha"),g(i,"class","pad-small svelte-eznsce"),g(v,"id","del-point"),g(m,"class","pad-small svelte-eznsce"),g(w,"id","add-point"),g(x,"class","pad-small svelte-eznsce"),g(f,"class","row svelte-eznsce"),g(n,"class","pad col svelte-eznsce")},m(t,r){s(t,n,r),a(n,i),a(i,o),a(n,c),a(n,f),a(f,m),a(m,v),a(f,b),a(f,x),a(x,w),a(n,y);for(let t=0;t<E.length;t+=1)E[t].m(n,null);_||(M=[p(o,"click",e[1]),p(v,"click",e[1]),p(w,"click",e[1])],_=!0)},p(t,[e]){if(3&e){let r;for(T=t[0].alpha,r=0;r<T.length;r+=1){const i=li(t,T,r);E[r]?E[r].p(i,e):(E[r]=ui(i),E[r].c(),E[r].m(n,null))}for(;r<E.length;r+=1)E[r].d(1);E.length=T.length}},i:t,o:t,d(t){t&&h(n),l(E,t),_=!1,r(M)}}}function fi(t,e,n){let{sig:r}=e,{cn:i}=e,{plot:o}=e;function a(){n(0,o.touch++,o)}var s=new zr(r,i,a);return t.$$set=t=>{"sig"in t&&n(2,r=t.sig),"cn"in t&&n(3,i=t.cn),"plot"in t&&n(0,o=t.plot)},[o,function(t){var e=t.target.id;"reset-alpha"==e&&o.resetAlpha(),"del-point"==e&&o.delPoint(),"add-point"==e&&o.addPoint(),e.match(/update-alpha/),a(),s.notify()},r,i,function(t,e){t[e]=b(this.value),n(0,o)}]}class di extends B{constructor(t){super(),K(this,t,fi,ci,o,{sig:2,cn:3,plot:0})}}var mi="undefined"!=typeof window?window:void 0!==Ft?Ft:"undefined"!=typeof self?self:{},pi=function(t){if(!t)return!1;var e=gi.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)},gi=Object.prototype.toString;var vi=function(t){return t.replace(/^\s+|\s+$/g,"")},bi=function(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)xi.call(n,r)&&(t[r]=n[r])}return t},xi=Object.prototype.hasOwnProperty;var wi=Mi,yi=Mi;function _i(t,e,n){var r=t;return pi(e)?(n=e,"string"==typeof t&&(r={uri:t})):r=bi(e,{uri:t}),r.callback=n,r}function Mi(t,e,n){return Ti(e=_i(t,e,n))}function Ti(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,n=function(n,r,i){e||(e=!0,t.callback(n,r,i))};function r(){var t=void 0;if(t=h.response?h.response:h.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(t){}return null}(h),p)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(l),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,n(t,g)}function o(){if(!s){var e;clearTimeout(l),e=t.useXDR&&void 0===h.status?200:1223===h.status?204:h.status;var i=g,o=null;return 0!==e?(i={body:r(),statusCode:e,method:c,headers:{},url:u,rawRequest:h},h.getAllResponseHeaders&&(i.headers=function(t){if(!t)return{};for(var e,n={},r=vi(t).split("\n"),i=0;i<r.length;i++){var o=r[i],a=o.indexOf(":"),s=vi(o.slice(0,a)).toLowerCase(),h=vi(o.slice(a+1));void 0===n[s]?n[s]=h:(e=n[s],"[object Array]"===Object.prototype.toString.call(e)?n[s].push(h):n[s]=[n[s],h])}return n}(h.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),n(o,i,i.body)}}var a,s,h=t.xhr||null;h||(h=t.cors||t.useXDR?new Mi.XDomainRequest:new Mi.XMLHttpRequest);var l,u=h.url=t.uri||t.url,c=h.method=t.method||"GET",f=t.body||t.data,d=h.headers=t.headers||{},m=!!t.sync,p=!1,g={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:h};if("json"in t&&!1!==t.json&&(p=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),h.onreadystatechange=function(){4===h.readyState&&setTimeout(o,0)},h.onload=o,h.onerror=i,h.onprogress=function(){},h.onabort=function(){s=!0},h.ontimeout=i,h.open(c,u,!m,t.username,t.password),m||(h.withCredentials=!!t.withCredentials),!m&&t.timeout>0&&(l=setTimeout((function(){if(!s){s=!0,h.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}}),t.timeout)),h.setRequestHeader)for(a in d)d.hasOwnProperty(a)&&h.setRequestHeader(a,d[a]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(h),h.send(f||null),h}Mi.XMLHttpRequest=mi.XMLHttpRequest||function(){},Mi.XDomainRequest="withCredentials"in new Mi.XMLHttpRequest?Mi.XMLHttpRequest:mi.XDomainRequest,function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(["get","put","post","patch","head","delete"],(function(t){Mi["delete"===t?"del":t]=function(e,n,r){return(n=_i(e,n,r)).method=t.toUpperCase(),Ti(n)}})),wi.default=yi;var Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Li=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ki=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Hi=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},Ri="";function Ai(t,e,n){function r(e,r){var i,o;"function"==typeof n?n(e):(i=r,(o=t.parentNode)&&(o.innerHTML='\n<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>\n<td align="center">\n<div style="display: table-cell; vertical-align: middle;">\n<div style="">'+i+"</div>\n</div>\n</td></tr></table>\n"))}if(!window.WebGLRenderingContext)return r(1,'\n\tThis page requires a browser that supports WebGL.<br/>\n\t<a href="http://get.webgl.org">Click here to upgrade your browser.</a>\n'),null;var i=function(t,e){for(var n=["webgl","experimental-webgl"],r=null,i=0;i<n.length;++i)try{r=t.getContext(n[i],e)}catch(t){if(r)break}return r}(t,e);return i?i.getExtension("OES_standard_derivatives"):r(2,'\n\tIt does not appear your computer can support WebGL.<br/>\n\t<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>\n'),i}function Si(t,e,n,r){var i=t.gl,o=i.createShader(n);return i.shaderSource(o,e),i.compileShader(o),i.getShaderParameter(o,i.COMPILE_STATUS)?o:(Ri=i.getShaderInfoLog(o),console.error("*** Error compiling shader "+o+":"+Ri),t.trigger("error",{shader:o,source:e,type:n,error:Ri,offset:r||0}),i.deleteShader(o),null)}function Ci(t,e,n,r){for(var i=t.gl,o=i.createProgram(),a=0;a<e.length;++a)i.attachShader(o,e[a]);if(n)for(var s=0;s<n.length;++s)i.bindAttribLocation(o,r?r[s]:s,n[s]);return i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)?o:(Ri=i.getProgramInfoLog(o),console.log("Error in program linking:"+Ri),i.deleteProgram(o),null)}function $i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];for(var r in t){var i=t[r],o=void 0;if(e&&(r=e+"."+r),"number"==typeof i)n.push({type:"float",method:"1f",name:r,value:i});else if(Array.isArray(i)){if("number"==typeof i[0])1===i.length?n.push({type:"float",method:"1f",name:r,value:i}):i.length>=2&&i.length<=4?n.push({type:"vec"+i.length,method:i.length+"fv",name:r,value:i}):i.length>4&&n.push({type:"float[]",method:"1fv",name:r+"[0]",value:i});else if("string"==typeof i[0])n.push({type:"sampler2D",method:"1i",name:r,value:i});else if(Array.isArray(i[0])&&"number"==typeof i[0][0]){if(i[0].length>=2&&i[0].length<=4)for(o=0;o<i.length;o++)n.push({type:"vec"+i[0].length,method:i[o].length+"fv",name:r+"["+o+"]",value:i[o]})}else if("object"===Ei(i[0]))for(o=0;o<i.length;o++)n.push.apply(n,Hi($i(i[o],r+"["+o+"]")))}else"boolean"==typeof i?n.push({type:"bool",method:"1i",name:r,value:i}):"string"==typeof i?n.push({type:"sampler2D",method:"1i",name:r,value:i}):"object"===(void 0===i?"undefined":Ei(i))&&n.push.apply(n,Hi($i(i,r)))}return n}function Pi(t){return 0==(t&t-1)}function ji(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ii(t,e){return!(!t||!e)&&t.toString()!==e.toString()}function Fi(t){var e=new Set;return Object.assign(t,{on:function(t,n){var r={};r[t]=n,e.add(r)},off:function(t,n){if(n){var r={};r[t]=n,e.delete(r)}else{var i=!0,o=!1,a=void 0;try{for(var s,h=e[Symbol.iterator]();!(i=(s=h.next()).done);i=!0){var l=s.value,u=!0,c=!1,f=void 0;try{for(var d,m=Object.keys(l)[Symbol.iterator]();!(u=(d=m.next()).done);u=!0){if(d.value===t)return void e.delete(l)}}catch(t){c=!0,f=t}finally{try{!u&&m.return&&m.return()}finally{if(c)throw f}}}}catch(t){o=!0,a=t}finally{try{!i&&h.return&&h.return()}finally{if(o)throw a}}}},listSubscriptions:function(){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;console.log(a)}}catch(t){n=!0,r=t}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}},subscribe:function(t){e.add(t)},unsubscribe:function(t){e.delete(t)},unsubscribeAll:function(){e.clear()},trigger:function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=!0,a=!1,s=void 0;try{for(var h,l=e[Symbol.iterator]();!(o=(h=l.next()).done);o=!0){var u=h.value;"function"==typeof u[t]&&u[t].apply(u,Hi(r))}}catch(t){a=!0,s=t}finally{try{!o&&l.return&&l.return()}finally{if(a)throw s}}}})}var Ni=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Li(this,t),Fi(this),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.bind(),this.name=n,this.source=null,this.sourceType=null,this.loading=null,this.setData(1,1,new Uint8Array([0,0,0,255]),{filtering:"linear"}),this.setFiltering(r.filtering),this.load(r)}return ki(t,[{key:"destroy",value:function(){this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,this.valid=!1)}},{key:"bind",value:function(e){this.valid&&("number"==typeof e&&t.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),t.activeUnit=e),t.activeTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),t.activeTexture=this.texture))}},{key:"load",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=null,"string"==typeof t.url?void 0!==this.url&&t.url===this.url||this.setUrl(t.url,t):t.element?this.setElement(t.element,t):t.data&&t.width&&t.height&&this.setData(t.width,t.height,t.data,t)}},{key:"setUrl",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.valid)return this.url=t,this.source=this.url,this.sourceType="url",this.loading=new Promise((function(r,i){var o=t.split(".").pop().toLowerCase(),a="ogv"===o||"webm"===o||"mp4"===o,s=void 0;a?((s=document.createElement("video")).autoplay=!0,n.filtering="nearest"):s=new Image,s.onload=function(){try{e.setElement(s,n)}catch(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,n)}r(e)},s.onerror=function(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,n),r(e)},ji()&&"data:"===e.source.slice(0,5)||(s.crossOrigin="anonymous"),s.src=e.source,a&&e.setElement(s,n)})),this.loading}},{key:"setData",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.width=t,this.height=e,this.source=n,this.sourceType="data",this.update(r),this.setFiltering(r),this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var n=this,r=t;if("string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)this.source=t,this.sourceType="element",t instanceof HTMLVideoElement?(t.addEventListener("canplaythrough",(function(){n.intervalID=setInterval((function(){n.update(e)}),15)}),!0),t.addEventListener("ended",(function(){t.currentTime=0,t.play()}),!0)):this.update(e),this.setFiltering(e);else{var i="the 'element' parameter (`element: "+JSON.stringify(r)+"`) must be a CSS ";i+="selector string, or a <canvas>, <image> or <video> object",console.log("Texture '"+this.name+"': "+i,e)}return this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.valid&&(this.bind(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==t.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),"element"===this.sourceType&&(this.source instanceof HTMLCanvasElement||this.source instanceof HTMLVideoElement||this.source instanceof HTMLImageElement&&this.source.complete)?(this.source instanceof HTMLVideoElement?(this.width=this.source.videoWidth,this.height=this.source.videoHeight):(this.width=this.source.width,this.height=this.source.height),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source)):"data"===this.sourceType&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.trigger("loaded",this))}},{key:"setFiltering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.valid){this.powerOf2=Pi(this.width)&&Pi(this.height);var e=this.powerOf2?"mipmap":"linear";this.filtering=t.filtering||e;var n=this.gl;this.bind(),this.powerOf2?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t.TEXTURE_WRAP_S||t.repeat&&n.REPEAT||n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t.TEXTURE_WRAP_T||t.repeat&&n.REPEAT||n.CLAMP_TO_EDGE),"mipmap"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.generateMipmap(n.TEXTURE_2D)):"linear"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)):"nearest"===this.filtering&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST))):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),"mipmap"===this.filtering&&(this.filtering="linear"),"nearest"===this.filtering?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR)))}}}]),t}();Ni.getMaxTextureSize=function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)},Ni.activeUnit=-1;var Ui=function(){function t(e,n,r){var i=this;Li(this,t),Fi(this),n=n||{},r=r||{},this.width=e.clientWidth,this.height=e.clientHeight,this.canvas=e,this.gl=void 0,this.program=void 0,this.textures={},this.buffers={},this.uniforms={},this.vbo={},this.isValid=!1,this.BUFFER_COUNT=0,this.vertexString=n.vertexString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n",this.fragmentString=n.fragmentString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 v_texcoord;\n\nvoid main(){\n    gl_FragColor = vec4(0.0);\n}\n";var o=Ai(e,n,r.onError);if(o){if(this.gl=o,this.timeLoad=this.timePrev=performance.now(),this.timeDelta=0,this.forceRender=!0,this.paused=!1,this.realToCSSPixels=window.devicePixelRatio||1,e.style.backgroundColor=n.backgroundColor||"rgba(1,1,1,0)",e.hasAttribute("data-fragment"))this.fragmentString=e.getAttribute("data-fragment");else if(e.hasAttribute("data-fragment-url")){var a=e.getAttribute("data-fragment-url");wi.get(a,(function(t,e,n){i.load(n,i.vertexString)}))}if(e.hasAttribute("data-vertex"))this.vertexString=e.getAttribute("data-vertex");else if(e.hasAttribute("data-vertex-url")){var s=e.getAttribute("data-vertex-url");wi.get(s,(function(t,e,n){i.load(i.fragmentString,n)}))}if(this.load(),this.program){var h=o.getAttribLocation(this.program,"a_texcoord");this.vbo.texCoords=o.createBuffer(),this.gl.bindBuffer(o.ARRAY_BUFFER,this.vbo.texCoords),this.gl.bufferData(o.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),o.STATIC_DRAW),this.gl.enableVertexAttribArray(h),this.gl.vertexAttribPointer(h,2,o.FLOAT,!1,0,0);var l=o.getAttribLocation(this.program,"a_position");if(this.vbo.vertices=o.createBuffer(),this.gl.bindBuffer(o.ARRAY_BUFFER,this.vbo.vertices),this.gl.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),o.STATIC_DRAW),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),e.hasAttribute("data-textures")){var u=e.getAttribute("data-textures").split(",");for(var c in u)this.setUniform("u_tex"+c,u[c])}var f={x:0,y:0};document.addEventListener("mousemove",(function(t){f.x=t.clientX||t.pageX,f.y=t.clientY||t.pageY}),!1);var d=this;return this.setMouse({x:0,y:0}),function t(){d.nMouse>1&&d.setMouse(f),d.resize()&&(d.forceRender=!0),d.render(),window.requestAnimationFrame(t)}(),this}}}return ki(t,[{key:"destroy",value:function(){for(var t in this.animated=!1,this.isValid=!1,this.textures)t.destroy&&t.destroy();for(var e in this.textures={},this.attribs)this.gl.deleteBuffer(this.attribs[e]);for(var n in this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.buffers){var r=this.buffers[n];this.gl.deleteProgram(r.program)}this.program=null,this.gl=null}},{key:"load",value:function(t,e){if(e&&(this.vertexString=e),t&&(this.fragmentString=t),this.animated=!1,this.nDelta=(this.fragmentString.match(/u_delta/g)||[]).length,this.nTime=(this.fragmentString.match(/u_time/g)||[]).length,this.nDate=(this.fragmentString.match(/u_date/g)||[]).length,this.nMouse=(this.fragmentString.match(/u_mouse/g)||[]).length,this.animated=this.nDate>1||this.nTime>1||this.nMouse>1,this.fragmentString.search(/sampler2D/g))for(var n=this.fragmentString.split("\n"),r=0;r<n.length;r++){var i=n[r].match(/uniform\s*sampler2D\s*([\w]*);\s*\/\/\s*([\w|\:\/\/|\.|\-|\_]*)/i);if(i){var o=i[2].split(".").pop().toLowerCase();i[1]&&i[2]&&("jpg"===o||"jpeg"===o||"png"===o||"ogv"===o||"webm"===o||"mp4"===o)&&this.setUniform(i[1],i[2])}if(n[r].match(/\s*void\s*main\s*/g))break}var a=Si(this,this.vertexString,this.gl.VERTEX_SHADER),s=Si(this,this.fragmentString,this.gl.FRAGMENT_SHADER);s?this.isValid=!0:(s=Si(this,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",this.gl.FRAGMENT_SHADER),this.isValid=!1);var h=Ci(this,[a,s]);this.gl.useProgram(h),this.gl.deleteShader(a),this.gl.deleteShader(s),this.program=h,this.change=!0,this.BUFFER_COUNT=0;var l=this.getBuffers(this.fragmentString);Object.keys(l).length&&this.loadPrograms(l),this.buffers=l,this.texureIndex=this.BUFFER_COUNT,this.trigger("load",{}),this.forceRender=!0,this.render()}},{key:"test",value:function(t,e,n){var r=this.vertexString,i=this.fragmentString,o=this.paused,a=this.gl.getExtension("EXT_disjoint_timer_query"),s=a.createQueryEXT(),h=this.isValid;(e||n)&&(this.load(e,n),h=this.isValid,this.forceRender=!0,this.render()),this.paused=!0,a.beginQueryEXT(a.TIME_ELAPSED_EXT,s),this.forceRender=!0,this.render(),a.endQueryEXT(a.TIME_ELAPSED_EXT);var l=this;!function u(){l.forceRender=!0,l.render();var c=a.getQueryObjectEXT(s,a.QUERY_RESULT_AVAILABLE_EXT),f=l.gl.getParameter(a.GPU_DISJOINT_EXT);if(c&&!f){var d={wasValid:h,frag:e||l.fragmentString,vert:n||l.vertexString,timeElapsedMs:a.getQueryObjectEXT(s,a.QUERY_RESULT_EXT)/1e6};l.paused=o,(e||n)&&l.load(i,r),t(d)}else window.requestAnimationFrame(u)}()}},{key:"loadTexture",value:function(t,e,n){var r=this;n||(n={}),"string"==typeof e?n.url=e:"object"===(void 0===e?"undefined":Ei(e))&&e.data&&e.width&&e.height?(n.data=e.data,n.width=e.width,n.height=e.height):"object"===(void 0===e?"undefined":Ei(e))&&(n.element=e),this.textures[t]?this.textures[t]&&(this.textures[t].load(n),this.textures[t].on("loaded",(function(t){r.forceRender=!0}))):(this.textures[t]=new Ni(this.gl,t,n),this.textures[t].on("loaded",(function(t){r.forceRender=!0})))}},{key:"refreshUniforms",value:function(){this.uniforms={}}},{key:"setUniform",value:function(t){for(var e={},n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e[t]=r,this.setUniforms(e)}},{key:"setUniforms",value:function(t){var e=$i(t);for(var n in e)"sampler2D"===e[n].type?this.loadTexture(e[n].name,e[n].value[0]):this.uniform(e[n].method,e[n].type,e[n].name,e[n].value);this.forceRender=!0}},{key:"setMouse",value:function(t){var e=this.canvas.getBoundingClientRect();if(t&&t.x&&t.x>=e.left&&t.x<=e.right&&t.y&&t.y>=e.top&&t.y<=e.bottom){var n=(t.x-e.left)*this.realToCSSPixels,r=this.canvas.height-(t.y-e.top)*this.realToCSSPixels;this.uniform("2f","vec2","u_mouse",n,r)}}},{key:"uniform",value:function(t,e,n){this.uniforms[n]=this.uniforms[n]||{};for(var r=this.uniforms[n],i=arguments.length,o=Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];var s=Ii(r.value,o);if(s||this.change||!r.location||!r.value)for(var h in r.name=n,r.type=e,r.value=o,r.method="uniform"+t,this.gl.useProgram(this.program),r.location=this.gl.getUniformLocation(this.program,n),this.gl[r.method].apply(this.gl,[r.location].concat(r.value)),this.buffers){var l=this.buffers[h];this.gl.useProgram(l.program);var u=this.gl.getUniformLocation(l.program,n);this.gl[r.method].apply(this.gl,[u].concat(r.value))}}},{key:"uniformTexture",value:function(t,e,n){if(void 0===this.textures[t])this.loadTexture(t,e,n);else{for(var r in this.uniform("1i","sampler2D",t,this.texureIndex),this.buffers){var i=this.buffers[r];this.gl.useProgram(i.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture)}this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture),this.uniform("2f","vec2",t+"Resolution",this.textures[t].width,this.textures[t].height)}}},{key:"resize",value:function(){if(this.width!==this.canvas.clientWidth||this.height!==this.canvas.clientHeight){this.realToCSSPixels=window.devicePixelRatio||1;var t=Math.floor(this.gl.canvas.clientWidth*this.realToCSSPixels),e=Math.floor(this.gl.canvas.clientHeight*this.realToCSSPixels);return this.gl.canvas.width===t&&this.gl.canvas.height===e||(this.gl.canvas.width=t,this.gl.canvas.height=e,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.resizeSwappableBuffers(),!0}return!1}},{key:"render",value:function(){var t;if(this.visible=(t=this.canvas).getBoundingClientRect().top+t.height>0&&t.getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight),this.forceRender||this.change||this.animated&&this.visible&&!this.paused){var e=new Date,n=performance.now();for(var r in this.timeDelta=(n-this.timePrev)/1e3,this.timePrev=n,this.nDelta>1&&this.uniform("1f","float","u_delta",this.timeDelta),this.nTime>1&&this.uniform("1f","float","u_time",(n-this.timeLoad)/1e3),this.nDate&&this.uniform("4f","float","u_date",e.getFullYear(),e.getMonth(),e.getDate(),3600*e.getHours()+60*e.getMinutes()+e.getSeconds()+.001*e.getMilliseconds()),this.uniform("2f","vec2","u_resolution",this.canvas.width,this.canvas.height),this.buffers){var i=this.buffers[r];this.uniform("1i","sampler2D",i.name,i.bundle.input.index)}for(var o in this.texureIndex=this.BUFFER_COUNT,this.textures)this.uniformTexture(o),this.texureIndex++;this.renderPrograms(),this.trigger("render",{}),this.change=!1,this.forceRender=!1}}},{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"renderPrograms",value:function(){var t=this.gl,e=t.canvas.width,n=t.canvas.height;for(var r in t.viewport(0,0,e,n),this.buffers){var i=this.buffers[r];i.bundle.render(e,n,i.program,i.name),t.bindFramebuffer(t.FRAMEBUFFER,null)}t.useProgram(this.program),t.drawArrays(t.TRIANGLES,0,6)}},{key:"getBuffers",value:function(t){var e={};return t&&t.replace(/(?:^\s*)((?:#if|#elif)(?:\s*)(defined\s*\(\s*BUFFER_)(\d+)(?:\s*\))|(?:#ifdef)(?:\s*BUFFER_)(\d+)(?:\s*))/gm,(function(){var n=arguments[3]||arguments[4];e["u_buffer"+n]={fragment:"#define BUFFER_"+n+"\n"+t}})),e}},{key:"loadPrograms",value:function(t){var e=this,n=this.gl,r=Si(e,e.vertexString,n.VERTEX_SHADER);for(var i in t){var o=t[i],a=Si(e,o.fragment,n.FRAGMENT_SHADER,1);a?e.isValid=!0:(a=Si(e,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",n.FRAGMENT_SHADER),e.isValid=!1);var s=Ci(e,[r,a]);o.name=i,o.program=s,o.bundle=e.createSwappableBuffer(e.canvas.width,e.canvas.height,s),n.deleteShader(a)}n.deleteShader(r)}},{key:"createSwappableBuffer",value:function(t,e,n){var r=this.createBuffer(t,e,n),i=this.createBuffer(t,e,n),o=this.gl;return{input:r,output:i,swap:function(){var t=r;r=i,i=t,this.input=r,this.output=i},render:function(t,e,n,r){o.useProgram(n),o.viewport(0,0,t,e),o.bindFramebuffer(o.FRAMEBUFFER,this.input.buffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,this.output.texture,0),o.drawArrays(o.TRIANGLES,0,6),this.swap()},resize:function(t,e,n,r){o.useProgram(n),o.viewport(0,0,t,e),this.input.resize(t,e),this.output.resize(t,e)}}}},{key:"createBuffer",value:function(t,e,n){var r=this.gl,i=this.BUFFER_COUNT;this.BUFFER_COUNT+=2,r.getExtension("OES_texture_float");var o=r.createTexture();r.activeTexture(r.TEXTURE0+i),r.bindTexture(r.TEXTURE_2D,o),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.FLOAT,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var a=r.createFramebuffer();return{index:i,texture:o,buffer:a,W:t,H:e,resize:function(t,e){r.bindFramebuffer(r.FRAMEBUFFER,a);var n=Math.min(t,this.W),s=Math.min(e,this.H),h=new Float32Array(n*s*4);r.readPixels(0,0,n,s,r.RGBA,r.FLOAT,h),r.bindFramebuffer(r.FRAMEBUFFER,null);var l=i+1,u=r.createTexture();r.activeTexture(r.TEXTURE0+l),r.bindTexture(r.TEXTURE_2D,u),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t,e,0,r.RGBA,r.FLOAT,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,n,s,r.RGBA,r.FLOAT,h);var c=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(o),r.activeTexture(r.TEXTURE0+i),r.bindTexture(r.TEXTURE_2D,u),i=this.index=i,o=this.texture=u,a=this.buffer=c,this.W=t,this.H=e}}}},{key:"resizeSwappableBuffers",value:function(){var t=this.gl,e=t.canvas.width,n=t.canvas.height;for(var r in t.viewport(0,0,e,n),this.buffers){var i=this.buffers[r];i.bundle.resize(e,n,i.program,i.name)}t.useProgram(this.program)}},{key:"version",value:function(){return"0.1.7"}}]),t}();window.addEventListener("load",(function(){!function(){var t=document.getElementsByClassName("glslCanvas");if(t.length>0){window.glslCanvases=[];for(var e=0;e<t.length;e++){var n=new Ui(t[e]);n.isValid&&window.glslCanvases.push(n)}}}()}));function Xi(t,e,n){const r=t.slice();return r[12]=e[n],r}function qi(t,e,n){const r=t.slice();return r[15]=e[n],r}function Di(t){let e,n,r;return{c(){e=c("circle"),g(e,"cx",n=t[2](t[12])),g(e,"cy",r=t[3](t[15])),g(e,"r","2"),g(e,"fill","rgba(255,0,0,1)")},m(t,n){s(t,e,n)},p(t,i){1&i&&n!==(n=t[2](t[12]))&&g(e,"cx",n),1&i&&r!==(r=t[3](t[15]))&&g(e,"cy",r)},d(t){t&&h(e)}}}function zi(t){let e,n=t[0].mu,r=[];for(let e=0;e<n.length;e+=1)r[e]=Di(qi(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(13&i){let o;for(n=t[0].mu,o=0;o<n.length;o+=1){const a=qi(t,n,o);r[o]?r[o].p(a,i):(r[o]=Di(a),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Oi(e){let n,r,i,o,m,p,v,b,x,w,y,_,M,T,L,k,H,R,A=e[0].x,S=[];for(let t=0;t<A.length;t+=1)S[t]=zi(Xi(e,A,t));return{c(){n=u("div"),r=u("div"),i=u("div"),o=u("d-math"),m=d(),p=u("div"),v=u("div"),b=u("canvas"),x=d(),w=c("svg");for(let t=0;t<S.length;t+=1)S[t].c();_=d(),M=u("div"),T=u("d-math"),L=d(),k=u("p"),H=f("Each row is the Gaussian at "),R=u("d-math"),g(i,"class","col pad-small svelte-1bhz1t1"),g(b,"id","glslCanvas"),g(b,"width",e[1]),g(b,"height",e[1]),g(w,"class","overlay svelte-1bhz1t1"),g(w,"width",e[1]),g(w,"height",e[1]),g(v,"class","square inner-plot svelte-1bhz1t1"),P((()=>e[6].call(v))),g(M,"class","pad-small svelte-1bhz1t1"),g(p,"class","col center svelte-1bhz1t1"),g(r,"class","row center svelte-1bhz1t1"),g(n,"class","pad col svelte-1bhz1t1")},m(t,h){s(t,n,h),a(n,r),a(r,i),a(i,o),o.innerHTML="\\mu",a(r,m),a(r,p),a(p,v),a(v,b),a(v,x),a(v,w);for(let t=0;t<S.length;t+=1)S[t].m(w,null);y=E(v,e[6].bind(v)),a(p,_),a(p,M),a(M,T),T.innerHTML="x",a(p,L),a(p,k),a(k,H),a(k,R),R.innerHTML="\\mu"},p(t,[e]){if(2&e&&g(b,"width",t[1]),2&e&&g(b,"height",t[1]),13&e){let n;for(A=t[0].x,n=0;n<A.length;n+=1){const r=Xi(t,A,n);S[n]?S[n].p(r,e):(S[n]=zi(r),S[n].c(),S[n].m(w,null))}for(;n<S.length;n+=1)S[n].d(1);S.length=A.length}2&e&&g(w,"width",t[1]),2&e&&g(w,"height",t[1])},i:t,o:t,d(t){t&&h(n),l(S,t),y()}}}function Vi(t,e,n){let r,i,o,a,{sig:s}=e,{cn:h}=e,{plot:l}=e;function u(t){return o*(t-r)/(i-r)}function c(){if(null!=a){var t=Math.sqrt(l.get_sigma2()),e=l.scrambled(),o=l.cut_size();[r,i]=l.get_xrange(),a.setUniform("u_sigma",t),a.setUniform("cut_size",o),a.setUniform("u_do_scramble",e?1:0),a.setUniform("u_xmin",r),a.setUniform("u_xmax",i),n(0,l.touch++,l)}}return k((()=>{const t=document.getElementById("glslCanvas");console.log("here in onMount");var e=t.getContext("webgl")||t.getContext("experimental-webgl");console.log("gl is ",e),e&&e instanceof WebGLRenderingContext&&(a=new Ui(t),a.load("precision mediump float;precision lowp int;\n#define GLSLIFY 1\nuniform vec2 u_resolution;uniform float u_sigma;uniform float cut_size;uniform bool u_do_scramble;uniform float u_xmin;uniform float u_xmax;const vec3 blue=vec3(0.0,0.0,1.0);const vec3 white=vec3(1.0,1.0,1.0);const float pi=3.1415926539;float slope=u_xmax-u_xmin;float intercept=u_xmin;float scramble(float x){float d=floor(x/cut_size);float r=x-d*cut_size;if(abs(mod(d,2.0))==1.0){x=x+cut_size-2.0*r;}return x;}float kernel(vec2 st){float fac=1.0/(u_sigma*sqrt(2.0*pi));return fac*exp(-0.5*pow((st.x-st.y)/u_sigma,2.0));}void main(){vec2 st=gl_FragCoord.xy/u_resolution;st=vec2(st.x,1.0-st.y)*slope+intercept;if(u_do_scramble){st=vec2(scramble(st.x),st.y);}float k=kernel(st)/kernel(vec2(0.0,0.0));vec3 color=k*blue+(1.0-k)*white;gl_FragColor=vec4(color,1.0);}")),c()})),new zr(s,h,c),t.$$set=t=>{"sig"in t&&n(4,s=t.sig),"cn"in t&&n(5,h=t.cn),"plot"in t&&n(0,l=t.plot)},[l,o,u,function(t){return u(t)},s,h,function(){o=this.clientWidth,n(1,o)}]}class Ki extends B{constructor(t){super(),K(this,t,Vi,Oi,o,{sig:4,cn:5,plot:0})}}function Bi(t,e,n){const r=t.slice();return r[11]=e[n],r}function Gi(t,e,n){const r=t.slice();return r[14]=e[n],r}function Wi(t){let e,n,r,i,o;return{c(){e=c("rect"),g(e,"width",n=2*t[1]),g(e,"height",r=2*t[1]),g(e,"x",i=t[3](t[11])),g(e,"y",o=t[3](t[14])),y(e,"fill",Ji(t[0].K[t[11]][t[14]]))},m(t,n){s(t,e,n)},p(t,a){2&a&&n!==(n=2*t[1])&&g(e,"width",n),2&a&&r!==(r=2*t[1])&&g(e,"height",r),1&a&&i!==(i=t[3](t[11]))&&g(e,"x",i),1&a&&o!==(o=t[3](t[14]))&&g(e,"y",o),1&a&&y(e,"fill",Ji(t[0].K[t[11]][t[14]]))},d(t){t&&h(e)}}}function Yi(t){let e,n=Zi(t[0].n),r=[];for(let e=0;e<n.length;e+=1)r[e]=Wi(Gi(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,i){if(11&i){let o;for(n=Zi(t[0].n),o=0;o<n.length;o+=1){const a=Gi(t,n,o);r[o]?r[o].p(a,i):(r[o]=Wi(a),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){l(r,t),t&&h(e)}}}function Qi(e){let n,r,i,o,m,p,v,b,x,w,y,_,M=Zi(e[0].n),T=[];for(let t=0;t<M.length;t+=1)T[t]=Yi(Bi(e,M,t));return{c(){n=u("div"),r=u("div"),i=u("div"),o=c("svg");for(let t=0;t<T.length;t+=1)T[t].c();p=d(),v=u("div"),b=u("p"),x=f("The "),w=u("d-math"),y=f("'th row is the vector of evaluation \n      "),_=u("d-math"),g(o,"class","inner-plot full svelte-8j35ro"),g(i,"class","square svelte-8j35ro"),P((()=>e[7].call(i))),g(r,"class","col center svelte-8j35ro"),g(n,"class","pad svelte-8j35ro")},m(t,h){s(t,n,h),a(n,r),a(r,i),a(i,o);for(let t=0;t<T.length;t+=1)T[t].m(o,null);m=E(i,e[7].bind(i)),a(r,p),a(r,v),a(v,b),a(b,x),a(b,w),w.innerHTML="i",a(b,y),a(b,_),_.innerHTML="(f_i(x_1), f_i(x_2), \\cdots, f_i(x_n))"},p(t,[e]){if(11&e){let n;for(M=Zi(t[0].n),n=0;n<M.length;n+=1){const r=Bi(t,M,n);T[n]?T[n].p(r,e):(T[n]=Yi(r),T[n].c(),T[n].m(o,null))}for(;n<T.length;n+=1)T[n].d(1);T.length=M.length}},i:t,o:t,d(t){t&&h(n),l(T,t),m()}}}function Ji(t){var e=255*t;return`rgba(${255-e}, ${255-e}, 255)`}function Zi(t){return[...Array(t).keys()]}function to(t,e,n){let r,i,{sig:o}=e,{cn:a}=e,{plot:s}=e,{space:h=10}=e;function l(){n(0,s.touch++,s),n(1,r=(i-(s.n-1)*h)/s.n/2)}return new zr(o,a,l),k((()=>{l(),console.log(`Matrix w=${i}`)})),t.$$set=t=>{"sig"in t&&n(4,o=t.sig),"cn"in t&&n(5,a=t.cn),"plot"in t&&n(0,s=t.plot),"space"in t&&n(6,h=t.space)},[s,r,i,function(t){return(2*r+h)*t},o,a,h,function(){i=this.clientWidth,n(2,i)}]}class eo extends B{constructor(t){super(),K(this,t,to,Qi,o,{sig:4,cn:5,plot:0,space:6})}}function no(e){let n,r,i,o,l,c,f,m,p,v,b,x,w,y;return o=new ii({props:{sig:e[3],cn:"1",box:e[0],cfg:e[1],plot:e[2]}}),c=new hi({props:{sig:e[3],cn:"2",cfg:e[1],plot:e[2]}}),m=new di({props:{sig:e[3],cn:"3",plot:e[2]}}),b=new Ki({props:{sig:e[3],cn:"4",plot:e[2]}}),w=new eo({props:{sig:e[3],cn:"5",plot:e[2]}}),{c(){n=u("div"),r=u("div"),i=u("div"),D(o.$$.fragment),l=d(),D(c.$$.fragment),f=d(),D(m.$$.fragment),p=d(),v=u("div"),D(b.$$.fragment),x=d(),D(w.$$.fragment),g(i,"class","col full svelte-59d2b5"),g(r,"class","row full svelte-59d2b5"),g(v,"class","row full svelte-59d2b5"),g(n,"class","col full svelte-59d2b5")},m(t,e){s(t,n,e),a(n,r),a(r,i),z(o,i,null),a(i,l),z(c,i,null),a(r,f),z(m,r,null),a(n,p),a(n,v),z(b,v,null),a(v,x),z(w,v,null),y=!0},p:t,i(t){y||(X(o.$$.fragment,t),X(c.$$.fragment,t),X(m.$$.fragment,t),X(b.$$.fragment,t),X(w.$$.fragment,t),y=!0)},o(t){q(o.$$.fragment,t),q(c.$$.fragment,t),q(m.$$.fragment,t),q(b.$$.fragment,t),q(w.$$.fragment,t),y=!1},d(t){t&&h(n),O(o),O(c),O(m),O(b),O(w)}}}function ro(t){let e={w:10,h:10},n=new Dr(e.w,e.h,[-4,4],[-4,4]);return[e,{show_data:!0,show_scaled:!0,show_solution:!0,show_points:!1,auto_solve:!1},new qr(n,3),Q(0)]}class io extends B{constructor(t){super(),K(this,t,ro,no,o,{})}}function oo(t,e){return t[0]*e[0]+t[1]*e[1]}function ao(t,e){return function(t,e){return[t[0]*e,t[1]*e]}(t,oo(t,e)/oo(n=t,n));var n}class so{constructor(t){this.basis=new Rt([[1,0],[0,0]]),this.xTou=Pr().domain([-t,t]),this.yTov=Pr().domain([-t,t]);var e=new Dr(10,10,[-4,4],[-4,4]);this.plot=new qr(e,2),this.updateBasis(),this.plot.initK(),this.plot.initCurveCache()}toUV(t,e){return 0==e?this.xTou(t):this.yTov(t)}toXY(t,e){return 0==e?this.xTou.invert(t):this.yTov.invert(t)}resizePhi(t,e){this.xTou.range([0,t]),this.yTov.range([e,0])}resizeCtx(t,e){this.plot.resize(t,e)}updateBasis(){var t=this.plot.K[0][1],e=Math.acos(t);this.basis[1][0]=Math.cos(e),this.basis[1][1]=Math.sin(e)}updateF(t,e){var n=this.toXY(t,0),r=this.toXY(e,1),i=new Rt([[n,r]]);this.plot.alpha=i.mmul(Ct(this.basis)).flat()}F(t){var e=this.alpha().mmul(this.basis).flat();return this.toUV(e[t],t)}updateY(t,e){var n=[this.toXY(t,0),this.toXY(e,1)],r=new Rt([n]).mmul(this.basis.transpose()).flat();this.plot.y=r}_fHat(){return new Rt([this.plot.solutionAlpha()]).mmul(this.basis).flat()}fHat(t){var e=this._fHat();return this.toUV(e[t],t)}fHatProj(t,e){var n=ao(this.basis[t],this._fHat())[e];return this.toUV(n,e)}alpha(){return new Rt([this.plot.alpha])}Fproj(t,e){var n=this.alpha().mmul(this.plot.K)[0][t]*this.basis[t][e];return this.toUV(n,e)}Yproj(t,e){var n=new Rt([this.plot.y]).mmul(this.basis.transpose())[0][t]*this.basis[t][e];return this.toUV(n,e)}scr(t,e){return this.toUV(this.basis[t][e],e)}}function ho(t,e,n){const r=t.slice();return r[14]=e[n],r}function lo(t){let e,n,r,i,o,a,l,u,f,d;return{c(){e=c("line"),a=c("line"),g(e,"class","basis svelte-7fxcc2"),g(e,"x1",n=t[0].xTou(0)),g(e,"y1",r=t[0].yTov(0)),g(e,"x2",i=t[0].scr(t[14],0)),g(e,"y2",o=t[0].scr(t[14],1)),g(e,"marker-end","url(#basis-arrow)"),g(a,"class","perp svelte-7fxcc2"),g(a,"x1",l=t[0].fHat(0)),g(a,"y1",u=t[0].fHat(1)),g(a,"x2",f=t[0].fHatProj(t[14],0)),g(a,"y2",d=t[0].fHatProj(t[14],1)),g(a,"stroke-dasharray","4 4")},m(t,n){s(t,e,n),s(t,a,n)},p(t,s){1&s&&n!==(n=t[0].xTou(0))&&g(e,"x1",n),1&s&&r!==(r=t[0].yTov(0))&&g(e,"y1",r),1&s&&i!==(i=t[0].scr(t[14],0))&&g(e,"x2",i),1&s&&o!==(o=t[0].scr(t[14],1))&&g(e,"y2",o),1&s&&l!==(l=t[0].fHat(0))&&g(a,"x1",l),1&s&&u!==(u=t[0].fHat(1))&&g(a,"y1",u),1&s&&f!==(f=t[0].fHatProj(t[14],0))&&g(a,"x2",f),1&s&&d!==(d=t[0].fHatProj(t[14],1))&&g(a,"y2",d)},d(t){t&&h(e),t&&h(a)}}}function uo(e){let n,i,o,m,v,b,w,y,_,M,T,L,k,H,R,A,S,C,$,j,I,F,N,U,X,q,D,z,O,V,K,B,G,W,Y,Q,J,Z,tt,et,nt,rt=oi(e[0].plot.x[0])+"",it=oi(Math.sqrt(e[0].plot.get_sigma2()))+"",ot=oi(e[0].plot.x[1])+"",at=oi(Math.sqrt(e[0].plot.get_sigma2()))+"",st=[0,1],ht=[];for(let t=0;t<2;t+=1)ht[t]=lo(ho(e,st,t));return{c(){n=u("div"),i=u("div"),o=c("svg"),m=c("defs"),v=c("marker"),b=c("path"),w=c("marker"),y=c("path"),_=c("marker"),M=c("path");for(let t=0;t<2;t+=1)ht[t].c();T=c("circle"),H=c("line"),j=d(),I=u("div"),F=u("p"),N=f("Plane spanned by vectors \n    "),U=u("d-math"),X=f("("),q=f(rt),D=f("; "),z=u("d-math"),O=f("="),V=f(it),K=f(") and\n    "),B=u("d-math"),G=f("("),W=f(ot),Y=f("; "),Q=u("d-math"),J=f("="),Z=f(at),tt=f(")"),g(b,"d","M 0 0 L 10 5 L 0 10 z"),g(v,"id","solution-arrow"),g(v,"class","solution-arrow svelte-7fxcc2"),g(v,"viewBox","0 0 10 10"),g(v,"refX","10"),g(v,"refY","5"),g(v,"markerWidth","6"),g(v,"markerHeight","6"),g(v,"orient","auto-start-reverse"),g(y,"d","M 0 0 L 10 5 L 0 10 z"),g(w,"id","basis-arrow"),g(w,"class","basis-arrow svelte-7fxcc2"),g(w,"viewBox","0 0 10 10"),g(w,"refX","10"),g(w,"refY","5"),g(w,"markerWidth","6"),g(w,"markerHeight","6"),g(w,"orient","auto-start-reverse"),g(M,"d","M 3 0 L 6 0 L 6 10 L 3 10 z"),g(_,"id","flat-head"),g(_,"class","flat-head"),g(_,"viewBox","0 0 10 10"),g(_,"refX","5"),g(_,"refY","5"),g(_,"markerWidth","10"),g(_,"markerHeight","10"),g(_,"orient","auto-start-reverse"),g(T,"id","fhat"),g(T,"class","perp-target draggable svelte-7fxcc2"),g(T,"r","6"),g(T,"cx",L=e[0].fHat(0)),g(T,"cy",k=e[0].fHat(1)),g(H,"class","solution-curve draggable svelte-7fxcc2"),g(H,"x1",R=e[0].xTou(0)),g(H,"y1",A=e[0].yTov(0)),g(H,"x2",S=e[0].F(0)),g(H,"y2",C=e[0].F(1)),g(H,"marker-end","url(#solution-arrow)"),g(o,"class","inner-plot full svelte-7fxcc2"),g(i,"class","grow pad svelte-7fxcc2"),P((()=>e[8].call(i))),g(I,"class",""),g(n,"class","col full svelte-7fxcc2")},m(t,r){s(t,n,r),a(n,i),a(i,o),a(o,m),a(m,v),a(v,b),a(m,w),a(w,y),a(m,_),a(_,M);for(let t=0;t<2;t+=1)ht[t].m(o,null);a(o,T),a(o,H),$=E(i,e[8].bind(i)),a(n,j),a(n,I),a(I,F),a(F,N),a(F,U),U.innerHTML="\\phi",a(F,X),a(F,q),a(F,D),a(F,z),z.innerHTML="\\sigma",a(F,O),a(F,V),a(F,K),a(F,B),B.innerHTML="\\phi",a(F,G),a(F,W),a(F,Y),a(F,Q),Q.innerHTML="\\sigma",a(F,J),a(F,Z),a(F,tt),et||(nt=[p(T,"mousedown",e[3]),p(H,"mousedown",e[3]),p(o,"mousemove",e[4]),p(o,"mouseup",e[5])],et=!0)},p(t,[e]){if(1&e){let n;for(st=[0,1],n=0;n<2;n+=1){const r=ho(t,st,n);ht[n]?ht[n].p(r,e):(ht[n]=lo(r),ht[n].c(),ht[n].m(o,T))}for(;n<2;n+=1)ht[n].d(1)}1&e&&L!==(L=t[0].fHat(0))&&g(T,"cx",L),1&e&&k!==(k=t[0].fHat(1))&&g(T,"cy",k),1&e&&R!==(R=t[0].xTou(0))&&g(H,"x1",R),1&e&&A!==(A=t[0].yTov(0))&&g(H,"y1",A),1&e&&S!==(S=t[0].F(0))&&g(H,"x2",S),1&e&&C!==(C=t[0].F(1))&&g(H,"y2",C),1&e&&rt!==(rt=oi(t[0].plot.x[0])+"")&&x(q,rt),1&e&&it!==(it=oi(Math.sqrt(t[0].plot.get_sigma2()))+"")&&x(V,it),1&e&&ot!==(ot=oi(t[0].plot.x[1])+"")&&x(W,ot),1&e&&at!==(at=oi(Math.sqrt(t[0].plot.get_sigma2()))+"")&&x(Z,at)},i:t,o:t,d(t){t&&h(n),l(ht,t),$(),et=!1,r(nt)}}}function co(t,e,n){let{sig:r}=e,{cn:i}=e,{pp:o}=e;function a(){o.updateBasis(),n(0,o.plot.touch++,o),n(0,o.touch++,o)}var s=new zr(r,i,a);let h,l,u=null;return k((()=>{o.resizePhi(h,l),o.resizeCtx(undefined,undefined),a()})),t.$$set=t=>{"sig"in t&&n(6,r=t.sig),"cn"in t&&n(7,i=t.cn),"pp"in t&&n(0,o=t.pp)},[o,h,l,function(t){u=t.target},function(t){null!=u&&("fhat"==u.id?o.updateY(t.offsetX,t.offsetY):o.updateF(t.offsetX,t.offsetY),a(),s.notify())},function(t){u=null},r,i,function(){h=this.clientWidth,l=this.clientHeight,n(1,h),n(2,l)}]}class fo extends B{constructor(t){super(),K(this,t,co,uo,o,{sig:6,cn:7,pp:0})}}function mo(e){let n,r,i,o,l,c,f,m;return i=new ii({props:{sig:e[3],box:e[0],cfg:e[1],cn:"1",plot:e[2].plot}}),l=new hi({props:{sig:e[3],cfg:e[1],cn:"2",plot:e[2].plot}}),f=new fo({props:{sig:e[3],cn:"3",pp:e[2]}}),{c(){n=u("div"),r=u("div"),D(i.$$.fragment),o=d(),D(l.$$.fragment),c=d(),D(f.$$.fragment),g(r,"class","col full svelte-59d2b5"),g(n,"class","row full svelte-59d2b5")},m(t,e){s(t,n,e),a(n,r),z(i,r,null),a(r,o),z(l,r,null),a(n,c),z(f,n,null),m=!0},p:t,i(t){m||(X(i.$$.fragment,t),X(l.$$.fragment,t),X(f.$$.fragment,t),m=!0)},o(t){q(i.$$.fragment,t),q(l.$$.fragment,t),q(f.$$.fragment,t),m=!1},d(t){t&&h(n),O(i),O(l),O(f)}}}function po(t){return[{w:10,h:10},{show_data:!0,show_scaled:!0,show_solution:!0,show_points:!1,auto_solve:!0,log_sigma:0},new so(4),Q(0)]}class go extends B{constructor(t){super(),K(this,t,po,mo,o,{})}}function vo(e){let n,r,i,o,l,c,f,m,p,v,b,x,w,_,M,T,E,L,k,H;return v=new io({}),M=new go({}),E=new W({}),{c(){n=u("main"),r=u("d-front-matter"),r.innerHTML='<script type="text/json">{\n        "title": "Introduction to Kernel Regression",\n      "description": "A gentle introduction to Kernel Regression",\n      "authors": [\n      {\n          "author": "Henry Bigelow"\n      }\n      ]\n      }<\/script>',i=d(),o=u("d-title"),o.innerHTML="<h1>Introduction to Kernel Regression</h1>",l=d(),c=u("d-byline"),f=d(),m=u("d-article"),p=u("figure"),D(v.$$.fragment),b=d(),x=u("figcaption"),x.textContent="Interactive plot.  You can drag the black points",w=d(),_=u("figure"),D(M.$$.fragment),T=d(),D(E.$$.fragment),L=d(),k=u("d-appendix"),y(o,"padding-bottom","0"),g(p,"class","l-page-outset"),g(_,"class","l-page-outset"),y(_,"height","500px")},m(t,e){s(t,n,e),a(n,r),a(n,i),a(n,o),a(n,l),a(n,c),a(n,f),a(n,m),a(m,p),z(v,p,null),a(p,b),a(p,x),a(m,w),a(m,_),z(M,_,null),a(m,T),z(E,m,null),a(n,L),a(n,k),H=!0},p:t,i(t){H||(X(v.$$.fragment,t),X(M.$$.fragment,t),X(E.$$.fragment,t),H=!0)},o(t){q(v.$$.fragment,t),q(M.$$.fragment,t),q(E.$$.fragment,t),H=!1},d(t){t&&h(n),O(v),O(M),O(E)}}}return new class extends B{constructor(t){super(),K(this,t,null,vo,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
