var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function u(t){t.parentNode.removeChild(t)}function l(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function h(t){return document.createElement(t)}function c(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function m(){return f(" ")}function d(){return f("")}function g(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function v(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function p(t,e,r){t.setAttributeNS("http://www.w3.org/1999/xlink",e,r)}function w(t){return""===t?null:+t}function x(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function y(t,e){t.value=null==e?"":e}function b(t,e,r,n){t.style.setProperty(e,r,n?"important":"")}let _,M;function E(){if(void 0===_){_=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){_=!0}}return _}function T(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const r=h("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const n=E();let i;return n?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=g(window,"message",(t=>{t.source===r.contentWindow&&e()}))):(r.src="about:blank",r.onload=()=>{i=g(r.contentWindow,"resize",e)}),o(t,r),()=>{(n||i&&r.contentWindow)&&i(),u(r)}}class R{constructor(){this.e=this.n=null}c(t){this.h(t)}m(t,e,r=null){this.e||(this.e=h(e.nodeName),this.t=e,this.c(t)),this.i(r)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)a(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(u)}}function A(t){M=t}function k(t){(function(){if(!M)throw new Error("Function called outside component initialization");return M})().$$.on_mount.push(t)}const S=[],N=[],C=[],P=[],$=Promise.resolve();let L=!1;function U(t){C.push(t)}let j=!1;const I=new Set;function X(){if(!j){j=!0;do{for(let t=0;t<S.length;t+=1){const e=S[t];A(e),D(e.$$)}for(A(null),S.length=0;N.length;)N.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];I.has(e)||(I.add(e),e())}C.length=0}while(S.length);for(;P.length;)P.pop()();L=!1,j=!1,I.clear()}}function D(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(U)}}const F=new Set;function z(t,e){t&&t.i&&(F.delete(t),t.i(e))}function O(t,e,r,n){if(t&&t.o){if(F.has(t))return;F.add(t),undefined.c.push((()=>{F.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}function H(t){t&&t.c()}function V(t,r,s,o){const{fragment:a,on_mount:u,on_destroy:l,after_update:h}=t.$$;a&&a.m(r,s),o||U((()=>{const r=u.map(e).filter(i);l?l.push(...r):n(r),t.$$.on_mount=[]})),h.forEach(U)}function q(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function B(t,e){-1===t.$$.dirty[0]&&(S.push(t),L||(L=!0,$.then(X)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function G(e,i,s,o,a,l,h,c=[-1]){const f=M;A(e);const m=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:i.context||[]),callbacks:r(),dirty:c,skip_bound:!1,root:i.target||f.$$.root};h&&h(m.root);let d=!1;if(m.ctx=s?s(e,i.props||{},((t,r,...n)=>{const i=n.length?n[0]:r;return m.ctx&&a(m.ctx[t],m.ctx[t]=i)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](i),d&&B(e,t)),r})):[],m.update(),d=!0,n(m.before_update),m.fragment=!!o&&o(m.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);m.fragment&&m.fragment.l(t),t.forEach(u)}else m.fragment&&m.fragment.c();i.intro&&z(e.$$.fragment),V(e,i.target,i.anchor,i.customElement),X()}A(f)}class W{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Y=[];function Q(e,r=t){let n;const i=new Set;function o(t){if(s(e,t)&&(e=t,n)){const t=!Y.length;for(const t of i)t[1](),Y.push(t,e);if(t){for(let t=0;t<Y.length;t+=2)Y[t][0](Y[t+1]);Y.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.add(u),1===i.size&&(n=r(o)||t),s(e),()=>{i.delete(u),0===i.size&&(n(),n=null)}}}}const K=Object.prototype.toString;function J(t){return K.call(t).endsWith("Array]")}function Z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],a=n+1;a<s;a++)t[a]>o&&(o=t[a]);return o}function tt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,i=e.toIndex,s=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=n||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[n],a=n+1;a<s;a++)t[a]<o&&(o=t[a]);return o}function et(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!J(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!J(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=tt(t),i=Z(t);if(n===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=r.min,o=void 0===s?r.autoMinMax?n:0:s,a=r.max,u=void 0===a?r.autoMinMax?i:1:a;if(o>=u)throw new RangeError("min option must be smaller than max option");for(var l=(u-o)/(i-n),h=0;h<t.length;h++)e[h]=(t[h]-n)*l+o;return e}class rt{constructor(t){var e,r,n,i,s,o,a,u,l,h=(t=St.checkMatrix(t)).clone(),c=h.rows,f=h.columns,m=new Array(c),d=1;for(e=0;e<c;e++)m[e]=e;for(u=new Array(c),r=0;r<f;r++){for(e=0;e<c;e++)u[e]=h.get(e,r);for(e=0;e<c;e++){for(l=Math.min(e,r),s=0,n=0;n<l;n++)s+=h.get(e,n)*u[n];u[e]-=s,h.set(e,r,u[e])}for(i=r,e=r+1;e<c;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==r){for(n=0;n<f;n++)o=h.get(i,n),h.set(i,n,h.get(r,n)),h.set(r,n,o);a=m[i],m[i]=m[r],m[r]=a,d=-d}if(r<c&&0!==h.get(r,r))for(e=r+1;e<c;e++)h.set(e,r,h.get(e,r)/h.get(r,r))}this.LU=h,this.pivotVector=m,this.pivotSign=d}isSingular(){for(var t=this.LU,e=t.columns,r=0;r<e;r++)if(0===t[r][r])return!0;return!1}solve(t){t=kt.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var r,n,i,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),a=e.columns;for(i=0;i<a;i++)for(r=i+1;r<a;r++)for(n=0;n<s;n++)o[r][n]-=o[i][n]*e[r][i];for(i=a-1;i>=0;i--){for(n=0;n<s;n++)o[i][n]/=e[i][i];for(r=0;r<i;r++)for(n=0;n<s;n++)o[r][n]-=o[i][n]*e[r][i]}return o}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,r=t.columns,n=0;n<r;n++)e*=t[n][n];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new kt(e,r),i=0;i<e;i++)for(var s=0;s<r;s++)n[i][s]=i>s?t[i][s]:i===s?1:0;return n}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new kt(e,r),i=0;i<e;i++)for(var s=0;s<r;s++)n[i][s]=i<=s?t[i][s]:0;return n}get pivotPermutationVector(){return this.pivotVector.slice()}}function nt(t,e){var r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}function it(t,e,r){for(var n=new Array(t),i=0;i<t;i++){n[i]=new Array(e);for(var s=0;s<e;s++)n[i][s]=r}return n}class st{constructor(t,e={}){var r=(t=St.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;var a,u=Boolean(i),l=Boolean(s),h=!1;if(r<n)if(o){r=(a=t.transpose()).rows,n=a.columns,h=!0;var c=u;u=l,l=c}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();var f=Math.min(r,n),m=Math.min(r+1,n),d=new Array(m),g=it(r,f,0),v=it(n,n,0),p=new Array(n),w=new Array(r),x=new Array(m);for(let t=0;t<m;t++)x[t]=t;var y=Math.min(r-1,n),b=Math.max(0,Math.min(n-2,r)),_=Math.max(y,b);for(let t=0;t<_;t++){if(t<y){d[t]=0;for(let e=t;e<r;e++)d[t]=nt(d[t],a[e][t]);if(0!==d[t]){a[t][t]<0&&(d[t]=-d[t]);for(let e=t;e<r;e++)a[e][t]/=d[t];a[t][t]+=1}d[t]=-d[t]}for(let e=t+1;e<n;e++){if(t<y&&0!==d[t]){let n=0;for(let i=t;i<r;i++)n+=a[i][t]*a[i][e];n=-n/a[t][t];for(let i=t;i<r;i++)a[i][e]+=n*a[i][t]}p[e]=a[t][e]}if(u&&t<y)for(let e=t;e<r;e++)g[e][t]=a[e][t];if(t<b){p[t]=0;for(let e=t+1;e<n;e++)p[t]=nt(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<n;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<r&&0!==p[t]){for(let e=t+1;e<r;e++)w[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)w[e]+=p[r]*a[e][r];for(let e=t+1;e<n;e++){let n=-p[e]/p[t+1];for(let i=t+1;i<r;i++)a[i][e]+=n*w[i]}}if(l)for(let e=t+1;e<n;e++)v[e][t]=p[e]}}let M=Math.min(n,r+1);if(y<n&&(d[y]=a[y][y]),r<M&&(d[M-1]=0),b+1<M&&(p[b]=a[b][M-1]),p[M-1]=0,u){for(let t=y;t<f;t++){for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}for(let t=y-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<f;e++){let n=0;for(let i=t;i<r;i++)n+=g[i][t]*g[i][e];n=-n/g[t][t];for(let i=t;i<r;i++)g[i][e]+=n*g[i][t]}for(let e=t;e<r;e++)g[e][t]=-g[e][t];g[t][t]=1+g[t][t];for(let e=0;e<t-1;e++)g[e][t]=0}else{for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}}if(l)for(let t=n-1;t>=0;t--){if(t<b&&0!==p[t])for(let e=t+1;e<n;e++){let r=0;for(let i=t+1;i<n;i++)r+=v[i][t]*v[i][e];r=-r/v[t+1][t];for(let i=t+1;i<n;i++)v[i][e]+=r*v[i][t]}for(let e=0;e<n;e++)v[e][t]=0;v[t][t]=1}for(var E=M-1,T=Number.EPSILON;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+T*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===M-2)e=4;else{let r;for(r=M-1;r>=t&&r!==t;r--){let e=(r!==M?Math.abs(p[r]):0)+(r!==t+1?Math.abs(p[r-1]):0);if(Math.abs(d[r])<=T*e){d[r]=0;break}}r===t?e=3:r===M-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=p[M-2];p[M-2]=0;for(let r=M-2;r>=t;r--){let i=nt(d[r],e),s=d[r]/i,o=e/i;if(d[r]=i,r!==t&&(e=-o*p[r-1],p[r-1]=s*p[r-1]),l)for(let t=0;t<n;t++)i=s*v[t][r]+o*v[t][M-1],v[t][M-1]=-o*v[t][r]+s*v[t][M-1],v[t][r]=i}break}case 2:{let e=p[t-1];p[t-1]=0;for(let n=t;n<M;n++){let i=nt(d[n],e),s=d[n]/i,o=e/i;if(d[n]=i,e=-o*p[n],p[n]=s*p[n],u)for(let e=0;e<r;e++)i=s*g[e][n]+o*g[e][t-1],g[e][t-1]=-o*g[e][n]+s*g[e][t-1],g[e][n]=i}break}case 3:{const e=Math.max(Math.abs(d[M-1]),Math.abs(d[M-2]),Math.abs(p[M-2]),Math.abs(d[t]),Math.abs(p[t])),i=d[M-1]/e,s=d[M-2]/e,o=p[M-2]/e,a=d[t]/e,h=p[t]/e,c=((s+i)*(s-i)+o*o)/2,f=i*o*(i*o);let m=0;0===c&&0===f||(m=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),m=f/(c+m));let w=(a+i)*(a-i)+m,x=a*h;for(let e=t;e<M-1;e++){let i=nt(w,x);0===i&&(i=Number.MIN_VALUE);let s=w/i,o=x/i;if(e!==t&&(p[e-1]=i),w=s*d[e]+o*p[e],p[e]=s*p[e]-o*d[e],x=o*d[e+1],d[e+1]=s*d[e+1],l)for(let t=0;t<n;t++)i=s*v[t][e]+o*v[t][e+1],v[t][e+1]=-o*v[t][e]+s*v[t][e+1],v[t][e]=i;if(i=nt(w,x),0===i&&(i=Number.MIN_VALUE),s=w/i,o=x/i,d[e]=i,w=s*p[e]+o*d[e+1],d[e+1]=-o*p[e]+s*d[e+1],x=o*p[e+1],p[e+1]=s*p[e+1],u&&e<r-1)for(let t=0;t<r;t++)i=s*g[t][e]+o*g[t][e+1],g[t][e+1]=-o*g[t][e]+s*g[t][e+1],g[t][e]=i}p[M-2]=w;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,l))for(let e=0;e<=E;e++)v[e][t]=-v[e][t];for(;t<E&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,l&&t<n-1)for(let r=0;r<n;r++)e=v[r][t+1],v[r][t+1]=v[r][t],v[r][t]=e;if(u&&t<r-1)for(let n=0;n<r;n++)e=g[n][t+1],g[n][t+1]=g[n][t],g[n][t]=e;t++}M--}}if(h){var R=v;v=g,g=R}this.m=r,this.n=n,this.s=d,this.U=g,this.V=v}solve(t){var e=t,r=this.threshold,n=this.s.length,i=kt.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?i[t][t]=0:i[t][t]=1/this.s[t];var s=this.U,o=this.rightSingularVectors,a=o.mmul(i),u=o.rows,l=s.length,h=kt.zeros(u,l);for(let t=0;t<u;t++)for(let e=0;e<l;e++){let r=0;for(let i=0;i<n;i++)r+=a[t][i]*s[e][i];h[t][e]=r}return h.mmul(e)}solveForDiagonal(t){return this.solve(kt.diag(t))}inverse(){var t=this.V,e=this.threshold,r=t.length,n=t[0].length,i=new kt(r,this.s.length);for(let s=0;s<r;s++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e?i[s][r]=t[s][r]/this.s[r]:i[s][r]=0;var s=this.U,o=s.length,a=s[0].length,u=new kt(r,o);for(let t=0;t<r;t++)for(let e=0;e<o;e++){let r=0;for(let n=0;n<a;n++)r+=i[t][n]*s[e][n];u[t][e]=r}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s,n=0,i=r.length;n<i;n++)r[n]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return kt.isMatrix(this.U)||(this.U=new kt(this.U)),this.U}get rightSingularVectors(){return kt.isMatrix(this.V)||(this.V=new kt(this.V)),this.V}get diagonalMatrix(){return kt.diag(this.s)}}function ot(t,e,r){var n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function at(t,e,r){var n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function ut(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function lt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function ht(t,e,r){return{row:ct(t,e),column:ft(t,r)}}function ct(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function ft(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function mt(t,e,r,n,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(vt("startRow",e),vt("endRow",r),vt("startColumn",n),vt("endColumn",i),e>r||n>i||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function dt(t){for(var e=kt.zeros(t.rows,1),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(r,0,e.get(r,0)+t.get(r,n));return e}function gt(t){for(var e=kt.zeros(1,t.columns),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(0,n,e.get(0,n)+t.get(r,n));return e}function vt(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class pt extends(At()){constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}static get[Symbol.species](){return kt}}class wt extends pt{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class xt extends pt{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class yt extends pt{constructor(t,e,r,n,i){mt(t,e,r,n,i),super(t,r-e+1,i-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class bt extends pt{constructor(t,e,r){var n=ht(t,e,r);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class _t extends pt{constructor(t,e){super(t,(e=ct(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class Mt extends pt{constructor(t,e){e=ft(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class Et extends pt{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class Tt extends pt{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class Rt extends pt{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function At(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,e),i=0;i<t;i++)for(var s=0;s<e;s++)n.set(i,s,r[i*e+s]);return n}static rowVector(t){for(var e=new this(1,t.length),r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){for(var e=new this(t.length,1),r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,r){void 0===r&&(r=Math.random);for(var n=this.empty(t,e),i=0;i<t;i++)for(var s=0;s<e;s++)n.set(i,s,r());return n}static randInt(t,e,r,n){void 0===r&&(r=1e3),void 0===n&&(n=Math.random);for(var i=this.empty(t,e),s=0;s<t;s++)for(var o=0;o<e;o++){var a=Math.floor(n()*r);i.set(s,o,a)}return i}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);for(var n=Math.min(t,e),i=this.zeros(t,e),s=0;s<n;s++)i.set(s,s,r);return i}static diag(t,e,r){var n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);for(var i=Math.min(n,e,r),s=this.zeros(e,r),o=0;o<i;o++)s.set(o,o,t[o]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),s=0;s<r;s++)for(var o=0;o<n;o++)i.set(s,o,Math.min(t.get(s,o),e.get(s,o)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,i=new this(r,n),s=0;s<r;s++)for(var o=0;o<n;o++)i.set(s,o,Math.max(t.get(s,o),e.get(s,o)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,r=this.columns,n=0;n<e;n++)for(var i=0;i<r;i++)t.call(this,n,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t[e*this.columns+r]=this.get(e,r);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var r=0;r<this.columns;r++)t[e][r]=this.get(e,r)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,i=!1;for(;t<this.rows&&n;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(n=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}set(t,e,r){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var r=new this.constructor[Symbol.species](this.rows*t,this.columns*e),n=0;n<t;n++)for(var i=0;i<e;i++)r.setSubMatrix(this,this.rows*n,this.columns*i);return r}fill(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){ot(this,t);for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.get(t,r);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){ot(this,t),e=ut(this,e);for(var r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){ot(this,t),ot(this,e);for(var r=0;r<this.columns;r++){var n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){at(this,t);for(var e=new Array(this.rows),r=0;r<this.rows;r++)e[r]=this.get(r,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){at(this,t),e=lt(this,e);for(var r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){at(this,t),at(this,e);for(var r=0;r<this.rows;r++){var n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=ut(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=lt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){ot(this,t);for(var r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){at(this,t);for(var r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){ot(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){ot(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){ot(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){ot(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){at(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){at(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){at(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){at(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),r=0;r<t;r++)e[r]=this.get(r,r);return e}sum(t){switch(t){case"row":return dt(this);case"column":return gt(this);default:return function(t){for(var e=0,r=0;r<t.rows;r++)for(var n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t*=this.get(e,r);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e+=this.get(r,n)*this.get(r,n);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,i=0;i<r.length;i++)n+=r[i]*t[i];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,r=this.columns,n=t.columns,i=new this.constructor[Symbol.species](e,n),s=new Array(r),o=0;o<n;o++){for(var a=0;a<r;a++)s[a]=t.get(a,o);for(var u=0;u<e;u++){var l=0;for(a=0;a<r;a++)l+=this.get(u,a)*s[a];i.set(u,o,l)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const r=this.get(0,0),n=t.get(0,0),i=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),u=this.get(1,1),l=t.get(1,1),h=(r+u)*(n+l),c=(o+u)*n,f=r*(s-l),m=u*(a-n),d=(r+i)*l,g=h+m-d+(i-u)*(a+l),v=f+d,p=c+m,w=h-c+f+(o-r)*(n+s);return e.set(0,0,g),e.set(0,1,v),e.set(1,0,p),e.set(1,1,w),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const r=this.get(0,0),n=this.get(0,1),i=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),u=this.get(2,0),l=this.get(2,1),h=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),d=t.get(1,0),g=t.get(1,1),v=t.get(1,2),p=t.get(2,0),w=t.get(2,1),x=t.get(2,2),y=(r-s)*(-f+g),b=(-r+s+o)*(c-f+g),_=(s+o)*(-c+f),M=r*c,E=(-r+u+l)*(c-m+v),T=(-r+u)*(m-v),R=(u+l)*(-c+m),A=(-i+l+h)*(g+p-w),k=(i-h)*(g-w),S=i*p,N=(l+h)*(-p+w),C=(-i+o+a)*(v+p-x),P=(i-a)*(v-x),$=(o+a)*(-p+x),L=M+S+n*d,U=(r+n+i-s-o-l-h)*g+b+_+M+A+S+N,j=M+E+R+(r+n+i-o-a-u-l)*v+S+C+$,I=y+o*(-c+f+d-g-v-p+x)+b+M+S+C+P,X=y+b+_+M+a*w,D=S+C+P+$+s*m,F=M+E+T+l*(-c+m+d-g-v-p+w)+A+k+S,z=A+k+S+N+u*f,O=M+E+T+R+h*x;return e.set(0,0,L),e.set(0,1,U),e.set(0,2,j),e.set(1,0,I),e.set(1,1,X),e.set(1,2,D),e.set(2,0,F),e.set(2,1,z),e.set(2,2,O),e}mmulStrassen(t){var r=this.clone(),n=r.rows,i=r.columns,s=t.rows,o=t.columns;function a(t,r,n){var i=t.rows,s=t.columns;if(i===r&&s===n)return t;var o=e.zeros(r,n);return o=o.setSubMatrix(t,0,0)}i!==s&&console.warn(`Multiplying ${n} x ${i} and ${s} x ${o} matrix: dimensions do not match.`);var u=Math.max(n,s),l=Math.max(i,o);return function t(r,n,i,s){if(i<=512||s<=512)return r.mmul(n);i%2==1&&s%2==1?(r=a(r,i+1,s+1),n=a(n,i+1,s+1)):i%2==1?(r=a(r,i+1,s),n=a(n,i+1,s)):s%2==1&&(r=a(r,i,s+1),n=a(n,i,s+1));var o=parseInt(r.rows/2,10),u=parseInt(r.columns/2,10),l=r.subMatrix(0,o-1,0,u-1),h=n.subMatrix(0,o-1,0,u-1),c=r.subMatrix(0,o-1,u,r.columns-1),f=n.subMatrix(0,o-1,u,n.columns-1),m=r.subMatrix(o,r.rows-1,0,u-1),d=n.subMatrix(o,n.rows-1,0,u-1),g=r.subMatrix(o,r.rows-1,u,r.columns-1),v=n.subMatrix(o,n.rows-1,u,n.columns-1),p=t(e.add(l,g),e.add(h,v),o,u),w=t(e.add(m,g),h,o,u),x=t(l,e.sub(f,v),o,u),y=t(g,e.sub(d,h),o,u),b=t(e.add(l,c),v,o,u),_=t(e.sub(m,l),e.add(h,f),o,u),M=t(e.sub(c,g),e.add(d,v),o,u),E=e.add(p,y);E.sub(b),E.add(M);var T=e.add(x,b),R=e.add(w,y),A=e.sub(p,w);A.add(x),A.add(_);var k=e.zeros(2*E.rows,2*E.columns);return(k=(k=(k=(k=k.setSubMatrix(E,0,0)).setSubMatrix(T,E.rows,0)).setSubMatrix(R,0,E.columns)).setSubMatrix(A,E.rows,E.columns)).subMatrix(0,i-1,0,s-1)}(r=a(r,u,l),t=a(t,u,l),u,l)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var i=et(this.getRow(n),{min:t,max:e});r.setRow(n,i)}return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var i=et(this.getColumn(n),{min:t,max:e});r.setColumn(n,i)}return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,r=this.columns,n=t.rows,i=t.columns,s=new this.constructor[Symbol.species](e*n,r*i),o=0;o<e;o++)for(var a=0;a<r;a++)for(var u=0;u<n;u++)for(var l=0;l<i;l++)s[n*o+u][i*a+l]=this.get(o,a)*t.get(u,l);return s}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t){void 0===t&&(t=r);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=r);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){mt(this,t,e,r,n);for(var i=new this.constructor[Symbol.species](e-t+1,n-r+1),s=t;s<=e;s++)for(var o=r;o<=n;o++)i[s-t][o-r]=this.get(s,o);return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,r-e+1),i=0;i<t.length;i++)for(var s=e;s<=r;s++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);n.set(i,s-e,this.get(t[i],s))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](r-e+1,t.length),i=0;i<t.length;i++)for(var s=e;s<=r;s++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);n.set(s-e,i,this.get(s,t[i]))}return n}setSubMatrix(t,e,r){mt(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,r,r+t.columns-1);for(var n=0;n<t.rows;n++)for(var i=0;i<t.columns;i++)this[e+n][r+i]=t.get(n,i);return this}selection(t,e){for(var r=ht(this,t,e),n=new this.constructor[Symbol.species](t.length,e.length),i=0;i<r.row.length;i++)for(var s=r.row[i],o=0;o<r.column.length;o++){var a=r.column[o];n[i][o]=this.get(s,a)}return n}trace(){for(var t=Math.min(this.rows,this.columns),e=0,r=0;r<t;r++)e+=this.get(r,r);return e}transposeView(){return new wt(this)}rowView(t){return ot(this,t),new xt(this,t)}columnView(t){return at(this,t),new Et(this,t)}flipRowView(){return new Tt(this)}flipColumnView(){return new Rt(this)}subMatrixView(t,e,r,n){return new yt(this,t,e,r,n)}selectionView(t,e){return new bt(this,t,e)}rowSelectionView(t){return new _t(this,t)}columnSelectionView(t){return new Mt(this,t)}det(){var t,e,r,n,i,s;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),r=this.get(1,0),t*this.get(1,1)-e*r):3===this.columns?(n=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),s=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),r=this.get(0,2),t*n.det()-e*i.det()+r*s.det()):new rt(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new st(this,{autoTranspose:!0}),r=e.leftSingularVectors,n=e.rightSingularVectors,i=e.diagonal,s=0;s<i.length;s++)Math.abs(i[s])>t?i[s]=1/i[s]:i[s]=0;return i=this.constructor[Symbol.species].diag(i),n.mmul(i.mmul(r.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}}function r(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var n,i="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",s=eval;for(var o of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var a=s(E("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:o[1],op:o[0]})),u=s(E("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${o[1]}S`,op:o[0]})),l=s(E("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${o[1]}M`,op:o[0]})),h=s(E("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:o[1]}));for(n=1;n<o.length;n++)e.prototype[o[n]]=a,e.prototype[`${o[n]}S`]=u,e.prototype[`${o[n]}M`]=l,e[o[n]]=h}var c=[["~","not"]];for(var f of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){c.push([`Math.${t}`,t])})),c)){var m=s(E("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:f[1],method:f[0]})),d=s(E("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:f[1]}));for(n=1;n<f.length;n++)e.prototype[f[n]]=m,e[f[n]]=d}for(var g of[["Math.pow",1,"pow"]]){var v="arg0";for(n=1;n<g[1];n++)v+=`, arg${n}`;if(1!==g[1]){var p=s(E("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:g[2],method:g[0],args:v})),w=s(E(i,{name:g[2],args:v}));for(n=2;n<g.length;n++)e.prototype[g[n]]=p,e[g[n]]=w}else{var x={name:g[2],args:v,method:g[0]},y=s(E("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",x)),b=s(E("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",x)),_=s(E("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",x)),M=s(E("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",x));for(n=2;n<g.length;n++)e.prototype[g[n]]=y,e.prototype[`${g[n]}M`]=_,e.prototype[`${g[n]}S`]=b,e[g[n]]=M}}function E(t,e){for(var r in e)t=t.replace(new RegExp(`%${r}%`,"g"),e[r]);return t}return e}class kt extends(At(Array)){constructor(t,e){var r;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(kt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(r=0;r<t;r++)this[r]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(e=n[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");this[r]=[].concat(n[r])}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this[t][e]=r,this}get(t,e){return this[t][e]}removeRow(t){if(ot(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),ot(this,t,!0),e=ut(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(at(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),at(this,t,!0),e=lt(this,e);for(var r=0;r<this.rows;r++)this[r].splice(t,0,e[r]);return this.columns+=1,this}}At(),Symbol.species;class St extends(At()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return kt}}class Nt{constructor(t){var e,r,n,i,s=(t=St.checkMatrix(t)).clone(),o=t.rows,a=t.columns,u=new Array(a);for(n=0;n<a;n++){var l=0;for(e=n;e<o;e++)l=nt(l,s.get(e,n));if(0!==l){for(s.get(n,n)<0&&(l=-l),e=n;e<o;e++)s.set(e,n,s.get(e,n)/l);for(s.set(n,n,s.get(n,n)+1),r=n+1;r<a;r++){for(i=0,e=n;e<o;e++)i+=s.get(e,n)*s.get(e,r);for(i=-i/s.get(n,n),e=n;e<o;e++)s.set(e,r,s.get(e,r)+i*s.get(e,n))}}u[n]=-l}this.QR=s,this.Rdiag=u}solve(t){t=kt.checkMatrix(t);var e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,i,s,o,a=t.columns,u=t.clone(),l=e.columns;for(s=0;s<l;s++)for(i=0;i<a;i++){for(o=0,n=s;n<r;n++)o+=e[n][s]*u[n][i];for(o=-o/e[s][s],n=s;n<r;n++)u[n][i]+=o*e[n][s]}for(s=l-1;s>=0;s--){for(i=0;i<a;i++)u[s][i]/=this.Rdiag[s];for(n=0;n<s;n++)for(i=0;i<a;i++)u[n][i]-=u[s][i]*e[n][s]}return u.subMatrix(0,l-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,r=this.QR,n=r.columns,i=new kt(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)i[t][e]=t<e?r[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,r,n,i=this.QR,s=i.rows,o=i.columns,a=new kt(s,o);for(r=o-1;r>=0;r--){for(t=0;t<s;t++)a[t][r]=0;for(a[r][r]=1,e=r;e<o;e++)if(0!==i[r][r]){for(n=0,t=r;t<s;t++)n+=i[t][r]*a[t][e];for(n=-n/i[r][r],t=r;t<s;t++)a[t][e]+=n*i[t][r]}}return a}}function Ct(t,e=!1){return t=St.checkMatrix(t),e?new st(t).inverse():Pt(t,kt.eye(t.rows))}function Pt(t,e,r=!1){return t=St.checkMatrix(t),e=St.checkMatrix(e),r?new st(t).solve(e):t.isSquare()?new rt(t).solve(e):new Nt(t).solve(e)}class $t{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=St.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,i,s=t.columns,o=it(s,s,0),a=new Array(s),u=new Array(s),l=t;if(!!r||t.isSymmetric()){for(n=0;n<s;n++)for(i=0;i<s;i++)o[n][i]=l.get(n,i);!function(t,e,r,n){var i,s,o,a,u,l,h,c;for(u=0;u<t;u++)r[u]=n[t-1][u];for(a=t-1;a>0;a--){for(c=0,o=0,l=0;l<a;l++)c+=Math.abs(r[l]);if(0===c)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n[a-1][u],n[a][u]=0,n[u][a]=0;else{for(l=0;l<a;l++)r[l]/=c,o+=r[l]*r[l];for(i=r[a-1],s=Math.sqrt(o),i>0&&(s=-s),e[a]=c*s,o-=i*s,r[a-1]=i-s,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=r[u],n[u][a]=i,s=e[u]+n[u][u]*i,l=u+1;l<=a-1;l++)s+=n[l][u]*r[l],e[l]+=n[l][u]*i;e[u]=s}for(i=0,u=0;u<a;u++)e[u]/=o,i+=e[u]*r[u];for(h=i/(o+o),u=0;u<a;u++)e[u]-=h*r[u];for(u=0;u<a;u++){for(i=r[u],s=e[u],l=u;l<=a-1;l++)n[l][u]-=i*e[l]+s*r[l];r[u]=n[a-1][u],n[a][u]=0}}r[a]=o}for(a=0;a<t-1;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,0!==(o=r[a+1])){for(l=0;l<=a;l++)r[l]=n[l][a+1]/o;for(u=0;u<=a;u++){for(s=0,l=0;l<=a;l++)s+=n[l][a+1]*n[l][u];for(l=0;l<=a;l++)n[l][u]-=s*r[l]}}for(l=0;l<=a;l++)n[l][a+1]=0}for(u=0;u<t;u++)r[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,e[0]=0}(s,u,a,o),function(t,e,r,n){var i,s,o,a,u,l,h,c,f,m,d,g,v,p,w,x;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;var y=0,b=0,_=Number.EPSILON;for(l=0;l<t;l++){for(b=Math.max(b,Math.abs(r[l])+Math.abs(e[l])),h=l;h<t&&!(Math.abs(e[h])<=_*b);)h++;if(h>l)do{for(i=r[l],f=nt(c=(r[l+1]-i)/(2*e[l]),1),c<0&&(f=-f),r[l]=e[l]/(c+f),r[l+1]=e[l]*(c+f),m=r[l+1],s=i-r[l],o=l+2;o<t;o++)r[o]-=s;for(y+=s,c=r[h],g=d=1,v=d,p=e[l+1],w=0,x=0,o=h-1;o>=l;o--)for(v=g,g=d,x=w,i=d*e[o],s=d*c,f=nt(c,e[o]),e[o+1]=w*f,w=e[o]/f,c=(d=c/f)*r[o]-w*i,r[o+1]=s+w*(d*i+w*r[o]),u=0;u<t;u++)s=n[u][o+1],n[u][o+1]=w*n[u][o]+d*s,n[u][o]=d*n[u][o]-w*s;c=-w*x*v*p*e[l]/m,e[l]=w*c,r[l]=d*c}while(Math.abs(e[l])>_*b);r[l]=r[l]+y,e[l]=0}for(o=0;o<t-1;o++){for(u=o,c=r[o],a=o+1;a<t;a++)r[a]<c&&(u=a,c=r[a]);if(u!==o)for(r[u]=r[o],r[o]=c,a=0;a<t;a++)c=n[a][o],n[a][o]=n[a][u],n[a][u]=c}}(s,u,a,o)}else{var h=it(s,s,0),c=new Array(s);for(i=0;i<s;i++)for(n=0;n<s;n++)h[n][i]=l.get(n,i);!function(t,e,r,n){var i,s,o,a,u,l,h,c=0,f=t-1;for(l=c+1;l<=f-1;l++){for(h=0,a=l;a<=f;a++)h+=Math.abs(e[a][l-1]);if(0!==h){for(o=0,a=f;a>=l;a--)r[a]=e[a][l-1]/h,o+=r[a]*r[a];for(s=Math.sqrt(o),r[l]>0&&(s=-s),o-=r[l]*s,r[l]=r[l]-s,u=l;u<t;u++){for(i=0,a=f;a>=l;a--)i+=r[a]*e[a][u];for(i/=o,a=l;a<=f;a++)e[a][u]-=i*r[a]}for(a=0;a<=f;a++){for(i=0,u=f;u>=l;u--)i+=r[u]*e[a][u];for(i/=o,u=l;u<=f;u++)e[a][u]-=i*r[u]}r[l]=h*r[l],e[l][l-1]=h*s}}for(a=0;a<t;a++)for(u=0;u<t;u++)n[a][u]=a===u?1:0;for(l=f-1;l>=c+1;l--)if(0!==e[l][l-1]){for(a=l+1;a<=f;a++)r[a]=e[a][l-1];for(u=l;u<=f;u++){for(s=0,a=l;a<=f;a++)s+=r[a]*n[a][u];for(s=s/r[l]/e[l][l-1],a=l;a<=f;a++)n[a][u]+=s*r[a]}}}(s,h,c,o),function(t,e,r,n,i){var s,o,a,u,l,h,c,f,m,d,g,v,p,w,x,y=t-1,b=0,_=t-1,M=Number.EPSILON,E=0,T=0,R=0,A=0,k=0,S=0,N=0,C=0;for(s=0;s<t;s++)for((s<b||s>_)&&(r[s]=i[s][s],e[s]=0),o=Math.max(s-1,0);o<t;o++)T+=Math.abs(i[s][o]);for(;y>=b;){for(u=y;u>b&&(0===(S=Math.abs(i[u-1][u-1])+Math.abs(i[u][u]))&&(S=T),!(Math.abs(i[u][u-1])<M*S));)u--;if(u===y)i[y][y]=i[y][y]+E,r[y]=i[y][y],e[y]=0,y--,C=0;else if(u===y-1){if(c=i[y][y-1]*i[y-1][y],A=(R=(i[y-1][y-1]-i[y][y])/2)*R+c,N=Math.sqrt(Math.abs(A)),i[y][y]=i[y][y]+E,i[y-1][y-1]=i[y-1][y-1]+E,f=i[y][y],A>=0){for(N=R>=0?R+N:R-N,r[y-1]=f+N,r[y]=r[y-1],0!==N&&(r[y]=f-c/N),e[y-1]=0,e[y]=0,R=(f=i[y][y-1])/(S=Math.abs(f)+Math.abs(N)),A=N/S,R/=k=Math.sqrt(R*R+A*A),A/=k,o=y-1;o<t;o++)N=i[y-1][o],i[y-1][o]=A*N+R*i[y][o],i[y][o]=A*i[y][o]-R*N;for(s=0;s<=y;s++)N=i[s][y-1],i[s][y-1]=A*N+R*i[s][y],i[s][y]=A*i[s][y]-R*N;for(s=b;s<=_;s++)N=n[s][y-1],n[s][y-1]=A*N+R*n[s][y],n[s][y]=A*n[s][y]-R*N}else r[y-1]=f+R,r[y]=f+R,e[y-1]=N,e[y]=-N;y-=2,C=0}else{if(f=i[y][y],m=0,c=0,u<y&&(m=i[y-1][y-1],c=i[y][y-1]*i[y-1][y]),10===C){for(E+=f,s=b;s<=y;s++)i[s][s]-=f;f=m=.75*(S=Math.abs(i[y][y-1])+Math.abs(i[y-1][y-2])),c=-.4375*S*S}if(30===C&&(S=(S=(m-f)/2)*S+c)>0){for(S=Math.sqrt(S),m<f&&(S=-S),S=f-c/((m-f)/2+S),s=b;s<=y;s++)i[s][s]-=S;E+=S,f=m=c=.964}for(C+=1,l=y-2;l>=u&&(R=((k=f-(N=i[l][l]))*(S=m-N)-c)/i[l+1][l]+i[l][l+1],A=i[l+1][l+1]-N-k-S,k=i[l+2][l+1],R/=S=Math.abs(R)+Math.abs(A)+Math.abs(k),A/=S,k/=S,l!==u)&&!(Math.abs(i[l][l-1])*(Math.abs(A)+Math.abs(k))<M*(Math.abs(R)*(Math.abs(i[l-1][l-1])+Math.abs(N)+Math.abs(i[l+1][l+1]))));)l--;for(s=l+2;s<=y;s++)i[s][s-2]=0,s>l+2&&(i[s][s-3]=0);for(a=l;a<=y-1&&(w=a!==y-1,a!==l&&(R=i[a][a-1],A=i[a+1][a-1],k=w?i[a+2][a-1]:0,0!==(f=Math.abs(R)+Math.abs(A)+Math.abs(k))&&(R/=f,A/=f,k/=f)),0!==f);a++)if(S=Math.sqrt(R*R+A*A+k*k),R<0&&(S=-S),0!==S){for(a!==l?i[a][a-1]=-S*f:u!==l&&(i[a][a-1]=-i[a][a-1]),f=(R+=S)/S,m=A/S,N=k/S,A/=R,k/=R,o=a;o<t;o++)R=i[a][o]+A*i[a+1][o],w&&(R+=k*i[a+2][o],i[a+2][o]=i[a+2][o]-R*N),i[a][o]=i[a][o]-R*f,i[a+1][o]=i[a+1][o]-R*m;for(s=0;s<=Math.min(y,a+3);s++)R=f*i[s][a]+m*i[s][a+1],w&&(R+=N*i[s][a+2],i[s][a+2]=i[s][a+2]-R*k),i[s][a]=i[s][a]-R,i[s][a+1]=i[s][a+1]-R*A;for(s=b;s<=_;s++)R=f*n[s][a]+m*n[s][a+1],w&&(R+=N*n[s][a+2],n[s][a+2]=n[s][a+2]-R*k),n[s][a]=n[s][a]-R,n[s][a+1]=n[s][a+1]-R*A}}}if(0===T)return;for(y=t-1;y>=0;y--)if(R=r[y],0===(A=e[y]))for(u=y,i[y][y]=1,s=y-1;s>=0;s--){for(c=i[s][s]-R,k=0,o=u;o<=y;o++)k+=i[s][o]*i[o][y];if(e[s]<0)N=c,S=k;else if(u=s,0===e[s]?i[s][y]=0!==c?-k/c:-k/(M*T):(f=i[s][s+1],m=i[s+1][s],h=(f*S-N*k)/(A=(r[s]-R)*(r[s]-R)+e[s]*e[s]),i[s][y]=h,i[s+1][y]=Math.abs(f)>Math.abs(N)?(-k-c*h)/f:(-S-m*h)/N),M*(h=Math.abs(i[s][y]))*h>1)for(o=s;o<=y;o++)i[o][y]=i[o][y]/h}else if(A<0)for(u=y-1,Math.abs(i[y][y-1])>Math.abs(i[y-1][y])?(i[y-1][y-1]=A/i[y][y-1],i[y-1][y]=-(i[y][y]-R)/i[y][y-1]):(x=Lt(0,-i[y-1][y],i[y-1][y-1]-R,A),i[y-1][y-1]=x[0],i[y-1][y]=x[1]),i[y][y-1]=0,i[y][y]=1,s=y-2;s>=0;s--){for(d=0,g=0,o=u;o<=y;o++)d+=i[s][o]*i[o][y-1],g+=i[s][o]*i[o][y];if(c=i[s][s]-R,e[s]<0)N=c,k=d,S=g;else if(u=s,0===e[s]?(x=Lt(-d,-g,c,A),i[s][y-1]=x[0],i[s][y]=x[1]):(f=i[s][s+1],m=i[s+1][s],v=(r[s]-R)*(r[s]-R)+e[s]*e[s]-A*A,p=2*(r[s]-R)*A,0===v&&0===p&&(v=M*T*(Math.abs(c)+Math.abs(A)+Math.abs(f)+Math.abs(m)+Math.abs(N))),x=Lt(f*k-N*d+A*g,f*S-N*g-A*d,v,p),i[s][y-1]=x[0],i[s][y]=x[1],Math.abs(f)>Math.abs(N)+Math.abs(A)?(i[s+1][y-1]=(-d-c*i[s][y-1]+A*i[s][y])/f,i[s+1][y]=(-g-c*i[s][y]-A*i[s][y-1])/f):(x=Lt(-k-m*i[s][y-1],-S-m*i[s][y],N,A),i[s+1][y-1]=x[0],i[s+1][y]=x[1])),M*(h=Math.max(Math.abs(i[s][y-1]),Math.abs(i[s][y])))*h>1)for(o=s;o<=y;o++)i[o][y-1]=i[o][y-1]/h,i[o][y]=i[o][y]/h}for(s=0;s<t;s++)if(s<b||s>_)for(o=s;o<t;o++)n[s][o]=i[s][o];for(o=t-1;o>=b;o--)for(s=b;s<=_;s++){for(N=0,a=b;a<=Math.min(o,_);a++)N+=n[s][a]*i[a][o];n[s][o]=N}}(s,u,a,o,h)}this.n=s,this.e=u,this.d=a,this.V=o}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return kt.isMatrix(this.V)||(this.V=new kt(this.V)),this.V}get diagonalMatrix(){var t,e,r=this.n,n=this.e,i=this.d,s=new kt(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)s[t][e]=0;s[t][t]=i[t],n[t]>0?s[t][t+1]=n[t]:n[t]<0&&(s[t][t-1]=n[t])}return s}}function Lt(t,e,r,n){var i,s;return Math.abs(r)>Math.abs(n)?[(t+(i=n/r)*e)/(s=r+i*n),(e-i*t)/s]:[((i=r/n)*t+e)/(s=n+i*r),(i*e-t)/s]}class Ut{constructor(t){if(!(t=St.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,r,n,i=t,s=i.rows,o=new kt(s,s),a=!0;for(r=0;r<s;r++){var u=o[r],l=0;for(n=0;n<r;n++){var h=o[n],c=0;for(e=0;e<n;e++)c+=h[e]*u[e];u[n]=c=(i.get(r,n)-c)/o[n][n],l+=c*c}for(a&=(l=i.get(r,r)-l)>0,o[r][r]=Math.sqrt(Math.max(l,0)),n=r+1;n<s;n++)o[r][n]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=o}solve(t){t=St.checkMatrix(t);var e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var n,i,s,o=t.columns,a=t.clone();for(s=0;s<r;s++)for(i=0;i<o;i++){for(n=0;n<s;n++)a[s][i]-=a[n][i]*e[s][n];a[s][i]/=e[s][s]}for(s=r-1;s>=0;s--)for(i=0;i<o;i++){for(n=s+1;n<r;n++)a[s][i]-=a[n][i]*e[n][s];a[s][i]/=e[s][s]}return a}get lowerTriangularMatrix(){return this.L}}var jt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function It(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}function Xt(t){var e={exports:{}};return t(e,e.exports),e.exports}var Dt={func:Symbol("func"),validate:Symbol("validate")};const{func:Ft}=Dt;var zt={predicates:{positive:t=>t>0,negative:t=>t<0,nonNegative:t=>t>=0,integer:t=>t===(0|t),[Ft]:{is:t=>t,eq:t=>e=>e===t,gt:t=>e=>e>t,gte:t=>e=>e>=t,lt:t=>e=>e<t,lte:t=>e=>e<=t}},validator:t=>"number"==typeof t};const{func:Ot}=Dt;var Ht={predicates:{empty:t=>""===t,nonEmpty:t=>""!==t,[Ot]:{is:t=>t,eq:t=>e=>e===t,length:t=>e=>e.length===t,minLength:t=>e=>e.length>=t,maxLength:t=>e=>e.length<=t,matches:t=>e=>t.test(e),startsWith:t=>e=>e.startsWith(t),endsWith:t=>e=>e.endsWith(t)}},validator:t=>"string"==typeof t};const{func:Vt}=Dt;const qt={number:zt,string:Ht,object:{predicates:{plain:t=>{if("object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.getPrototypeOf({})},empty:t=>0===Object.keys(t).length,nonEmpty:t=>Object.keys(t).length>0,[Vt]:{is:t=>t,instanceOf:t=>e=>e instanceof t}},validator:t=>"object"==typeof t}},Bt=({validators:t=[],predicates:e=qt,type:r=null}={})=>{const n=new Proxy((function(){}),{get:(i,s)=>{if(s===Dt.validate)return(e,n="argument")=>{if(!r)return new Error("missing required type specifier");for(let i=0;i<t.length;++i){const s=t[i];if(!s.fn(e))throw 0===i?new Error(`Expected ${n} \`${e}\` to be of type \`${r}\`, but received type \`${typeof e}\``):new Error(`Expected ${r} \`${n}\` \`${e}\` failed predicate \`${s.key}\``)}};const o=e[s];if(o)return"function"==typeof o?(t.push({key:s,fn:o}),n):Bt({type:s,validators:[{key:s,fn:o.validator}],predicates:o.predicates});{const r=e[Dt.func]&&e[Dt.func][s];return r?new Proxy((function(){}),{get:()=>{throw new Error(`invalid use of functional predicate "${s}"`)},apply:(e,i,o)=>(t.push({key:s,fn:r(...o)}),n)}):n}},apply:(t,e,r)=>{if(2!==r.length&&3!==r.length)throw new Error('invalid number of arguments to "ow"');r[1][Dt.validate](r[0],r[2])}});return n};var Gt=Bt(),Wt=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var Yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Wt(t,[{key:"next",value:function(){throw new Error("RNG.next must be overridden")}},{key:"seed",value:function(t,e){throw new Error("RNG.seed must be overridden")}},{key:"clone",value:function(t,e){throw new Error("RNG.clone must be overridden")}},{key:"_seed",value:function(t,e){if(t===(0|t))return t;for(var r=""+t,n=0,i=0;i<r.length;++i)n^=0|r.charCodeAt(i);return n}},{key:"name",get:function(){throw new Error("RNG.name must be overridden")}}]),t}(),Qt=Object.defineProperty({default:Yt},"__esModule",{value:!0}),Kt=Xt((function(t){!function(t,e,r){function n(t){var e,r=this,n=(e=4022871197,function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var r=new n(t),s=e&&e.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.alea=s}(0,t,!1)})),Jt=Xt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var r=new n(t),s=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xor128=s}(0,t,!1)})),Zt=Xt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var r=new n(t),s=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xorwow=s}(0,t,!1)})),te=Xt((function(t){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],r=(t^=t>>>7)^t<<24,r^=(t=n[i+1&7])^t>>>10,r^=(t=n[i+3&7])^t>>>3,r^=(t=n[i+4&7])^t<<7,t=n[i+7&7],r^=(t^=t<<13)^t<<9,n[i]=r,e.i=i+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r&&(n[7]=-1),t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var r=new n(t),s=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,s&&(s.x&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xorshift7=s}(0,t,!1)})),ee=Xt((function(t){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.w,i=e.X,s=e.i;return e.w=n=n+1640531527|0,r=i[s+34&127],t=i[s=s+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[s]=r^t,e.i=s,r+(n^n>>>16)|0},function(t,e){var r,n,i,s,o,a=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),i=0,s=-32;s<u;++s)e&&(n^=e.charCodeAt((s+32)%e.length)),0===s&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,s>=0&&(o=o+1640531527|0,i=0==(r=a[127&s]^=n+o)?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,s=512;s>0;--s)n=a[i+34&127],r=a[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[i]=n^r;t.w=o,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var r=new n(t),s=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,s&&(s.X&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.xor4096=s}(0,t,!1)})),re=Xt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var r=new n(t),s=e&&e.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=r.next,o.quick=o,s&&("object"==typeof s&&i(s,r),o.state=function(){return i(r,{})}),o}e&&e.exports?e.exports=s:r&&r.amd?r((function(){return s})):this.tychei=s}(0,t,!1)})),ne=It(Object.freeze({__proto__:null,default:{}})),ie=Xt((function(t){!function(e,r,n){var i,s=256,o=n.pow(s,6),a=n.pow(2,52),u=2*a,l=255;function h(t,l,h){var v=[],p=d(m((l=1==l?{entropy:!0}:l||{}).entropy?[t,g(r)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(s):(t=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=e.navigator,o=n&&n.plugins;return[+new Date,e,o,e.screen,g(r)]}}():t,3),v),w=new c(v),x=function(){for(var t=w.g(6),e=o,r=0;t<a;)t=(t+r)*s,e*=s,r=w.g(1);for(;t>=u;)t/=2,e/=2,r>>>=1;return(t+r)/e};return x.int32=function(){return 0|w.g(4)},x.quick=function(){return w.g(4)/4294967296},x.double=x,d(g(w.S),r),(l.pass||h||function(t,e,r,i){return i&&(i.S&&f(i,w),t.state=function(){return f(w,{})}),r?(n.random=t,e):t})(x,p,"global"in l?l.global:this==n,l.state)}function c(t){var e,r=t.length,n=this,i=0,o=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);i<s;)a[i]=i++;for(i=0;i<s;i++)a[i]=a[o=l&o+t[i%r]+(e=a[i])],a[o]=e;(n.g=function(t){for(var e,r=0,i=n.i,o=n.j,a=n.S;t--;)e=a[i=l&i+1],r=r*s+a[l&(a[i]=a[o=l&o+e])+(a[o]=e)];return n.i=i,n.j=o,r})(s)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var r,n=[],i=typeof t;if(e&&"object"==i)for(r in t)try{n.push(m(t[r],e-1))}catch(t){}return n.length?n:"string"==i?t:t+"\0"}function d(t,e){for(var r,n=t+"",i=0;i<n.length;)e[l&i]=l&(r^=19*e[l&i])+n.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(d(n.random(),r),t.exports){t.exports=h;try{i=ne}catch(t){}}else n.seedrandom=h}("undefined"!=typeof self?self:jt,[],Math)}));ie.alea=Kt,ie.xor128=Jt,ie.xorwow=Zt,ie.xorshift7=te,ie.xor4096=ee,ie.tychei=re;var se=ie,oe=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),ae=ue(Gt);function ue(t){return t&&t.__esModule?t:{default:t}}var le=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.seed(t,r),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),oe(e,[{key:"next",value:function(){return this._rng()}},{key:"seed",value:function(t){(0,ae.default)(t,ae.default.function),this._rng=t}},{key:"clone",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return new(Function.prototype.bind.apply(e,[null].concat([this._rng],r)))}},{key:"name",get:function(){return"function"}}]),e}(ue(Qt).default),he=Object.defineProperty({default:le},"__esModule",{value:!0}),ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe=ge(se),me=ge(Qt),de=ge(he);function ge(t){return t&&t.__esModule?t:{default:t}}function ve(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var pe,we=Object.defineProperty({default:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0],i=void 0===n?"default":n,s=e.slice(1);switch(void 0===i?"undefined":ce(i)){case"object":if(i instanceof me.default)return i;break;case"function":return new de.default(i);case"string":case"number":return new de.default(fe.default.apply(void 0,ve(s)))}throw new Error('invalid RNG "'+i+'"')}},"__esModule",{value:!0}),xe=(pe=Gt)&&pe.__esModule?pe:{default:pe};var ye=Object.defineProperty({default:function(t,e,r){return void 0===r&&(r=void 0===e?1:e,e=0),(0,xe.default)(e,xe.default.number),(0,xe.default)(r,xe.default.number),function(){return t.next()*(r-e)+e}}},"__esModule",{value:!0}),be=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var _e=Object.defineProperty({default:function(t,e,r){return void 0===r&&(r=void 0===e?1:e,e=0),(0,be.default)(e,be.default.number.integer),(0,be.default)(r,be.default.number.integer),function(){return t.next()*(r-e+1)+e|0}}},"__esModule",{value:!0}),Me=Object.defineProperty({default:function(t){return function(){return t.next()>=.5}}},"__esModule",{value:!0}),Ee=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Te=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,Ee.default)(e,Ee.default.number),(0,Ee.default)(r,Ee.default.number),function(){var n=void 0,i=void 0,s=void 0;do{s=(n=2*t.next()-1)*n+(i=2*t.next()-1)*i}while(!s||s>1);return e+r*i*Math.sqrt(-2*Math.log(s)/s)}}},"__esModule",{value:!0}),Re=Object.defineProperty({default:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i=t.normal.apply(t,r);return function(){return Math.exp(i())}}},"__esModule",{value:!0}),Ae=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var ke=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,Ae.default)(e,Ae.default.number.gte(0).lt(1)),function(){return t.next()+e|0}}},"__esModule",{value:!0}),Se=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Ne=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return(0,Se.default)(e,Se.default.number.positive.integer),(0,Se.default)(r,Se.default.number.gte(0).lte(1)),function(){for(var n=0,i=0;n++<e;)i+=t.next()<r;return i}}},"__esModule",{value:!0}),Ce=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Pe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;(0,Ce.default)(e,Ce.default.number.gt(0).lte(1));var r=1/Math.log(1-e);return function(){return 1+Math.log(t.next())*r|0}}},"__esModule",{value:!0}),$e=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var Le=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Ue=function(t){return Le[t]},je=.9189385332046727,Ie=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,$e.default)(e,$e.default.number.positive),e<10){var r=Math.exp(-e);return function(){for(var n=r,i=0,s=t.next();s>n;)s-=n,n=e*n/++i;return i}}var n=Math.sqrt(e),i=.931+2.53*n,s=.02483*i-.059,o=1.1239+1.1328/(i-3.4),a=.9277-3.6224/(i-2);return function(){for(;;){var r=void 0,u=t.next();if(u<=.86*a)return r=u/a-.43,Math.floor((2*s/(.5-Math.abs(r))+i)*r+e+.445);u>=a?r=t.next()-.5:(r=((r=u/a-.93)<0?-.5:.5)-r,u=t.next()*a);var l=.5-Math.abs(r);if(!(l<.013&&u>l)){var h=0|Math.floor((2*s/l+i)*r+e+.445);if(u=u*o/(s/(l*l)+i),h>=10){var c=(h+.5)*Math.log(e/h)-e-je+h-(1/12-(1/360-1/(1260*h*h))/(h*h))/h;if(Math.log(u*n)<=c)return h}else if(h>=0&&Math.log(u)<=h*Math.log(e)-e-Ue(h))return h}}}}},"__esModule",{value:!0}),Xe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var De=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Xe.default)(e,Xe.default.number.positive),function(){return-Math.log(1-t.next())/e}}},"__esModule",{value:!0}),Fe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var ze=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Fe.default)(e,Fe.default.number.integer.gte(0)),function(){for(var r=0,n=0;n<e;++n)r+=t.next();return r}}},"__esModule",{value:!0}),Oe=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var He=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Oe.default)(e,Oe.default.number.integer.positive);var r=t.irwinHall(e);return function(){return r()/e}}},"__esModule",{value:!0}),Ve=function(t){return t&&t.__esModule?t:{default:t}}(Gt);var qe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Ve.default)(e,Ve.default.number.gte(0));var r=1/e;return function(){return 1/Math.pow(1-t.next(),r)}}},"__esModule",{value:!0}),Be=Xt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RNGFactory=e.RNG=void 0;var r=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),n=x(Gt),i=x(Qt),s=x(we),o=x(ye),a=x(_e),u=x(Me),l=x(Te),h=x(Re),c=x(ke),f=x(Ne),m=x(Pe),d=x(Ie),g=x(De),v=x(ze),p=x(He),w=x(qe);function x(t){return t&&t.__esModule?t:{default:t}}e.RNG=i.default,e.RNGFactory=s.default;var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(0,n.default)(e,n.default.object.instanceOf(i.default)),this._cache={},this.use(e)}return r(t,[{key:"clone",value:function(){return new t(arguments.length?s.default.apply(void 0,arguments):this.rng.clone())}},{key:"use",value:function(){this._rng=s.default.apply(void 0,arguments)}},{key:"patch",value:function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}},{key:"unpatch",value:function(){this._patch&&(Math.random=this._patch,delete this._patch)}},{key:"next",value:function(){return this._rng.next()}},{key:"float",value:function(t,e){return this.uniform(t,e)()}},{key:"int",value:function(t,e){return this.uniformInt(t,e)()}},{key:"integer",value:function(t,e){return this.uniformInt(t,e)()}},{key:"bool",value:function(){return this.uniformBoolean()()}},{key:"boolean",value:function(){return this.uniformBoolean()()}},{key:"uniform",value:function(t,e){return this._memoize("uniform",o.default,t,e)}},{key:"uniformInt",value:function(t,e){return this._memoize("uniformInt",a.default,t,e)}},{key:"uniformBoolean",value:function(){return this._memoize("uniformBoolean",u.default)}},{key:"normal",value:function(t,e){return(0,l.default)(this,t,e)}},{key:"logNormal",value:function(t,e){return(0,h.default)(this,t,e)}},{key:"bernoulli",value:function(t){return(0,c.default)(this,t)}},{key:"binomial",value:function(t,e){return(0,f.default)(this,t,e)}},{key:"geometric",value:function(t){return(0,m.default)(this,t)}},{key:"poisson",value:function(t){return(0,d.default)(this,t)}},{key:"exponential",value:function(t){return(0,g.default)(this,t)}},{key:"irwinHall",value:function(t){return(0,v.default)(this,t)}},{key:"bates",value:function(t){return(0,p.default)(this,t)}},{key:"pareto",value:function(t){return(0,w.default)(this,t)}},{key:"_memoize",value:function(t,e){for(var r=arguments.length,n=Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];var s=""+n.join(";"),o=this._cache[t];return void 0!==o&&o.key===s||(o={key:s,distribution:e.apply(void 0,[this].concat(n))},this._cache[t]=o),o.distribution}},{key:"rng",get:function(){return this._rng}}]),t}();e.default=new y})).default;class Ge{constructor(t,e){t instanceof kt&&e instanceof kt?(this.mean=t,this.cov=e):(this.mean=new kt([t]).transpose(),this.cov=new kt(e))}at(t){const e=new kt([t]).transpose().sub(this.mean);return e.transpose().mmul(Ct(this.cov)).mmul(e).mul(-.5).exp()*(1/Math.sqrt(Math.pow(2*Math.PI,this.mean.rows)*this.cov.det()))}marginalize(t){const e=We(this.mean,0,0,t,1),r=We(this.mean,t,0,this.mean.rows,1),n=We(this.cov,0,0,t,t),i=We(this.cov,t,t,this.mean.rows,this.mean.rows);return[new Ge(e,n),new Ge(r,i)]}condition(t){const e=t.length,r=new kt([t]).transpose(),n=We(this.cov,0,0,e,e),i=We(this.cov,0,e,e,this.mean.rows),s=i.transpose(),o=We(this.cov,e,e,this.mean.rows,this.mean.rows),a=new Ut(n).lowerTriangularMatrix,u=Pt(a,r),l=Pt(a,i).transpose().mmul(u),h=o.sub(s.mmul(Ct(n)).mmul(i));return new Ge(l,h)}transformationMatrix(){const t=new $t(this.cov),e=t.eigenvectorMatrix,r=kt.zeros(e.rows,e.columns);for(let e=0;e<r.rows;++e)r.set(e,e,Math.sqrt(t.realEigenvalues[e]));return e.mmul(r)}sample(){const t=kt.zeros(this.mean.rows,1),e=Be.normal();for(let r=0;r<this.mean.rows;++r)t.set(r,0,e());return kt.add(this.mean,this.transformationMatrix().mmul(t))}getMean(){return this.mean.transpose()[0]}getSd(){return this.cov.diag().map((t=>Math.sqrt(t)))}}function We(t,e,r,n,i){const s=new kt(n-e,i-r);for(let o=e;o<n;++o)for(let n=r;n<i;++n)s.set(o-e,n-r,t.get(o,n));return s}class Ye{constructor(){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0])}call(t,e){return this.g.at([t-e])*this.scale}inv0(t){var e=this.get_sigma2(),r=t/this.scale;const n=Math.sqrt(2*e*Math.PI),i=-2*e;return Math.sqrt(i*Math.log(r*n))}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,r){return[]}}class Qe{constructor(t){this.g=new Ge([0],[[1]]),this.scale=1/this.g.at([0]),this.cut_size=t}call(t,e){var r=this.cut_size,n=Math.floor(e/r),i=e-n*r;return 1==Math.abs(n%2)&&(e+=r-2*i),this.g.at([e-t])*this.scale}set_sigma(t){this.g=new Ge([0],[[t*t]]),this.scale=1/this.g.at([0])}get_sigma2(){return this.g.cov[0][0]}cuts(t,e,r){for(var n=e,i=[];n<r;)i.push(n),n+=this.cut_size;return i}}function Ke(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Je(t){let e=t,r=t;function n(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){const s=n+i>>>1;r(t[s],e)<0?n=s+1:i=s}return n}return 1===t.length&&(e=(e,r)=>t(e)-r,r=function(t){return(e,r)=>Ke(t(e),r)}(t)),{left:n,center:function(t,r,i,s){null==i&&(i=0),null==s&&(s=t.length);const o=n(t,r,i,s-1);return o>i&&e(t[o-1],r)>-e(t[o],r)?o-1:o},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){const s=n+i>>>1;r(t[s],e)>0?i=s:n=s+1}return n}}}const Ze=Je(Ke).right;Je((function(t){return null===t?NaN:+t})).center;var tr=Math.sqrt(50),er=Math.sqrt(10),rr=Math.sqrt(2);function nr(t,e,r){var n=(e-t)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),s=n/Math.pow(10,i);return i>=0?(s>=tr?10:s>=er?5:s>=rr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=tr?10:s>=er?5:s>=rr?2:1)}function ir(t,e,r){t=+t,e=+e,r=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+r;for(var n=-1,i=0|Math.max(0,Math.ceil((e-t)/r)),s=new Array(i);++n<i;)s[n]=t+n*r;return s}function sr(t){if(!(i=t.length))return[];for(var e=-1,r=function(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r>e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(r>i||void 0===r&&i>=i)&&(r=i)}return r}(t,or),n=new Array(r);++e<r;)for(var i,s=-1,o=n[e]=new Array(i);++s<i;)o[s]=t[s][e];return n}function or(t){return t.length}function ar(){return sr(arguments)}function ur(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function lr(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function hr(){}var cr=.7,fr=1/cr,mr="\\s*([+-]?\\d+)\\s*",dr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",gr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vr=/^#([0-9a-f]{3,8})$/,pr=new RegExp("^rgb\\("+[mr,mr,mr]+"\\)$"),wr=new RegExp("^rgb\\("+[gr,gr,gr]+"\\)$"),xr=new RegExp("^rgba\\("+[mr,mr,mr,dr]+"\\)$"),yr=new RegExp("^rgba\\("+[gr,gr,gr,dr]+"\\)$"),br=new RegExp("^hsl\\("+[dr,gr,gr]+"\\)$"),_r=new RegExp("^hsla\\("+[dr,gr,gr,dr]+"\\)$"),Mr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Er(){return this.rgb().formatHex()}function Tr(){return this.rgb().formatRgb()}function Rr(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=vr.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?Ar(e):3===r?new Cr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?kr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?kr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=pr.exec(t))?new Cr(e[1],e[2],e[3],1):(e=wr.exec(t))?new Cr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=xr.exec(t))?kr(e[1],e[2],e[3],e[4]):(e=yr.exec(t))?kr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=br.exec(t))?Ur(e[1],e[2]/100,e[3]/100,1):(e=_r.exec(t))?Ur(e[1],e[2]/100,e[3]/100,e[4]):Mr.hasOwnProperty(t)?Ar(Mr[t]):"transparent"===t?new Cr(NaN,NaN,NaN,0):null}function Ar(t){return new Cr(t>>16&255,t>>8&255,255&t,1)}function kr(t,e,r,n){return n<=0&&(t=e=r=NaN),new Cr(t,e,r,n)}function Sr(t){return t instanceof hr||(t=Rr(t)),t?new Cr((t=t.rgb()).r,t.g,t.b,t.opacity):new Cr}function Nr(t,e,r,n){return 1===arguments.length?Sr(t):new Cr(t,e,r,null==n?1:n)}function Cr(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function Pr(){return"#"+Lr(this.r)+Lr(this.g)+Lr(this.b)}function $r(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Lr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ur(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Ir(t,e,r,n)}function jr(t){if(t instanceof Ir)return new Ir(t.h,t.s,t.l,t.opacity);if(t instanceof hr||(t=Rr(t)),!t)return new Ir;if(t instanceof Ir)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,i=Math.min(e,r,n),s=Math.max(e,r,n),o=NaN,a=s-i,u=(s+i)/2;return a?(o=e===s?(r-n)/a+6*(r<n):r===s?(n-e)/a+2:(e-r)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new Ir(o,a,u,t.opacity)}function Ir(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function Xr(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}ur(hr,Rr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Er,formatHex:Er,formatHsl:function(){return jr(this).formatHsl()},formatRgb:Tr,toString:Tr}),ur(Cr,Nr,lr(hr,{brighter:function(t){return t=null==t?fr:Math.pow(fr,t),new Cr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?cr:Math.pow(cr,t),new Cr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pr,formatHex:Pr,formatRgb:$r,toString:$r})),ur(Ir,(function(t,e,r,n){return 1===arguments.length?jr(t):new Ir(t,e,r,null==n?1:n)}),lr(hr,{brighter:function(t){return t=null==t?fr:Math.pow(fr,t),new Ir(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?cr:Math.pow(cr,t),new Ir(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,i=2*r-n;return new Cr(Xr(t>=240?t-240:t+120,i,n),Xr(t,i,n),Xr(t<120?t+240:t-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Dr=t=>()=>t;function Fr(t){return 1==(t=+t)?zr:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):Dr(isNaN(e)?r:e)}}function zr(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):Dr(isNaN(t)?e:t)}var Or=function t(e){var r=Fr(e);function n(t,e){var n=r((t=Nr(t)).r,(e=Nr(e)).r),i=r(t.g,e.g),s=r(t.b,e.b),o=zr(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=i(e),t.b=s(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function Hr(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,i=e.slice();return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function Vr(t,e){var r,n=e?e.length:0,i=t?Math.min(n,t.length):0,s=new Array(i),o=new Array(n);for(r=0;r<i;++r)s[r]=Kr(t[r],e[r]);for(;r<n;++r)o[r]=e[r];return function(t){for(r=0;r<i;++r)o[r]=s[r](t);return o}}function qr(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Br(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Gr(t,e){var r,n={},i={};for(r in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)r in t?n[r]=Kr(t[r],e[r]):i[r]=e[r];return function(t){for(r in n)i[r]=n[r](t);return i}}var Wr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Yr=new RegExp(Wr.source,"g");function Qr(t,e){var r,n,i,s=Wr.lastIndex=Yr.lastIndex=0,o=-1,a=[],u=[];for(t+="",e+="";(r=Wr.exec(t))&&(n=Yr.exec(e));)(i=n.index)>s&&(i=e.slice(s,i),a[o]?a[o]+=i:a[++o]=i),(r=r[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,u.push({i:o,x:Br(r,n)})),s=Yr.lastIndex;return s<e.length&&(i=e.slice(s),a[o]?a[o]+=i:a[++o]=i),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var r,n=0;n<e;++n)a[(r=u[n]).i]=r.x(t);return a.join("")})}function Kr(t,e){var r,n=typeof e;return null==e||"boolean"===n?Dr(e):("number"===n?Br:"string"===n?(r=Rr(e))?(e=r,Or):Qr:e instanceof Rr?Or:e instanceof Date?qr:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Hr:Array.isArray(e)?Vr:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Gr:Br)(t,e)}function Jr(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}const Zr=Math.PI,tn=2*Zr,en=1e-6,rn=tn-en;function nn(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function sn(){return new nn}function on(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function an(t){return(t=on(Math.abs(t)))?t[1]:NaN}nn.prototype=sn.prototype={constructor:nn,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,r,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(t,e,r,n,i,s){this._+="C"+ +t+","+ +e+","+ +r+","+ +n+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,r,n,i){t=+t,e=+e,r=+r,n=+n,i=+i;var s=this._x1,o=this._y1,a=r-t,u=n-e,l=s-t,h=o-e,c=l*l+h*h;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>en)if(Math.abs(h*a-u*l)>en&&i){var f=r-s,m=n-o,d=a*a+u*u,g=f*f+m*m,v=Math.sqrt(d),p=Math.sqrt(c),w=i*Math.tan((Zr-Math.acos((d+c-g)/(2*v*p)))/2),x=w/p,y=w/v;Math.abs(x-1)>en&&(this._+="L"+(t+x*l)+","+(e+x*h)),this._+="A"+i+","+i+",0,0,"+ +(h*f>l*m)+","+(this._x1=t+y*a)+","+(this._y1=e+y*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,r,n,i,s){t=+t,e=+e,s=!!s;var o=(r=+r)*Math.cos(n),a=r*Math.sin(n),u=t+o,l=e+a,h=1^s,c=s?n-i:i-n;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>en||Math.abs(this._y1-l)>en)&&(this._+="L"+u+","+l),r&&(c<0&&(c=c%tn+tn),c>rn?this._+="A"+r+","+r+",0,1,"+h+","+(t-o)+","+(e-a)+"A"+r+","+r+",0,1,"+h+","+(this._x1=u)+","+(this._y1=l):c>en&&(this._+="A"+r+","+r+",0,"+ +(c>=Zr)+","+h+","+(this._x1=t+r*Math.cos(i))+","+(this._y1=e+r*Math.sin(i))))},rect:function(t,e,r,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};var un,ln=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hn(t){if(!(e=ln.exec(t)))throw new Error("invalid format: "+t);var e;return new cn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function cn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function fn(t,e){var r=on(t,e);if(!r)return t+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}hn.prototype=cn.prototype,cn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var mn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fn(100*t,e),r:fn,s:function(t,e){var r=on(t,e);if(!r)return t+"";var n=r[0],i=r[1],s=i-(un=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+on(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function dn(t){return t}var gn,vn,pn,wn=Array.prototype.map,xn=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yn(t){var e,r,n=void 0===t.grouping||void 0===t.thousands?dn:(e=wn.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var i=t.length,s=[],o=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>n&&(a=Math.max(1,n-u)),s.push(t.substring(i-=a,i+a)),!((u+=a+1)>n));)a=e[o=(o+1)%e.length];return s.reverse().join(r)}),i=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?dn:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(wn.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"−":t.minus+"",h=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=hn(t)).fill,r=t.align,c=t.sign,f=t.symbol,m=t.zero,d=t.width,g=t.comma,v=t.precision,p=t.trim,w=t.type;"n"===w?(g=!0,w="g"):mn[w]||(void 0===v&&(v=12),p=!0,w="g"),(m||"0"===e&&"="===r)&&(m=!0,e="0",r="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",y="$"===f?s:/[%p]/.test(w)?u:"",b=mn[w],_=/[defgprs%]/.test(w);function M(t){var i,s,u,f=x,M=y;if("c"===w)M=b(t)+M,t="";else{var E=(t=+t)<0||1/t<0;if(t=isNaN(t)?h:b(Math.abs(t),v),p&&(t=function(t){t:for(var e,r=t.length,n=1,i=-1;n<r;++n)switch(t[n]){case".":i=e=n;break;case"0":0===i&&(i=n),e=n;break;default:if(!+t[n])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),E&&0==+t&&"+"!==c&&(E=!1),f=(E?"("===c?c:l:"-"===c||"("===c?"":c)+f,M=("s"===w?xn[8+un/3]:"")+M+(E&&"("===c?")":""),_)for(i=-1,s=t.length;++i<s;)if(48>(u=t.charCodeAt(i))||u>57){M=(46===u?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}g&&!m&&(t=n(t,1/0));var T=f.length+t.length+M.length,R=T<d?new Array(d-T+1).join(e):"";switch(g&&m&&(t=n(R+t,R.length?d-M.length:1/0),R=""),r){case"<":t=f+t+M+R;break;case"=":t=f+R+t+M;break;case"^":t=R.slice(0,T=R.length>>1)+f+t+M+R.slice(T);break;default:t=R+f+t+M}return a(t)}return v=void 0===v?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,e){var r=c(((t=hn(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(an(e)/3))),i=Math.pow(10,-n),s=xn[8+n/3];return function(t){return r(i*t)+s}}}}function bn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function _n(t){return+t}gn=yn({thousands:",",grouping:[3],currency:["$",""]}),vn=gn.format,pn=gn.formatPrefix;var Mn=[0,1];function En(t){return t}function Tn(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Rn(t,e,r){var n=t[0],i=t[1],s=e[0],o=e[1];return i<n?(n=Tn(i,n),s=r(o,s)):(n=Tn(n,i),s=r(s,o)),function(t){return s(n(t))}}function An(t,e,r){var n=Math.min(t.length,e.length)-1,i=new Array(n),s=new Array(n),o=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<n;)i[o]=Tn(t[o],t[o+1]),s[o]=r(e[o],e[o+1]);return function(e){var r=Ze(t,e,1,n)-1;return s[r](i[r](e))}}function kn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Sn(){var t,e,r,n,i,s,o=Mn,a=Mn,u=Kr,l=En;function h(){var t,e,r,u=Math.min(o.length,a.length);return l!==En&&(t=o[0],e=o[u-1],t>e&&(r=t,t=e,e=r),l=function(r){return Math.max(t,Math.min(e,r))}),n=u>2?An:Rn,i=s=null,c}function c(e){return null==e||isNaN(e=+e)?r:(i||(i=n(o.map(t),a,u)))(t(l(e)))}return c.invert=function(r){return l(e((s||(s=n(a,o.map(t),Br)))(r)))},c.domain=function(t){return arguments.length?(o=Array.from(t,_n),h()):o.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),h()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),u=Jr,h()},c.clamp=function(t){return arguments.length?(l=!!t||En,h()):l!==En},c.interpolate=function(t){return arguments.length?(u=t,h()):u},c.unknown=function(t){return arguments.length?(r=t,c):r},function(r,n){return t=r,e=n,h()}}function Nn(){return Sn()(En,En)}function Cn(t,e,r,n){var i,s=function(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),s=n/i;return s>=tr?i*=10:s>=er?i*=5:s>=rr&&(i*=2),e<t?-i:i}(t,e,r);switch((n=hn(null==n?",f":n)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(an(e)/3)))-an(Math.abs(t)))}(s,o))||(n.precision=i),pn(n,o);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,an(e)-an(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(i=function(t){return Math.max(0,-an(Math.abs(t)))}(s))||(n.precision=i-2*("%"===n.type))}return vn(n)}function Pn(t){var e=t.domain;return t.ticks=function(t){var r=e();return function(t,e,r){var n,i,s,o,a=-1;if(r=+r,(t=+t)==(e=+e)&&r>0)return[t];if((n=e<t)&&(i=t,t=e,e=i),0===(o=nr(t,e,r))||!isFinite(o))return[];if(o>0){let r=Math.round(t/o),n=Math.round(e/o);for(r*o<t&&++r,n*o>e&&--n,s=new Array(i=n-r+1);++a<i;)s[a]=(r+a)*o}else{o=-o;let r=Math.round(t*o),n=Math.round(e*o);for(r/o<t&&++r,n/o>e&&--n,s=new Array(i=n-r+1);++a<i;)s[a]=(r+a)/o}return n&&s.reverse(),s}(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return Cn(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,i,s=e(),o=0,a=s.length-1,u=s[o],l=s[a],h=10;for(l<u&&(i=u,u=l,l=i,i=o,o=a,a=i);h-- >0;){if((i=nr(u,l,r))===n)return s[o]=u,s[a]=l,e(s);if(i>0)u=Math.floor(u/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,l=Math.floor(l*i)/i}n=i}return t},t}function $n(){var t=Nn();return t.copy=function(){return kn(t,$n())},bn.apply(t,arguments),Pn(t)}function Ln(t){return function(){return t}}function Un(t){this._context=t}function jn(t){return new Un(t)}function In(t){return t[0]}function Xn(t){return t[1]}function Dn(t,e){var r=Ln(!0),n=null,i=jn,s=null;function o(o){var a,u,l,h=(o=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(o)).length,c=!1;for(null==n&&(s=i(l=sn())),a=0;a<=h;++a)!(a<h&&r(u=o[a],a,o))===c&&((c=!c)?s.lineStart():s.lineEnd()),c&&s.point(+t(u,a,o),+e(u,a,o));if(l)return s=null,l+""||null}return t="function"==typeof t?t:void 0===t?In:Ln(t),e="function"==typeof e?e:void 0===e?Xn:Ln(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ln(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Ln(+t),o):e},o.defined=function(t){return arguments.length?(r="function"==typeof t?t:Ln(!!t),o):r},o.curve=function(t){return arguments.length?(i=t,null!=n&&(s=i(n)),o):i},o.context=function(t){return arguments.length?(null==t?n=s=null:s=i(n=t),o):n},o}Un.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};class Fn{constructor(t,e){this.touch=0,this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width,this.unitToAlpha=$n().domain([0,1]).range([-5,5]),this.n=e,this.kernels=[null,null],this.kernels[0]=new Ye,this.kernels[1]=new Qe(2),this.active_ker=0,this.pft=kt.zeros(this.n,this.n),this.ppt=kt.zeros(this.n,this.n),this.fft=kt.zeros(this.n,this.n),this.invpft=kt.zeros(this.n,this.n),this.curveCache=null,this.xCache=null,this.invertible=!0,this.populate()}get_xrange(){return[this.ctx.xmin,this.ctx.xmax]}init_metrics(){this.init_mat("ppt"),this.init_mat("pft"),this.init_mat("fft")}_init_mat(t,e,r){var n=kt.zeros(this.n,this.n);for(let r=0;r!=this.n;r++)for(let i=0;i!=this.n;i++)n[r][i]=this.kernel(t[r],e[i]);this[r]=n}_update_mat(t,e,r,n){for(let i=0;i!=this.n;i++)this[n][r][i]=this.kernel(t[r],e[i]),this[n][i][r]=this.kernel(t[i],e[r])}init_mat(t,e){var r,n;if("ppt"==t)[r,n]=[this.mu,this.mu];else if("pft"==t)[r,n]=[this.mu,this.x];else{if("fft"!=t)throw`init_mat: invalid type ${t}`;[r,n]=[this.x,this.x]}void 0===e?this._init_mat(r,n,t):this._update_mat(r,n,e,t)}initXCache(){var t,e=[this.ctx.xmin,this.ctx.xmax];for(let t=0;t!=this.n;t++)e.push(...this.jumps(this.x[t]));e.sort(((t,e)=>t-e)),this.xCache=new Array(0);for(let r=0;r!=e.length-1;r++)t=ir(e[r],e[r+1],.0125),this.xCache.push(t)}initCurveCache(){var t=this.n;this.initXCache(),this.curveCache=new Array(t);for(let e=0;e!=t;e++)this.updateCurveCache(e)}updateCurveCache(t){var e;this.curveCache[t]=new Array;for(let r=0;r!=this.xCache.length;r++)e=this.xCache[r].map((e=>this.kernel(this.mu[t],e))),this.curveCache[t].push(...e)}set_scramble(t){this.active_ker=t?1:0,this.init_metrics(),this.initCurveCache()}scrambled(){return 1==this.active_ker}cut_size(){return 2}resetAlpha(){this.alpha.fill(1)}set_sigma(t){for(let e=0;e!=this.kernels.length;e++)this.kernels[e].set_sigma(Math.pow(10,t));for(let t=0;t!=this.n;t++)this.updateCurveCache(t);this.init_metrics()}recenter_mu(){for(let t=0;t!=this.n;t++)this.mu[t]=this.x[t];this.init_metrics(),this.initCurveCache()}get_sigma2(){return this.kernels[this.active_ker].get_sigma2()}populate(){var t=this.n;this.x=new Array(t),this.y=new Array(t),this.mu=new Array(t),this.alpha=new Array(t);for(let e=0;e!=t;e++)this.x[e]=this.ctx.unitToX(Math.random()),this.mu[e]=this.x[e],this.y[e]=this.ctx.unitToY(Math.random());this.init_metrics(),this.initCurveCache(),this.alpha.fill(1)}setDataPoint(t,e,r){this.x[t]=this.ctx.x(e),this.y[t]=this.ctx.y(r),this.init_mat("pft",t),this.init_mat("fft",t),this.updateCurveCache(t)}setMu(t,e){this.mu[t]=this.ctx.x(e),this.init_mat("ppt",t),this.init_mat("pft",t),this.updateCurveCache(t)}kernel(t,e){return this.kernels[this.active_ker].call(t,e)}jumps(t){return this.kernels[this.active_ker].cuts(t,this.ctx.xmin,this.ctx.xmax)}solutionAlpha(){var t=new kt([this.y]);try{var e=Ct(this.pft),r=t.mmul(e).flat();return self.invertible=!0,r}catch(t){return self.invertible=!1,this.alpha}}_fNorm2(){var t=new kt([this.alpha]);return t.mmul(this.ppt).mmul(t.transpose()).flat()[0]}fNorm(){return Math.sqrt(this._fNorm2())}_fNormParallel2(){var t,e=new kt([this.alpha]);try{var r=Ct(this.fft);t=e.mmul(this.pft).mmul(r)}catch(t){return console.log("Could not invert matrix"),NaN}return t.mmul(this.fft).mmul(t.transpose())}fNormParallel(){return Math.sqrt(this._fNormParallel2())}fNormPerp(){var t=this._fNorm2()-this._fNormParallel2();return t>-1e-8&&(t=Math.max(0,t)),Math.sqrt(t)}resize(t,e){this.ctx.setWidth(t),this.ctx.setHeight(e),this.width=this.ctx.width,this.height=this.ctx.height}updateContext(t){this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width}addPoint(){this.n++,this.populate()}delPoint(){1!=this.n&&(this.n--,this.populate())}updateAlpha(t,e){isNaN(t+this.alpha[e])?console.log(`updateAlpha got ${t} and ${this.alpha[e]}`):this.alpha[e]+=t}makeLine(t,e){var r=this.ctx.xToViewport,[n,i]=[this.ctx.ymin,this.ctx.ymax];return Dn()(ar(t.map(r),e.map((t=>this.ctx.yToViewport(Math.max(n-1,Math.min(i+1,t)))))))||""}makeLines(t){var e,r,n="",i=0;for(let s=0;s!=this.xCache.length;s++)r=(e=this.xCache[s]).length,n+=this.makeLine(e,t.slice(i,i+r)),i+=r;return n}curve(t){var e=this.alpha[t],r=this.curveCache[t].map((t=>e*t));return this.makeLines(r)}solutionCurve(){if(0==this.n)return"";var t=new Array(this.curveCache[0].length).fill(0);for(let n=0;n!=this.n;n++){var e=this.alpha[n],r=this.curveCache[n];for(let n=0;n!=r.length;n++)t[n]+=r[n]*e}return this.makeLines(t)}points(t){var e=this.alpha[t];return ir(this.n).map((r=>[this.ctx.u(this.x[r]),this.ctx.v(e*this.pft.get(t,r))]))}data(){return ar(this.x,this.y).map((([t,e])=>[this.ctx.u(t),this.ctx.v(e)]))}getMuX(){return ar(this.mu,this.x).map((([t,e])=>[this.ctx.u(t),this.ctx.u(e)]))}solutionPoint(t){return ir(this.n).map((e=>this.alpha[e]*this.pft.get(t,e))).reduce(((t,e)=>t+e),0)}u(t){return this.ctx.u(t)}v(t){return this.ctx.v(t)}}class zn{constructor(t,e,[r,n],[i,s]){this.width=t,this.height=e,this.xmin=r,this.xmax=n,this.ymin=i,this.ymax=s,this.xToViewport=$n().domain([r,n]).range([0,t]),this.yToViewport=$n().domain([i,s]).range([e,0]),this.unitToX=$n().domain([0,1]).range([r,n]),this.unitToY=$n().domain([0,1]).range([i,s]),this.xToUnit=$n().domain([r,n]).range([0,1])}setWidth(t){this.width=t,this.xToViewport.range([0,t])}setHeight(t){this.height=t,this.yToViewport.range([t,0])}x(t){return this.xToViewport.invert(t)}y(t){return this.yToViewport.invert(t)}u(t){return this.xToViewport(t)}v(t){return this.yToViewport(t)}xDomain(){return this.xToViewport.domain()}yDomain(){return this.yToViewport.domain()}}class On{constructor(t,e,r){if(e=parseInt(e),isNaN(e)||e<=0)throw`sync.js: component_num must be integer > 0, got ${e}`;this.sig=t,this.cnum=e,this.sig.subscribe((t=>{Math.abs(t)!=this.cnum&&r()}))}notify(){this.sig.update((t=>-(Math.sign(t)||1)*this.cnum))}}function Hn(t,e,r){const n=t.slice();return n[17]=e[r][0],n[18]=e[r][1],n[20]=r,n}function Vn(t,e,r){const n=t.slice();return n[20]=e[r],n}function qn(t,e,r){const n=t.slice();return n[17]=e[r][0],n[18]=e[r][1],n}function Bn(t,e,r){const n=t.slice();return n[25]=e[r][0],n[26]=e[r][1],n[20]=r,n}function Gn(t){let e,r,n,i,s;return{c(){e=c("use"),v(e,"class","marker draggable svelte-cs9siv"),v(e,"id",r="mu"+t[20]),v(e,"x",n=t[25]),v(e,"y","0"),p(e,"xlink:href","#mu-select")},m(r,n){a(r,e,n),i||(s=g(e,"mousedown",t[5]),i=!0)},p(t,r){2&r&&n!==(n=t[25])&&v(e,"x",n)},d(t){t&&u(e),i=!1,s()}}}function Wn(t){let e,r;return{c(){e=c("path"),v(e,"class","curve svelte-cs9siv"),v(e,"d",r=t[1].curve(t[20]))},m(t,r){a(t,e,r)},p(t,n){2&n&&r!==(r=t[1].curve(t[20]))&&v(e,"d",r)},d(t){t&&u(e)}}}function Yn(t){let e,r=t[1].points(t[20]),n=[];for(let e=0;e<r.length;e+=1)n[e]=Qn(qn(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(2&i){let s;for(r=t[1].points(t[20]),s=0;s<r.length;s+=1){const o=qn(t,r,s);n[s]?n[s].p(o,i):(n[s]=Qn(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(t){l(n,t),t&&u(e)}}}function Qn(t){let e,r,n;return{c(){e=c("circle"),v(e,"class","point svelte-cs9siv"),v(e,"cx",r=t[17]),v(e,"cy",n=t[18]),v(e,"r","4")},m(t,r){a(t,e,r)},p(t,i){2&i&&r!==(r=t[17])&&v(e,"cx",r),2&i&&n!==(n=t[18])&&v(e,"cy",n)},d(t){t&&u(e)}}}function Kn(t){let e,r,n=t[0].curves&&Wn(t),i=t[0].points&&Yn(t);return{c(){n&&n.c(),e=d(),i&&i.c(),r=d()},m(t,s){n&&n.m(t,s),a(t,e,s),i&&i.m(t,s),a(t,r,s)},p(t,s){t[0].curves?n?n.p(t,s):(n=Wn(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null),t[0].points?i?i.p(t,s):(i=Yn(t),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(t){n&&n.d(t),t&&u(e),i&&i.d(t),t&&u(r)}}}function Jn(t){let e,r;return{c(){e=c("path"),v(e,"class","solution-curve svelte-cs9siv"),v(e,"d",r=t[1].solutionCurve())},m(t,r){a(t,e,r)},p(t,n){2&n&&r!==(r=t[1].solutionCurve())&&v(e,"d",r)},d(t){t&&u(e)}}}function Zn(t){let e,r=t[1].data(),n=[];for(let e=0;e<r.length;e+=1)n[e]=ti(Hn(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(34&i){let s;for(r=t[1].data(),s=0;s<r.length;s+=1){const o=Hn(t,r,s);n[s]?n[s].p(o,i):(n[s]=ti(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(t){l(n,t),t&&u(e)}}}function ti(t){let e,r,n,i,s;return{c(){e=c("circle"),v(e,"id","xy"+t[20]),v(e,"class","marker draggable svelte-cs9siv"),v(e,"cx",r=t[17]),v(e,"cy",n=t[18]),v(e,"r","5")},m(r,n){a(r,e,n),i||(s=g(e,"mousedown",t[5]),i=!0)},p(t,i){2&i&&r!==(r=t[17])&&v(e,"cx",r),2&i&&n!==(n=t[18])&&v(e,"cy",n)},d(t){t&&u(e),i=!1,s()}}}function ei(e){let r,i,s,f,p,w,x,y,b,_,M,E,R,A=e[1].getMuX(),k=[];for(let t=0;t<A.length;t+=1)k[t]=Gn(Bn(e,A,t));let S=ir(e[1].n),N=[];for(let t=0;t<S.length;t+=1)N[t]=Kn(Vn(e,S,t));let C=e[0].solution&&Jn(e),P=e[0].show_data&&Zn(e);return{c(){r=h("div"),f=m(),p=c("svg"),w=c("defs"),x=c("polygon");for(let t=0;t<k.length;t+=1)k[t].c();y=d();for(let t=0;t<N.length;t+=1)N[t].c();b=d(),C&&C.c(),_=d(),P&&P.c(),v(r,"class",i="framed "+e[2]+" z3 svelte-cs9siv"),U((()=>e[10].call(r))),v(x,"id","mu-select"),v(x,"points","-6,0 6,0 0,12"),v(p,"class",M="framed "+e[2]+" svelte-cs9siv")},m(t,n){a(t,r,n),s=T(r,e[10].bind(r)),a(t,f,n),a(t,p,n),o(p,w),o(w,x);for(let t=0;t<k.length;t+=1)k[t].m(p,null);o(p,y);for(let t=0;t<N.length;t+=1)N[t].m(p,null);o(p,b),C&&C.m(p,null),o(p,_),P&&P.m(p,null),E||(R=[g(p,"mousemove",e[6]),g(p,"mouseup",e[7])],E=!0)},p(t,[e]){if(4&e&&i!==(i="framed "+t[2]+" z3 svelte-cs9siv")&&v(r,"class",i),34&e){let r;for(A=t[1].getMuX(),r=0;r<A.length;r+=1){const n=Bn(t,A,r);k[r]?k[r].p(n,e):(k[r]=Gn(n),k[r].c(),k[r].m(p,y))}for(;r<k.length;r+=1)k[r].d(1);k.length=A.length}if(3&e){let r;for(S=ir(t[1].n),r=0;r<S.length;r+=1){const n=Vn(t,S,r);N[r]?N[r].p(n,e):(N[r]=Kn(n),N[r].c(),N[r].m(p,b))}for(;r<N.length;r+=1)N[r].d(1);N.length=S.length}t[0].solution?C?C.p(t,e):(C=Jn(t),C.c(),C.m(p,_)):C&&(C.d(1),C=null),t[0].show_data?P?P.p(t,e):(P=Zn(t),P.c(),P.m(p,null)):P&&(P.d(1),P=null),4&e&&M!==(M="framed "+t[2]+" svelte-cs9siv")&&v(p,"class",M)},i:t,o:t,d(t){t&&u(r),s(),t&&u(f),t&&u(p),l(k,t),l(N,t),C&&C.d(),P&&P.d(),E=!1,n(R)}}}function ri(t,e,r){let n,{sig:i}=e,{cfg:s}=e,{plot:o}=e,{cn:a}=e,{gridarea:u}=e,l=0,h=0,c=null,f=!1;function m(t,e){if(console.log(`in solve: ${e}, do_solve=${t}`),!t)return;var i=o.alpha,s=o.solutionAlpha();console.log(`in solve: ${s}`),function t(e,a){if(e==a)r(1,o.alpha=s,o);else{var u=e/a;for(let t=0;t!=o.n;t++)r(1,o.alpha[t]=u*s[t]+(1-u)*i[t],o)}n.notify(),e!=a&&setTimeout((()=>t(e+1,a)),10)}(0,50)}function d(){if(f){var t=s.cmd;if(null==t)throw"got null cfg.cmd in Curves update";"reset_alpha"==t&&o.resetAlpha(),"del_point"==t&&o.delPoint(),"add_point"==t&&o.addPoint(),"new_data"==t&&o.populate(),"auto_solve"==t&&m(s.auto_solve),"mu_tracks_x"==t&&s.mu_tracks_x&&o.recenter_mu(),"scramble"==t&&o.set_scramble(s.scramble),"set_sigma"==t&&o.set_sigma(s.log_sigma),t.match(/update_alpha/)||("set_sigma"==t||"mu_xy_changed"==t?s.auto_solve&&r(1,o.alpha=o.solutionAlpha(),o):"reset_alpha"!=t&&m(s.auto_solve)),r(1,o.touch++,o),r(0,s.cmd=null,s),n.notify()}}function g(t,e){f&&(o.resize(t,e),r(1,o.touch++,o))}return k((()=>{n=new On(i,a,d),f=!0,g(l,h)})),t.$$set=t=>{"sig"in t&&r(8,i=t.sig),"cfg"in t&&r(0,s=t.cfg),"plot"in t&&r(1,o=t.plot),"cn"in t&&r(9,a=t.cn),"gridarea"in t&&r(2,u=t.gridarea)},t.$$.update=()=>{24&t.$$.dirty&&g(l,h)},[s,o,u,l,h,function(t){c=t.target},function(t){if(null!=c){var e=c.id.match(/(?<code>\D+)(?<num>\d+)/).groups;"mu"==e.code?o.setMu(e.num,t.offsetX):"xy"==e.code&&(o.setDataPoint(e.num,t.offsetX,t.offsetY),s.mu_tracks_x&&o.setMu(e.num,t.offsetX)),r(0,s.cmd="mu_xy_changed",s),d()}},function(t){c=null},i,a,function(){l=this.clientWidth,h=this.clientHeight,r(3,l),r(4,h)}]}class ni extends W{constructor(t){super(),G(this,t,ri,ei,s,{sig:8,cfg:0,plot:1,cn:9,gridarea:2})}}function ii(t){var e=t=>Math.abs(t)>1e3||Math.abs(t)<.01?t.toExponential(2):t.toFixed(2);return t instanceof Array?t.map(e):e(t)}function si(e){let r,i,s,l,c,d,p,w,b,_,M,E,T,R,A,k,S,N,C,P,$,L,U,j,I,X,D,F,z,O,H,V,q,B,G,W,Y,Q,K,J,Z,tt,et,rt=(e[1].invertible?ii(e[1].fNorm()):"Could not solve")+"",nt=(e[1].invertible?ii(e[1].fNormParallel()):"Could not solve")+"",it=(e[1].invertible?ii(e[1].fNormPerp()):"Could not solve")+"",st=ii(Math.pow(10,e[0].log_sigma))+"";return{c(){r=h("div"),i=h("div"),s=h("d-math"),l=m(),c=f(rt),d=m(),p=h("div"),w=h("d-math"),b=m(),_=f(nt),M=m(),E=h("div"),T=h("d-math"),R=m(),A=f(it),k=m(),S=h("div"),N=h("label"),C=h("input"),P=f("\n      auto solve"),$=m(),L=h("div"),U=h("label"),j=h("input"),I=m(),X=h("d-math"),D=f(" tracks "),F=h("d-math"),z=m(),O=h("div"),H=h("label"),V=h("input"),q=f("\n      scramble"),B=m(),G=h("div"),W=h("label"),Y=h("d-math"),Q=f(": \n      "),K=h("input"),J=m(),Z=f(st),v(i,"class","col1 line svelte-alai6s"),v(p,"class","col2 line svelte-alai6s"),v(E,"class","col2 row2 line svelte-alai6s"),v(C,"id","auto_solve"),v(C,"type","checkbox"),v(N,"class","ib"),v(S,"class","col4 row1 line svelte-alai6s"),v(j,"id","mu_tracks_x"),v(j,"type","checkbox"),v(U,"class","ib"),v(L,"class","col4 row2 line svelte-alai6s"),v(V,"id","scramble"),v(V,"type","checkbox"),v(H,"class","ib"),v(O,"class","col5 row1 line svelte-alai6s"),v(K,"id","set_sigma"),v(K,"class","short svelte-alai6s"),v(K,"type","range"),v(K,"min","-5"),v(K,"max","2"),v(K,"step","0.01"),v(W,"class","ib"),v(G,"class","col5 row2 line svelte-alai6s"),v(r,"class","gb gi svelte-alai6s")},m(t,n){a(t,r,n),o(r,i),o(i,s),s.innerHTML="\\|f\\| = ",o(i,l),o(i,c),o(r,d),o(r,p),o(p,w),w.innerHTML="\\|f_\\parallel\\| = ",o(p,b),o(p,_),o(r,M),o(r,E),o(E,T),T.innerHTML="\\|f_\\perp\\| = ",o(E,R),o(E,A),o(r,k),o(r,S),o(S,N),o(N,C),C.checked=e[0].auto_solve,o(N,P),o(r,$),o(r,L),o(L,U),o(U,j),j.checked=e[0].mu_tracks_x,o(U,I),o(U,X),X.innerHTML="\\mu",o(U,D),o(U,F),F.innerHTML="x",o(r,z),o(r,O),o(O,H),o(H,V),V.checked=e[0].scramble,o(H,q),o(r,B),o(r,G),o(G,W),o(W,Y),Y.innerHTML="\\sigma",o(W,Q),o(W,K),y(K,e[0].log_sigma),o(W,J),o(W,Z),tt||(et=[g(C,"change",e[5]),g(C,"change",e[2]),g(j,"change",e[6]),g(j,"change",e[2]),g(V,"change",e[7]),g(V,"change",e[2]),g(K,"change",e[8]),g(K,"input",e[8]),g(K,"input",e[2])],tt=!0)},p(t,[e]){2&e&&rt!==(rt=(t[1].invertible?ii(t[1].fNorm()):"Could not solve")+"")&&x(c,rt),2&e&&nt!==(nt=(t[1].invertible?ii(t[1].fNormParallel()):"Could not solve")+"")&&x(_,nt),2&e&&it!==(it=(t[1].invertible?ii(t[1].fNormPerp()):"Could not solve")+"")&&x(A,it),1&e&&(C.checked=t[0].auto_solve),1&e&&(j.checked=t[0].mu_tracks_x),1&e&&(V.checked=t[0].scramble),1&e&&y(K,t[0].log_sigma),1&e&&st!==(st=ii(Math.pow(10,t[0].log_sigma))+"")&&x(Z,st)},i:t,o:t,d(t){t&&u(r),tt=!1,n(et)}}}function oi(t,e,r){let{sig:n}=e,{cn:i}=e,{cfg:s}=e,{plot:o}=e;function a(){r(1,o.touch++,o)}var u=new On(n,i,a);return t.$$set=t=>{"sig"in t&&r(3,n=t.sig),"cn"in t&&r(4,i=t.cn),"cfg"in t&&r(0,s=t.cfg),"plot"in t&&r(1,o=t.plot)},[s,o,function(t){r(0,s.cmd=t.target.id,s),a(),u.notify()},n,i,function(){s.auto_solve=this.checked,r(0,s)},function(){s.mu_tracks_x=this.checked,r(0,s)},function(){s.scramble=this.checked,r(0,s)},function(){s.log_sigma=w(this.value),r(0,s)}]}class ai extends W{constructor(t){super(),G(this,t,oi,si,s,{sig:3,cn:4,cfg:0,plot:1})}}function ui(t,e,r){const n=t.slice();return n[8]=e[r],n[9]=e,n[10]=r,n}function li(t){let e,r,i,s,l,c,d,p,w,b,_,M,E,T=ii(t[8])+"";function A(){t[5].call(d,t[9],t[10])}return{c(){var n,o,a;e=h("div"),r=h("label"),i=h("d-math"),s=new R,l=f(t[10]),c=m(),d=h("input"),w=m(),b=h("div"),_=f(T),s.a=l,a="",(o="plain")in(n=i)?n[o]="boolean"==typeof n[o]&&""===a||a:v(n,o,a),v(d,"id",p="update_alpha"+t[10]),v(d,"class","ib slider svelte-n9jner"),v(d,"type","range"),v(d,"min","-10"),v(d,"max","10"),v(d,"step","0.01"),v(b,"class","ib svelte-n9jner"),v(r,"class","ib svelte-n9jner"),v(e,"class","alpha svelte-n9jner")},m(n,u){a(n,e,u),o(e,r),o(r,i),s.m("\\alpha_",i),o(i,l),o(r,c),o(r,d),y(d,t[8]),o(r,w),o(r,b),o(b,_),M||(E=[g(d,"change",A),g(d,"input",A),g(d,"input",t[1])],M=!0)},p(e,r){t=e,1&r&&y(d,t[8]),1&r&&T!==(T=ii(t[8])+"")&&x(_,T)},d(t){t&&u(e),M=!1,n(E)}}}function hi(e){let r,i,s,c,d,p,w,x,y,b,_,M,E,T=e[0].alpha,R=[];for(let t=0;t<T.length;t+=1)R[t]=li(ui(e,T,t));return{c(){r=h("div");for(let t=0;t<R.length;t+=1)R[t].c();i=m(),s=h("button"),s.textContent="New Data",c=m(),d=h("button"),p=f("Reset "),w=h("d-math"),x=m(),y=h("button"),y.textContent="Del Point",b=m(),_=h("button"),_.textContent="Add Point",v(s,"id","new_data"),v(d,"id","reset_alpha"),v(y,"id","del_point"),v(_,"id","add_point"),v(r,"class","gb svelte-n9jner")},m(t,n){a(t,r,n);for(let t=0;t<R.length;t+=1)R[t].m(r,null);o(r,i),o(r,s),o(r,c),o(r,d),o(d,p),o(d,w),w.innerHTML="\\alpha",o(r,x),o(r,y),o(r,b),o(r,_),M||(E=[g(s,"click",e[1]),g(d,"click",e[1]),g(y,"click",e[1]),g(_,"click",e[1])],M=!0)},p(t,[e]){if(3&e){let n;for(T=t[0].alpha,n=0;n<T.length;n+=1){const s=ui(t,T,n);R[n]?R[n].p(s,e):(R[n]=li(s),R[n].c(),R[n].m(r,i))}for(;n<R.length;n+=1)R[n].d(1);R.length=T.length}},i:t,o:t,d(t){t&&u(r),l(R,t),M=!1,n(E)}}}function ci(t,e,r){let{sig:n}=e,{cn:i}=e,{cfg:s}=e,{plot:o}=e;function a(){r(0,o.touch++,o)}var u=new On(n,i,a);return t.$$set=t=>{"sig"in t&&r(3,n=t.sig),"cn"in t&&r(4,i=t.cn),"cfg"in t&&r(2,s=t.cfg),"plot"in t&&r(0,o=t.plot)},[o,function(t){r(2,s.cmd=t.target.id,s),u.notify(),a()},s,n,i,function(t,e){t[e]=w(this.value),r(0,o)}]}class fi extends W{constructor(t){super(),G(this,t,ci,hi,s,{sig:3,cn:4,cfg:2,plot:0})}}var mi="undefined"!=typeof window?window:void 0!==jt?jt:"undefined"!=typeof self?self:{},di=function(t){if(!t)return!1;var e=gi.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)},gi=Object.prototype.toString;var vi=function(t){return t.replace(/^\s+|\s+$/g,"")},pi=function(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var n in r)wi.call(r,n)&&(t[n]=r[n])}return t},wi=Object.prototype.hasOwnProperty;var xi=_i,yi=_i;function bi(t,e,r){var n=t;return di(e)?(r=e,"string"==typeof t&&(n={uri:t})):n=pi(e,{uri:t}),n.callback=r,n}function _i(t,e,r){return Mi(e=bi(t,e,r))}function Mi(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,r=function(r,n,i){e||(e=!0,t.callback(r,n,i))};function n(){var t=void 0;if(t=u.response?u.response:u.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(t){}return null}(u),g)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(l),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,r(t,v)}function s(){if(!a){var e;clearTimeout(l),e=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var i=v,s=null;return 0!==e?(i={body:n(),statusCode:e,method:c,headers:{},url:h,rawRequest:u},u.getAllResponseHeaders&&(i.headers=function(t){if(!t)return{};for(var e,r={},n=vi(t).split("\n"),i=0;i<n.length;i++){var s=n[i],o=s.indexOf(":"),a=vi(s.slice(0,o)).toLowerCase(),u=vi(s.slice(o+1));void 0===r[a]?r[a]=u:(e=r[a],"[object Array]"===Object.prototype.toString.call(e)?r[a].push(u):r[a]=[r[a],u])}return r}(u.getAllResponseHeaders()))):s=new Error("Internal XMLHttpRequest Error"),r(s,i,i.body)}}var o,a,u=t.xhr||null;u||(u=t.cors||t.useXDR?new _i.XDomainRequest:new _i.XMLHttpRequest);var l,h=u.url=t.uri||t.url,c=u.method=t.method||"GET",f=t.body||t.data,m=u.headers=t.headers||{},d=!!t.sync,g=!1,v={body:void 0,headers:{},statusCode:0,method:c,url:h,rawRequest:u};if("json"in t&&!1!==t.json&&(g=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(s,0)},u.onload=s,u.onerror=i,u.onprogress=function(){},u.onabort=function(){a=!0},u.ontimeout=i,u.open(c,h,!d,t.username,t.password),d||(u.withCredentials=!!t.withCredentials),!d&&t.timeout>0&&(l=setTimeout((function(){if(!a){a=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}}),t.timeout)),u.setRequestHeader)for(o in m)m.hasOwnProperty(o)&&u.setRequestHeader(o,m[o]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(f||null),u}_i.XMLHttpRequest=mi.XMLHttpRequest||function(){},_i.XDomainRequest="withCredentials"in new _i.XMLHttpRequest?_i.XMLHttpRequest:mi.XDomainRequest,function(t,e){for(var r=0;r<t.length;r++)e(t[r])}(["get","put","post","patch","head","delete"],(function(t){_i["delete"===t?"del":t]=function(e,r,n){return(r=bi(e,r,n)).method=t.toUpperCase(),Mi(r)}})),xi.default=yi;var Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ti=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Ri=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Ai=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},ki="";function Si(t,e,r){function n(e,n){var i,s;"function"==typeof r?r(e):(i=n,(s=t.parentNode)&&(s.innerHTML='\n<table style="background-color: #8CE; width: 100%; height: 100%;"><tr>\n<td align="center">\n<div style="display: table-cell; vertical-align: middle;">\n<div style="">'+i+"</div>\n</div>\n</td></tr></table>\n"))}if(!window.WebGLRenderingContext)return n(1,'\n\tThis page requires a browser that supports WebGL.<br/>\n\t<a href="http://get.webgl.org">Click here to upgrade your browser.</a>\n'),null;var i=function(t,e){for(var r=["webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)try{n=t.getContext(r[i],e)}catch(t){if(n)break}return n}(t,e);return i?i.getExtension("OES_standard_derivatives"):n(2,'\n\tIt does not appear your computer can support WebGL.<br/>\n\t<a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>\n'),i}function Ni(t,e,r,n){var i=t.gl,s=i.createShader(r);return i.shaderSource(s,e),i.compileShader(s),i.getShaderParameter(s,i.COMPILE_STATUS)?s:(ki=i.getShaderInfoLog(s),console.error("*** Error compiling shader "+s+":"+ki),t.trigger("error",{shader:s,source:e,type:r,error:ki,offset:n||0}),i.deleteShader(s),null)}function Ci(t,e,r,n){for(var i=t.gl,s=i.createProgram(),o=0;o<e.length;++o)i.attachShader(s,e[o]);if(r)for(var a=0;a<r.length;++a)i.bindAttribLocation(s,n?n[a]:a,r[a]);return i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)?s:(ki=i.getProgramInfoLog(s),console.log("Error in program linking:"+ki),i.deleteProgram(s),null)}function Pi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];for(var n in t){var i=t[n],s=void 0;if(e&&(n=e+"."+n),"number"==typeof i)r.push({type:"float",method:"1f",name:n,value:i});else if(Array.isArray(i)){if("number"==typeof i[0])1===i.length?r.push({type:"float",method:"1f",name:n,value:i}):i.length>=2&&i.length<=4?r.push({type:"vec"+i.length,method:i.length+"fv",name:n,value:i}):i.length>4&&r.push({type:"float[]",method:"1fv",name:n+"[0]",value:i});else if("string"==typeof i[0])r.push({type:"sampler2D",method:"1i",name:n,value:i});else if(Array.isArray(i[0])&&"number"==typeof i[0][0]){if(i[0].length>=2&&i[0].length<=4)for(s=0;s<i.length;s++)r.push({type:"vec"+i[0].length,method:i[s].length+"fv",name:n+"["+s+"]",value:i[s]})}else if("object"===Ei(i[0]))for(s=0;s<i.length;s++)r.push.apply(r,Ai(Pi(i[s],n+"["+s+"]")))}else"boolean"==typeof i?r.push({type:"bool",method:"1i",name:n,value:i}):"string"==typeof i?r.push({type:"sampler2D",method:"1i",name:n,value:i}):"object"===(void 0===i?"undefined":Ei(i))&&r.push.apply(r,Ai(Pi(i,n)))}return r}function $i(t){return 0==(t&t-1)}function Li(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ui(t,e){return!(!t||!e)&&t.toString()!==e.toString()}function ji(t){var e=new Set;return Object.assign(t,{on:function(t,r){var n={};n[t]=r,e.add(n)},off:function(t,r){if(r){var n={};n[t]=r,e.delete(n)}else{var i=!0,s=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(i=(a=u.next()).done);i=!0){var l=a.value,h=!0,c=!1,f=void 0;try{for(var m,d=Object.keys(l)[Symbol.iterator]();!(h=(m=d.next()).done);h=!0){if(m.value===t)return void e.delete(l)}}catch(t){c=!0,f=t}finally{try{!h&&d.return&&d.return()}finally{if(c)throw f}}}}catch(t){s=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(s)throw o}}}},listSubscriptions:function(){var t=!0,r=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var o=i.value;console.log(o)}}catch(t){r=!0,n=t}finally{try{!t&&s.return&&s.return()}finally{if(r)throw n}}},subscribe:function(t){e.add(t)},unsubscribe:function(t){e.delete(t)},unsubscribeAll:function(){e.clear()},trigger:function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var s=!0,o=!1,a=void 0;try{for(var u,l=e[Symbol.iterator]();!(s=(u=l.next()).done);s=!0){var h=u.value;"function"==typeof h[t]&&h[t].apply(h,Ai(n))}}catch(t){o=!0,a=t}finally{try{!s&&l.return&&l.return()}finally{if(o)throw a}}}})}var Ii=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Ti(this,t),ji(this),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.bind(),this.name=r,this.source=null,this.sourceType=null,this.loading=null,this.setData(1,1,new Uint8Array([0,0,0,255]),{filtering:"linear"}),this.setFiltering(n.filtering),this.load(n)}return Ri(t,[{key:"destroy",value:function(){this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,this.valid=!1)}},{key:"bind",value:function(e){this.valid&&("number"==typeof e&&t.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),t.activeUnit=e),t.activeTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),t.activeTexture=this.texture))}},{key:"load",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=null,"string"==typeof t.url?void 0!==this.url&&t.url===this.url||this.setUrl(t.url,t):t.element?this.setElement(t.element,t):t.data&&t.width&&t.height&&this.setData(t.width,t.height,t.data,t)}},{key:"setUrl",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.valid)return this.url=t,this.source=this.url,this.sourceType="url",this.loading=new Promise((function(n,i){var s=t.split(".").pop().toLowerCase(),o="ogv"===s||"webm"===s||"mp4"===s,a=void 0;o?((a=document.createElement("video")).autoplay=!0,r.filtering="nearest"):a=new Image,a.onload=function(){try{e.setElement(a,r)}catch(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,r)}n(e)},a.onerror=function(t){console.log("Texture '"+e.name+"': failed to load url: '"+e.source+"'",t,r),n(e)},Li()&&"data:"===e.source.slice(0,5)||(a.crossOrigin="anonymous"),a.src=e.source,o&&e.setElement(a,r)})),this.loading}},{key:"setData",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.width=t,this.height=e,this.source=r,this.sourceType="data",this.update(n),this.setFiltering(n),this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var r=this,n=t;if("string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement)this.source=t,this.sourceType="element",t instanceof HTMLVideoElement?(t.addEventListener("canplaythrough",(function(){r.intervalID=setInterval((function(){r.update(e)}),15)}),!0),t.addEventListener("ended",(function(){t.currentTime=0,t.play()}),!0)):this.update(e),this.setFiltering(e);else{var i="the 'element' parameter (`element: "+JSON.stringify(n)+"`) must be a CSS ";i+="selector string, or a <canvas>, <image> or <video> object",console.log("Texture '"+this.name+"': "+i,e)}return this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.valid&&(this.bind(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==t.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),"element"===this.sourceType&&(this.source instanceof HTMLCanvasElement||this.source instanceof HTMLVideoElement||this.source instanceof HTMLImageElement&&this.source.complete)?(this.source instanceof HTMLVideoElement?(this.width=this.source.videoWidth,this.height=this.source.videoHeight):(this.width=this.source.width,this.height=this.source.height),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source)):"data"===this.sourceType&&this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.source),this.trigger("loaded",this))}},{key:"setFiltering",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.valid){this.powerOf2=$i(this.width)&&$i(this.height);var e=this.powerOf2?"mipmap":"linear";this.filtering=t.filtering||e;var r=this.gl;this.bind(),this.powerOf2?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,t.TEXTURE_WRAP_S||t.repeat&&r.REPEAT||r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,t.TEXTURE_WRAP_T||t.repeat&&r.REPEAT||r.CLAMP_TO_EDGE),"mipmap"===this.filtering?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.generateMipmap(r.TEXTURE_2D)):"linear"===this.filtering?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR)):"nearest"===this.filtering&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST))):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),"mipmap"===this.filtering&&(this.filtering="linear"),"nearest"===this.filtering?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR)))}}}]),t}();Ii.getMaxTextureSize=function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)},Ii.activeUnit=-1;var Xi=function(){function t(e,r,n){var i=this;Ti(this,t),ji(this),r=r||{},n=n||{},this.width=e.clientWidth,this.height=e.clientHeight,this.canvas=e,this.gl=void 0,this.program=void 0,this.textures={},this.buffers={},this.uniforms={},this.vbo={},this.isValid=!1,this.BUFFER_COUNT=0,this.vertexString=r.vertexString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nattribute vec2 a_position;\nattribute vec2 a_texcoord;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n    gl_Position = vec4(a_position, 0.0, 1.0);\n    v_texcoord = a_texcoord;\n}\n",this.fragmentString=r.fragmentString||"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 v_texcoord;\n\nvoid main(){\n    gl_FragColor = vec4(0.0);\n}\n";var s=Si(e,r,n.onError);if(s){if(this.gl=s,this.timeLoad=this.timePrev=performance.now(),this.timeDelta=0,this.forceRender=!0,this.paused=!1,this.realToCSSPixels=window.devicePixelRatio||1,e.style.backgroundColor=r.backgroundColor||"rgba(1,1,1,0)",e.hasAttribute("data-fragment"))this.fragmentString=e.getAttribute("data-fragment");else if(e.hasAttribute("data-fragment-url")){var o=e.getAttribute("data-fragment-url");xi.get(o,(function(t,e,r){i.load(r,i.vertexString)}))}if(e.hasAttribute("data-vertex"))this.vertexString=e.getAttribute("data-vertex");else if(e.hasAttribute("data-vertex-url")){var a=e.getAttribute("data-vertex-url");xi.get(a,(function(t,e,r){i.load(i.fragmentString,r)}))}if(this.load(),this.program){var u=s.getAttribLocation(this.program,"a_texcoord");this.vbo.texCoords=s.createBuffer(),this.gl.bindBuffer(s.ARRAY_BUFFER,this.vbo.texCoords),this.gl.bufferData(s.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),s.STATIC_DRAW),this.gl.enableVertexAttribArray(u),this.gl.vertexAttribPointer(u,2,s.FLOAT,!1,0,0);var l=s.getAttribLocation(this.program,"a_position");if(this.vbo.vertices=s.createBuffer(),this.gl.bindBuffer(s.ARRAY_BUFFER,this.vbo.vertices),this.gl.bufferData(s.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),s.STATIC_DRAW),this.gl.enableVertexAttribArray(l),this.gl.vertexAttribPointer(l,2,s.FLOAT,!1,0,0),e.hasAttribute("data-textures")){var h=e.getAttribute("data-textures").split(",");for(var c in h)this.setUniform("u_tex"+c,h[c])}var f={x:0,y:0};document.addEventListener("mousemove",(function(t){f.x=t.clientX||t.pageX,f.y=t.clientY||t.pageY}),!1);var m=this;return this.setMouse({x:0,y:0}),function t(){m.nMouse>1&&m.setMouse(f),m.resize()&&(m.forceRender=!0),m.render(),window.requestAnimationFrame(t)}(),this}}}return Ri(t,[{key:"destroy",value:function(){for(var t in this.animated=!1,this.isValid=!1,this.textures)t.destroy&&t.destroy();for(var e in this.textures={},this.attribs)this.gl.deleteBuffer(this.attribs[e]);for(var r in this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.buffers){var n=this.buffers[r];this.gl.deleteProgram(n.program)}this.program=null,this.gl=null}},{key:"load",value:function(t,e){if(e&&(this.vertexString=e),t&&(this.fragmentString=t),this.animated=!1,this.nDelta=(this.fragmentString.match(/u_delta/g)||[]).length,this.nTime=(this.fragmentString.match(/u_time/g)||[]).length,this.nDate=(this.fragmentString.match(/u_date/g)||[]).length,this.nMouse=(this.fragmentString.match(/u_mouse/g)||[]).length,this.animated=this.nDate>1||this.nTime>1||this.nMouse>1,this.fragmentString.search(/sampler2D/g))for(var r=this.fragmentString.split("\n"),n=0;n<r.length;n++){var i=r[n].match(/uniform\s*sampler2D\s*([\w]*);\s*\/\/\s*([\w|\:\/\/|\.|\-|\_]*)/i);if(i){var s=i[2].split(".").pop().toLowerCase();i[1]&&i[2]&&("jpg"===s||"jpeg"===s||"png"===s||"ogv"===s||"webm"===s||"mp4"===s)&&this.setUniform(i[1],i[2])}if(r[n].match(/\s*void\s*main\s*/g))break}var o=Ni(this,this.vertexString,this.gl.VERTEX_SHADER),a=Ni(this,this.fragmentString,this.gl.FRAGMENT_SHADER);a?this.isValid=!0:(a=Ni(this,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",this.gl.FRAGMENT_SHADER),this.isValid=!1);var u=Ci(this,[o,a]);this.gl.useProgram(u),this.gl.deleteShader(o),this.gl.deleteShader(a),this.program=u,this.change=!0,this.BUFFER_COUNT=0;var l=this.getBuffers(this.fragmentString);Object.keys(l).length&&this.loadPrograms(l),this.buffers=l,this.texureIndex=this.BUFFER_COUNT,this.trigger("load",{}),this.forceRender=!0,this.render()}},{key:"test",value:function(t,e,r){var n=this.vertexString,i=this.fragmentString,s=this.paused,o=this.gl.getExtension("EXT_disjoint_timer_query"),a=o.createQueryEXT(),u=this.isValid;(e||r)&&(this.load(e,r),u=this.isValid,this.forceRender=!0,this.render()),this.paused=!0,o.beginQueryEXT(o.TIME_ELAPSED_EXT,a),this.forceRender=!0,this.render(),o.endQueryEXT(o.TIME_ELAPSED_EXT);var l=this;!function h(){l.forceRender=!0,l.render();var c=o.getQueryObjectEXT(a,o.QUERY_RESULT_AVAILABLE_EXT),f=l.gl.getParameter(o.GPU_DISJOINT_EXT);if(c&&!f){var m={wasValid:u,frag:e||l.fragmentString,vert:r||l.vertexString,timeElapsedMs:o.getQueryObjectEXT(a,o.QUERY_RESULT_EXT)/1e6};l.paused=s,(e||r)&&l.load(i,n),t(m)}else window.requestAnimationFrame(h)}()}},{key:"loadTexture",value:function(t,e,r){var n=this;r||(r={}),"string"==typeof e?r.url=e:"object"===(void 0===e?"undefined":Ei(e))&&e.data&&e.width&&e.height?(r.data=e.data,r.width=e.width,r.height=e.height):"object"===(void 0===e?"undefined":Ei(e))&&(r.element=e),this.textures[t]?this.textures[t]&&(this.textures[t].load(r),this.textures[t].on("loaded",(function(t){n.forceRender=!0}))):(this.textures[t]=new Ii(this.gl,t,r),this.textures[t].on("loaded",(function(t){n.forceRender=!0})))}},{key:"refreshUniforms",value:function(){this.uniforms={}}},{key:"setUniform",value:function(t){for(var e={},r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e[t]=n,this.setUniforms(e)}},{key:"setUniforms",value:function(t){var e=Pi(t);for(var r in e)"sampler2D"===e[r].type?this.loadTexture(e[r].name,e[r].value[0]):this.uniform(e[r].method,e[r].type,e[r].name,e[r].value);this.forceRender=!0}},{key:"setMouse",value:function(t){var e=this.canvas.getBoundingClientRect();if(t&&t.x&&t.x>=e.left&&t.x<=e.right&&t.y&&t.y>=e.top&&t.y<=e.bottom){var r=(t.x-e.left)*this.realToCSSPixels,n=this.canvas.height-(t.y-e.top)*this.realToCSSPixels;this.uniform("2f","vec2","u_mouse",r,n)}}},{key:"uniform",value:function(t,e,r){this.uniforms[r]=this.uniforms[r]||{};for(var n=this.uniforms[r],i=arguments.length,s=Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];var a=Ui(n.value,s);if(a||this.change||!n.location||!n.value)for(var u in n.name=r,n.type=e,n.value=s,n.method="uniform"+t,this.gl.useProgram(this.program),n.location=this.gl.getUniformLocation(this.program,r),this.gl[n.method].apply(this.gl,[n.location].concat(n.value)),this.buffers){var l=this.buffers[u];this.gl.useProgram(l.program);var h=this.gl.getUniformLocation(l.program,r);this.gl[n.method].apply(this.gl,[h].concat(n.value))}}},{key:"uniformTexture",value:function(t,e,r){if(void 0===this.textures[t])this.loadTexture(t,e,r);else{for(var n in this.uniform("1i","sampler2D",t,this.texureIndex),this.buffers){var i=this.buffers[n];this.gl.useProgram(i.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture)}this.gl.useProgram(this.program),this.gl.activeTexture(this.gl.TEXTURE0+this.texureIndex),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textures[t].texture),this.uniform("2f","vec2",t+"Resolution",this.textures[t].width,this.textures[t].height)}}},{key:"resize",value:function(){if(this.width!==this.canvas.clientWidth||this.height!==this.canvas.clientHeight){this.realToCSSPixels=window.devicePixelRatio||1;var t=Math.floor(this.gl.canvas.clientWidth*this.realToCSSPixels),e=Math.floor(this.gl.canvas.clientHeight*this.realToCSSPixels);return this.gl.canvas.width===t&&this.gl.canvas.height===e||(this.gl.canvas.width=t,this.gl.canvas.height=e,this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.resizeSwappableBuffers(),!0}return!1}},{key:"render",value:function(){var t;if(this.visible=(t=this.canvas).getBoundingClientRect().top+t.height>0&&t.getBoundingClientRect().top<(window.innerHeight||document.documentElement.clientHeight),this.forceRender||this.change||this.animated&&this.visible&&!this.paused){var e=new Date,r=performance.now();for(var n in this.timeDelta=(r-this.timePrev)/1e3,this.timePrev=r,this.nDelta>1&&this.uniform("1f","float","u_delta",this.timeDelta),this.nTime>1&&this.uniform("1f","float","u_time",(r-this.timeLoad)/1e3),this.nDate&&this.uniform("4f","float","u_date",e.getFullYear(),e.getMonth(),e.getDate(),3600*e.getHours()+60*e.getMinutes()+e.getSeconds()+.001*e.getMilliseconds()),this.uniform("2f","vec2","u_resolution",this.canvas.width,this.canvas.height),this.buffers){var i=this.buffers[n];this.uniform("1i","sampler2D",i.name,i.bundle.input.index)}for(var s in this.texureIndex=this.BUFFER_COUNT,this.textures)this.uniformTexture(s),this.texureIndex++;this.renderPrograms(),this.trigger("render",{}),this.change=!1,this.forceRender=!1}}},{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"renderPrograms",value:function(){var t=this.gl,e=t.canvas.width,r=t.canvas.height;for(var n in t.viewport(0,0,e,r),this.buffers){var i=this.buffers[n];i.bundle.render(e,r,i.program,i.name),t.bindFramebuffer(t.FRAMEBUFFER,null)}t.useProgram(this.program),t.drawArrays(t.TRIANGLES,0,6)}},{key:"getBuffers",value:function(t){var e={};return t&&t.replace(/(?:^\s*)((?:#if|#elif)(?:\s*)(defined\s*\(\s*BUFFER_)(\d+)(?:\s*\))|(?:#ifdef)(?:\s*BUFFER_)(\d+)(?:\s*))/gm,(function(){var r=arguments[3]||arguments[4];e["u_buffer"+r]={fragment:"#define BUFFER_"+r+"\n"+t}})),e}},{key:"loadPrograms",value:function(t){var e=this,r=this.gl,n=Ni(e,e.vertexString,r.VERTEX_SHADER);for(var i in t){var s=t[i],o=Ni(e,s.fragment,r.FRAGMENT_SHADER,1);o?e.isValid=!0:(o=Ni(e,"void main(){\n\tgl_FragColor = vec4(1.0);\n}",r.FRAGMENT_SHADER),e.isValid=!1);var a=Ci(e,[n,o]);s.name=i,s.program=a,s.bundle=e.createSwappableBuffer(e.canvas.width,e.canvas.height,a),r.deleteShader(o)}r.deleteShader(n)}},{key:"createSwappableBuffer",value:function(t,e,r){var n=this.createBuffer(t,e,r),i=this.createBuffer(t,e,r),s=this.gl;return{input:n,output:i,swap:function(){var t=n;n=i,i=t,this.input=n,this.output=i},render:function(t,e,r,n){s.useProgram(r),s.viewport(0,0,t,e),s.bindFramebuffer(s.FRAMEBUFFER,this.input.buffer),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,this.output.texture,0),s.drawArrays(s.TRIANGLES,0,6),this.swap()},resize:function(t,e,r,n){s.useProgram(r),s.viewport(0,0,t,e),this.input.resize(t,e),this.output.resize(t,e)}}}},{key:"createBuffer",value:function(t,e,r){var n=this.gl,i=this.BUFFER_COUNT;this.BUFFER_COUNT+=2,n.getExtension("OES_texture_float");var s=n.createTexture();n.activeTexture(n.TEXTURE0+i),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,e,0,n.RGBA,n.FLOAT,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var o=n.createFramebuffer();return{index:i,texture:s,buffer:o,W:t,H:e,resize:function(t,e){n.bindFramebuffer(n.FRAMEBUFFER,o);var r=Math.min(t,this.W),a=Math.min(e,this.H),u=new Float32Array(r*a*4);n.readPixels(0,0,r,a,n.RGBA,n.FLOAT,u),n.bindFramebuffer(n.FRAMEBUFFER,null);var l=i+1,h=n.createTexture();n.activeTexture(n.TEXTURE0+l),n.bindTexture(n.TEXTURE_2D,h),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,e,0,n.RGBA,n.FLOAT,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,r,a,n.RGBA,n.FLOAT,u);var c=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.activeTexture(n.TEXTURE0+i),n.bindTexture(n.TEXTURE_2D,h),i=this.index=i,s=this.texture=h,o=this.buffer=c,this.W=t,this.H=e}}}},{key:"resizeSwappableBuffers",value:function(){var t=this.gl,e=t.canvas.width,r=t.canvas.height;for(var n in t.viewport(0,0,e,r),this.buffers){var i=this.buffers[n];i.bundle.resize(e,r,i.program,i.name)}t.useProgram(this.program)}},{key:"version",value:function(){return"0.1.7"}}]),t}();window.addEventListener("load",(function(){!function(){var t=document.getElementsByClassName("glslCanvas");if(t.length>0){window.glslCanvases=[];for(var e=0;e<t.length;e++){var r=new Xi(t[e]);r.isValid&&window.glslCanvases.push(r)}}}()}));function Di(t,e,r){const n=t.slice();return n[19]=e[r],n}function Fi(t,e,r){const n=t.slice();return n[22]=e[r],n}function zi(t){let e,r=t[0].x,n=[];for(let e=0;e<r.length;e+=1)n[e]=Hi(Di(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(193&i){let s;for(r=t[0].x,s=0;s<r.length;s+=1){const o=Di(t,r,s);n[s]?n[s].p(o,i):(n[s]=Hi(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(t){l(n,t),t&&u(e)}}}function Oi(t){let e,r,n;return{c(){e=c("circle"),v(e,"cx",r=t[6](t[19])),v(e,"cy",n=t[7](t[22])),v(e,"r","2"),v(e,"fill","rgba(255,0,0,1)")},m(t,r){a(t,e,r)},p(t,i){1&i&&r!==(r=t[6](t[19]))&&v(e,"cx",r),1&i&&n!==(n=t[7](t[22]))&&v(e,"cy",n)},d(t){t&&u(e)}}}function Hi(t){let e,r=t[0].mu,n=[];for(let e=0;e<r.length;e+=1)n[e]=Oi(Fi(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(193&i){let s;for(r=t[0].mu,s=0;s<r.length;s+=1){const o=Fi(t,r,s);n[s]?n[s].p(o,i):(n[s]=Oi(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(t){l(n,t),t&&u(e)}}}function Vi(e){let r,n,i,s,o,l,f,d,g,p=e[3]&&zi(e);return{c(){r=h("div"),s=m(),o=h("canvas"),f=m(),d=c("svg"),p&&p.c(),v(r,"class",n=e[1]+" invis-framed svelte-1cp5z7m"),U((()=>e[10].call(r))),v(o,"class",l=e[1]+" framed z1 svelte-1cp5z7m"),v(d,"class",g=e[1]+" framed z2 svelte-1cp5z7m")},m(t,n){a(t,r,n),i=T(r,e[10].bind(r)),a(t,s,n),a(t,o,n),e[11](o),a(t,f,n),a(t,d,n),p&&p.m(d,null),e[12](d)},p(t,[e]){2&e&&n!==(n=t[1]+" invis-framed svelte-1cp5z7m")&&v(r,"class",n),2&e&&l!==(l=t[1]+" framed z1 svelte-1cp5z7m")&&v(o,"class",l),t[3]?p?p.p(t,e):(p=zi(t),p.c(),p.m(d,null)):p&&(p.d(1),p=null),2&e&&g!==(g=t[1]+" framed z2 svelte-1cp5z7m")&&v(d,"class",g)},i:t,o:t,d(t){t&&u(r),i(),t&&u(s),t&&u(o),e[11](null),t&&u(f),t&&u(d),p&&p.d(),e[12](null)}}}function qi(t,e,r){let n,i,s,o,a,u,{sig:l}=e,{cn:h}=e,{plot:c}=e,{gridarea:f}=e,m=!1;function d(t){return o.clientHeight*(t-n)/(i-n)}function g(t){if(m){var e=o.clientHeight;o.setAttribute("width",e),a.setAttribute("width",e),v()}}function v(){var t=Math.sqrt(c.get_sigma2()),e=c.scrambled(),o=c.cut_size();[n,i]=c.get_xrange(),s instanceof Xi&&(s.setUniform("u_sigma",t),s.setUniform("cut_size",o),s.setUniform("u_do_scramble",e?1:0),s.setUniform("u_xmin",n),s.setUniform("u_xmax",i)),r(0,c.touch++,c)}return k((()=>{new On(l,h,v);var t=a.getContext("webgl")||a.getContext("experimental-webgl");t&&t instanceof WebGLRenderingContext&&(s=new Xi(a),s.load("precision mediump float;precision lowp int;\n#define GLSLIFY 1\nuniform vec2 u_resolution;uniform float u_sigma;uniform float cut_size;uniform bool u_do_scramble;uniform float u_xmin;uniform float u_xmax;const vec3 blue=vec3(0.0,0.0,1.0);const vec3 white=vec3(1.0,1.0,1.0);const float pi=3.1415926539;float slope=u_xmax-u_xmin;float intercept=u_xmin;float scramble(float x){float d=floor(x/cut_size);float r=x-d*cut_size;if(abs(mod(d,2.0))==1.0){x=x+cut_size-2.0*r;}return x;}float kernel(vec2 st){float fac=1.0/(u_sigma*sqrt(2.0*pi));return fac*exp(-0.5*pow((st.x-st.y)/u_sigma,2.0));}void main(){vec2 st=gl_FragCoord.xy/u_resolution;st=vec2(st.x,1.0-st.y)*slope+intercept;if(u_do_scramble){st=vec2(scramble(st.x),st.y);}float k=kernel(st)/kernel(vec2(0.0,0.0));vec3 color=k*blue+(1.0-k)*white;gl_FragColor=vec4(color,1.0);}")),r(3,m=!0),g()})),t.$$set=t=>{"sig"in t&&r(8,l=t.sig),"cn"in t&&r(9,h=t.cn),"plot"in t&&r(0,c=t.plot),"gridarea"in t&&r(1,f=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty&&g()},[c,f,u,m,o,a,d,function(t){return d(t)},l,h,function(){u=this.clientHeight,r(2,u)},function(t){N[t?"unshift":"push"]((()=>{a=t,r(5,a)}))},function(t){N[t?"unshift":"push"]((()=>{o=t,r(4,o)}))}]}class Bi extends W{constructor(t){super(),G(this,t,qi,Vi,s,{sig:8,cn:9,plot:0,gridarea:1})}}function Gi(t,e,r){const n=t.slice();return n[13]=e[r].x,n[14]=e[r].y,n[15]=e[r].v,n[16]=e[r].side,n}function Wi(t){let e,r=t[5](t[0]),n=[];for(let e=0;e<r.length;e+=1)n[e]=Yi(Gi(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(33&i){let s;for(r=t[5](t[0]),s=0;s<r.length;s+=1){const o=Gi(t,r,s);n[s]?n[s].p(o,i):(n[s]=Yi(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=r.length}},d(t){l(n,t),t&&u(e)}}}function Yi(t){let e,r,n,i,s;return{c(){e=c("rect"),v(e,"width",r=t[16]),v(e,"height",n=t[16]),v(e,"x",i=t[13]),v(e,"y",s=t[14]),b(e,"fill",Ki(t[15]))},m(t,r){a(t,e,r)},p(t,o){1&o&&r!==(r=t[16])&&v(e,"width",r),1&o&&n!==(n=t[16])&&v(e,"height",n),1&o&&i!==(i=t[13])&&v(e,"x",i),1&o&&s!==(s=t[14])&&v(e,"y",s),1&o&&b(e,"fill",Ki(t[15]))},d(t){t&&u(e)}}}function Qi(e){let r,n,i,s,o,l,f=e[4]&&Wi(e);return{c(){r=h("div"),s=m(),o=c("svg"),f&&f.c(),v(r,"class",n="invis-framed "+e[1]+" svelte-29ayl0"),U((()=>e[8].call(r))),v(o,"class",l="framed "+e[1]+" svelte-29ayl0")},m(t,n){a(t,r,n),i=T(r,e[8].bind(r)),a(t,s,n),a(t,o,n),f&&f.m(o,null),e[9](o)},p(t,[e]){2&e&&n!==(n="invis-framed "+t[1]+" svelte-29ayl0")&&v(r,"class",n),t[4]?f?f.p(t,e):(f=Wi(t),f.c(),f.m(o,null)):f&&(f.d(1),f=null),2&e&&l!==(l="framed "+t[1]+" svelte-29ayl0")&&v(o,"class",l)},i:t,o:t,d(t){t&&u(r),i(),t&&u(s),t&&u(o),f&&f.d(),e[9](null)}}}function Ki(t){var e=255*t;return`rgba(${255-e}, ${255-e}, 255)`}function Ji(t,e,r){let n,i,{sig:s}=e,{cn:o}=e,{plot:a}=e,{gridarea:u}=e,l=!1;function h(t){if(l){var e=i.clientHeight;i.setAttribute("width",e),c()}}function c(){r(0,a.touch++,a)}return k((()=>{new On(s,o,c),r(4,l=!0),h()})),t.$$set=t=>{"sig"in t&&r(6,s=t.sig),"cn"in t&&r(7,o=t.cn),"plot"in t&&r(0,a=t.plot),"gridarea"in t&&r(1,u=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty&&h()},[a,u,n,i,l,function(t){var e=[];if(0==t.n)return e;var r=i.clientHeight,n=1==t.n?r:.9*r,s=r-n,o=n/t.n,a=o+(t.n>1?s/(t.n-1):0);for(let r=0;r!=t.n;r++)for(let n=0;n!=t.n;n++)e.push({x:a*r,y:a*n,v:t.pft[r][n],side:o});return e},s,o,function(){n=this.clientHeight,r(2,n)},function(t){N[t?"unshift":"push"]((()=>{i=t,r(3,i)}))}]}class Zi extends W{constructor(t){super(),G(this,t,Ji,Qi,s,{sig:6,cn:7,plot:0,gridarea:1})}}function ts(e){let r,n,i,s,l,c,f,d,g,p,w,x,y,b,_,M,E,T,R,A,k,S,N,C,P,$,L,U,j,I,X;return i=new ni({props:{sig:e[3],cn:"1",cfg:e[1],plot:e[2],gridarea:"curves"}}),l=new fi({props:{sig:e[3],cn:"3",cfg:e[1],plot:e[2]}}),f=new ai({props:{sig:e[3],cn:"2",cfg:e[1],plot:e[2]}}),y=new Bi({props:{sig:e[3],cn:"4",plot:e[2],gridarea:"cell2"}}),T=new Zi({props:{sig:e[3],cn:"5",plot:e[2],gridarea:"cell6"}}),{c(){r=h("div"),n=h("div"),H(i.$$.fragment),s=m(),H(l.$$.fragment),c=m(),H(f.$$.fragment),d=m(),g=h("div"),p=h("div"),w=h("d-math"),x=m(),H(y.$$.fragment),b=m(),_=h("div"),M=h("d-math"),E=m(),H(T.$$.fragment),R=m(),A=h("div"),k=h("d-math"),S=m(),N=h("div"),C=h("d-math"),P=m(),$=h("div"),L=h("d-math"),U=m(),j=h("div"),I=h("d-math"),v(n,"class","fi-upper gbox-upper svelte-frau4j"),v(p,"class","y1 svelte-frau4j"),v(_,"class","y2 svelte-frau4j"),v(A,"class","x1 svelte-frau4j"),v(N,"class","x2 svelte-frau4j"),v($,"class","cap1 svelte-frau4j"),v(j,"class","cap2 svelte-frau4j"),v(g,"class","fi-lower gbox-lower svelte-frau4j"),v(r,"class",e[0]+" fb-vert svelte-frau4j")},m(t,e){a(t,r,e),o(r,n),V(i,n,null),o(n,s),V(l,n,null),o(n,c),V(f,n,null),o(r,d),o(r,g),o(g,p),o(p,w),w.innerHTML="\\mu",o(g,x),V(y,g,null),o(g,b),o(g,_),o(_,M),M.innerHTML="\\mu_i",o(g,E),V(T,g,null),o(g,R),o(g,A),o(A,k),k.innerHTML="x",o(g,S),o(g,N),o(N,C),C.innerHTML="x_i",o(g,P),o(g,$),o($,L),L.innerHTML="\\mathcal{N}(x; \\mu, \\sigma)",o(g,U),o(g,j),o(j,I),I.innerHTML="\\mathcal{N}(x_i; \\mu_i, \\sigma)",X=!0},p:t,i(t){X||(z(i.$$.fragment,t),z(l.$$.fragment,t),z(f.$$.fragment,t),z(y.$$.fragment,t),z(T.$$.fragment,t),X=!0)},o(t){O(i.$$.fragment,t),O(l.$$.fragment,t),O(f.$$.fragment,t),O(y.$$.fragment,t),O(T.$$.fragment,t),X=!1},d(t){t&&u(r),q(i),q(l),q(f),q(y),q(T)}}}function es(t,e,r){let{fullscreen:n=!1}=e,i=n?"screen100":"screen80",s=new zn(0,0,[-4,4],[-4,4]),o=new Fn(s,3),a=Q(0);return t.$$set=t=>{"fullscreen"in t&&r(4,n=t.fullscreen)},[i,{cmd:null,points:!1,curves:!0,solution:!0,auto_solve:!1,mu_tracks_x:!0,scramble:!1,log_sigma:0,show_data:!0},o,a,n]}class rs extends W{constructor(t){super(),G(this,t,es,ts,s,{fullscreen:4})}}function ns(t,e){return t[0]*e[0]+t[1]*e[1]}function is(t,e){return function(t,e){return[t[0]*e,t[1]*e]}(t,ns(t,e)/ns(r=t,r));var r}class ss{constructor(t){this.basis=new kt([[1,0],[0,0]]),this.xTou=$n().domain([-t,t]),this.yTov=$n().domain([-t,t]);var e=new zn(10,10,[-4,4],[-4,4]);this.plot=new Fn(e,2),this.updateBasis(),this.plot.init_metrics(),this.plot.initCurveCache()}toUV(t){return[this.xTou(t[0]),this.yTov(t[1])]}toXY(t){return[this.xTou.invert(t[0]),this.yTov.invert(t[1])]}resize(t,e){this.xTou.range([0,t]),this.yTov.range([e,0]),this.plot.resize(t,e)}updateBasis(){var t=this.plot.ppt[0][1],e=Math.acos(t);this.basis[1][0]=Math.cos(e),this.basis[1][1]=Math.sin(e)}updateF(t,e){var r=this.toXY([t,e]),n=new kt([r]);this.plot.alpha=n.mmul(Ct(this.basis)).flat()}F(){var[t,e]=this.alpha().mmul(this.basis).flat(),[r,n]=[this.xTou(t),this.yTov(e)];return{u:r,v:n,deg:Math.atan2(e,t)*(-180/Math.PI)}}updateY(t,e){var r=new kt([this.toXY([t,e])]).mmul(Ct(this.basis)).mmul(this.plot.pft);this.plot.y=r.flat()}_fHat(){return new kt([this.plot.solutionAlpha()]).mmul(this.basis).flat()}fHat(){var t=this._fHat();return this.toUV(t)}fHatProj(t){var e=is(this.basis[t],this._fHat());return this.toUV(e)}alpha(){return new kt([this.plot.alpha])}scr(t){return this.toUV(this.basis[t])}}function os(t,e,r){const n=t.slice();return n[17]=e[r].p1,n[18]=e[r].p2,n}function as(t,e,r){const n=t.slice();return n[21]=e[r][0],n[22]=e[r][1],n}function us(t,e,r){const n=t.slice();return n[25]=e[r][0],n[26]=e[r][1],n}function ls(t,e,r){const n=t.slice();return n[21]=e[r][0],n[22]=e[r][1],n}function hs(t,e,r){const n=t.slice();return n[25]=e[r][0],n[26]=e[r][1],n}function cs(t){let e,r,n,i,s;return{c(){e=c("line"),v(e,"class","basis svelte-li3dzh"),v(e,"x1",r=t[21]),v(e,"y1",n=t[22]),v(e,"x2",i=t[25]),v(e,"y2",s=t[26]),v(e,"marker-end","url(#basis-arrow)")},m(t,r){a(t,e,r)},p(t,o){1&o[0]&&r!==(r=t[21])&&v(e,"x1",r),1&o[0]&&n!==(n=t[22])&&v(e,"y1",n),1&o[0]&&i!==(i=t[25])&&v(e,"x2",i),1&o[0]&&s!==(s=t[26])&&v(e,"y2",s)},d(t){t&&u(e)}}}function fs(t){let e,r=[t[0].scr(0),t[0].scr(1)],n=[];for(let e=0;e<2;e+=1)n[e]=cs(hs(t,r,e));return{c(){for(let t=0;t<2;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<2;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(1&i[0]){let s;for(r=[t[0].scr(0),t[0].scr(1)],s=0;s<2;s+=1){const o=hs(t,r,s);n[s]?n[s].p(o,i):(n[s]=cs(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<2;s+=1)n[s].d(1)}},d(t){l(n,t),t&&u(e)}}}function ms(t){let e,r,n,i,s,o,l,h,f,m;return{c(){e=c("line"),o=c("circle"),v(e,"class","perp svelte-li3dzh"),v(e,"x1",r=t[21]),v(e,"y1",n=t[22]),v(e,"x2",i=t[25]),v(e,"y2",s=t[26]),v(e,"stroke-dasharray","4 4"),v(o,"id","fhat"),v(o,"class","perp-target draggable svelte-li3dzh"),v(o,"r","6"),v(o,"cx",l=t[21]),v(o,"cy",h=t[22])},m(r,n){a(r,e,n),a(r,o,n),f||(m=g(o,"mousedown",t[4]),f=!0)},p(t,a){1&a[0]&&r!==(r=t[21])&&v(e,"x1",r),1&a[0]&&n!==(n=t[22])&&v(e,"y1",n),1&a[0]&&i!==(i=t[25])&&v(e,"x2",i),1&a[0]&&s!==(s=t[26])&&v(e,"y2",s),1&a[0]&&l!==(l=t[21])&&v(o,"cx",l),1&a[0]&&h!==(h=t[22])&&v(o,"cy",h)},d(t){t&&u(e),t&&u(o),f=!1,m()}}}function ds(t){let e,r=[t[0].fHatProj(0),t[0].fHatProj(1)],n=[];for(let e=0;e<2;e+=1)n[e]=ms(us(t,r,e));return{c(){for(let t=0;t<2;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<2;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(17&i[0]){let s;for(r=[t[0].fHatProj(0),t[0].fHatProj(1)],s=0;s<2;s+=1){const o=us(t,r,s);n[s]?n[s].p(o,i):(n[s]=ms(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<2;s+=1)n[s].d(1)}},d(t){l(n,t),t&&u(e)}}}function gs(t){let e,r,n,i,s,o,l,h,f,m,d;return{c(){e=c("line"),o=c("use"),v(e,"class","solution-curve svelte-li3dzh"),v(e,"x1",r=t[17][0]),v(e,"y1",n=t[17][1]),v(e,"x2",i=t[18].u),v(e,"y2",s=t[18].v),v(o,"class","solution-arrow draggable svelte-li3dzh"),p(o,"xlink:href","#pointer"),v(o,"id","f"),v(o,"x",l=t[18].u),v(o,"y",h=t[18].v),v(o,"transform",f="rotate("+t[18].deg+", "+t[18].u+", "+t[18].v+")")},m(r,n){a(r,e,n),a(r,o,n),m||(d=g(o,"mousedown",t[4]),m=!0)},p(t,a){1&a[0]&&r!==(r=t[17][0])&&v(e,"x1",r),1&a[0]&&n!==(n=t[17][1])&&v(e,"y1",n),1&a[0]&&i!==(i=t[18].u)&&v(e,"x2",i),1&a[0]&&s!==(s=t[18].v)&&v(e,"y2",s),1&a[0]&&l!==(l=t[18].u)&&v(o,"x",l),1&a[0]&&h!==(h=t[18].v)&&v(o,"y",h),1&a[0]&&f!==(f="rotate("+t[18].deg+", "+t[18].u+", "+t[18].v+")")&&v(o,"transform",f)},d(t){t&&u(e),t&&u(o),m=!1,d()}}}function vs(e){let r,i,s,f,p,w,x,y,b,_,M,E,R,A,k=[e[0].toUV([0,0])],S=[];for(let t=0;t<1;t+=1)S[t]=fs(ls(e,k,t));let N=function(t){let e,r=[t[0].fHat()],n=[];for(let e=0;e<1;e+=1)n[e]=ds(as(t,r,e));return{c(){for(let t=0;t<1;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<1;e+=1)n[e].m(t,r);a(t,e,r)},p(t,i){if(17&i[0]){let s;for(r=[t[0].fHat()],s=0;s<1;s+=1){const o=as(t,r,s);n[s]?n[s].p(o,i):(n[s]=ds(o),n[s].c(),n[s].m(e.parentNode,e))}for(;s<1;s+=1)n[s].d(1)}},d(t){l(n,t),t&&u(e)}}}(e),C=[{p1:e[0].toUV([0,0]),p2:e[0].F()}],P=[];for(let t=0;t<1;t+=1)P[t]=gs(os(e,C,t));return{c(){r=h("div"),f=m(),p=c("svg"),w=c("defs"),x=c("marker"),y=c("path"),b=c("polygon");for(let t=0;t<1;t+=1)S[t].c();_=d(),N&&N.c(),M=d();for(let t=0;t<1;t+=1)P[t].c();v(r,"class",i=e[1]+" framed z3 svelte-li3dzh"),U((()=>e[10].call(r))),v(y,"d","M 0 0 L 10 5 L 0 10 z"),v(x,"id","basis-arrow"),v(x,"class","basis-arrow svelte-li3dzh"),v(x,"viewBox","0 0 10 10"),v(x,"refX","10"),v(x,"refY","5"),v(x,"markerWidth","6"),v(x,"markerHeight","6"),v(x,"orient","auto-start-reverse"),v(b,"id","pointer"),v(b,"points","-10,-5 0,0 -10,5"),v(p,"class",E=e[1]+" framed svelte-li3dzh")},m(t,n){a(t,r,n),s=T(r,e[10].bind(r)),a(t,f,n),a(t,p,n),o(p,w),o(w,x),o(x,y),o(w,b);for(let t=0;t<1;t+=1)S[t].m(p,null);o(p,_),N&&N.m(p,null),o(p,M);for(let t=0;t<1;t+=1)P[t].m(p,null);e[11](p),R||(A=[g(p,"mousemove",e[5]),g(p,"mouseup",e[6])],R=!0)},p(t,e){if(2&e[0]&&i!==(i=t[1]+" framed z3 svelte-li3dzh")&&v(r,"class",i),1&e[0]){let r;for(k=[t[0].toUV([0,0])],r=0;r<1;r+=1){const n=ls(t,k,r);S[r]?S[r].p(n,e):(S[r]=fs(n),S[r].c(),S[r].m(p,_))}for(;r<1;r+=1)S[r].d(1)}if(N.p(t,e),17&e[0]){let r;for(C=[{p1:t[0].toUV([0,0]),p2:t[0].F()}],r=0;r<1;r+=1){const n=os(t,C,r);P[r]?P[r].p(n,e):(P[r]=gs(n),P[r].c(),P[r].m(p,null))}for(;r<1;r+=1)P[r].d(1)}2&e[0]&&E!==(E=t[1]+" framed svelte-li3dzh")&&v(p,"class",E)},i:t,o:t,d(t){t&&u(r),s(),t&&u(f),t&&u(p),l(S,t),N&&N.d(),l(P,t),e[11](null),R=!1,n(A)}}}function ps(t,e,r){let n,i,s,{sig:o}=e,{cn:a}=e,{cfg:u}=e,{pp:l}=e,{gridarea:h}=e,c=!1,f=null;function m(){c&&(l.updateBasis(),r(0,l.plot.touch++,l),r(0,l.touch++,l))}function d(t){if(c){var e=s.clientHeight;s.setAttribute("width",e),l.resize(e,e),r(0,l.plot.touch++,l),r(0,l.touch++,l)}}return k((()=>{n=new On(o,a,m),c=!0,d(),m()})),t.$$set=t=>{"sig"in t&&r(8,o=t.sig),"cn"in t&&r(9,a=t.cn),"cfg"in t&&r(7,u=t.cfg),"pp"in t&&r(0,l=t.pp),"gridarea"in t&&r(1,h=t.gridarea)},t.$$.update=()=>{4&t.$$.dirty[0]&&d()},[l,h,i,s,function(t){f=t.target},function(t){null!=f&&("fhat"==f.id?(l.updateY(t.offsetX,t.offsetY),r(7,u.cmd="mu_xy_changed",u)):(l.updateF(t.offsetX,t.offsetY),r(7,u.cmd="update_alpha",u)),m(),n.notify())},function(t){f=null},u,o,a,function(){i=this.clientHeight,r(2,i)},function(t){N[t?"unshift":"push"]((()=>{s=t,r(3,s)}))}]}class ws extends W{constructor(t){super(),G(this,t,ps,vs,s,{sig:8,cn:9,cfg:7,pp:0,gridarea:1},null,[-1,-1])}}function xs(e){let r,n,i,s,l,c,d,g,p,w,x,y,b,_;return n=new ni({props:{sig:e[2],cfg:e[0],cn:"1",plot:e[1].plot,gridarea:"curves"}}),s=new ws({props:{sig:e[2],cn:"2",cfg:e[0],pp:e[1],gridarea:"phi"}}),c=new ai({props:{sig:e[2],cfg:e[0],cn:"3",plot:e[1].plot}}),{c(){r=h("div"),H(n.$$.fragment),i=m(),H(s.$$.fragment),l=m(),H(c.$$.fragment),d=m(),g=h("div"),p=f("Plane spanned by "),w=h("d-math"),x=f(" and\n      "),y=h("d-math"),b=f("."),v(r,"class","gb screen svelte-h34vza")},m(t,e){a(t,r,e),V(n,r,null),o(r,i),V(s,r,null),o(r,l),V(c,r,null),o(r,d),o(r,g),o(g,p),o(g,w),w.innerHTML="\\vec\\phi_\\sigma(\\mu_1)",o(g,x),o(g,y),y.innerHTML="\\vec\\phi_\\sigma(\\mu_2)",o(g,b),_=!0},p:t,i(t){_||(z(n.$$.fragment,t),z(s.$$.fragment,t),z(c.$$.fragment,t),_=!0)},o(t){O(n.$$.fragment,t),O(s.$$.fragment,t),O(c.$$.fragment,t),_=!1},d(t){t&&u(r),q(n),q(s),q(c)}}}function ys(t){return[{cmd:null,points:!1,curves:!0,solution:!0,auto_solve:!1,mu_tracks_x:!0,scramble:!1,log_sigma:0,show_data:!0},new ss(4),Q(0)]}class bs extends W{constructor(t){super(),G(this,t,ys,xs,s,{})}}function _s(e){let r,n,i,s,l,c,d,g,p,w,x,y,_,M,E,T,R,A,k,S,N,C,P,$,L,U,j,I,X,D,F,B,G,W,Y,Q,K,J,Z,tt,et,rt,nt,it,st,ot,at,ut,lt,ht,ct,ft,mt,dt,gt;return w=new rs({}),tt=new bs({}),{c(){r=h("main"),n=h("d-front-matter"),n.innerHTML='<script type="text/json">{\n        "title": "Introduction to Kernel Regression",\n      "description": "A gentle introduction to Kernel Regression",\n      "authors": [ { "author": "Henry Bigelow" } ] }<\/script>',i=m(),s=h("d-title"),s.innerHTML="<h1>Introduction to Kernel Regression</h1>",l=m(),c=h("d-byline"),d=m(),g=h("d-article"),p=h("figure"),H(w.$$.fragment),x=m(),y=h("figcaption"),_=f("Interctive plot.  You can drag the black \n                "),M=h("d-math"),E=f(" data points and triangles\n                ("),T=h("d-math"),R=f(" values).  "),A=h("b"),A.textContent="Top",k=f(": gray curves are\n                Gaussians centered at the "),S=h("d-math"),N=f(".  Blue curve is the\n                "),C=h("d-math"),P=f(" linear combination of the gray curves.\n                "),$=h("b"),$.textContent="Bottom left",L=f(": A heatmap showing the family of Gaussians\n                with the same "),U=h("d-math"),j=f(" at every\n                "),I=h("d-math"),X=f(" value.  Red dots show the locations of evaluation points.\n                "),D=h("b"),D.textContent="Bottom right",F=f(":  The matrix of values of evaluation\n                points organized by "),B=h("d-math"),G=f(" and "),W=h("d-math"),Y=f(".\n                Other details provided in text.  "),Q=h("a"),Q.textContent="Full Page Figure",K=f("."),J=m(),Z=h("figure"),H(tt.$$.fragment),et=m(),rt=h("figcaption"),nt=h("b"),nt.textContent="Left",it=f(": The curves plot as before with only two curves.\n                "),st=h("b"),st.textContent="Right",ot=f(": The plane in feature space spanned by vectors\n                "),at=h("d-math"),ut=f(" and\n                "),lt=h("d-math"),ht=f(" The blue arrow is\n                "),ct=h("d-math"),ft=f("."),mt=m(),dt=h("d-appendix"),b(s,"padding-bottom","0"),v(Q,"href","full.html"),v(p,"class","l-page-outset"),v(Z,"class","l-page-outset")},m(t,e){a(t,r,e),o(r,n),o(r,i),o(r,s),o(r,l),o(r,c),o(r,d),o(r,g),o(g,p),V(w,p,null),o(p,x),o(p,y),o(y,_),o(y,M),M.innerHTML="(x_i, y_i)",o(y,E),o(y,T),T.innerHTML="\\mu_i",o(y,R),o(y,A),o(y,k),o(y,S),S.innerHTML="\\mu_i",o(y,N),o(y,C),C.innerHTML="\\vec\\alpha",o(y,P),o(y,$),o(y,L),o(y,U),U.innerHTML="\\sigma",o(y,j),o(y,I),I.innerHTML="\\mu",o(y,X),o(y,D),o(y,F),o(y,B),B.innerHTML="\\mu_i",o(y,G),o(y,W),W.innerHTML="x_i",o(y,Y),o(y,Q),o(y,K),o(g,J),o(g,Z),V(tt,Z,null),o(Z,et),o(Z,rt),o(rt,nt),o(rt,it),o(rt,st),o(rt,ot),o(rt,at),at.innerHTML="\\vec\\phi(\\mu_1)",o(rt,ut),o(rt,lt),lt.innerHTML="\\vec\\phi(\\mu_2)",o(rt,ht),o(rt,ct),ct.innerHTML="\\alpha_1 \\vec\\phi(\\mu_1) + \\alpha_2\n                    \\vec\\phi(\\mu_2)",o(rt,ft),o(r,mt),o(r,dt),gt=!0},p:t,i(t){gt||(z(w.$$.fragment,t),z(tt.$$.fragment,t),gt=!0)},o(t){O(w.$$.fragment,t),O(tt.$$.fragment,t),gt=!1},d(t){t&&u(r),q(w),q(tt)}}}return new class extends W{constructor(t){super(),G(this,t,null,_s,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
