var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function l(t){return document.createElement(t)}function c(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function m(){return f("")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function p(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:v(t,e,n)}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e){t.value=null==e?"":e}function b(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let y,M;function _(){if(void 0===y){y=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){y=!0}}return y}function k(t){M=t}const E=[],S=[],N=[],$=[],R=Promise.resolve();let j=!1;function A(t){N.push(t)}let C=!1;const T=new Set;function q(){if(!C){C=!0;do{for(let t=0;t<E.length;t+=1){const e=E[t];k(e),V(e.$$)}for(k(null),E.length=0;S.length;)S.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];T.has(e)||(T.add(e),e())}N.length=0}while(E.length);for(;$.length;)$.pop()();j=!1,C=!1,T.clear()}}function V(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;function O(t,e){t&&t.i&&(I.delete(t),t.i(e))}function P(t,n,o,s){const{fragment:a,on_mount:u,on_destroy:h,after_update:l}=t.$$;a&&a.m(n,o),s||A((()=>{const n=u.map(e).filter(i);h?h.push(...n):r(n),t.$$.on_mount=[]})),l.forEach(A)}function z(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function L(t,e){-1===t.$$.dirty[0]&&(E.push(t),j||(j=!0,R.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,i,o,s,a,h,l=[-1]){const c=M;k(e);const f=e.$$={fragment:null,ctx:null,props:h,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:i.context||[]),callbacks:n(),dirty:l,skip_bound:!1};let d=!1;if(f.ctx=o?o(e,i.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),d&&L(e,t)),n})):[],f.update(),d=!0,r(f.before_update),f.fragment=!!s&&s(f.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();i.intro&&O(e.$$.fragment),P(e,i.target,i.anchor,i.customElement),q()}k(c)}class H{$destroy(){z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const U=Object.prototype.toString;function F(t){return U.call(t).endsWith("Array]")}function X(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!F(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],a=r+1;a<o;a++)t[a]>s&&(s=t[a]);return s}function B(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!F(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,o=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[r],a=r+1;a<o;a++)t[a]<s&&(s=t[a]);return s}function W(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!F(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!F(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=B(t),i=X(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,s=void 0===o?n.autoMinMax?r:0:o,a=n.max,u=void 0===a?n.autoMinMax?i:1:a;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-s)/(i-r),l=0;l<t.length;l++)e[l]=(t[l]-r)*h+s;return e}class G{constructor(t){var e,n,r,i,o,s,a,u,h,l=(t=yt.checkMatrix(t)).clone(),c=l.rows,f=l.columns,d=new Array(c),m=1;for(e=0;e<c;e++)d[e]=e;for(u=new Array(c),n=0;n<f;n++){for(e=0;e<c;e++)u[e]=l.get(e,n);for(e=0;e<c;e++){for(h=Math.min(e,n),o=0,r=0;r<h;r++)o+=l.get(e,r)*u[r];u[e]-=o,l.set(e,n,u[e])}for(i=n,e=n+1;e<c;e++)Math.abs(u[e])>Math.abs(u[i])&&(i=e);if(i!==n){for(r=0;r<f;r++)s=l.get(i,r),l.set(i,r,l.get(n,r)),l.set(n,r,s);a=d[i],d[i]=d[n],d[n]=a,m=-m}if(n<c&&0!==l.get(n,n))for(e=n+1;e<c;e++)l.set(e,n,l.get(e,n)/l.get(n,n))}this.LU=l,this.pivotVector=d,this.pivotSign=m}isSingular(){for(var t=this.LU,e=t.columns,n=0;n<e;n++)if(0===t[n][n])return!0;return!1}solve(t){t=bt.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,i,o=t.columns,s=t.subMatrixRow(this.pivotVector,0,o-1),a=e.columns;for(i=0;i<a;i++)for(n=i+1;n<a;n++)for(r=0;r<o;r++)s[n][r]-=s[i][r]*e[n][i];for(i=a-1;i>=0;i--){for(r=0;r<o;r++)s[i][r]/=e[i][i];for(n=0;n<i;n++)for(r=0;r<o;r++)s[n][r]-=s[i][r]*e[n][i]}return s}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,n=t.columns,r=0;r<n;r++)e*=t[r][r];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new bt(e,n),i=0;i<e;i++)for(var o=0;o<n;o++)r[i][o]=i>o?t[i][o]:i===o?1:0;return r}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,n=t.columns,r=new bt(e,n),i=0;i<e;i++)for(var o=0;o<n;o++)r[i][o]=i<=o?t[i][o]:0;return r}get pivotPermutationVector(){return this.pivotVector.slice()}}function K(t,e){var n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}function Q(t,e,n){for(var r=new Array(t),i=0;i<t;i++){r[i]=new Array(e);for(var o=0;o<e;o++)r[i][o]=n}return r}class Y{constructor(t,e={}){var n=(t=yt.checkMatrix(t)).rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:o=!0,autoTranspose:s=!1}=e;var a,u=Boolean(i),h=Boolean(o),l=!1;if(n<r)if(s){n=(a=t.transpose()).rows,r=a.columns,l=!0;var c=u;u=h,h=c}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();var f=Math.min(n,r),d=Math.min(n+1,r),m=new Array(d),g=Q(n,f,0),v=Q(r,r,0),p=new Array(r),w=new Array(n),x=new Array(d);for(let t=0;t<d;t++)x[t]=t;var b=Math.min(n-1,r),y=Math.max(0,Math.min(r-2,n)),M=Math.max(b,y);for(let t=0;t<M;t++){if(t<b){m[t]=0;for(let e=t;e<n;e++)m[t]=K(m[t],a[e][t]);if(0!==m[t]){a[t][t]<0&&(m[t]=-m[t]);for(let e=t;e<n;e++)a[e][t]/=m[t];a[t][t]+=1}m[t]=-m[t]}for(let e=t+1;e<r;e++){if(t<b&&0!==m[t]){let r=0;for(let i=t;i<n;i++)r+=a[i][t]*a[i][e];r=-r/a[t][t];for(let i=t;i<n;i++)a[i][e]+=r*a[i][t]}p[e]=a[t][e]}if(u&&t<b)for(let e=t;e<n;e++)g[e][t]=a[e][t];if(t<y){p[t]=0;for(let e=t+1;e<r;e++)p[t]=K(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<r;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<n&&0!==p[t]){for(let e=t+1;e<n;e++)w[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)w[e]+=p[n]*a[e][n];for(let e=t+1;e<r;e++){let r=-p[e]/p[t+1];for(let i=t+1;i<n;i++)a[i][e]+=r*w[i]}}if(h)for(let e=t+1;e<r;e++)v[e][t]=p[e]}}let _=Math.min(r,n+1);if(b<r&&(m[b]=a[b][b]),n<_&&(m[_-1]=0),y+1<_&&(p[y]=a[y][_-1]),p[_-1]=0,u){for(let t=b;t<f;t++){for(let e=0;e<n;e++)g[e][t]=0;g[t][t]=1}for(let t=b-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<f;e++){let r=0;for(let i=t;i<n;i++)r+=g[i][t]*g[i][e];r=-r/g[t][t];for(let i=t;i<n;i++)g[i][e]+=r*g[i][t]}for(let e=t;e<n;e++)g[e][t]=-g[e][t];g[t][t]=1+g[t][t];for(let e=0;e<t-1;e++)g[e][t]=0}else{for(let e=0;e<n;e++)g[e][t]=0;g[t][t]=1}}if(h)for(let t=r-1;t>=0;t--){if(t<y&&0!==p[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=v[i][t]*v[i][e];n=-n/v[t+1][t];for(let i=t+1;i<r;i++)v[i][e]+=n*v[i][t]}for(let e=0;e<r;e++)v[e][t]=0;v[t][t]=1}for(var k=_-1,E=Number.EPSILON;_>0;){let t,e;for(t=_-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+E*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===_-2)e=4;else{let n;for(n=_-1;n>=t&&n!==t;n--){let e=(n!==_?Math.abs(p[n]):0)+(n!==t+1?Math.abs(p[n-1]):0);if(Math.abs(m[n])<=E*e){m[n]=0;break}}n===t?e=3:n===_-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=p[_-2];p[_-2]=0;for(let n=_-2;n>=t;n--){let i=K(m[n],e),o=m[n]/i,s=e/i;if(m[n]=i,n!==t&&(e=-s*p[n-1],p[n-1]=o*p[n-1]),h)for(let t=0;t<r;t++)i=o*v[t][n]+s*v[t][_-1],v[t][_-1]=-s*v[t][n]+o*v[t][_-1],v[t][n]=i}break}case 2:{let e=p[t-1];p[t-1]=0;for(let r=t;r<_;r++){let i=K(m[r],e),o=m[r]/i,s=e/i;if(m[r]=i,e=-s*p[r],p[r]=o*p[r],u)for(let e=0;e<n;e++)i=o*g[e][r]+s*g[e][t-1],g[e][t-1]=-s*g[e][r]+o*g[e][t-1],g[e][r]=i}break}case 3:{const e=Math.max(Math.abs(m[_-1]),Math.abs(m[_-2]),Math.abs(p[_-2]),Math.abs(m[t]),Math.abs(p[t])),i=m[_-1]/e,o=m[_-2]/e,s=p[_-2]/e,a=m[t]/e,l=p[t]/e,c=((o+i)*(o-i)+s*s)/2,f=i*s*(i*s);let d=0;0===c&&0===f||(d=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),d=f/(c+d));let w=(a+i)*(a-i)+d,x=a*l;for(let e=t;e<_-1;e++){let i=K(w,x);0===i&&(i=Number.MIN_VALUE);let o=w/i,s=x/i;if(e!==t&&(p[e-1]=i),w=o*m[e]+s*p[e],p[e]=o*p[e]-s*m[e],x=s*m[e+1],m[e+1]=o*m[e+1],h)for(let t=0;t<r;t++)i=o*v[t][e]+s*v[t][e+1],v[t][e+1]=-s*v[t][e]+o*v[t][e+1],v[t][e]=i;if(i=K(w,x),0===i&&(i=Number.MIN_VALUE),o=w/i,s=x/i,m[e]=i,w=o*p[e]+s*m[e+1],m[e+1]=-s*p[e]+o*m[e+1],x=s*p[e+1],p[e+1]=o*p[e+1],u&&e<n-1)for(let t=0;t<n;t++)i=o*g[t][e]+s*g[t][e+1],g[t][e+1]=-s*g[t][e]+o*g[t][e+1],g[t][e]=i}p[_-2]=w;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,h))for(let e=0;e<=k;e++)v[e][t]=-v[e][t];for(;t<k&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,h&&t<r-1)for(let n=0;n<r;n++)e=v[n][t+1],v[n][t+1]=v[n][t],v[n][t]=e;if(u&&t<n-1)for(let r=0;r<n;r++)e=g[r][t+1],g[r][t+1]=g[r][t],g[r][t]=e;t++}_--}}if(l){var S=v;v=g,g=S}this.m=n,this.n=r,this.s=m,this.U=g,this.V=v}solve(t){var e=t,n=this.threshold,r=this.s.length,i=bt.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i[t][t]=0:i[t][t]=1/this.s[t];var o=this.U,s=this.rightSingularVectors,a=s.mmul(i),u=s.rows,h=o.length,l=bt.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let n=0;for(let i=0;i<r;i++)n+=a[t][i]*o[e][i];l[t][e]=n}return l.mmul(e)}solveForDiagonal(t){return this.solve(bt.diag(t))}inverse(){var t=this.V,e=this.threshold,n=t.length,r=t[0].length,i=new bt(n,this.s.length);for(let o=0;o<n;o++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e?i[o][n]=t[o][n]/this.s[n]:i[o][n]=0;var o=this.U,s=o.length,a=o[0].length,u=new bt(n,s);for(let t=0;t<n;t++)for(let e=0;e<s;e++){let n=0;for(let r=0;r<a;r++)n+=i[t][r]*o[e][r];u[t][e]=n}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s,r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return bt.isMatrix(this.U)||(this.U=new bt(this.U)),this.U}get rightSingularVectors(){return bt.isMatrix(this.V)||(this.V=new bt(this.V)),this.V}get diagonalMatrix(){return bt.diag(this.s)}}function Z(t,e,n){var r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function J(t,e,n){var r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function tt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function et(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function nt(t,e,n){return{row:rt(t,e),column:it(t,n)}}function rt(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function it(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function ot(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(ut("startRow",e),ut("endRow",n),ut("startColumn",r),ut("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function st(t){for(var e=bt.zeros(t.rows,1),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(n,0,e.get(n,0)+t.get(n,r));return e}function at(t){for(var e=bt.zeros(1,t.columns),n=0;n<t.rows;++n)for(var r=0;r<t.columns;++r)e.set(0,r,e.get(0,r)+t.get(n,r));return e}function ut(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class ht extends(xt()){constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}static get[Symbol.species](){return bt}}class lt extends ht{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}}class ct extends ht{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}}class ft extends ht{constructor(t,e,n,r,i){ot(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class dt extends ht{constructor(t,e,n){var r=nt(t,e,n);super(t,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class mt extends ht{constructor(t,e){super(t,(e=rt(t,e)).length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class gt extends ht{constructor(t,e){e=it(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class vt extends ht{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}}class pt extends ht{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class wt extends ht{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function xt(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n[i*e+o]);return r}static rowVector(t){for(var e=new this(1,t.length),n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){for(var e=new this(t.length,1),n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,n){void 0===n&&(n=Math.random);for(var r=this.empty(t,e),i=0;i<t;i++)for(var o=0;o<e;o++)r.set(i,o,n());return r}static randInt(t,e,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var i=this.empty(t,e),o=0;o<t;o++)for(var s=0;s<e;s++){var a=Math.floor(r()*n);i.set(o,s,a)}return i}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);for(var r=Math.min(t,e),i=this.zeros(t,e),o=0;o<r;o++)i.set(o,o,n);return i}static diag(t,e,n){var r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);for(var i=Math.min(r,e,n),o=this.zeros(e,n),s=0;s<i;s++)o.set(s,s,t[s]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var s=0;s<r;s++)i.set(o,s,Math.min(t.get(o,s),e.get(o,s)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var n=t.rows,r=t.columns,i=new this(n,r),o=0;o<n;o++)for(var s=0;s<r;s++)i.set(o,s,Math.max(t.get(o,s),e.get(o,s)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,n=this.columns,r=0;r<e;r++)for(var i=0;i<n;i++)t.call(this,r,i);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t[e*this.columns+n]=this.get(e,n);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var n=0;n<this.columns;n++)t[e][n]=this.get(e,n)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}set(t,e,n){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var n=new this.constructor[Symbol.species](this.rows*t,this.columns*e),r=0;r<t;r++)for(var i=0;i<e;i++)n.setSubMatrix(this,this.rows*r,this.columns*i);return n}fill(t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){Z(this,t);for(var e=new Array(this.columns),n=0;n<this.columns;n++)e[n]=this.get(t,n);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){Z(this,t),e=tt(this,e);for(var n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){Z(this,t),Z(this,e);for(var n=0;n<this.columns;n++){var r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){J(this,t);for(var e=new Array(this.rows),n=0;n<this.rows;n++)e[n]=this.get(n,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){J(this,t),e=et(this,e);for(var n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){J(this,t),J(this,e);for(var n=0;n<this.rows;n++){var r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){Z(this,t);for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){J(this,t);for(var n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){Z(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){Z(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){Z(this,t);for(var e=this.get(t,0),n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){Z(this,t);for(var e=this.get(t,0),n=[t,0],r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){J(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){J(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){J(this,t);for(var e=this.get(0,t),n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){J(this,t);for(var e=this.get(0,t),n=[0,t],r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),n=0;n<t;n++)e[n]=this.get(n,n);return e}sum(t){switch(t){case"row":return st(this);case"column":return at(this);default:return function(t){for(var e=0,n=0;n<t.rows;n++)for(var r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t*=this.get(e,n);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)e+=this.get(n,r)*this.get(n,r);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var n=this.to1DArray();if(n.length!==t.length)throw new RangeError("vectors do not have the same size");for(var r=0,i=0;i<n.length;i++)r+=n[i]*t[i];return r}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,n=this.columns,r=t.columns,i=new this.constructor[Symbol.species](e,r),o=new Array(n),s=0;s<r;s++){for(var a=0;a<n;a++)o[a]=t.get(a,s);for(var u=0;u<e;u++){var h=0;for(a=0;a<n;a++)h+=this.get(u,a)*o[a];i.set(u,s,h)}}return i}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),o=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),l=(n+u)*(r+h),c=(s+u)*r,f=n*(o-h),d=u*(a-r),m=(n+i)*h,g=l+d-m+(i-u)*(a+h),v=f+m,p=c+d,w=l-c+f+(s-n)*(r+o);return e.set(0,0,g),e.set(0,1,v),e.set(1,0,p),e.set(1,1,w),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),o=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),l=this.get(2,2),c=t.get(0,0),f=t.get(0,1),d=t.get(0,2),m=t.get(1,0),g=t.get(1,1),v=t.get(1,2),p=t.get(2,0),w=t.get(2,1),x=t.get(2,2),b=(n-o)*(-f+g),y=(-n+o+s)*(c-f+g),M=(o+s)*(-c+f),_=n*c,k=(-n+u+h)*(c-d+v),E=(-n+u)*(d-v),S=(u+h)*(-c+d),N=(-i+h+l)*(g+p-w),$=(i-l)*(g-w),R=i*p,j=(h+l)*(-p+w),A=(-i+s+a)*(v+p-x),C=(i-a)*(v-x),T=(s+a)*(-p+x),q=_+R+r*m,V=(n+r+i-o-s-h-l)*g+y+M+_+N+R+j,I=_+k+S+(n+r+i-s-a-u-h)*v+R+A+T,O=b+s*(-c+f+m-g-v-p+x)+y+_+R+A+C,P=b+y+M+_+a*w,z=R+A+C+T+o*d,L=_+k+E+h*(-c+d+m-g-v-p+w)+N+$+R,D=N+$+R+j+u*f,H=_+k+E+S+l*x;return e.set(0,0,q),e.set(0,1,V),e.set(0,2,I),e.set(1,0,O),e.set(1,1,P),e.set(1,2,z),e.set(2,0,L),e.set(2,1,D),e.set(2,2,H),e}mmulStrassen(t){var n=this.clone(),r=n.rows,i=n.columns,o=t.rows,s=t.columns;function a(t,n,r){var i=t.rows,o=t.columns;if(i===n&&o===r)return t;var s=e.zeros(n,r);return s=s.setSubMatrix(t,0,0)}i!==o&&console.warn(`Multiplying ${r} x ${i} and ${o} x ${s} matrix: dimensions do not match.`);var u=Math.max(r,o),h=Math.max(i,s);return function t(n,r,i,o){if(i<=512||o<=512)return n.mmul(r);i%2==1&&o%2==1?(n=a(n,i+1,o+1),r=a(r,i+1,o+1)):i%2==1?(n=a(n,i+1,o),r=a(r,i+1,o)):o%2==1&&(n=a(n,i,o+1),r=a(r,i,o+1));var s=parseInt(n.rows/2,10),u=parseInt(n.columns/2,10),h=n.subMatrix(0,s-1,0,u-1),l=r.subMatrix(0,s-1,0,u-1),c=n.subMatrix(0,s-1,u,n.columns-1),f=r.subMatrix(0,s-1,u,r.columns-1),d=n.subMatrix(s,n.rows-1,0,u-1),m=r.subMatrix(s,r.rows-1,0,u-1),g=n.subMatrix(s,n.rows-1,u,n.columns-1),v=r.subMatrix(s,r.rows-1,u,r.columns-1),p=t(e.add(h,g),e.add(l,v),s,u),w=t(e.add(d,g),l,s,u),x=t(h,e.sub(f,v),s,u),b=t(g,e.sub(m,l),s,u),y=t(e.add(h,c),v,s,u),M=t(e.sub(d,h),e.add(l,f),s,u),_=t(e.sub(c,g),e.add(m,v),s,u),k=e.add(p,b);k.sub(y),k.add(_);var E=e.add(x,y),S=e.add(w,b),N=e.sub(p,w);N.add(x),N.add(M);var $=e.zeros(2*k.rows,2*k.columns);return($=($=($=($=$.setSubMatrix(k,0,0)).setSubMatrix(E,k.rows,0)).setSubMatrix(S,0,k.columns)).setSubMatrix(N,k.rows,k.columns)).subMatrix(0,i-1,0,o-1)}(n=a(n,u,h),t=a(t,u,h),u,h)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.rows;r++){var i=W(this.getRow(r),{min:t,max:e});n.setRow(r,i)}return n}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.columns;r++){var i=W(this.getColumn(r),{min:t,max:e});n.setColumn(r,i)}return n}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,n=this.columns,r=t.rows,i=t.columns,o=new this.constructor[Symbol.species](e*r,n*i),s=0;s<e;s++)for(var a=0;a<n;a++)for(var u=0;u<r;u++)for(var h=0;h<i;h++)o[r*s+u][i*a+h]=this.get(s,a)*t.get(u,h);return o}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t){void 0===t&&(t=n);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=n);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){ot(this,t,e,n,r);for(var i=new this.constructor[Symbol.species](e-t+1,r-n+1),o=t;o<=e;o++)for(var s=n;s<=r;s++)i[o-t][s-n]=this.get(o,s);return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](t.length,n-e+1),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,o-e,this.get(t[i],o))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-e+1,t.length),i=0;i<t.length;i++)for(var o=e;o<=n;o++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(o-e,i,this.get(o,t[i]))}return r}setSubMatrix(t,e,n){ot(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,n,n+t.columns-1);for(var r=0;r<t.rows;r++)for(var i=0;i<t.columns;i++)this[e+r][n+i]=t.get(r,i);return this}selection(t,e){for(var n=nt(this,t,e),r=new this.constructor[Symbol.species](t.length,e.length),i=0;i<n.row.length;i++)for(var o=n.row[i],s=0;s<n.column.length;s++){var a=n.column[s];r[i][s]=this.get(o,a)}return r}trace(){for(var t=Math.min(this.rows,this.columns),e=0,n=0;n<t;n++)e+=this.get(n,n);return e}transposeView(){return new lt(this)}rowView(t){return Z(this,t),new ct(this,t)}columnView(t){return J(this,t),new vt(this,t)}flipRowView(){return new pt(this)}flipColumnView(){return new wt(this)}subMatrixView(t,e,n,r){return new ft(this,t,e,n,r)}selectionView(t,e){return new dt(this,t,e)}rowSelectionView(t){return new mt(this,t)}columnSelectionView(t){return new gt(this,t)}det(){var t,e,n,r,i,o;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),n=this.get(1,0),t*this.get(1,1)-e*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),i=this.selectionView([1,2],[0,2]),o=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),n=this.get(0,2),t*r.det()-e*i.det()+n*o.det()):new G(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new Y(this,{autoTranspose:!0}),n=e.leftSingularVectors,r=e.rightSingularVectors,i=e.diagonal,o=0;o<i.length;o++)Math.abs(i[o])>t?i[o]=1/i[o]:i[o]=0;return i=this.constructor[Symbol.species].diag(i),r.mmul(i.mmul(n.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)t.set(e,n,this.get(e,n));return t}}function n(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var r,i="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",o=eval;for(var s of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var a=o(k("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:s[1],op:s[0]})),u=o(k("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${s[1]}S`,op:s[0]})),h=o(k("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${s[1]}M`,op:s[0]})),l=o(k("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:s[1]}));for(r=1;r<s.length;r++)e.prototype[s[r]]=a,e.prototype[`${s[r]}S`]=u,e.prototype[`${s[r]}M`]=h,e[s[r]]=l}var c=[["~","not"]];for(var f of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){c.push([`Math.${t}`,t])})),c)){var d=o(k("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:f[1],method:f[0]})),m=o(k("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:f[1]}));for(r=1;r<f.length;r++)e.prototype[f[r]]=d,e[f[r]]=m}for(var g of[["Math.pow",1,"pow"]]){var v="arg0";for(r=1;r<g[1];r++)v+=`, arg${r}`;if(1!==g[1]){var p=o(k("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:g[2],method:g[0],args:v})),w=o(k(i,{name:g[2],args:v}));for(r=2;r<g.length;r++)e.prototype[g[r]]=p,e[g[r]]=w}else{var x={name:g[2],args:v,method:g[0]},b=o(k("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",x)),y=o(k("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",x)),M=o(k("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",x)),_=o(k("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",x));for(r=2;r<g.length;r++)e.prototype[g[r]]=b,e.prototype[`${g[r]}M`]=M,e.prototype[`${g[r]}S`]=y,e[g[r]]=_}}function k(t,e){for(var n in e)t=t.replace(new RegExp(`%${n}%`,"g"),e[n]);return t}return e}class bt extends(xt(Array)){constructor(t,e){var n;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(bt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)this[n]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,"number"!=typeof(e=r[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),n=0;n<t;n++){if(r[n].length!==e)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}}return this.rows=t,this.columns=e,this}set(t,e,n){return this[t][e]=n,this}get(t,e){return this[t][e]}removeRow(t){if(Z(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Z(this,t,!0),e=tt(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(J(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),J(this,t,!0),e=et(this,e);for(var n=0;n<this.rows;n++)this[n].splice(t,0,e[n]);return this.columns+=1,this}}xt(),Symbol.species;class yt extends(xt()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return bt}}class Mt{constructor(t){var e,n,r,i,o=(t=yt.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Array(a);for(r=0;r<a;r++){var h=0;for(e=r;e<s;e++)h=K(h,o.get(e,r));if(0!==h){for(o.get(r,r)<0&&(h=-h),e=r;e<s;e++)o.set(e,r,o.get(e,r)/h);for(o.set(r,r,o.get(r,r)+1),n=r+1;n<a;n++){for(i=0,e=r;e<s;e++)i+=o.get(e,r)*o.get(e,n);for(i=-i/o.get(r,r),e=r;e<s;e++)o.set(e,n,o.get(e,n)+i*o.get(e,r))}}u[r]=-h}this.QR=o,this.Rdiag=u}solve(t){t=bt.checkMatrix(t);var e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,i,o,s,a=t.columns,u=t.clone(),h=e.columns;for(o=0;o<h;o++)for(i=0;i<a;i++){for(s=0,r=o;r<n;r++)s+=e[r][o]*u[r][i];for(s=-s/e[o][o],r=o;r<n;r++)u[r][i]+=s*e[r][o]}for(o=h-1;o>=0;o--){for(i=0;i<a;i++)u[o][i]/=this.Rdiag[o];for(r=0;r<o;r++)for(i=0;i<a;i++)u[r][i]-=u[o][i]*e[r][o]}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,n=this.QR,r=n.columns,i=new bt(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)i[t][e]=t<e?n[t][e]:t===e?this.Rdiag[t]:0;return i}get orthogonalMatrix(){var t,e,n,r,i=this.QR,o=i.rows,s=i.columns,a=new bt(o,s);for(n=s-1;n>=0;n--){for(t=0;t<o;t++)a[t][n]=0;for(a[n][n]=1,e=n;e<s;e++)if(0!==i[n][n]){for(r=0,t=n;t<o;t++)r+=i[t][n]*a[t][e];for(r=-r/i[n][n],t=n;t<o;t++)a[t][e]+=r*i[t][n]}}return a}}function _t(t,e=!1){return t=yt.checkMatrix(t),e?new Y(t).inverse():kt(t,bt.eye(t.rows))}function kt(t,e,n=!1){return t=yt.checkMatrix(t),e=yt.checkMatrix(e),n?new Y(t).solve(e):t.isSquare()?new G(t).solve(e):new Mt(t).solve(e)}class Et{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=yt.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var r,i,o=t.columns,s=Q(o,o,0),a=new Array(o),u=new Array(o),h=t;if(!!n||t.isSymmetric()){for(r=0;r<o;r++)for(i=0;i<o;i++)s[r][i]=h.get(r,i);!function(t,e,n,r){var i,o,s,a,u,h,l,c;for(u=0;u<t;u++)n[u]=r[t-1][u];for(a=t-1;a>0;a--){for(c=0,s=0,h=0;h<a;h++)c+=Math.abs(n[h]);if(0===c)for(e[a]=n[a-1],u=0;u<a;u++)n[u]=r[a-1][u],r[a][u]=0,r[u][a]=0;else{for(h=0;h<a;h++)n[h]/=c,s+=n[h]*n[h];for(i=n[a-1],o=Math.sqrt(s),i>0&&(o=-o),e[a]=c*o,s-=i*o,n[a-1]=i-o,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(i=n[u],r[u][a]=i,o=e[u]+r[u][u]*i,h=u+1;h<=a-1;h++)o+=r[h][u]*n[h],e[h]+=r[h][u]*i;e[u]=o}for(i=0,u=0;u<a;u++)e[u]/=s,i+=e[u]*n[u];for(l=i/(s+s),u=0;u<a;u++)e[u]-=l*n[u];for(u=0;u<a;u++){for(i=n[u],o=e[u],h=u;h<=a-1;h++)r[h][u]-=i*e[h]+o*n[h];n[u]=r[a-1][u],r[a][u]=0}}n[a]=s}for(a=0;a<t-1;a++){if(r[t-1][a]=r[a][a],r[a][a]=1,0!==(s=n[a+1])){for(h=0;h<=a;h++)n[h]=r[h][a+1]/s;for(u=0;u<=a;u++){for(o=0,h=0;h<=a;h++)o+=r[h][a+1]*r[h][u];for(h=0;h<=a;h++)r[h][u]-=o*n[h]}}for(h=0;h<=a;h++)r[h][a+1]=0}for(u=0;u<t;u++)n[u]=r[t-1][u],r[t-1][u]=0;r[t-1][t-1]=1,e[0]=0}(o,u,a,s),function(t,e,n,r){var i,o,s,a,u,h,l,c,f,d,m,g,v,p,w,x;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;var b=0,y=0,M=Number.EPSILON;for(h=0;h<t;h++){for(y=Math.max(y,Math.abs(n[h])+Math.abs(e[h])),l=h;l<t&&!(Math.abs(e[l])<=M*y);)l++;if(l>h)do{for(i=n[h],f=K(c=(n[h+1]-i)/(2*e[h]),1),c<0&&(f=-f),n[h]=e[h]/(c+f),n[h+1]=e[h]*(c+f),d=n[h+1],o=i-n[h],s=h+2;s<t;s++)n[s]-=o;for(b+=o,c=n[l],g=m=1,v=m,p=e[h+1],w=0,x=0,s=l-1;s>=h;s--)for(v=g,g=m,x=w,i=m*e[s],o=m*c,f=K(c,e[s]),e[s+1]=w*f,w=e[s]/f,c=(m=c/f)*n[s]-w*i,n[s+1]=o+w*(m*i+w*n[s]),u=0;u<t;u++)o=r[u][s+1],r[u][s+1]=w*r[u][s]+m*o,r[u][s]=m*r[u][s]-w*o;c=-w*x*v*p*e[h]/d,e[h]=w*c,n[h]=m*c}while(Math.abs(e[h])>M*y);n[h]=n[h]+b,e[h]=0}for(s=0;s<t-1;s++){for(u=s,c=n[s],a=s+1;a<t;a++)n[a]<c&&(u=a,c=n[a]);if(u!==s)for(n[u]=n[s],n[s]=c,a=0;a<t;a++)c=r[a][s],r[a][s]=r[a][u],r[a][u]=c}}(o,u,a,s)}else{var l=Q(o,o,0),c=new Array(o);for(i=0;i<o;i++)for(r=0;r<o;r++)l[r][i]=h.get(r,i);!function(t,e,n,r){var i,o,s,a,u,h,l,c=0,f=t-1;for(h=c+1;h<=f-1;h++){for(l=0,a=h;a<=f;a++)l+=Math.abs(e[a][h-1]);if(0!==l){for(s=0,a=f;a>=h;a--)n[a]=e[a][h-1]/l,s+=n[a]*n[a];for(o=Math.sqrt(s),n[h]>0&&(o=-o),s-=n[h]*o,n[h]=n[h]-o,u=h;u<t;u++){for(i=0,a=f;a>=h;a--)i+=n[a]*e[a][u];for(i/=s,a=h;a<=f;a++)e[a][u]-=i*n[a]}for(a=0;a<=f;a++){for(i=0,u=f;u>=h;u--)i+=n[u]*e[a][u];for(i/=s,u=h;u<=f;u++)e[a][u]-=i*n[u]}n[h]=l*n[h],e[h][h-1]=l*o}}for(a=0;a<t;a++)for(u=0;u<t;u++)r[a][u]=a===u?1:0;for(h=f-1;h>=c+1;h--)if(0!==e[h][h-1]){for(a=h+1;a<=f;a++)n[a]=e[a][h-1];for(u=h;u<=f;u++){for(o=0,a=h;a<=f;a++)o+=n[a]*r[a][u];for(o=o/n[h]/e[h][h-1],a=h;a<=f;a++)r[a][u]+=o*n[a]}}}(o,l,c,s),function(t,e,n,r,i){var o,s,a,u,h,l,c,f,d,m,g,v,p,w,x,b=t-1,y=0,M=t-1,_=Number.EPSILON,k=0,E=0,S=0,N=0,$=0,R=0,j=0,A=0;for(o=0;o<t;o++)for((o<y||o>M)&&(n[o]=i[o][o],e[o]=0),s=Math.max(o-1,0);s<t;s++)E+=Math.abs(i[o][s]);for(;b>=y;){for(u=b;u>y&&(0===(R=Math.abs(i[u-1][u-1])+Math.abs(i[u][u]))&&(R=E),!(Math.abs(i[u][u-1])<_*R));)u--;if(u===b)i[b][b]=i[b][b]+k,n[b]=i[b][b],e[b]=0,b--,A=0;else if(u===b-1){if(c=i[b][b-1]*i[b-1][b],N=(S=(i[b-1][b-1]-i[b][b])/2)*S+c,j=Math.sqrt(Math.abs(N)),i[b][b]=i[b][b]+k,i[b-1][b-1]=i[b-1][b-1]+k,f=i[b][b],N>=0){for(j=S>=0?S+j:S-j,n[b-1]=f+j,n[b]=n[b-1],0!==j&&(n[b]=f-c/j),e[b-1]=0,e[b]=0,S=(f=i[b][b-1])/(R=Math.abs(f)+Math.abs(j)),N=j/R,S/=$=Math.sqrt(S*S+N*N),N/=$,s=b-1;s<t;s++)j=i[b-1][s],i[b-1][s]=N*j+S*i[b][s],i[b][s]=N*i[b][s]-S*j;for(o=0;o<=b;o++)j=i[o][b-1],i[o][b-1]=N*j+S*i[o][b],i[o][b]=N*i[o][b]-S*j;for(o=y;o<=M;o++)j=r[o][b-1],r[o][b-1]=N*j+S*r[o][b],r[o][b]=N*r[o][b]-S*j}else n[b-1]=f+S,n[b]=f+S,e[b-1]=j,e[b]=-j;b-=2,A=0}else{if(f=i[b][b],d=0,c=0,u<b&&(d=i[b-1][b-1],c=i[b][b-1]*i[b-1][b]),10===A){for(k+=f,o=y;o<=b;o++)i[o][o]-=f;f=d=.75*(R=Math.abs(i[b][b-1])+Math.abs(i[b-1][b-2])),c=-.4375*R*R}if(30===A&&(R=(R=(d-f)/2)*R+c)>0){for(R=Math.sqrt(R),d<f&&(R=-R),R=f-c/((d-f)/2+R),o=y;o<=b;o++)i[o][o]-=R;k+=R,f=d=c=.964}for(A+=1,h=b-2;h>=u&&(S=(($=f-(j=i[h][h]))*(R=d-j)-c)/i[h+1][h]+i[h][h+1],N=i[h+1][h+1]-j-$-R,$=i[h+2][h+1],S/=R=Math.abs(S)+Math.abs(N)+Math.abs($),N/=R,$/=R,h!==u)&&!(Math.abs(i[h][h-1])*(Math.abs(N)+Math.abs($))<_*(Math.abs(S)*(Math.abs(i[h-1][h-1])+Math.abs(j)+Math.abs(i[h+1][h+1]))));)h--;for(o=h+2;o<=b;o++)i[o][o-2]=0,o>h+2&&(i[o][o-3]=0);for(a=h;a<=b-1&&(w=a!==b-1,a!==h&&(S=i[a][a-1],N=i[a+1][a-1],$=w?i[a+2][a-1]:0,0!==(f=Math.abs(S)+Math.abs(N)+Math.abs($))&&(S/=f,N/=f,$/=f)),0!==f);a++)if(R=Math.sqrt(S*S+N*N+$*$),S<0&&(R=-R),0!==R){for(a!==h?i[a][a-1]=-R*f:u!==h&&(i[a][a-1]=-i[a][a-1]),f=(S+=R)/R,d=N/R,j=$/R,N/=S,$/=S,s=a;s<t;s++)S=i[a][s]+N*i[a+1][s],w&&(S+=$*i[a+2][s],i[a+2][s]=i[a+2][s]-S*j),i[a][s]=i[a][s]-S*f,i[a+1][s]=i[a+1][s]-S*d;for(o=0;o<=Math.min(b,a+3);o++)S=f*i[o][a]+d*i[o][a+1],w&&(S+=j*i[o][a+2],i[o][a+2]=i[o][a+2]-S*$),i[o][a]=i[o][a]-S,i[o][a+1]=i[o][a+1]-S*N;for(o=y;o<=M;o++)S=f*r[o][a]+d*r[o][a+1],w&&(S+=j*r[o][a+2],r[o][a+2]=r[o][a+2]-S*$),r[o][a]=r[o][a]-S,r[o][a+1]=r[o][a+1]-S*N}}}if(0===E)return;for(b=t-1;b>=0;b--)if(S=n[b],0===(N=e[b]))for(u=b,i[b][b]=1,o=b-1;o>=0;o--){for(c=i[o][o]-S,$=0,s=u;s<=b;s++)$+=i[o][s]*i[s][b];if(e[o]<0)j=c,R=$;else if(u=o,0===e[o]?i[o][b]=0!==c?-$/c:-$/(_*E):(f=i[o][o+1],d=i[o+1][o],l=(f*R-j*$)/(N=(n[o]-S)*(n[o]-S)+e[o]*e[o]),i[o][b]=l,i[o+1][b]=Math.abs(f)>Math.abs(j)?(-$-c*l)/f:(-R-d*l)/j),_*(l=Math.abs(i[o][b]))*l>1)for(s=o;s<=b;s++)i[s][b]=i[s][b]/l}else if(N<0)for(u=b-1,Math.abs(i[b][b-1])>Math.abs(i[b-1][b])?(i[b-1][b-1]=N/i[b][b-1],i[b-1][b]=-(i[b][b]-S)/i[b][b-1]):(x=St(0,-i[b-1][b],i[b-1][b-1]-S,N),i[b-1][b-1]=x[0],i[b-1][b]=x[1]),i[b][b-1]=0,i[b][b]=1,o=b-2;o>=0;o--){for(m=0,g=0,s=u;s<=b;s++)m+=i[o][s]*i[s][b-1],g+=i[o][s]*i[s][b];if(c=i[o][o]-S,e[o]<0)j=c,$=m,R=g;else if(u=o,0===e[o]?(x=St(-m,-g,c,N),i[o][b-1]=x[0],i[o][b]=x[1]):(f=i[o][o+1],d=i[o+1][o],v=(n[o]-S)*(n[o]-S)+e[o]*e[o]-N*N,p=2*(n[o]-S)*N,0===v&&0===p&&(v=_*E*(Math.abs(c)+Math.abs(N)+Math.abs(f)+Math.abs(d)+Math.abs(j))),x=St(f*$-j*m+N*g,f*R-j*g-N*m,v,p),i[o][b-1]=x[0],i[o][b]=x[1],Math.abs(f)>Math.abs(j)+Math.abs(N)?(i[o+1][b-1]=(-m-c*i[o][b-1]+N*i[o][b])/f,i[o+1][b]=(-g-c*i[o][b]-N*i[o][b-1])/f):(x=St(-$-d*i[o][b-1],-R-d*i[o][b],j,N),i[o+1][b-1]=x[0],i[o+1][b]=x[1])),_*(l=Math.max(Math.abs(i[o][b-1]),Math.abs(i[o][b])))*l>1)for(s=o;s<=b;s++)i[s][b-1]=i[s][b-1]/l,i[s][b]=i[s][b]/l}for(o=0;o<t;o++)if(o<y||o>M)for(s=o;s<t;s++)r[o][s]=i[o][s];for(s=t-1;s>=y;s--)for(o=y;o<=M;o++){for(j=0,a=y;a<=Math.min(s,M);a++)j+=r[o][a]*i[a][s];r[o][s]=j}}(o,u,a,s,l)}this.n=o,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return bt.isMatrix(this.V)||(this.V=new bt(this.V)),this.V}get diagonalMatrix(){var t,e,n=this.n,r=this.e,i=this.d,o=new bt(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)o[t][e]=0;o[t][t]=i[t],r[t]>0?o[t][t+1]=r[t]:r[t]<0&&(o[t][t-1]=r[t])}return o}}function St(t,e,n,r){var i,o;return Math.abs(n)>Math.abs(r)?[(t+(i=r/n)*e)/(o=n+i*r),(e-i*t)/o]:[((i=n/r)*t+e)/(o=r+i*n),(i*e-t)/o]}class Nt{constructor(t){if(!(t=yt.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,r,i=t,o=i.rows,s=new bt(o,o),a=!0;for(n=0;n<o;n++){var u=s[n],h=0;for(r=0;r<n;r++){var l=s[r],c=0;for(e=0;e<r;e++)c+=l[e]*u[e];u[r]=c=(i.get(n,r)-c)/s[r][r],h+=c*c}for(a&=(h=i.get(n,n)-h)>0,s[n][n]=Math.sqrt(Math.max(h,0)),r=n+1;r<o;r++)s[n][r]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=s}solve(t){t=yt.checkMatrix(t);var e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");var r,i,o,s=t.columns,a=t.clone();for(o=0;o<n;o++)for(i=0;i<s;i++){for(r=0;r<o;r++)a[o][i]-=a[r][i]*e[o][r];a[o][i]/=e[o][o]}for(o=n-1;o>=0;o--)for(i=0;i<s;i++){for(r=o+1;r<n;r++)a[o][i]-=a[r][i]*e[r][o];a[o][i]/=e[o][o]}return a}get lowerTriangularMatrix(){return this.L}}var $t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Rt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}function jt(t){var e={exports:{}};return t(e,e.exports),e.exports}var At={func:Symbol("func"),validate:Symbol("validate")};const{func:Ct}=At;var Tt={predicates:{positive:t=>t>0,negative:t=>t<0,nonNegative:t=>t>=0,integer:t=>t===(0|t),[Ct]:{is:t=>t,eq:t=>e=>e===t,gt:t=>e=>e>t,gte:t=>e=>e>=t,lt:t=>e=>e<t,lte:t=>e=>e<=t}},validator:t=>"number"==typeof t};const{func:qt}=At;var Vt={predicates:{empty:t=>""===t,nonEmpty:t=>""!==t,[qt]:{is:t=>t,eq:t=>e=>e===t,length:t=>e=>e.length===t,minLength:t=>e=>e.length>=t,maxLength:t=>e=>e.length<=t,matches:t=>e=>t.test(e),startsWith:t=>e=>e.startsWith(t),endsWith:t=>e=>e.endsWith(t)}},validator:t=>"string"==typeof t};const{func:It}=At;const Ot={number:Tt,string:Vt,object:{predicates:{plain:t=>{if("object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.getPrototypeOf({})},empty:t=>0===Object.keys(t).length,nonEmpty:t=>Object.keys(t).length>0,[It]:{is:t=>t,instanceOf:t=>e=>e instanceof t}},validator:t=>"object"==typeof t}},Pt=({validators:t=[],predicates:e=Ot,type:n=null}={})=>{const r=new Proxy((function(){}),{get:(i,o)=>{if(o===At.validate)return(e,r="argument")=>{if(!n)return new Error("missing required type specifier");for(let i=0;i<t.length;++i){const o=t[i];if(!o.fn(e))throw 0===i?new Error(`Expected ${r} \`${e}\` to be of type \`${n}\`, but received type \`${typeof e}\``):new Error(`Expected ${n} \`${r}\` \`${e}\` failed predicate \`${o.key}\``)}};const s=e[o];if(s)return"function"==typeof s?(t.push({key:o,fn:s}),r):Pt({type:o,validators:[{key:o,fn:s.validator}],predicates:s.predicates});{const n=e[At.func]&&e[At.func][o];return n?new Proxy((function(){}),{get:()=>{throw new Error(`invalid use of functional predicate "${o}"`)},apply:(e,i,s)=>(t.push({key:o,fn:n(...s)}),r)}):r}},apply:(t,e,n)=>{if(2!==n.length&&3!==n.length)throw new Error('invalid number of arguments to "ow"');n[1][At.validate](n[0],n[2])}});return r};var zt=Pt(),Lt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();var Dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return Lt(t,[{key:"next",value:function(){throw new Error("RNG.next must be overridden")}},{key:"seed",value:function(t,e){throw new Error("RNG.seed must be overridden")}},{key:"clone",value:function(t,e){throw new Error("RNG.clone must be overridden")}},{key:"_seed",value:function(t,e){if(t===(0|t))return t;for(var n=""+t,r=0,i=0;i<n.length;++i)r^=0|n.charCodeAt(i);return r}},{key:"name",get:function(){throw new Error("RNG.name must be overridden")}}]),t}(),Ht=Object.defineProperty({default:Dt},"__esModule",{value:!0}),Ut=jt((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.alea=o}(0,t,!1)})),Ft=jt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor128=o}(0,t,!1)})),Xt=jt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorwow=o}(0,t,!1)})),Bt=jt((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorshift7=o}(0,t,!1)})),Wt=jt((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,s,a=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,i=0==(n=a[127&o]^=r+s)?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;t.w=s,t.X=a,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor4096=o}(0,t,!1)})),Gt=jt((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.tychei=o}(0,t,!1)})),Kt=Rt(Object.freeze({__proto__:null,default:{}})),Qt=jt((function(t){!function(e,n,r){var i,o=256,s=r.pow(o,6),a=r.pow(2,52),u=2*a,h=255;function l(t,h,l){var v=[],p=m(d((h=1==h?{entropy:!0}:h||{}).entropy?[t,g(n)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var r=e.navigator,s=r&&r.plugins;return[+new Date,e,s,e.screen,g(n)]}}():t,3),v),w=new c(v),x=function(){for(var t=w.g(6),e=s,n=0;t<a;)t=(t+n)*o,e*=o,n=w.g(1);for(;t>=u;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|w.g(4)},x.quick=function(){return w.g(4)/4294967296},x.double=x,m(g(w.S),n),(h.pass||l||function(t,e,n,i){return i&&(i.S&&f(i,w),t.state=function(){return f(w,{})}),n?(r.random=t,e):t})(x,p,"global"in h?h.global:this==r,h.state)}function c(t){var e,n=t.length,r=this,i=0,s=r.i=r.j=0,a=r.S=[];for(n||(t=[n++]);i<o;)a[i]=i++;for(i=0;i<o;i++)a[i]=a[s=h&s+t[i%n]+(e=a[i])],a[s]=e;(r.g=function(t){for(var e,n=0,i=r.i,s=r.j,a=r.S;t--;)e=a[i=h&i+1],n=n*o+a[h&(a[i]=a[s=h&s+e])+(a[s]=e)];return r.i=i,r.j=s,n})(o)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function d(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(d(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function m(t,e){for(var n,r=t+"",i=0;i<r.length;)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(m(r.random(),n),t.exports){t.exports=l;try{i=Kt}catch(t){}}else r.seedrandom=l}("undefined"!=typeof self?self:$t,[],Math)}));Qt.alea=Ut,Qt.xor128=Ft,Qt.xorwow=Xt,Qt.xorshift7=Bt,Qt.xor4096=Wt,Qt.tychei=Gt;var Yt=Qt,Zt=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Jt=te(zt);function te(t){return t&&t.__esModule?t:{default:t}}var ee=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return r.seed(t,n),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Zt(e,[{key:"next",value:function(){return this._rng()}},{key:"seed",value:function(t){(0,Jt.default)(t,Jt.default.function),this._rng=t}},{key:"clone",value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return new(Function.prototype.bind.apply(e,[null].concat([this._rng],n)))}},{key:"name",get:function(){return"function"}}]),e}(te(Ht).default),ne=Object.defineProperty({default:ee},"__esModule",{value:!0}),re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie=ae(Yt),oe=ae(Ht),se=ae(ne);function ae(t){return t&&t.__esModule?t:{default:t}}function ue(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var he,le=Object.defineProperty({default:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=void 0===r?"default":r,o=e.slice(1);switch(void 0===i?"undefined":re(i)){case"object":if(i instanceof oe.default)return i;break;case"function":return new se.default(i);case"string":case"number":return new se.default(ie.default.apply(void 0,ue(o)))}throw new Error('invalid RNG "'+i+'"')}},"__esModule",{value:!0}),ce=(he=zt)&&he.__esModule?he:{default:he};var fe=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,ce.default)(e,ce.default.number),(0,ce.default)(n,ce.default.number),function(){return t.next()*(n-e)+e}}},"__esModule",{value:!0}),de=function(t){return t&&t.__esModule?t:{default:t}}(zt);var me=Object.defineProperty({default:function(t,e,n){return void 0===n&&(n=void 0===e?1:e,e=0),(0,de.default)(e,de.default.number.integer),(0,de.default)(n,de.default.number.integer),function(){return t.next()*(n-e+1)+e|0}}},"__esModule",{value:!0}),ge=Object.defineProperty({default:function(t){return function(){return t.next()>=.5}}},"__esModule",{value:!0}),ve=function(t){return t&&t.__esModule?t:{default:t}}(zt);var pe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,ve.default)(e,ve.default.number),(0,ve.default)(n,ve.default.number),function(){var r=void 0,i=void 0,o=void 0;do{o=(r=2*t.next()-1)*r+(i=2*t.next()-1)*i}while(!o||o>1);return e+n*i*Math.sqrt(-2*Math.log(o)/o)}}},"__esModule",{value:!0}),we=Object.defineProperty({default:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i=t.normal.apply(t,n);return function(){return Math.exp(i())}}},"__esModule",{value:!0}),xe=function(t){return t&&t.__esModule?t:{default:t}}(zt);var be=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,xe.default)(e,xe.default.number.gte(0).lt(1)),function(){return t.next()+e|0}}},"__esModule",{value:!0}),ye=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Me=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return(0,ye.default)(e,ye.default.number.positive.integer),(0,ye.default)(n,ye.default.number.gte(0).lte(1)),function(){for(var r=0,i=0;r++<e;)i+=t.next()<n;return i}}},"__esModule",{value:!0}),_e=function(t){return t&&t.__esModule?t:{default:t}}(zt);var ke=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;(0,_e.default)(e,_e.default.number.gt(0).lte(1));var n=1/Math.log(1-e);return function(){return 1+Math.log(t.next())*n|0}}},"__esModule",{value:!0}),Ee=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Se=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],Ne=function(t){return Se[t]},$e=.9189385332046727,Re=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,Ee.default)(e,Ee.default.number.positive),e<10){var n=Math.exp(-e);return function(){for(var r=n,i=0,o=t.next();o>r;)o-=r,r=e*r/++i;return i}}var r=Math.sqrt(e),i=.931+2.53*r,o=.02483*i-.059,s=1.1239+1.1328/(i-3.4),a=.9277-3.6224/(i-2);return function(){for(;;){var n=void 0,u=t.next();if(u<=.86*a)return n=u/a-.43,Math.floor((2*o/(.5-Math.abs(n))+i)*n+e+.445);u>=a?n=t.next()-.5:(n=((n=u/a-.93)<0?-.5:.5)-n,u=t.next()*a);var h=.5-Math.abs(n);if(!(h<.013&&u>h)){var l=0|Math.floor((2*o/h+i)*n+e+.445);if(u=u*s/(o/(h*h)+i),l>=10){var c=(l+.5)*Math.log(e/l)-e-$e+l-(1/12-(1/360-1/(1260*l*l))/(l*l))/l;if(Math.log(u*r)<=c)return l}else if(l>=0&&Math.log(u)<=l*Math.log(e)-e-Ne(l))return l}}}}},"__esModule",{value:!0}),je=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Ae=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,je.default)(e,je.default.number.positive),function(){return-Math.log(1-t.next())/e}}},"__esModule",{value:!0}),Ce=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Te=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Ce.default)(e,Ce.default.number.integer.gte(0)),function(){for(var n=0,r=0;r<e;++r)n+=t.next();return n}}},"__esModule",{value:!0}),qe=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Ve=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,qe.default)(e,qe.default.number.integer.positive);var n=t.irwinHall(e);return function(){return n()/e}}},"__esModule",{value:!0}),Ie=function(t){return t&&t.__esModule?t:{default:t}}(zt);var Oe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Ie.default)(e,Ie.default.number.gte(0));var n=1/e;return function(){return 1/Math.pow(1-t.next(),n)}}},"__esModule",{value:!0}),Pe=jt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RNGFactory=e.RNG=void 0;var n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=x(zt),i=x(Ht),o=x(le),s=x(fe),a=x(me),u=x(ge),h=x(pe),l=x(we),c=x(be),f=x(Me),d=x(ke),m=x(Re),g=x(Ae),v=x(Te),p=x(Ve),w=x(Oe);function x(t){return t&&t.__esModule?t:{default:t}}e.RNG=i.default,e.RNGFactory=o.default;var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(0,r.default)(e,r.default.object.instanceOf(i.default)),this._cache={},this.use(e)}return n(t,[{key:"clone",value:function(){return new t(arguments.length?o.default.apply(void 0,arguments):this.rng.clone())}},{key:"use",value:function(){this._rng=o.default.apply(void 0,arguments)}},{key:"patch",value:function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}},{key:"unpatch",value:function(){this._patch&&(Math.random=this._patch,delete this._patch)}},{key:"next",value:function(){return this._rng.next()}},{key:"float",value:function(t,e){return this.uniform(t,e)()}},{key:"int",value:function(t,e){return this.uniformInt(t,e)()}},{key:"integer",value:function(t,e){return this.uniformInt(t,e)()}},{key:"bool",value:function(){return this.uniformBoolean()()}},{key:"boolean",value:function(){return this.uniformBoolean()()}},{key:"uniform",value:function(t,e){return this._memoize("uniform",s.default,t,e)}},{key:"uniformInt",value:function(t,e){return this._memoize("uniformInt",a.default,t,e)}},{key:"uniformBoolean",value:function(){return this._memoize("uniformBoolean",u.default)}},{key:"normal",value:function(t,e){return(0,h.default)(this,t,e)}},{key:"logNormal",value:function(t,e){return(0,l.default)(this,t,e)}},{key:"bernoulli",value:function(t){return(0,c.default)(this,t)}},{key:"binomial",value:function(t,e){return(0,f.default)(this,t,e)}},{key:"geometric",value:function(t){return(0,d.default)(this,t)}},{key:"poisson",value:function(t){return(0,m.default)(this,t)}},{key:"exponential",value:function(t){return(0,g.default)(this,t)}},{key:"irwinHall",value:function(t){return(0,v.default)(this,t)}},{key:"bates",value:function(t){return(0,p.default)(this,t)}},{key:"pareto",value:function(t){return(0,w.default)(this,t)}},{key:"_memoize",value:function(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=""+r.join(";"),s=this._cache[t];return void 0!==s&&s.key===o||(s={key:o,distribution:e.apply(void 0,[this].concat(r))},this._cache[t]=s),s.distribution}},{key:"rng",get:function(){return this._rng}}]),t}();e.default=new b})).default;class ze{constructor(t,e){t instanceof bt&&e instanceof bt?(this.mean=t,this.cov=e):(this.mean=new bt([t]).transpose(),this.cov=new bt(e))}at(t){const e=new bt([t]).transpose().sub(this.mean);return e.transpose().mmul(_t(this.cov)).mmul(e).mul(-.5).exp()*(1/Math.sqrt(Math.pow(2*Math.PI,this.mean.rows)*this.cov.det()))}marginalize(t){const e=Le(this.mean,0,0,t,1),n=Le(this.mean,t,0,this.mean.rows,1),r=Le(this.cov,0,0,t,t),i=Le(this.cov,t,t,this.mean.rows,this.mean.rows);return[new ze(e,r),new ze(n,i)]}condition(t){const e=t.length,n=new bt([t]).transpose(),r=Le(this.cov,0,0,e,e),i=Le(this.cov,0,e,e,this.mean.rows),o=i.transpose(),s=Le(this.cov,e,e,this.mean.rows,this.mean.rows),a=new Nt(r).lowerTriangularMatrix,u=kt(a,n),h=kt(a,i).transpose().mmul(u),l=s.sub(o.mmul(_t(r)).mmul(i));return new ze(h,l)}transformationMatrix(){const t=new Et(this.cov),e=t.eigenvectorMatrix,n=bt.zeros(e.rows,e.columns);for(let e=0;e<n.rows;++e)n.set(e,e,Math.sqrt(t.realEigenvalues[e]));return e.mmul(n)}sample(){const t=bt.zeros(this.mean.rows,1),e=Pe.normal();for(let n=0;n<this.mean.rows;++n)t.set(n,0,e());return bt.add(this.mean,this.transformationMatrix().mmul(t))}getMean(){return this.mean.transpose()[0]}getSd(){return this.cov.diag().map((t=>Math.sqrt(t)))}}function Le(t,e,n,r,i){const o=new bt(r-e,i-n);for(let s=e;s<r;++s)for(let r=n;r<i;++r)o.set(s-e,r-n,t.get(s,r));return o}class De{constructor(t,e,n){this.ns=t,this.beg=e,this.end=n;var r,i=[e];this.inds=[],this.y=[],this.x=[],this.up=[];for(let t=0;t<this.ns-1;t++)i.push(e+(n-e)*Math.random()),this.inds.push(t);i.push(n),this.inds.push(this.ns-1),this.inds=function(t){for(var e,n=t.length;0!==n;)e=Math.floor(Math.random()*n),n--,[t[n],t[e]]=[t[e],t[n]];return t}(this.inds),i.sort(((t,e)=>t-e));var o=e;for(let t=0;t<this.ns;t++)this.up.push(Math.random()<.5),r=this.inds[t],this.x.push(o),o+=i[r+1]-i[r],this.y.push(this.up[t]?i[r]:i[r+1]);this.x.push(n)}static identity(t,e){var n=new De(1,t,e);return n.y[0]=n.beg,n.up[0]=!0,n}is_identity(){return 1==this.ns&&this.y[0]==this.beg&&this.up[0]}get(t){if(t<this.beg||t>this.end)throw`invalid input to Scramble::get (${t}).  must be in [${this.beg}, ${this.end}]`;var e;for(e=0;e!=this.ns&&!(t<this.x[e]);e++);e--;var n=t-this.x[e];return this.up[e]?this.y[e]+n:this.y[e]-n}}function He(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ue(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>He(t(e),n)}(t)),{left:r,center:function(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}}const Fe=Ue(He).right;Ue((function(t){return null===t?NaN:+t})).center;var Xe=Math.sqrt(50),Be=Math.sqrt(10),We=Math.sqrt(2);function Ge(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Xe?10:o>=Be?5:o>=We?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Xe?10:o>=Be?5:o>=We?2:1)}function Ke(t){if(!(i=t.length))return[];for(var e=-1,n=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}(t,Qe),r=new Array(n);++e<n;)for(var i,o=-1,s=r[e]=new Array(i);++o<i;)s[o]=t[o][e];return r}function Qe(t){return t.length}function Ye(){return Ke(arguments)}function Ze(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Je(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function tn(){}var en=.7,nn=1/en,rn="\\s*([+-]?\\d+)\\s*",on="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",sn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",an=/^#([0-9a-f]{3,8})$/,un=new RegExp("^rgb\\("+[rn,rn,rn]+"\\)$"),hn=new RegExp("^rgb\\("+[sn,sn,sn]+"\\)$"),ln=new RegExp("^rgba\\("+[rn,rn,rn,on]+"\\)$"),cn=new RegExp("^rgba\\("+[sn,sn,sn,on]+"\\)$"),fn=new RegExp("^hsl\\("+[on,sn,sn]+"\\)$"),dn=new RegExp("^hsla\\("+[on,sn,sn,on]+"\\)$"),mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function gn(){return this.rgb().formatHex()}function vn(){return this.rgb().formatRgb()}function pn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=an.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?wn(e):3===n?new Mn(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?xn(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?xn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=un.exec(t))?new Mn(e[1],e[2],e[3],1):(e=hn.exec(t))?new Mn(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ln.exec(t))?xn(e[1],e[2],e[3],e[4]):(e=cn.exec(t))?xn(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=fn.exec(t))?Sn(e[1],e[2]/100,e[3]/100,1):(e=dn.exec(t))?Sn(e[1],e[2]/100,e[3]/100,e[4]):mn.hasOwnProperty(t)?wn(mn[t]):"transparent"===t?new Mn(NaN,NaN,NaN,0):null}function wn(t){return new Mn(t>>16&255,t>>8&255,255&t,1)}function xn(t,e,n,r){return r<=0&&(t=e=n=NaN),new Mn(t,e,n,r)}function bn(t){return t instanceof tn||(t=pn(t)),t?new Mn((t=t.rgb()).r,t.g,t.b,t.opacity):new Mn}function yn(t,e,n,r){return 1===arguments.length?bn(t):new Mn(t,e,n,null==r?1:r)}function Mn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function _n(){return"#"+En(this.r)+En(this.g)+En(this.b)}function kn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function En(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Sn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $n(t,e,n,r)}function Nn(t){if(t instanceof $n)return new $n(t.h,t.s,t.l,t.opacity);if(t instanceof tn||(t=pn(t)),!t)return new $n;if(t instanceof $n)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new $n(s,a,u,t.opacity)}function $n(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Rn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ze(tn,pn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:gn,formatHex:gn,formatHsl:function(){return Nn(this).formatHsl()},formatRgb:vn,toString:vn}),Ze(Mn,yn,Je(tn,{brighter:function(t){return t=null==t?nn:Math.pow(nn,t),new Mn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?en:Math.pow(en,t),new Mn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_n,formatHex:_n,formatRgb:kn,toString:kn})),Ze($n,(function(t,e,n,r){return 1===arguments.length?Nn(t):new $n(t,e,n,null==r?1:r)}),Je(tn,{brighter:function(t){return t=null==t?nn:Math.pow(nn,t),new $n(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?en:Math.pow(en,t),new $n(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Mn(Rn(t>=240?t-240:t+120,i,r),Rn(t,i,r),Rn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var jn=t=>()=>t;function An(t){return 1==(t=+t)?Cn:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):jn(isNaN(e)?n:e)}}function Cn(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):jn(isNaN(t)?e:t)}var Tn=function t(e){var n=An(e);function r(t,e){var r=n((t=yn(t)).r,(e=yn(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=Cn(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function qn(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Vn(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=Hn(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}function In(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function On(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Pn(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Hn(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var zn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ln=new RegExp(zn.source,"g");function Dn(t,e){var n,r,i,o=zn.lastIndex=Ln.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=zn.exec(t))&&(r=Ln.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:On(n,r)})),o=Ln.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})}function Hn(t,e){var n,r=typeof e;return null==e||"boolean"===r?jn(e):("number"===r?On:"string"===r?(n=pn(e))?(e=n,Tn):Dn:e instanceof pn?Tn:e instanceof Date?In:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?qn:Array.isArray(e)?Vn:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Pn:On)(t,e)}function Un(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}const Fn=Math.PI,Xn=2*Fn,Bn=1e-6,Wn=Xn-Bn;function Gn(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Kn(){return new Gn}function Qn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Yn(t){return(t=Qn(Math.abs(t)))?t[1]:NaN}Gn.prototype=Kn.prototype={constructor:Gn,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-t,u=r-e,h=o-t,l=s-e,c=h*h+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>Bn)if(Math.abs(l*a-u*h)>Bn&&i){var f=n-o,d=r-s,m=a*a+u*u,g=f*f+d*d,v=Math.sqrt(m),p=Math.sqrt(c),w=i*Math.tan((Fn-Math.acos((m+c-g)/(2*v*p)))/2),x=w/p,b=w/v;Math.abs(x-1)>Bn&&(this._+="L"+(t+x*h)+","+(e+x*l)),this._+="A"+i+","+i+",0,0,"+ +(l*f>h*d)+","+(this._x1=t+b*a)+","+(this._y1=e+b*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=t+s,h=e+a,l=1^o,c=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+h:(Math.abs(this._x1-u)>Bn||Math.abs(this._y1-h)>Bn)&&(this._+="L"+u+","+h),n&&(c<0&&(c=c%Xn+Xn),c>Wn?this._+="A"+n+","+n+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=h):c>Bn&&(this._+="A"+n+","+n+",0,"+ +(c>=Fn)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Zn,Jn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tr(t){if(!(e=Jn.exec(t)))throw new Error("invalid format: "+t);var e;return new er({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function er(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function nr(t,e){var n=Qn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}tr.prototype=er.prototype,er.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var rr={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>nr(100*t,e),r:nr,s:function(t,e){var n=Qn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Zn=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Qn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ir(t){return t}var or,sr,ar,ur=Array.prototype.map,hr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function lr(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ir:(e=ur.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(t.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?ir:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ur.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"−":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=tr(t)).fill,n=t.align,c=t.sign,f=t.symbol,d=t.zero,m=t.width,g=t.comma,v=t.precision,p=t.trim,w=t.type;"n"===w?(g=!0,w="g"):rr[w]||(void 0===v&&(v=12),p=!0,w="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var x="$"===f?i:"#"===f&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",b="$"===f?o:/[%p]/.test(w)?u:"",y=rr[w],M=/[defgprs%]/.test(w);function _(t){var i,o,u,f=x,_=b;if("c"===w)_=y(t)+_,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:y(Math.abs(t),v),p&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==c&&(k=!1),f=(k?"("===c?c:h:"-"===c||"("===c?"":c)+f,_=("s"===w?hr[8+Zn/3]:"")+_+(k&&"("===c?")":""),M)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){_=(46===u?s+t.slice(i+1):t.slice(i))+_,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var E=f.length+t.length+_.length,S=E<m?new Array(m-E+1).join(e):"";switch(g&&d&&(t=r(S+t,S.length?m-_.length:1/0),S=""),n){case"<":t=f+t+_+S;break;case"=":t=f+S+t+_;break;case"^":t=S.slice(0,E=S.length>>1)+f+t+_+S.slice(E);break;default:t=S+f+t+_}return a(t)}return v=void 0===v?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),_.toString=function(){return t+""},_}return{format:c,formatPrefix:function(t,e){var n=c(((t=tr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Yn(e)/3))),i=Math.pow(10,-r),o=hr[8+r/3];return function(t){return n(i*t)+o}}}}function cr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function fr(t){return+t}or=lr({thousands:",",grouping:[3],currency:["$",""]}),sr=or.format,ar=or.formatPrefix;var dr=[0,1];function mr(t){return t}function gr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function vr(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=gr(i,r),o=n(s,o)):(r=gr(r,i),o=n(o,s)),function(t){return o(r(t))}}function pr(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=gr(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=Fe(t,e,1,r)-1;return o[n](i[n](e))}}function wr(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function xr(){var t,e,n,r,i,o,s=dr,a=dr,u=Hn,h=mr;function l(){var t,e,n,u=Math.min(s.length,a.length);return h!==mr&&(t=s[0],e=s[u-1],t>e&&(n=t,t=e,e=n),h=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?pr:vr,i=o=null,c}function c(e){return null==e||isNaN(e=+e)?n:(i||(i=r(s.map(t),a,u)))(t(h(e)))}return c.invert=function(n){return h(e((o||(o=r(a,s.map(t),On)))(n)))},c.domain=function(t){return arguments.length?(s=Array.from(t,fr),l()):s.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),l()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),u=Un,l()},c.clamp=function(t){return arguments.length?(h=!!t||mr,l()):h!==mr},c.interpolate=function(t){return arguments.length?(u=t,l()):u},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,r){return t=n,e=r,l()}}function br(){return xr()(mr,mr)}function yr(t,e,n,r){var i,o=function(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Xe?i*=10:o>=Be?i*=5:o>=We&&(i*=2),e<t?-i:i}(t,e,n);switch((r=tr(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Yn(e)/3)))-Yn(Math.abs(t)))}(o,s))||(r.precision=i),ar(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Yn(e)-Yn(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-Yn(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return sr(r)}function Mr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var r,i,o,s,a=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=Ge(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),r=Math.round(e/s);for(n*s<t&&++n,r*s>e&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(t*s),r=Math.round(e*s);for(n/s<t&&++n,r/s>e&&--r,o=new Array(i=r-n+1);++a<i;)o[a]=(n+a)/s}return r&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return yr(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),s=0,a=o.length-1,u=o[s],h=o[a],l=10;for(h<u&&(i=u,u=h,h=i,i=s,s=a,a=i);l-- >0;){if((i=Ge(u,h,n))===r)return o[s]=u,o[a]=h,e(o);if(i>0)u=Math.floor(u/i)*i,h=Math.ceil(h/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,h=Math.floor(h*i)/i}r=i}return t},t}function _r(){var t=br();return t.copy=function(){return wr(t,_r())},cr.apply(t,arguments),Mr(t)}function kr(t){return function(){return t}}function Er(t){this._context=t}function Sr(t){return new Er(t)}function Nr(t){return t[0]}function $r(t){return t[1]}function Rr(t,e){var n=kr(!0),r=null,i=Sr,o=null;function s(s){var a,u,h,l=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,c=!1;for(null==r&&(o=i(h=Kn())),a=0;a<=l;++a)!(a<l&&n(u=s[a],a,s))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+t(u,a,s),+e(u,a,s));if(h)return o=null,h+""||null}return t="function"==typeof t?t:void 0===t?Nr:kr(t),e="function"==typeof e?e:void 0===e?$r:kr(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:kr(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:kr(+t),s):e},s.defined=function(t){return arguments.length?(n="function"==typeof t?t:kr(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}Er.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};class jr{constructor(t,e){console.log("in constructor with ",e),this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width,this.unitToBeta=_r().domain([0,1]).range([-3,3]),this.n=e,this.g=new ze([0],[[1]]),this.maps=[null,null],this.maps[0]=De.identity(this.ctx.xmin,this.ctx.xmax),this.maps[1]=new De(10,this.ctx.xmin,this.ctx.xmax),this.active_map=0,this.populate()}toggle_scramble(){console.log("in toggle_scramble"),this.active_map=1-this.active_map}scrambled(){return 1==this.active_map}map(){return this.maps[this.active_map]}reset(){this.active_map=0,this.maps[1]=new De(10,this.ctx.xmin,this.ctx.xmax),this.populate()}populate(){console.log("in populate");var t=this.n;this.x=new Array(t),this.y=new Array(t),this.beta=new Array(t);for(let e=0;e!=t;e++)this.x[e]=this.ctx.unitToX(Math.random()),this.beta[e]=this.unitToBeta(Math.random());for(let e=0;e!=t;e++)this.y[e]=this._point(this.x,this.beta,this.x[e]);for(let e=0;e!=t;e++)this.beta[e]=1}kernel(t,e){return this.g.at([t-e])}mx(t){return this.maps[this.active_map].get(t)}solve(){var t,e,n=this.n,r=bt.zeros(n,n),i=new bt([this.y]);for(let i=0;i!=n;i++){t=this.x[i];for(let o=0;o!=n;o++)e=this.x[o],r.set(i,o,this.kernel(t,e))}var o=_t(r),s=i.mmul(o);for(let t=0;t!=n;t++)this.beta[t]=s.get(0,t)}updateContext(t){console.log("in updateContext"),this.ctx=t,this.height=this.ctx.height,this.width=this.ctx.width}addPoint(){this.n++,this.populate()}delPoint(){0!=this.n&&(this.n--,this.populate())}updateBeta(t,e){this.beta[e]+=t}makeLine(t,e){return Rr().x((t=>this.ctx.u(t[0]))).y((t=>this.ctx.v(t[1])))(Ye(t,e))}_curve(t,e,n){var r=n,i=this.map(),o=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}(i.x[r],i.x[r+1],.05);return[o.map((t=>i.get(t))),o.map((n=>Ye(t,e).map((([t,e])=>e*this.kernel(t,n))).reduce(((t,e)=>t+e),0)))]}_curveSegment(t,e,n){var r,i;return[r,i]=this._curve(t,e,n),this.makeLine(r,i)}_curveFull(t,e){var n="";for(let r=0;r!=this.map().ns;r++)n+=this._curveSegment(t,e,r);return n}curve(t,e){return this._curveFull([t],[e])}solutionCurve(){return this._curveFull(this.x,this.beta)}_point(t,e,n){return Ye(t,e).map((([t,e])=>e*this.kernel(t,n))).reduce(((t,e)=>t+e),0)}point(t,e,n){const r=this._point([t],[e],n);return this.ctx.v(r)}solutionPoint(t){const e=this._point(this.x,this.beta,t);return this.ctx.v(e)}u(t){return this.ctx.u(this.maps[this.active_map].get(t))}v(t){return this.ctx.v(t)}}class Ar{constructor(t,e,[n,r],[i,o]){this.width=t,this.height=e,this.xmin=n,this.xmax=r,this.ymin=i,this.ymax=o,this.xToViewport=_r().domain([n,r]).range([0,t]),this.yToViewport=_r().domain([i,o]).range([e,0]),this.unitToX=_r().domain([0,1]).range([n,r]),this.unitToY=_r().domain([0,1]).range([i,o]),this.xToUnit=_r().domain([n,r]).range([0,1])}setWidth(t){this.width=t,this.xToViewport.range([0,t])}x(t){return this.xToViewport.invert(t)}y(t){return this.yToViewport.invert(t)}u(t){return this.xToViewport(t)}v(t){return this.yToViewport(t)}xDomain(){return this.xToViewport.domain()}yDomain(){return this.yToViewport.domain()}}function Cr(t,e,n){const r=t.slice();return r[19]=e[n],r[20]=e,r[21]=n,r}function Tr(t,e,n){const r=t.slice();return r[22]=e[n][0],r[23]=e[n][1],r}function qr(t,e,n){const r=t.slice();return r[26]=e[n],r}function Vr(t,e,n){const r=t.slice();return r[22]=e[n][0],r[29]=e[n][1],r}function Ir(e){let n;return{c(){n=l("div"),v(n,"class","gauss-grid svelte-1dypxuo")},m(t,e){a(t,n,e)},p:t,d(t){t&&u(n)}}}function Or(t){let e,n,i,o,p,x,y,M,_,k,E,S,N,$,R,j,A,C,T,q,V,I,O,P,z,L,D,H,U,F,X,B,W,G,K,Q,Y,Z,J,tt,et,nt,rt,it=t[5].scrambled()?"Unscramble":"Scramble",ot=t[3]&&Pr(t),st=Ye(t[5].x,t[5].beta),at=[];for(let e=0;e<st.length;e+=1)at[e]=Ur(Tr(t,st,e));let ut=t[2]&&Fr(t),ht=t[5].beta,lt=[];for(let e=0;e<ht.length;e+=1)lt[e]=Xr(Cr(t,ht,e));return{c(){e=l("div"),n=l("div"),i=c("svg"),ot&&ot.c(),o=m();for(let t=0;t<at.length;t+=1)at[t].c();p=m(),ut&&ut.c(),_=d(),k=l("div"),E=l("div"),S=l("button"),S.textContent="Reset",N=d(),$=l("div"),R=l("button"),R.textContent="Del Point",j=d(),A=l("div"),C=l("button"),C.textContent="Add Point",T=d(),q=l("div"),V=l("button"),I=f(it),O=d(),P=l("div"),z=l("button"),z.textContent="Solve",L=d(),D=l("div"),H=l("label"),U=l("input"),F=f("Toggle points"),X=d(),B=l("div"),W=l("label"),G=l("input"),K=f("Toggle basis curves"),Q=d(),Y=l("div"),Z=l("label"),J=l("input"),tt=f("Toggle solution curve"),et=d();for(let t=0;t<lt.length;t+=1)lt[t].c();v(i,"width",x=t[5].width),v(i,"height",y=t[5].height),v(i,"viewBox",M="0 0\n                             "+t[5].width+" "+t[5].height),v(i,"class","plot"),v(n,"class","grid-item svelte-1dypxuo"),b(n,"border","1px"),v(E,"class","control svelte-1dypxuo"),v($,"class","control svelte-1dypxuo"),v(A,"class","control svelte-1dypxuo"),v(q,"class","control svelte-1dypxuo"),v(P,"class","control svelte-1dypxuo"),v(U,"type","checkbox"),v(D,"class","control svelte-1dypxuo"),v(G,"type","checkbox"),v(B,"class","control svelte-1dypxuo"),v(J,"type","checkbox"),v(Y,"class","control svelte-1dypxuo"),v(k,"class","grid-item svelte-1dypxuo"),v(e,"class","gauss-grid svelte-1dypxuo")},m(r,u){a(r,e,u),s(e,n),s(n,i),ot&&ot.m(i,null),s(i,o);for(let t=0;t<at.length;t+=1)at[t].m(i,null);s(i,p),ut&&ut.m(i,null),s(e,_),s(e,k),s(k,E),s(E,S),s(k,N),s(k,$),s($,R),s(k,j),s(k,A),s(A,C),s(k,T),s(k,q),s(q,V),s(V,I),s(k,O),s(k,P),s(P,z),s(k,L),s(k,D),s(D,H),s(H,U),U.checked=t[1],s(H,F),s(k,X),s(k,B),s(B,W),s(W,G),G.checked=t[0],s(W,K),s(k,Q),s(k,Y),s(Y,Z),s(Z,J),J.checked=t[2],s(Z,tt),s(k,et);for(let t=0;t<lt.length;t+=1)lt[t].m(k,null);nt||(rt=[g(S,"click",t[6]),g(R,"click",t[7]),g(C,"click",t[8]),g(V,"click",t[9]),g(z,"click",t[10]),g(U,"change",t[11]),g(G,"change",t[12]),g(J,"change",t[13])],nt=!0)},p(t,e){if(t[3]?ot?ot.p(t,e):(ot=Pr(t),ot.c(),ot.m(i,o)):ot&&(ot.d(1),ot=null),35&e[0]){let n;for(st=Ye(t[5].x,t[5].beta),n=0;n<st.length;n+=1){const r=Tr(t,st,n);at[n]?at[n].p(r,e):(at[n]=Ur(r),at[n].c(),at[n].m(i,p))}for(;n<at.length;n+=1)at[n].d(1);at.length=st.length}if(t[2]?ut?ut.p(t,e):(ut=Fr(t),ut.c(),ut.m(i,null)):ut&&(ut.d(1),ut=null),32&e[0]&&x!==(x=t[5].width)&&v(i,"width",x),32&e[0]&&y!==(y=t[5].height)&&v(i,"height",y),32&e[0]&&M!==(M="0 0\n                             "+t[5].width+" "+t[5].height)&&v(i,"viewBox",M),32&e[0]&&it!==(it=t[5].scrambled()?"Unscramble":"Scramble")&&w(I,it),2&e[0]&&(U.checked=t[1]),1&e[0]&&(G.checked=t[0]),4&e[0]&&(J.checked=t[2]),32&e[0]){let n;for(ht=t[5].beta,n=0;n<ht.length;n+=1){const r=Cr(t,ht,n);lt[n]?lt[n].p(r,e):(lt[n]=Xr(r),lt[n].c(),lt[n].m(k,null))}for(;n<lt.length;n+=1)lt[n].d(1);lt.length=ht.length}},d(t){t&&u(e),ot&&ot.d(),h(at,t),ut&&ut.d(),h(lt,t),nt=!1,r(rt)}}}function Pr(t){let e,n=Ye(t[5].x,t[5].y),r=[];for(let e=0;e<n.length;e+=1)r[e]=zr(Vr(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);a(t,e,n)},p(t,i){if(32&i[0]){let o;for(n=Ye(t[5].x,t[5].y),o=0;o<n.length;o+=1){const s=Vr(t,n,o);r[o]?r[o].p(s,i):(r[o]=zr(s),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){h(r,t),t&&u(e)}}}function zr(t){let e,n,r;return{c(){e=c("circle"),v(e,"class","data svelte-1dypxuo"),b(e,"stroke","#000000"),v(e,"cx",n=t[5].u(t[22])),v(e,"cy",r=t[5].v(t[29])),v(e,"r","5")},m(t,n){a(t,e,n)},p(t,i){32&i[0]&&n!==(n=t[5].u(t[22]))&&v(e,"cx",n),32&i[0]&&r!==(r=t[5].v(t[29]))&&v(e,"cy",r)},d(t){t&&u(e)}}}function Lr(t){let e,n;return{c(){e=c("path"),v(e,"class","curve svelte-1dypxuo"),v(e,"d",n=t[5].curve(t[22],t[23]))},m(t,n){a(t,e,n)},p(t,r){32&r[0]&&n!==(n=t[5].curve(t[22],t[23]))&&v(e,"d",n)},d(t){t&&u(e)}}}function Dr(t){let e,n=t[5].x,r=[];for(let e=0;e<n.length;e+=1)r[e]=Hr(qr(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);a(t,e,n)},p(t,i){if(32&i[0]){let o;for(n=t[5].x,o=0;o<n.length;o+=1){const s=qr(t,n,o);r[o]?r[o].p(s,i):(r[o]=Hr(s),r[o].c(),r[o].m(e.parentNode,e))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){h(r,t),t&&u(e)}}}function Hr(t){let e,n,r;return{c(){e=c("circle"),v(e,"class","point svelte-1dypxuo"),v(e,"cx",n=t[5].u(t[26])),v(e,"cy",r=t[5].point(t[22],t[23],t[26])),v(e,"r","4")},m(t,n){a(t,e,n)},p(t,i){32&i[0]&&n!==(n=t[5].u(t[26]))&&v(e,"cx",n),32&i[0]&&r!==(r=t[5].point(t[22],t[23],t[26]))&&v(e,"cy",r)},d(t){t&&u(e)}}}function Ur(t){let e,n,r=t[0]&&Lr(t),i=t[1]&&Dr(t);return{c(){r&&r.c(),e=m(),i&&i.c(),n=m()},m(t,o){r&&r.m(t,o),a(t,e,o),i&&i.m(t,o),a(t,n,o)},p(t,o){t[0]?r?r.p(t,o):(r=Lr(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),t[1]?i?i.p(t,o):(i=Dr(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(t){r&&r.d(t),t&&u(e),i&&i.d(t),t&&u(n)}}}function Fr(t){let e,n;return{c(){e=c("path"),v(e,"class","solution-curve svelte-1dypxuo"),v(e,"d",n=t[5].solutionCurve())},m(t,n){a(t,e,n)},p(t,r){32&r[0]&&n!==(n=t[5].solutionCurve())&&v(e,"d",n)},d(t){t&&u(e)}}}function Xr(t){let e,n,i,o,h,c,m,p,b=t[19].toFixed(2)+"";function y(){t[14].call(i,t[20],t[21])}return{c(){e=l("div"),n=l("label"),i=l("input"),o=d(),h=f(b),c=d(),v(i,"type","range"),v(i,"min","-10"),v(i,"max","10"),v(i,"step","0.01"),v(e,"class","control svelte-1dypxuo")},m(r,u){a(r,e,u),s(e,n),s(n,i),x(i,t[19]),s(n,o),s(n,h),s(e,c),m||(p=[g(i,"change",y),g(i,"input",y)],m=!0)},p(e,n){t=e,32&n[0]&&x(i,t[19]),32&n[0]&&b!==(b=t[19].toFixed(2)+"")&&w(h,b)},d(t){t&&u(e),m=!1,r(p)}}}function Br(e){let n;function r(t,e){return t[4]?Or:Ir}let i=r(e),o=i(e);return{c(){o.c(),n=m()},m(t,e){o.m(t,e),a(t,n,e)},p(t,e){i===(i=r(t))&&o?o.p(t,e):(o.d(1),o=i(t),o&&(o.c(),o.m(n.parentNode,n)))},i:t,o:t,d(t){o.d(t),t&&u(n)}}}function Wr(t,e,n){let{show_data:r=!0}=e,{show_scaled:i=!0}=e,{show_solution:o=!0}=e,{show_points:s=!1}=e,{context_width:a}=e,u=new Ar(a,700,[0,10],[-2,2]),h=new jr(u,3);return t.$$set=t=>{"show_data"in t&&n(3,r=t.show_data),"show_scaled"in t&&n(0,i=t.show_scaled),"show_solution"in t&&n(2,o=t.show_solution),"show_points"in t&&n(1,s=t.show_points),"context_width"in t&&n(4,a=t.context_width)},t.$$.update=()=>{var e;16&t.$$.dirty[0]&&console.log(`context_width = ${a}`),1&t.$$.dirty[0]&&console.log(`show_scaled = ${i}`),2&t.$$.dirty[0]&&console.log(`show_points = ${s}`),16&t.$$.dirty[0]&&(e=a,console.log("in resize"),u.setWidth(e),h.updateContext(u))},[i,s,o,r,a,h,()=>{h.reset(),n(5,h)},()=>{h.delPoint(),n(5,h)},()=>{h.addPoint(),n(5,h)},()=>{h.toggle_scramble(),n(5,h)},()=>{h.solve(),n(5,h)},function(){s=this.checked,n(1,s)},function(){i=this.checked,n(0,i)},function(){o=this.checked,n(2,o)},function(t,e){var r;t[e]=""===(r=this.value)?null:+r,n(5,h)}]}class Gr extends H{constructor(t){super(),D(this,t,Wr,Br,o,{show_data:3,show_scaled:0,show_solution:2,show_points:1,context_width:4},[-1,-1])}}function Kr(t){let e,n,r,i,o,h,c,f,m,w,x,y,M,k,E,S,N,$,R,j,C,T,q,V,L,D,H,U,F,X,B,W,G,K,Q,Y,Z,J,tt,et,nt,rt,it,ot,st,at,ut,ht,lt,ct,ft,dt,mt,gt,vt,pt,wt,xt,bt;return E=new Gr({props:{context_width:t[0]}}),{c(){var s;e=l("main"),n=l("d-front-matter"),n.innerHTML='<script type="text/json">{\n        "title": "Introduction to Kernel Regression",\n      "description": "A gentle introduction to Kernel Regression",\n      "authors": [\n      {\n          "author": "Henry Bigelow"\n      }\n      ]\n      }<\/script>',r=d(),i=l("d-title"),i.innerHTML="<h1>Introduction to Kernel Regression</h1>",o=d(),h=l("d-byline"),c=d(),f=l("d-article"),m=l("h3"),m.textContent="A problem for Kernel Regression to solve",w=d(),x=l("p"),x.innerHTML="Consider the following:  you are given a dataset <d-math>\\textbf{D} =\n            \\{(x_i, y_i)\\}_{i \\in (1, \\cdots, n)}</d-math>, with\n        <d-math>\\mathcal{X} \\times \\mathcal{Y} \\in \\mathbb{R} \\times\n            \\mathbb{R}</d-math>.  There is nothing known about the true\n        relationship between <d-math>X</d-math> and <d-math>Y</d-math> except that\n        it is deterministic, continuous, and with some bounded first derivative.\n        In other words, &quot;smooth&quot;.  So you would like to find a smooth function to\n        fit the data.",y=d(),M=l("figure"),k=l("d-figure"),(s=E.$$.fragment)&&s.c(),N=d(),$=l("p"),$.innerHTML="With this smoothness goal in mind, you have decided to create a function\n        which is a linear combination of <d-math>n</d-math> gaussians, each one\n        centered at one of the <d-math>x_i</d-math>.  Since the gaussians themselves\n        are smooth, the resulting linear combination will also be smooth.  The goal\n        will be to adjust the weight of each gaussian and hopfully fit the\n        <d-math>y_i</d-math> at each point <d-math>x_i</d-math>.",R=d(),j=l("p"),j.innerHTML="Here are the functions we have chosen to use, now shown with the data.\n        Notice that there is one function per data point, centered at the\n        <d-math>x_i</d-math> coordinate.  The goal will be to find some weight vector\n        <d-math>\\beta</d-math> that combines these together to form a curve that goes through all of\n        the <d-math>y_i</d-math> values.",C=d(),T=l("p"),T.innerHTML="How do we find <d-math>\\beta</d-math>?  At first it seems like a hard problem.  We could\n        easily weight the <d-math>i^{th}</d-math> function so that its peak equals\n        <d-math>y_i</d-math>.  But, the resulting function would miss the\n        <d-math>y_i</d-math> due to the additional contribution of the other functions\n        at that point, since these functions are non-zero everywhere.  Every time you\n        adjust one of the <d-math>\\beta_i</d-math>, the values of the solution function changes\n        everywhere, so it isn&#39;t obvious how to find a solution, or if one exists at\n        all.",q=d(),V=l("h3"),V.textContent="The approach",L=d(),D=l("p"),D.innerHTML="For the moment, we are only concerned with the values of the solution\n        function at positions <d-math>x_i</d-math>.  Each value of the solution\n        function at <d-math>x_i</d-math> will be the same linear combination of the\n        curve heights at <d-math>x_i</d-math>, so we have highlighted them here.",H=d(),U=l("p"),U.innerHTML="Recall from linear algebra, that if you have a set of <d-math>n</d-math>\n        linearly independent vectors in <d-math>\\mathbb{R}^n</d-math>, those vectors\n        are said to <i>span</i>  <d-math>\\mathbb{R}^n</d-math>. This means every other\n        vector in <d-math>\\mathbb{R}^n</d-math> may be formed as a unique linear\n        combination of these spanning vectors.",F=d(),X=l("p"),X.innerHTML="Looking at the graph again, you can now see that each curve, evaluated at\n        the <d-math>x_i</d-math> in order, provides one of these spanning vectors (this\n        isn&#39;t proven but let&#39;s for the moment accept it).  And, the set of\n        <d-math>y_i</d-math> values is just our target vector.  So, all we need is to\n        express it as the unique linear combination <d-math>\\beta</d-math> which must\n        exist.",B=d(),W=l("p"),W.textContent="To make this explicit, let:",G=d(),K=l("d-math"),K.textContent="\\begin{aligned}\n            k_i(x) & \\equiv \\text{curves centered at $x_i$} \\\\\n            f(x) & \\equiv \\beta_1 k_1(x) + \\cdots + \\beta_n k_n(x) & \\text{the solution function} \\\\[1em]\n            D_x & \\equiv (x_1, \\cdots, x_n) & \\text{vector of $x_i$ values in the dataset} \\\\\n            (k_i)_{D_x} & \\equiv (k_i(x_1), \\cdots, k_i(x_n)) & \\text{values of $k_i$ along $D_x$ (the spanning vectors)} \\\\\n            (f)_{D_x} & \\equiv (f(x_1), \\cdots, f(x_n)) & \\text{values of $f$ along $D_x$ (the target vector)} \\\\\n            \\end{aligned}",Q=d(),Y=l("p"),Y.innerHTML="Now, shown above are the same curves, each scaled by a candidate\n        <d-math>\\beta</d-math>.  The goal is for the sum of these scaled curves to form\n        a function that goes through the <d-math>y_i</d-math>.  Using the linear\n        algebra fact that an expansion exists, we can assert that there exists such a\n        <d-math>\\beta</d-math>, formally:",Z=d(),J=l("d-math"),J.textContent="\\begin{aligned}\n            (f)_{D_x} = \\beta_1 (k_1)_{D_x} + \\cdots + \\beta_n (k_n)_{D_x} = Y & \\\\\n            \\end{aligned}",tt=d(),et=l("p"),et.textContent="Or, in matrix notation, let:",nt=d(),rt=l("d-math"),rt.textContent="\\begin{aligned}\n            K & \\equiv\n            \\begin{bmatrix}\n            - (k_1)_{D_x} - \\\\\n            - (k_2)_{D_x} - \\\\\n            \\cdots \\\\\n            - (k_n)_{D_x} -\n            \\end{bmatrix} \\\\[1em]\n            \\beta & \\equiv [\\beta_1, \\cdots, \\beta_n] & \\text{row vector} \\\\[1em]\n            \\end{aligned}",it=d(),ot=l("p"),ot.innerHTML="So, the unique function that goes through all values <d-math>y_i</d-math> uses <d-math>\\beta</d-math> that\n        satisfies <d-math>\\beta K = Y</d-math>.",st=d(),at=l("h3"),at.textContent="Where is the Kernel?",ut=d(),ht=l("p"),ht.innerHTML="Notice that the family of functions <d-math>k_i(x)</d-math> are all related by a\n        two-argument gaussian formula (if we consider <d-math>\\sigma</d-math> to be constant) with\n        signature <d-math>\\mathcal{X} \\times \\mathcal{X} \\rightarrow \\mathbb{R}</d-math>.  One\n        argument is the mean parameter, and the other the position.   We could call\n        that function <d-math>k</d-math> (with no subscript):",lt=d(),ct=l("d-math"),ct.textContent="\\begin{aligned}\n            k(x, x') & \\equiv \\tfrac{1}{\\sigma \\sqrt{2 \\pi}} e^{-\\tfrac{(x - x')^2}{2 \\sigma^2}} & : \\mathcal{X} \\times \\mathcal{X} \\rightarrow \\mathbb{R} \\\\\n            \\end{aligned}",ft=d(),dt=l("p"),dt.innerHTML="More generally, we designed our solution function at the very beginning to\n        be a linear combination of functions which were 1) parameterized by a point in\n        <d-math>\\mathcal{X}</d-math> and 2) defined over domain\n        <d-math>\\mathcal{X}</d-math>.  Implicitly, the two-argument function that was\n        needed to define these functions was already there.",mt=d(),gt=l("p"),gt.innerHTML="This function <d-math>k(x, x&#39;)</d-math> is known as a &quot;kernel&quot;.  We can now express the\n        matrix, and our solution function in terms of the kernel:",vt=d(),pt=l("d-math"),pt.textContent="\\begin{aligned}\n            K & \\equiv\n            \\begin{bmatrix}\n            k(x_1, x_1), \\cdots, k(x_1, x_n) \\\\\n            k(x_2, x_1), \\cdots, k(x_2, x_n) \\\\\n            \\cdots \\\\\n            k(x_n, x_1), \\cdots, k(x_n, x_n) \n            \\end{bmatrix} \\\\[1em]\n            f(x) & \\equiv \\sum_i { \\beta_i k(x_i, x) }\\\\\n            \\end{aligned}",wt=d(),xt=l("d-appendix"),b(i,"padding-bottom","0"),v(M,"class","l-middle-outset"),b(M,"width","100%"),A((()=>t[1].call(M))),p(K,"block",""),p(J,"block",""),p(rt,"block",""),p(ct,"block",""),p(pt,"block","")},m(d,v){a(d,e,v),s(e,n),s(e,r),s(e,i),s(e,o),s(e,h),s(e,c),s(e,f),s(f,m),s(f,w),s(f,x),s(f,y),s(f,M),s(M,k),P(E,k,null),S=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=l("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=_();let i;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=g(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{i=g(n.contentWindow,"resize",e)}),s(t,n),()=>{(r||i&&n.contentWindow)&&i(),u(n)}}(M,t[1].bind(M)),s(f,N),s(f,$),s(f,R),s(f,j),s(f,C),s(f,T),s(f,q),s(f,V),s(f,L),s(f,D),s(f,H),s(f,U),s(f,F),s(f,X),s(f,B),s(f,W),s(f,G),s(f,K),s(f,Q),s(f,Y),s(f,Z),s(f,J),s(f,tt),s(f,et),s(f,nt),s(f,rt),s(f,it),s(f,ot),s(f,st),s(f,at),s(f,ut),s(f,ht),s(f,lt),s(f,ct),s(f,ft),s(f,dt),s(f,mt),s(f,gt),s(f,vt),s(f,pt),s(e,wt),s(e,xt),bt=!0},p(t,[e]){const n={};1&e&&(n.context_width=t[0]),E.$set(n)},i(t){bt||(O(E.$$.fragment,t),bt=!0)},o(t){!function(t,e,n,r){if(t&&t.o){if(I.has(t))return;I.add(t),(void 0).c.push((()=>{I.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}(E.$$.fragment,t),bt=!1},d(t){t&&u(e),z(E),S()}}}function Qr(t,e,n){let r;return[r,function(){r=this.clientWidth,n(0,r)}]}return new class extends H{constructor(t){super(),D(this,t,Qr,Kr,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
