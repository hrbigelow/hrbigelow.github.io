var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function u(t){t.parentNode.removeChild(t)}function h(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function l(t){return document.createElement(t)}function c(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function f(t){return document.createTextNode(t)}function m(){return f(" ")}function d(){return f("")}function g(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function w(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function v(t,e,r){e in t?t[e]="boolean"==typeof t[e]&&""===r||r:w(t,e,r)}function p(t,e,r,n){t.style.setProperty(e,r,n?"important":"")}let x,y;function b(){if(void 0===x){x=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){x=!0}}return x}function M(t){y=t}const _=[],k=[],$=[],E=[],j=Promise.resolve();let S=!1;function N(t){$.push(t)}let R=!1;const A=new Set;function q(){if(!R){R=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];M(e),C(e.$$)}for(M(null),_.length=0;k.length;)k.pop()();for(let t=0;t<$.length;t+=1){const e=$[t];A.has(e)||(A.add(e),e())}$.length=0}while(_.length);for(;E.length;)E.pop()();S=!1,R=!1,A.clear()}}function C(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(N)}}const T=new Set;function V(t,e){t&&t.i&&(T.delete(t),t.i(e))}function I(t,e,r,n){if(t&&t.o){if(T.has(t))return;T.add(t),undefined.c.push((()=>{T.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}function O(t){t&&t.c()}function P(t,r,i,s){const{fragment:a,on_mount:u,on_destroy:h,after_update:l}=t.$$;a&&a.m(r,i),s||N((()=>{const r=u.map(e).filter(o);h?h.push(...r):n(r),t.$$.on_mount=[]})),l.forEach(N)}function L(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function z(t,e){-1===t.$$.dirty[0]&&(_.push(t),S||(S=!0,j.then(q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,o,i,s,a,h,l=[-1]){const c=y;M(e);const f=e.$$={fragment:null,ctx:null,props:h,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:o.context||[]),callbacks:r(),dirty:l,skip_bound:!1};let m=!1;if(f.ctx=i?i(e,o.props||{},((t,r,...n)=>{const o=n.length?n[0]:r;return f.ctx&&a(f.ctx[t],f.ctx[t]=o)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](o),m&&z(e,t)),r})):[],f.update(),m=!0,n(f.before_update),f.fragment=!!s&&s(f.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);f.fragment&&f.fragment.l(t),t.forEach(u)}else f.fragment&&f.fragment.c();o.intro&&V(e.$$.fragment),P(e,o.target,o.anchor,o.customElement),q()}M(c)}class H{$destroy(){L(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const U=Object.prototype.toString;function B(t){return U.call(t).endsWith("Array]")}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!B(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]>s&&(s=t[a]);return s}function X(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!B(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,o=e.toIndex,i=void 0===o?t.length:o;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(i<=n||i>t.length||!Number.isInteger(i))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<i;a++)t[a]<s&&(s=t[a]);return s}function W(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!B(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!B(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var n=X(t),o=F(t);if(n===o)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var i=r.min,s=void 0===i?r.autoMinMax?n:0:i,a=r.max,u=void 0===a?r.autoMinMax?o:1:a;if(s>=u)throw new RangeError("min option must be smaller than max option");for(var h=(u-s)/(o-n),l=0;l<t.length;l++)e[l]=(t[l]-n)*h+s;return e}class G{constructor(t){var e,r,n,o,i,s,a,u,h,l=(t=bt.checkMatrix(t)).clone(),c=l.rows,f=l.columns,m=new Array(c),d=1;for(e=0;e<c;e++)m[e]=e;for(u=new Array(c),r=0;r<f;r++){for(e=0;e<c;e++)u[e]=l.get(e,r);for(e=0;e<c;e++){for(h=Math.min(e,r),i=0,n=0;n<h;n++)i+=l.get(e,n)*u[n];u[e]-=i,l.set(e,r,u[e])}for(o=r,e=r+1;e<c;e++)Math.abs(u[e])>Math.abs(u[o])&&(o=e);if(o!==r){for(n=0;n<f;n++)s=l.get(o,n),l.set(o,n,l.get(r,n)),l.set(r,n,s);a=m[o],m[o]=m[r],m[r]=a,d=-d}if(r<c&&0!==l.get(r,r))for(e=r+1;e<c;e++)l.set(e,r,l.get(e,r)/l.get(r,r))}this.LU=l,this.pivotVector=m,this.pivotSign=d}isSingular(){for(var t=this.LU,e=t.columns,r=0;r<e;r++)if(0===t[r][r])return!0;return!1}solve(t){t=yt.checkMatrix(t);var e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var r,n,o,i=t.columns,s=t.subMatrixRow(this.pivotVector,0,i-1),a=e.columns;for(o=0;o<a;o++)for(r=o+1;r<a;r++)for(n=0;n<i;n++)s[r][n]-=s[o][n]*e[r][o];for(o=a-1;o>=0;o--){for(n=0;n<i;n++)s[o][n]/=e[o][o];for(r=0;r<o;r++)for(n=0;n<i;n++)s[r][n]-=s[o][n]*e[r][o]}return s}get determinant(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var e=this.pivotSign,r=t.columns,n=0;n<r;n++)e*=t[n][n];return e}get lowerTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new yt(e,r),o=0;o<e;o++)for(var i=0;i<r;i++)n[o][i]=o>i?t[o][i]:o===i?1:0;return n}get upperTriangularMatrix(){for(var t=this.LU,e=t.rows,r=t.columns,n=new yt(e,r),o=0;o<e;o++)for(var i=0;i<r;i++)n[o][i]=o<=i?t[o][i]:0;return n}get pivotPermutationVector(){return this.pivotVector.slice()}}function K(t,e){var r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}function Q(t,e,r){for(var n=new Array(t),o=0;o<t;o++){n[o]=new Array(e);for(var i=0;i<e;i++)n[o][i]=r}return n}class Y{constructor(t,e={}){var r=(t=bt.checkMatrix(t)).rows,n=t.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:s=!1}=e;var a,u=Boolean(o),h=Boolean(i),l=!1;if(r<n)if(s){r=(a=t.transpose()).rows,n=a.columns,l=!0;var c=u;u=h,h=c}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();var f=Math.min(r,n),m=Math.min(r+1,n),d=new Array(m),g=Q(r,f,0),w=Q(n,n,0),v=new Array(n),p=new Array(r),x=new Array(m);for(let t=0;t<m;t++)x[t]=t;var y=Math.min(r-1,n),b=Math.max(0,Math.min(n-2,r)),M=Math.max(y,b);for(let t=0;t<M;t++){if(t<y){d[t]=0;for(let e=t;e<r;e++)d[t]=K(d[t],a[e][t]);if(0!==d[t]){a[t][t]<0&&(d[t]=-d[t]);for(let e=t;e<r;e++)a[e][t]/=d[t];a[t][t]+=1}d[t]=-d[t]}for(let e=t+1;e<n;e++){if(t<y&&0!==d[t]){let n=0;for(let o=t;o<r;o++)n+=a[o][t]*a[o][e];n=-n/a[t][t];for(let o=t;o<r;o++)a[o][e]+=n*a[o][t]}v[e]=a[t][e]}if(u&&t<y)for(let e=t;e<r;e++)g[e][t]=a[e][t];if(t<b){v[t]=0;for(let e=t+1;e<n;e++)v[t]=K(v[t],v[e]);if(0!==v[t]){v[t+1]<0&&(v[t]=0-v[t]);for(let e=t+1;e<n;e++)v[e]/=v[t];v[t+1]+=1}if(v[t]=-v[t],t+1<r&&0!==v[t]){for(let e=t+1;e<r;e++)p[e]=0;for(let e=t+1;e<r;e++)for(let r=t+1;r<n;r++)p[e]+=v[r]*a[e][r];for(let e=t+1;e<n;e++){let n=-v[e]/v[t+1];for(let o=t+1;o<r;o++)a[o][e]+=n*p[o]}}if(h)for(let e=t+1;e<n;e++)w[e][t]=v[e]}}let _=Math.min(n,r+1);if(y<n&&(d[y]=a[y][y]),r<_&&(d[_-1]=0),b+1<_&&(v[b]=a[b][_-1]),v[_-1]=0,u){for(let t=y;t<f;t++){for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}for(let t=y-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<f;e++){let n=0;for(let o=t;o<r;o++)n+=g[o][t]*g[o][e];n=-n/g[t][t];for(let o=t;o<r;o++)g[o][e]+=n*g[o][t]}for(let e=t;e<r;e++)g[e][t]=-g[e][t];g[t][t]=1+g[t][t];for(let e=0;e<t-1;e++)g[e][t]=0}else{for(let e=0;e<r;e++)g[e][t]=0;g[t][t]=1}}if(h)for(let t=n-1;t>=0;t--){if(t<b&&0!==v[t])for(let e=t+1;e<n;e++){let r=0;for(let o=t+1;o<n;o++)r+=w[o][t]*w[o][e];r=-r/w[t+1][t];for(let o=t+1;o<n;o++)w[o][e]+=r*w[o][t]}for(let e=0;e<n;e++)w[e][t]=0;w[t][t]=1}for(var k=_-1,$=Number.EPSILON;_>0;){let t,e;for(t=_-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+$*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(v[t])<=e||Number.isNaN(v[t])){v[t]=0;break}}if(t===_-2)e=4;else{let r;for(r=_-1;r>=t&&r!==t;r--){let e=(r!==_?Math.abs(v[r]):0)+(r!==t+1?Math.abs(v[r-1]):0);if(Math.abs(d[r])<=$*e){d[r]=0;break}}r===t?e=3:r===_-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=v[_-2];v[_-2]=0;for(let r=_-2;r>=t;r--){let o=K(d[r],e),i=d[r]/o,s=e/o;if(d[r]=o,r!==t&&(e=-s*v[r-1],v[r-1]=i*v[r-1]),h)for(let t=0;t<n;t++)o=i*w[t][r]+s*w[t][_-1],w[t][_-1]=-s*w[t][r]+i*w[t][_-1],w[t][r]=o}break}case 2:{let e=v[t-1];v[t-1]=0;for(let n=t;n<_;n++){let o=K(d[n],e),i=d[n]/o,s=e/o;if(d[n]=o,e=-s*v[n],v[n]=i*v[n],u)for(let e=0;e<r;e++)o=i*g[e][n]+s*g[e][t-1],g[e][t-1]=-s*g[e][n]+i*g[e][t-1],g[e][n]=o}break}case 3:{const e=Math.max(Math.abs(d[_-1]),Math.abs(d[_-2]),Math.abs(v[_-2]),Math.abs(d[t]),Math.abs(v[t])),o=d[_-1]/e,i=d[_-2]/e,s=v[_-2]/e,a=d[t]/e,l=v[t]/e,c=((i+o)*(i-o)+s*s)/2,f=o*s*(o*s);let m=0;0===c&&0===f||(m=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),m=f/(c+m));let p=(a+o)*(a-o)+m,x=a*l;for(let e=t;e<_-1;e++){let o=K(p,x);0===o&&(o=Number.MIN_VALUE);let i=p/o,s=x/o;if(e!==t&&(v[e-1]=o),p=i*d[e]+s*v[e],v[e]=i*v[e]-s*d[e],x=s*d[e+1],d[e+1]=i*d[e+1],h)for(let t=0;t<n;t++)o=i*w[t][e]+s*w[t][e+1],w[t][e+1]=-s*w[t][e]+i*w[t][e+1],w[t][e]=o;if(o=K(p,x),0===o&&(o=Number.MIN_VALUE),i=p/o,s=x/o,d[e]=o,p=i*v[e]+s*d[e+1],d[e+1]=-s*v[e]+i*d[e+1],x=s*v[e+1],v[e+1]=i*v[e+1],u&&e<r-1)for(let t=0;t<r;t++)o=i*g[t][e]+s*g[t][e+1],g[t][e+1]=-s*g[t][e]+i*g[t][e+1],g[t][e]=o}v[_-2]=p;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,h))for(let e=0;e<=k;e++)w[e][t]=-w[e][t];for(;t<k&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,h&&t<n-1)for(let r=0;r<n;r++)e=w[r][t+1],w[r][t+1]=w[r][t],w[r][t]=e;if(u&&t<r-1)for(let n=0;n<r;n++)e=g[n][t+1],g[n][t+1]=g[n][t],g[n][t]=e;t++}_--}}if(l){var E=w;w=g,g=E}this.m=r,this.n=n,this.s=d,this.U=g,this.V=w}solve(t){var e=t,r=this.threshold,n=this.s.length,o=yt.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=r?o[t][t]=0:o[t][t]=1/this.s[t];var i=this.U,s=this.rightSingularVectors,a=s.mmul(o),u=s.rows,h=i.length,l=yt.zeros(u,h);for(let t=0;t<u;t++)for(let e=0;e<h;e++){let r=0;for(let o=0;o<n;o++)r+=a[t][o]*i[e][o];l[t][e]=r}return l.mmul(e)}solveForDiagonal(t){return this.solve(yt.diag(t))}inverse(){var t=this.V,e=this.threshold,r=t.length,n=t[0].length,o=new yt(r,this.s.length);for(let i=0;i<r;i++)for(let r=0;r<n;r++)Math.abs(this.s[r])>e?o[i][r]=t[i][r]/this.s[r]:o[i][r]=0;var i=this.U,s=i.length,a=i[0].length,u=new yt(r,s);for(let t=0;t<r;t++)for(let e=0;e<s;e++){let r=0;for(let n=0;n<a;n++)r+=o[t][n]*i[e][n];u[t][e]=r}return u}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s,n=0,o=r.length;n<o;n++)r[n]>t&&e++;return e}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return yt.isMatrix(this.U)||(this.U=new yt(this.U)),this.U}get rightSingularVectors(){return yt.isMatrix(this.V)||(this.V=new yt(this.V)),this.V}get diagonalMatrix(){return yt.diag(this.s)}}function Z(t,e,r){var n=r?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function J(t,e,r){var n=r?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function tt(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function et(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function rt(t,e,r){return{row:nt(t,e),column:ot(t,r)}}function nt(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for row indices");if(e.some((e=>e<0||e>=t.rows)))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function ot(t,e){if("object"!=typeof e)throw new TypeError("unexpected type for column indices");if(e.some((e=>e<0||e>=t.columns)))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function it(t,e,r,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(ut("startRow",e),ut("endRow",r),ut("startColumn",n),ut("endColumn",o),e>r||n>o||e<0||e>=t.rows||r<0||r>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function st(t){for(var e=yt.zeros(t.rows,1),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(r,0,e.get(r,0)+t.get(r,n));return e}function at(t){for(var e=yt.zeros(1,t.columns),r=0;r<t.rows;++r)for(var n=0;n<t.columns;++n)e.set(0,n,e.get(0,n)+t.get(r,n));return e}function ut(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}class ht extends(xt()){constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}static get[Symbol.species](){return yt}}class lt extends ht{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class ct extends ht{constructor(t,e){super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class ft extends ht{constructor(t,e,r,n,o){it(t,e,r,n,o),super(t,r-e+1,o-n+1),this.startRow=e,this.startColumn=n}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class mt extends ht{constructor(t,e,r){var n=rt(t,e,r);super(t,n.row.length,n.column.length),this.rowIndices=n.row,this.columnIndices=n.column}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class dt extends ht{constructor(t,e){super(t,(e=nt(t,e)).length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class gt extends ht{constructor(t,e){e=ot(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class wt extends ht{constructor(t,e){super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class vt extends ht{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class pt extends ht{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}function xt(t){void 0===t&&(t=Object);class e extends t{static get[Symbol.species](){return this}static from1DArray(t,e,r){if(t*e!==r.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,e),o=0;o<t;o++)for(var i=0;i<e;i++)n.set(o,i,r[o*e+i]);return n}static rowVector(t){for(var e=new this(1,t.length),r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){for(var e=new this(t.length,1),r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static empty(t,e){return new this(t,e)}static zeros(t,e){return this.empty(t,e).fill(0)}static ones(t,e){return this.empty(t,e).fill(1)}static rand(t,e,r){void 0===r&&(r=Math.random);for(var n=this.empty(t,e),o=0;o<t;o++)for(var i=0;i<e;i++)n.set(o,i,r());return n}static randInt(t,e,r,n){void 0===r&&(r=1e3),void 0===n&&(n=Math.random);for(var o=this.empty(t,e),i=0;i<t;i++)for(var s=0;s<e;s++){var a=Math.floor(n()*r);o.set(i,s,a)}return o}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);for(var n=Math.min(t,e),o=this.zeros(t,e),i=0;i<n;i++)o.set(i,i,r);return o}static diag(t,e,r){var n=t.length;void 0===e&&(e=n),void 0===r&&(r=e);for(var o=Math.min(n,e,r),i=this.zeros(e,r),s=0;s<o;s++)i.set(s,s,t[s]);return i}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,o=new this(r,n),i=0;i<r;i++)for(var s=0;s<n;s++)o.set(i,s,Math.min(t.get(i,s),e.get(i,s)));return o}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);for(var r=t.rows,n=t.columns,o=new this(r,n),i=0;i<r;i++)for(var s=0;s<n;s++)o.set(i,s,Math.max(t.get(i,s),e.get(i,s)));return o}static checkMatrix(t){return e.isMatrix(t)?t:new this(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=this.rows,r=this.columns,n=0;n<e;n++)for(var o=0;o<r;o++)t.call(this,n,o);return this}to1DArray(){for(var t=new Array(this.size),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t[e*this.columns+r]=this.get(e,r);return t}to2DArray(){for(var t=new Array(this.rows),e=0;e<this.rows;e++){t[e]=new Array(this.columns);for(var r=0;r<this.columns;r++)t[e][r]=this.get(e,r)}return t}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,r=-1,n=!0,o=!1;for(;t<this.rows&&n;){for(e=0,o=!1;e<this.columns&&!1===o;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(o=!0,r=e):(n=!1,o=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(n=!1);t++}return n}set(t,e,r){throw new Error("set method is unimplemented")}get(t,e){throw new Error("get method is unimplemented")}repeat(t,e){t=t||1,e=e||1;for(var r=new this.constructor[Symbol.species](this.rows*t,this.columns*e),n=0;n<t;n++)for(var o=0;o<e;o++)r.setSubMatrix(this,this.rows*n,this.columns*o);return r}fill(t){for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){Z(this,t);for(var e=new Array(this.columns),r=0;r<this.columns;r++)e[r]=this.get(t,r);return e}getRowVector(t){return this.constructor.rowVector(this.getRow(t))}setRow(t,e){Z(this,t),e=tt(this,e);for(var r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){Z(this,t),Z(this,e);for(var r=0;r<this.columns;r++){var n=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,n)}return this}getColumn(t){J(this,t);for(var e=new Array(this.rows),r=0;r<this.rows;r++)e[r]=this.get(r,t);return e}getColumnVector(t){return this.constructor.columnVector(this.getColumn(t))}setColumn(t,e){J(this,t),e=et(this,e);for(var r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){J(this,t),J(this,e);for(var r=0;r<this.rows;r++){var n=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,n)}return this}addRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=tt(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=et(this,t);for(var e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){Z(this,t);for(var r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){J(this,t);for(var r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}maxIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)>t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}min(){for(var t=this.get(0,0),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}minIndex(){for(var t=this.get(0,0),e=[0,0],r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)this.get(r,n)<t&&(t=this.get(r,n),e[0]=r,e[1]=n);return e}maxRow(t){Z(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){Z(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),r[1]=n);return r}minRow(t){Z(this,t);for(var e=this.get(t,0),r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){Z(this,t);for(var e=this.get(t,0),r=[t,0],n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),r[1]=n);return r}maxColumn(t){J(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){J(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),r[0]=n);return r}minColumn(t){J(this,t);for(var e=this.get(0,t),r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){J(this,t);for(var e=this.get(0,t),r=[0,t],n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),r[0]=n);return r}diag(){for(var t=Math.min(this.rows,this.columns),e=new Array(t),r=0;r<t;r++)e[r]=this.get(r,r);return e}sum(t){switch(t){case"row":return st(this);case"column":return at(this);default:return function(t){for(var e=0,r=0;r<t.rows;r++)for(var n=0;n<t.columns;n++)e+=t.get(r,n);return e}(this)}}mean(){return this.sum()/this.size}prod(){for(var t=1,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t*=this.get(e,r);return t}norm(t="frobenius"){var e=0;if("max"===t)return this.max();if("frobenius"===t){for(var r=0;r<this.rows;r++)for(var n=0;n<this.columns;n++)e+=this.get(r,n)*this.get(r,n);return Math.sqrt(e)}throw new RangeError(`unknown norm type: ${t}`)}cumulativeSum(){for(var t=0,e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var n=0,o=0;o<r.length;o++)n+=r[o]*t[o];return n}mmul(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var e=this.rows,r=this.columns,n=t.columns,o=new this.constructor[Symbol.species](e,n),i=new Array(r),s=0;s<n;s++){for(var a=0;a<r;a++)i[a]=t.get(a,s);for(var u=0;u<e;u++){var h=0;for(a=0;a<r;a++)h+=this.get(u,a)*i[a];o.set(u,s,h)}}return o}strassen2x2(t){var e=new this.constructor[Symbol.species](2,2);const r=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),s=this.get(1,0),a=t.get(1,0),u=this.get(1,1),h=t.get(1,1),l=(r+u)*(n+h),c=(s+u)*n,f=r*(i-h),m=u*(a-n),d=(r+o)*h,g=l+m-d+(o-u)*(a+h),w=f+d,v=c+m,p=l-c+f+(s-r)*(n+i);return e.set(0,0,g),e.set(0,1,w),e.set(1,0,v),e.set(1,1,p),e}strassen3x3(t){var e=new this.constructor[Symbol.species](3,3);const r=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),s=this.get(1,1),a=this.get(1,2),u=this.get(2,0),h=this.get(2,1),l=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),d=t.get(1,0),g=t.get(1,1),w=t.get(1,2),v=t.get(2,0),p=t.get(2,1),x=t.get(2,2),y=(r-i)*(-f+g),b=(-r+i+s)*(c-f+g),M=(i+s)*(-c+f),_=r*c,k=(-r+u+h)*(c-m+w),$=(-r+u)*(m-w),E=(u+h)*(-c+m),j=(-o+h+l)*(g+v-p),S=(o-l)*(g-p),N=o*v,R=(h+l)*(-v+p),A=(-o+s+a)*(w+v-x),q=(o-a)*(w-x),C=(s+a)*(-v+x),T=_+N+n*d,V=(r+n+o-i-s-h-l)*g+b+M+_+j+N+R,I=_+k+E+(r+n+o-s-a-u-h)*w+N+A+C,O=y+s*(-c+f+d-g-w-v+x)+b+_+N+A+q,P=y+b+M+_+a*p,L=N+A+q+C+i*m,z=_+k+$+h*(-c+m+d-g-w-v+p)+j+S+N,D=j+S+N+R+u*f,H=_+k+$+E+l*x;return e.set(0,0,T),e.set(0,1,V),e.set(0,2,I),e.set(1,0,O),e.set(1,1,P),e.set(1,2,L),e.set(2,0,z),e.set(2,1,D),e.set(2,2,H),e}mmulStrassen(t){var r=this.clone(),n=r.rows,o=r.columns,i=t.rows,s=t.columns;function a(t,r,n){var o=t.rows,i=t.columns;if(o===r&&i===n)return t;var s=e.zeros(r,n);return s=s.setSubMatrix(t,0,0)}o!==i&&console.warn(`Multiplying ${n} x ${o} and ${i} x ${s} matrix: dimensions do not match.`);var u=Math.max(n,i),h=Math.max(o,s);return function t(r,n,o,i){if(o<=512||i<=512)return r.mmul(n);o%2==1&&i%2==1?(r=a(r,o+1,i+1),n=a(n,o+1,i+1)):o%2==1?(r=a(r,o+1,i),n=a(n,o+1,i)):i%2==1&&(r=a(r,o,i+1),n=a(n,o,i+1));var s=parseInt(r.rows/2,10),u=parseInt(r.columns/2,10),h=r.subMatrix(0,s-1,0,u-1),l=n.subMatrix(0,s-1,0,u-1),c=r.subMatrix(0,s-1,u,r.columns-1),f=n.subMatrix(0,s-1,u,n.columns-1),m=r.subMatrix(s,r.rows-1,0,u-1),d=n.subMatrix(s,n.rows-1,0,u-1),g=r.subMatrix(s,r.rows-1,u,r.columns-1),w=n.subMatrix(s,n.rows-1,u,n.columns-1),v=t(e.add(h,g),e.add(l,w),s,u),p=t(e.add(m,g),l,s,u),x=t(h,e.sub(f,w),s,u),y=t(g,e.sub(d,l),s,u),b=t(e.add(h,c),w,s,u),M=t(e.sub(m,h),e.add(l,f),s,u),_=t(e.sub(c,g),e.add(d,w),s,u),k=e.add(v,y);k.sub(b),k.add(_);var $=e.add(x,b),E=e.add(p,y),j=e.sub(v,p);j.add(x),j.add(M);var S=e.zeros(2*k.rows,2*k.columns);return(S=(S=(S=(S=S.setSubMatrix(k,0,0)).setSubMatrix($,k.rows,0)).setSubMatrix(E,0,k.columns)).setSubMatrix(j,k.rows,k.columns)).subMatrix(0,o-1,0,i-1)}(r=a(r,u,h),t=a(t,u,h),u,h)}scaleRows(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=W(this.getRow(n),{min:t,max:e});r.setRow(n,o)}return r}scaleColumns(t,e){if((t=void 0===t?0:t)>=(e=void 0===e?1:e))throw new RangeError("min should be strictly smaller than max");for(var r=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=W(this.getColumn(n),{min:t,max:e});r.setColumn(n,o)}return r}kroneckerProduct(t){t=this.constructor.checkMatrix(t);for(var e=this.rows,r=this.columns,n=t.rows,o=t.columns,i=new this.constructor[Symbol.species](e*n,r*o),s=0;s<e;s++)for(var a=0;a<r;a++)for(var u=0;u<n;u++)for(var h=0;h<o;h++)i[n*s+u][o*a+h]=this.get(s,a)*t.get(u,h);return i}transpose(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t){void 0===t&&(t=r);for(var e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t){void 0===t&&(t=r);for(var e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,n){it(this,t,e,r,n);for(var o=new this.constructor[Symbol.species](e-t+1,n-r+1),i=t;i<=e;i++)for(var s=r;s<=n;s++)o[i-t][s-r]=this.get(i,s);return o}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,r-e+1),o=0;o<t.length;o++)for(var i=e;i<=r;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError(`Row index out of range: ${t[o]}`);n.set(o,i-e,this.get(t[o],i))}return n}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](r-e+1,t.length),o=0;o<t.length;o++)for(var i=e;i<=r;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError(`Column index out of range: ${t[o]}`);n.set(i-e,o,this.get(i,t[o]))}return n}setSubMatrix(t,e,r){it(this,e,e+(t=this.constructor.checkMatrix(t)).rows-1,r,r+t.columns-1);for(var n=0;n<t.rows;n++)for(var o=0;o<t.columns;o++)this[e+n][r+o]=t.get(n,o);return this}selection(t,e){for(var r=rt(this,t,e),n=new this.constructor[Symbol.species](t.length,e.length),o=0;o<r.row.length;o++)for(var i=r.row[o],s=0;s<r.column.length;s++){var a=r.column[s];n[o][s]=this.get(i,a)}return n}trace(){for(var t=Math.min(this.rows,this.columns),e=0,r=0;r<t;r++)e+=this.get(r,r);return e}transposeView(){return new lt(this)}rowView(t){return Z(this,t),new ct(this,t)}columnView(t){return J(this,t),new wt(this,t)}flipRowView(){return new vt(this)}flipColumnView(){return new pt(this)}subMatrixView(t,e,r,n){return new ft(this,t,e,r,n)}selectionView(t,e){return new mt(this,t,e)}rowSelectionView(t){return new dt(this,t)}columnSelectionView(t){return new gt(this,t)}det(){var t,e,r,n,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),e=this.get(0,1),r=this.get(1,0),t*this.get(1,1)-e*r):3===this.columns?(n=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),e=this.get(0,1),r=this.get(0,2),t*n.det()-e*o.det()+r*i.det()):new G(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(t){void 0===t&&(t=Number.EPSILON);for(var e=new Y(this,{autoTranspose:!0}),r=e.leftSingularVectors,n=e.rightSingularVectors,o=e.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),n.mmul(o.mmul(r.transposeView()))}clone(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),e=0;e<this.rows;e++)for(var r=0;r<this.columns;r++)t.set(e,r,this.get(e,r));return t}}function r(t,e){return t-e}e.prototype.klass="Matrix",e.random=e.rand,e.diagonal=e.diag,e.prototype.diagonal=e.prototype.diag,e.identity=e.eye,e.prototype.negate=e.prototype.neg,e.prototype.tensorProduct=e.prototype.kroneckerProduct,e.prototype.determinant=e.prototype.det;var n,o="\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",i=eval;for(var s of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var a=i(k("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:s[1],op:s[0]})),u=i(k("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${s[1]}S`,op:s[0]})),h=i(k("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${s[1]}M`,op:s[0]})),l=i(k("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:s[1]}));for(n=1;n<s.length;n++)e.prototype[s[n]]=a,e.prototype[`${s[n]}S`]=u,e.prototype[`${s[n]}M`]=h,e[s[n]]=l}var c=[["~","not"]];for(var f of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){c.push([`Math.${t}`,t])})),c)){var m=i(k("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:f[1],method:f[0]})),d=i(k("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:f[1]}));for(n=1;n<f.length;n++)e.prototype[f[n]]=m,e[f[n]]=d}for(var g of[["Math.pow",1,"pow"]]){var w="arg0";for(n=1;n<g[1];n++)w+=`, arg${n}`;if(1!==g[1]){var v=i(k("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:g[2],method:g[0],args:w})),p=i(k(o,{name:g[2],args:w}));for(n=2;n<g.length;n++)e.prototype[g[n]]=v,e[g[n]]=p}else{var x={name:g[2],args:w,method:g[0]},y=i(k("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",x)),b=i(k("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",x)),M=i(k("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",x)),_=i(k("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",x));for(n=2;n<g.length;n++)e.prototype[g[n]]=y,e.prototype[`${g[n]}M`]=M,e.prototype[`${g[n]}S`]=b,e[g[n]]=_}}function k(t,e){for(var r in e)t=t.replace(new RegExp(`%${r}%`,"g"),e[r]);return t}return e}class yt extends(xt(Array)){constructor(t,e){var r;if(1===arguments.length&&"number"==typeof t)return new Array(t);if(yt.isMatrix(t))return t.clone();if(Number.isInteger(t)&&t>0){if(super(t),!(Number.isInteger(e)&&e>0))throw new TypeError("nColumns must be a positive integer");for(r=0;r<t;r++)this[r]=new Array(e)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if(t=n.length,"number"!=typeof(e=n[0].length)||0===e)throw new TypeError("Data must be a 2D array with at least one element");for(super(t),r=0;r<t;r++){if(n[r].length!==e)throw new RangeError("Inconsistent array dimensions");this[r]=[].concat(n[r])}}}return this.rows=t,this.columns=e,this}set(t,e,r){return this[t][e]=r,this}get(t,e){return this[t][e]}removeRow(t){if(Z(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),Z(this,t,!0),e=tt(this,e),this.splice(t,0,e),this.rows+=1,this}removeColumn(t){if(J(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var e=0;e<this.rows;e++)this[e].splice(t,1);return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),J(this,t,!0),e=et(this,e);for(var r=0;r<this.rows;r++)this[r].splice(t,0,e[r]);return this.columns+=1,this}}xt(),Symbol.species;class bt extends(xt()){constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}static get[Symbol.species](){return yt}}class Mt{constructor(t){var e,r,n,o,i=(t=bt.checkMatrix(t)).clone(),s=t.rows,a=t.columns,u=new Array(a);for(n=0;n<a;n++){var h=0;for(e=n;e<s;e++)h=K(h,i.get(e,n));if(0!==h){for(i.get(n,n)<0&&(h=-h),e=n;e<s;e++)i.set(e,n,i.get(e,n)/h);for(i.set(n,n,i.get(n,n)+1),r=n+1;r<a;r++){for(o=0,e=n;e<s;e++)o+=i.get(e,n)*i.get(e,r);for(o=-o/i.get(n,n),e=n;e<s;e++)i.set(e,r,i.get(e,r)+o*i.get(e,n))}}u[n]=-h}this.QR=i,this.Rdiag=u}solve(t){t=yt.checkMatrix(t);var e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,o,i,s,a=t.columns,u=t.clone(),h=e.columns;for(i=0;i<h;i++)for(o=0;o<a;o++){for(s=0,n=i;n<r;n++)s+=e[n][i]*u[n][o];for(s=-s/e[i][i],n=i;n<r;n++)u[n][o]+=s*e[n][i]}for(i=h-1;i>=0;i--){for(o=0;o<a;o++)u[i][o]/=this.Rdiag[i];for(n=0;n<i;n++)for(o=0;o<a;o++)u[n][o]-=u[i][o]*e[n][i]}return u.subMatrix(0,h-1,0,a-1)}isFullRank(){for(var t=this.QR.columns,e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){var t,e,r=this.QR,n=r.columns,o=new yt(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)o[t][e]=t<e?r[t][e]:t===e?this.Rdiag[t]:0;return o}get orthogonalMatrix(){var t,e,r,n,o=this.QR,i=o.rows,s=o.columns,a=new yt(i,s);for(r=s-1;r>=0;r--){for(t=0;t<i;t++)a[t][r]=0;for(a[r][r]=1,e=r;e<s;e++)if(0!==o[r][r]){for(n=0,t=r;t<i;t++)n+=o[t][r]*a[t][e];for(n=-n/o[r][r],t=r;t<i;t++)a[t][e]+=n*o[t][r]}}return a}}function _t(t,e=!1){return t=bt.checkMatrix(t),e?new Y(t).inverse():kt(t,yt.eye(t.rows))}function kt(t,e,r=!1){return t=bt.checkMatrix(t),e=bt.checkMatrix(e),r?new Y(t).solve(e):t.isSquare()?new G(t).solve(e):new Mt(t).solve(e)}class $t{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(!(t=bt.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");var n,o,i=t.columns,s=Q(i,i,0),a=new Array(i),u=new Array(i),h=t;if(!!r||t.isSymmetric()){for(n=0;n<i;n++)for(o=0;o<i;o++)s[n][o]=h.get(n,o);!function(t,e,r,n){var o,i,s,a,u,h,l,c;for(u=0;u<t;u++)r[u]=n[t-1][u];for(a=t-1;a>0;a--){for(c=0,s=0,h=0;h<a;h++)c+=Math.abs(r[h]);if(0===c)for(e[a]=r[a-1],u=0;u<a;u++)r[u]=n[a-1][u],n[a][u]=0,n[u][a]=0;else{for(h=0;h<a;h++)r[h]/=c,s+=r[h]*r[h];for(o=r[a-1],i=Math.sqrt(s),o>0&&(i=-i),e[a]=c*i,s-=o*i,r[a-1]=o-i,u=0;u<a;u++)e[u]=0;for(u=0;u<a;u++){for(o=r[u],n[u][a]=o,i=e[u]+n[u][u]*o,h=u+1;h<=a-1;h++)i+=n[h][u]*r[h],e[h]+=n[h][u]*o;e[u]=i}for(o=0,u=0;u<a;u++)e[u]/=s,o+=e[u]*r[u];for(l=o/(s+s),u=0;u<a;u++)e[u]-=l*r[u];for(u=0;u<a;u++){for(o=r[u],i=e[u],h=u;h<=a-1;h++)n[h][u]-=o*e[h]+i*r[h];r[u]=n[a-1][u],n[a][u]=0}}r[a]=s}for(a=0;a<t-1;a++){if(n[t-1][a]=n[a][a],n[a][a]=1,0!==(s=r[a+1])){for(h=0;h<=a;h++)r[h]=n[h][a+1]/s;for(u=0;u<=a;u++){for(i=0,h=0;h<=a;h++)i+=n[h][a+1]*n[h][u];for(h=0;h<=a;h++)n[h][u]-=i*r[h]}}for(h=0;h<=a;h++)n[h][a+1]=0}for(u=0;u<t;u++)r[u]=n[t-1][u],n[t-1][u]=0;n[t-1][t-1]=1,e[0]=0}(i,u,a,s),function(t,e,r,n){var o,i,s,a,u,h,l,c,f,m,d,g,w,v,p,x;for(s=1;s<t;s++)e[s-1]=e[s];e[t-1]=0;var y=0,b=0,M=Number.EPSILON;for(h=0;h<t;h++){for(b=Math.max(b,Math.abs(r[h])+Math.abs(e[h])),l=h;l<t&&!(Math.abs(e[l])<=M*b);)l++;if(l>h)do{for(o=r[h],f=K(c=(r[h+1]-o)/(2*e[h]),1),c<0&&(f=-f),r[h]=e[h]/(c+f),r[h+1]=e[h]*(c+f),m=r[h+1],i=o-r[h],s=h+2;s<t;s++)r[s]-=i;for(y+=i,c=r[l],g=d=1,w=d,v=e[h+1],p=0,x=0,s=l-1;s>=h;s--)for(w=g,g=d,x=p,o=d*e[s],i=d*c,f=K(c,e[s]),e[s+1]=p*f,p=e[s]/f,c=(d=c/f)*r[s]-p*o,r[s+1]=i+p*(d*o+p*r[s]),u=0;u<t;u++)i=n[u][s+1],n[u][s+1]=p*n[u][s]+d*i,n[u][s]=d*n[u][s]-p*i;c=-p*x*w*v*e[h]/m,e[h]=p*c,r[h]=d*c}while(Math.abs(e[h])>M*b);r[h]=r[h]+y,e[h]=0}for(s=0;s<t-1;s++){for(u=s,c=r[s],a=s+1;a<t;a++)r[a]<c&&(u=a,c=r[a]);if(u!==s)for(r[u]=r[s],r[s]=c,a=0;a<t;a++)c=n[a][s],n[a][s]=n[a][u],n[a][u]=c}}(i,u,a,s)}else{var l=Q(i,i,0),c=new Array(i);for(o=0;o<i;o++)for(n=0;n<i;n++)l[n][o]=h.get(n,o);!function(t,e,r,n){var o,i,s,a,u,h,l,c=0,f=t-1;for(h=c+1;h<=f-1;h++){for(l=0,a=h;a<=f;a++)l+=Math.abs(e[a][h-1]);if(0!==l){for(s=0,a=f;a>=h;a--)r[a]=e[a][h-1]/l,s+=r[a]*r[a];for(i=Math.sqrt(s),r[h]>0&&(i=-i),s-=r[h]*i,r[h]=r[h]-i,u=h;u<t;u++){for(o=0,a=f;a>=h;a--)o+=r[a]*e[a][u];for(o/=s,a=h;a<=f;a++)e[a][u]-=o*r[a]}for(a=0;a<=f;a++){for(o=0,u=f;u>=h;u--)o+=r[u]*e[a][u];for(o/=s,u=h;u<=f;u++)e[a][u]-=o*r[u]}r[h]=l*r[h],e[h][h-1]=l*i}}for(a=0;a<t;a++)for(u=0;u<t;u++)n[a][u]=a===u?1:0;for(h=f-1;h>=c+1;h--)if(0!==e[h][h-1]){for(a=h+1;a<=f;a++)r[a]=e[a][h-1];for(u=h;u<=f;u++){for(i=0,a=h;a<=f;a++)i+=r[a]*n[a][u];for(i=i/r[h]/e[h][h-1],a=h;a<=f;a++)n[a][u]+=i*r[a]}}}(i,l,c,s),function(t,e,r,n,o){var i,s,a,u,h,l,c,f,m,d,g,w,v,p,x,y=t-1,b=0,M=t-1,_=Number.EPSILON,k=0,$=0,E=0,j=0,S=0,N=0,R=0,A=0;for(i=0;i<t;i++)for((i<b||i>M)&&(r[i]=o[i][i],e[i]=0),s=Math.max(i-1,0);s<t;s++)$+=Math.abs(o[i][s]);for(;y>=b;){for(u=y;u>b&&(0===(N=Math.abs(o[u-1][u-1])+Math.abs(o[u][u]))&&(N=$),!(Math.abs(o[u][u-1])<_*N));)u--;if(u===y)o[y][y]=o[y][y]+k,r[y]=o[y][y],e[y]=0,y--,A=0;else if(u===y-1){if(c=o[y][y-1]*o[y-1][y],j=(E=(o[y-1][y-1]-o[y][y])/2)*E+c,R=Math.sqrt(Math.abs(j)),o[y][y]=o[y][y]+k,o[y-1][y-1]=o[y-1][y-1]+k,f=o[y][y],j>=0){for(R=E>=0?E+R:E-R,r[y-1]=f+R,r[y]=r[y-1],0!==R&&(r[y]=f-c/R),e[y-1]=0,e[y]=0,E=(f=o[y][y-1])/(N=Math.abs(f)+Math.abs(R)),j=R/N,E/=S=Math.sqrt(E*E+j*j),j/=S,s=y-1;s<t;s++)R=o[y-1][s],o[y-1][s]=j*R+E*o[y][s],o[y][s]=j*o[y][s]-E*R;for(i=0;i<=y;i++)R=o[i][y-1],o[i][y-1]=j*R+E*o[i][y],o[i][y]=j*o[i][y]-E*R;for(i=b;i<=M;i++)R=n[i][y-1],n[i][y-1]=j*R+E*n[i][y],n[i][y]=j*n[i][y]-E*R}else r[y-1]=f+E,r[y]=f+E,e[y-1]=R,e[y]=-R;y-=2,A=0}else{if(f=o[y][y],m=0,c=0,u<y&&(m=o[y-1][y-1],c=o[y][y-1]*o[y-1][y]),10===A){for(k+=f,i=b;i<=y;i++)o[i][i]-=f;f=m=.75*(N=Math.abs(o[y][y-1])+Math.abs(o[y-1][y-2])),c=-.4375*N*N}if(30===A&&(N=(N=(m-f)/2)*N+c)>0){for(N=Math.sqrt(N),m<f&&(N=-N),N=f-c/((m-f)/2+N),i=b;i<=y;i++)o[i][i]-=N;k+=N,f=m=c=.964}for(A+=1,h=y-2;h>=u&&(E=((S=f-(R=o[h][h]))*(N=m-R)-c)/o[h+1][h]+o[h][h+1],j=o[h+1][h+1]-R-S-N,S=o[h+2][h+1],E/=N=Math.abs(E)+Math.abs(j)+Math.abs(S),j/=N,S/=N,h!==u)&&!(Math.abs(o[h][h-1])*(Math.abs(j)+Math.abs(S))<_*(Math.abs(E)*(Math.abs(o[h-1][h-1])+Math.abs(R)+Math.abs(o[h+1][h+1]))));)h--;for(i=h+2;i<=y;i++)o[i][i-2]=0,i>h+2&&(o[i][i-3]=0);for(a=h;a<=y-1&&(p=a!==y-1,a!==h&&(E=o[a][a-1],j=o[a+1][a-1],S=p?o[a+2][a-1]:0,0!==(f=Math.abs(E)+Math.abs(j)+Math.abs(S))&&(E/=f,j/=f,S/=f)),0!==f);a++)if(N=Math.sqrt(E*E+j*j+S*S),E<0&&(N=-N),0!==N){for(a!==h?o[a][a-1]=-N*f:u!==h&&(o[a][a-1]=-o[a][a-1]),f=(E+=N)/N,m=j/N,R=S/N,j/=E,S/=E,s=a;s<t;s++)E=o[a][s]+j*o[a+1][s],p&&(E+=S*o[a+2][s],o[a+2][s]=o[a+2][s]-E*R),o[a][s]=o[a][s]-E*f,o[a+1][s]=o[a+1][s]-E*m;for(i=0;i<=Math.min(y,a+3);i++)E=f*o[i][a]+m*o[i][a+1],p&&(E+=R*o[i][a+2],o[i][a+2]=o[i][a+2]-E*S),o[i][a]=o[i][a]-E,o[i][a+1]=o[i][a+1]-E*j;for(i=b;i<=M;i++)E=f*n[i][a]+m*n[i][a+1],p&&(E+=R*n[i][a+2],n[i][a+2]=n[i][a+2]-E*S),n[i][a]=n[i][a]-E,n[i][a+1]=n[i][a+1]-E*j}}}if(0===$)return;for(y=t-1;y>=0;y--)if(E=r[y],0===(j=e[y]))for(u=y,o[y][y]=1,i=y-1;i>=0;i--){for(c=o[i][i]-E,S=0,s=u;s<=y;s++)S+=o[i][s]*o[s][y];if(e[i]<0)R=c,N=S;else if(u=i,0===e[i]?o[i][y]=0!==c?-S/c:-S/(_*$):(f=o[i][i+1],m=o[i+1][i],l=(f*N-R*S)/(j=(r[i]-E)*(r[i]-E)+e[i]*e[i]),o[i][y]=l,o[i+1][y]=Math.abs(f)>Math.abs(R)?(-S-c*l)/f:(-N-m*l)/R),_*(l=Math.abs(o[i][y]))*l>1)for(s=i;s<=y;s++)o[s][y]=o[s][y]/l}else if(j<0)for(u=y-1,Math.abs(o[y][y-1])>Math.abs(o[y-1][y])?(o[y-1][y-1]=j/o[y][y-1],o[y-1][y]=-(o[y][y]-E)/o[y][y-1]):(x=Et(0,-o[y-1][y],o[y-1][y-1]-E,j),o[y-1][y-1]=x[0],o[y-1][y]=x[1]),o[y][y-1]=0,o[y][y]=1,i=y-2;i>=0;i--){for(d=0,g=0,s=u;s<=y;s++)d+=o[i][s]*o[s][y-1],g+=o[i][s]*o[s][y];if(c=o[i][i]-E,e[i]<0)R=c,S=d,N=g;else if(u=i,0===e[i]?(x=Et(-d,-g,c,j),o[i][y-1]=x[0],o[i][y]=x[1]):(f=o[i][i+1],m=o[i+1][i],w=(r[i]-E)*(r[i]-E)+e[i]*e[i]-j*j,v=2*(r[i]-E)*j,0===w&&0===v&&(w=_*$*(Math.abs(c)+Math.abs(j)+Math.abs(f)+Math.abs(m)+Math.abs(R))),x=Et(f*S-R*d+j*g,f*N-R*g-j*d,w,v),o[i][y-1]=x[0],o[i][y]=x[1],Math.abs(f)>Math.abs(R)+Math.abs(j)?(o[i+1][y-1]=(-d-c*o[i][y-1]+j*o[i][y])/f,o[i+1][y]=(-g-c*o[i][y]-j*o[i][y-1])/f):(x=Et(-S-m*o[i][y-1],-N-m*o[i][y],R,j),o[i+1][y-1]=x[0],o[i+1][y]=x[1])),_*(l=Math.max(Math.abs(o[i][y-1]),Math.abs(o[i][y])))*l>1)for(s=i;s<=y;s++)o[s][y-1]=o[s][y-1]/l,o[s][y]=o[s][y]/l}for(i=0;i<t;i++)if(i<b||i>M)for(s=i;s<t;s++)n[i][s]=o[i][s];for(s=t-1;s>=b;s--)for(i=b;i<=M;i++){for(R=0,a=b;a<=Math.min(s,M);a++)R+=n[i][a]*o[a][s];n[i][s]=R}}(i,u,a,s,l)}this.n=i,this.e=u,this.d=a,this.V=s}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return yt.isMatrix(this.V)||(this.V=new yt(this.V)),this.V}get diagonalMatrix(){var t,e,r=this.n,n=this.e,o=this.d,i=new yt(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)i[t][e]=0;i[t][t]=o[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}}function Et(t,e,r,n){var o,i;return Math.abs(r)>Math.abs(n)?[(t+(o=n/r)*e)/(i=r+o*n),(e-o*t)/i]:[((o=r/n)*t+e)/(i=n+o*r),(o*e-t)/i]}class jt{constructor(t){if(!(t=bt.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");var e,r,n,o=t,i=o.rows,s=new yt(i,i),a=!0;for(r=0;r<i;r++){var u=s[r],h=0;for(n=0;n<r;n++){var l=s[n],c=0;for(e=0;e<n;e++)c+=l[e]*u[e];u[n]=c=(o.get(r,n)-c)/s[n][n],h+=c*c}for(a&=(h=o.get(r,r)-h)>0,s[r][r]=Math.sqrt(Math.max(h,0)),n=r+1;n<i;n++)s[r][n]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=s}solve(t){t=bt.checkMatrix(t);var e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");var n,o,i,s=t.columns,a=t.clone();for(i=0;i<r;i++)for(o=0;o<s;o++){for(n=0;n<i;n++)a[i][o]-=a[n][o]*e[i][n];a[i][o]/=e[i][i]}for(i=r-1;i>=0;i--)for(o=0;o<s;o++){for(n=i+1;n<r;n++)a[i][o]-=a[n][o]*e[n][i];a[i][o]/=e[i][i]}return a}get lowerTriangularMatrix(){return this.L}}var St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Nt(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})})),e}function Rt(t){var e={exports:{}};return t(e,e.exports),e.exports}var At={func:Symbol("func"),validate:Symbol("validate")};const{func:qt}=At;var Ct={predicates:{positive:t=>t>0,negative:t=>t<0,nonNegative:t=>t>=0,integer:t=>t===(0|t),[qt]:{is:t=>t,eq:t=>e=>e===t,gt:t=>e=>e>t,gte:t=>e=>e>=t,lt:t=>e=>e<t,lte:t=>e=>e<=t}},validator:t=>"number"==typeof t};const{func:Tt}=At;var Vt={predicates:{empty:t=>""===t,nonEmpty:t=>""!==t,[Tt]:{is:t=>t,eq:t=>e=>e===t,length:t=>e=>e.length===t,minLength:t=>e=>e.length>=t,maxLength:t=>e=>e.length<=t,matches:t=>e=>t.test(e),startsWith:t=>e=>e.startsWith(t),endsWith:t=>e=>e.endsWith(t)}},validator:t=>"string"==typeof t};const{func:It}=At;const Ot={number:Ct,string:Vt,object:{predicates:{plain:t=>{if("object"!=typeof t)return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.getPrototypeOf({})},empty:t=>0===Object.keys(t).length,nonEmpty:t=>Object.keys(t).length>0,[It]:{is:t=>t,instanceOf:t=>e=>e instanceof t}},validator:t=>"object"==typeof t}},Pt=({validators:t=[],predicates:e=Ot,type:r=null}={})=>{const n=new Proxy((function(){}),{get:(o,i)=>{if(i===At.validate)return(e,n="argument")=>{if(!r)return new Error("missing required type specifier");for(let o=0;o<t.length;++o){const i=t[o];if(!i.fn(e))throw 0===o?new Error(`Expected ${n} \`${e}\` to be of type \`${r}\`, but received type \`${typeof e}\``):new Error(`Expected ${r} \`${n}\` \`${e}\` failed predicate \`${i.key}\``)}};const s=e[i];if(s)return"function"==typeof s?(t.push({key:i,fn:s}),n):Pt({type:i,validators:[{key:i,fn:s.validator}],predicates:s.predicates});{const r=e[At.func]&&e[At.func][i];return r?new Proxy((function(){}),{get:()=>{throw new Error(`invalid use of functional predicate "${i}"`)},apply:(e,o,s)=>(t.push({key:i,fn:r(...s)}),n)}):n}},apply:(t,e,r)=>{if(2!==r.length&&3!==r.length)throw new Error('invalid number of arguments to "ow"');r[1][At.validate](r[0],r[2])}});return n};var Lt=Pt(),zt=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var Dt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return zt(t,[{key:"next",value:function(){throw new Error("RNG.next must be overridden")}},{key:"seed",value:function(t,e){throw new Error("RNG.seed must be overridden")}},{key:"clone",value:function(t,e){throw new Error("RNG.clone must be overridden")}},{key:"_seed",value:function(t,e){if(t===(0|t))return t;for(var r=""+t,n=0,o=0;o<r.length;++o)n^=0|r.charCodeAt(o);return n}},{key:"name",get:function(){throw new Error("RNG.name must be overridden")}}]),t}(),Ht=Object.defineProperty({default:Dt},"__esModule",{value:!0}),Ut=Rt((function(t){!function(t,e,r){function n(t){var e,r=this,n=(e=4022871197,function(t){t=String(t);for(var r=0;r<t.length;r++){var n=.02519603282416938*(e+=t.charCodeAt(r));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(t),r.s0<0&&(r.s0+=1),r.s1-=n(t),r.s1<0&&(r.s1+=1),r.s2-=n(t),r.s2<0&&(r.s2+=1),n=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var r=new n(t),i=e&&e.state,s=r.next;return s.int32=function(){return 4294967296*r.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,i&&("object"==typeof i&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.alea=i}(0,t,!1)})),Bt=Rt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var r=new n(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.xor128=i}(0,t,!1)})),Ft=Rt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var r=new n(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.xorwow=i}(0,t,!1)})),Xt=Rt((function(t){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.x,o=e.i;return t=n[o],r=(t^=t>>>7)^t<<24,r^=(t=n[o+1&7])^t>>>10,r^=(t=n[o+3&7])^t>>>3,r^=(t=n[o+4&7])^t<<7,t=n[o+7&7],r^=(t^=t<<13)^t<<9,n[o]=r,e.i=o+1&7,r},function(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r&&(n[7]=-1),t.x=n,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var r=new n(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&(i.x&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.xorshift7=i}(0,t,!1)})),Wt=Rt((function(t){!function(t,e,r){function n(t){var e=this;e.next=function(){var t,r,n=e.w,o=e.X,i=e.i;return e.w=n=n+1640531527|0,r=o[i+34&127],t=o[i=i+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=o[i]=r^t,e.i=i,r+(n^n>>>16)|0},function(t,e){var r,n,o,i,s,a=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),o=0,i=-32;i<u;++i)e&&(n^=e.charCodeAt((i+32)%e.length)),0===i&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,i>=0&&(s=s+1640531527|0,o=0==(r=a[127&i]^=n+s)?o+1:0);for(o>=128&&(a[127&(e&&e.length||0)]=-1),o=127,i=512;i>0;--i)n=a[o+34&127],r=a[o=o+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[o]=n^r;t.w=s,t.X=a,t.i=o}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var r=new n(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&(i.X&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.xor4096=i}(0,t,!1)})),Gt=Rt((function(t){!function(t,e,r){function n(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,o=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^o,o=o-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^o,e.a=o-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var r=new n(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&o(i,r),s.state=function(){return o(r,{})}),s}e&&e.exports?e.exports=i:r&&r.amd?r((function(){return i})):this.tychei=i}(0,t,!1)})),Kt=Nt(Object.freeze({__proto__:null,default:{}})),Qt=Rt((function(t){!function(e,r,n){var o,i=256,s=n.pow(i,6),a=n.pow(2,52),u=2*a,h=255;function l(t,h,l){var w=[],v=d(m((h=1==h?{entropy:!0}:h||{}).entropy?[t,g(r)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(i):(t=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=e.navigator,s=n&&n.plugins;return[+new Date,e,s,e.screen,g(r)]}}():t,3),w),p=new c(w),x=function(){for(var t=p.g(6),e=s,r=0;t<a;)t=(t+r)*i,e*=i,r=p.g(1);for(;t>=u;)t/=2,e/=2,r>>>=1;return(t+r)/e};return x.int32=function(){return 0|p.g(4)},x.quick=function(){return p.g(4)/4294967296},x.double=x,d(g(p.S),r),(h.pass||l||function(t,e,r,o){return o&&(o.S&&f(o,p),t.state=function(){return f(p,{})}),r?(n.random=t,e):t})(x,v,"global"in h?h.global:this==n,h.state)}function c(t){var e,r=t.length,n=this,o=0,s=n.i=n.j=0,a=n.S=[];for(r||(t=[r++]);o<i;)a[o]=o++;for(o=0;o<i;o++)a[o]=a[s=h&s+t[o%r]+(e=a[o])],a[s]=e;(n.g=function(t){for(var e,r=0,o=n.i,s=n.j,a=n.S;t--;)e=a[o=h&o+1],r=r*i+a[h&(a[o]=a[s=h&s+e])+(a[s]=e)];return n.i=o,n.j=s,r})(i)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var r,n=[],o=typeof t;if(e&&"object"==o)for(r in t)try{n.push(m(t[r],e-1))}catch(t){}return n.length?n:"string"==o?t:t+"\0"}function d(t,e){for(var r,n=t+"",o=0;o<n.length;)e[h&o]=h&(r^=19*e[h&o])+n.charCodeAt(o++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(d(n.random(),r),t.exports){t.exports=l;try{o=Kt}catch(t){}}else n.seedrandom=l}("undefined"!=typeof self?self:St,[],Math)}));Qt.alea=Ut,Qt.xor128=Bt,Qt.xorwow=Ft,Qt.xorshift7=Xt,Qt.xor4096=Wt,Qt.tychei=Gt;var Yt=Qt,Zt=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),Jt=te(Lt);function te(t){return t&&t.__esModule?t:{default:t}}var ee=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.seed(t,r),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Zt(e,[{key:"next",value:function(){return this._rng()}},{key:"seed",value:function(t){(0,Jt.default)(t,Jt.default.function),this._rng=t}},{key:"clone",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return new(Function.prototype.bind.apply(e,[null].concat([this._rng],r)))}},{key:"name",get:function(){return"function"}}]),e}(te(Ht).default),re=Object.defineProperty({default:ee},"__esModule",{value:!0}),ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe=ae(Yt),ie=ae(Ht),se=ae(re);function ae(t){return t&&t.__esModule?t:{default:t}}function ue(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}var he,le=Object.defineProperty({default:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0],o=void 0===n?"default":n,i=e.slice(1);switch(void 0===o?"undefined":ne(o)){case"object":if(o instanceof ie.default)return o;break;case"function":return new se.default(o);case"string":case"number":return new se.default(oe.default.apply(void 0,ue(i)))}throw new Error('invalid RNG "'+o+'"')}},"__esModule",{value:!0}),ce=(he=Lt)&&he.__esModule?he:{default:he};var fe=Object.defineProperty({default:function(t,e,r){return void 0===r&&(r=void 0===e?1:e,e=0),(0,ce.default)(e,ce.default.number),(0,ce.default)(r,ce.default.number),function(){return t.next()*(r-e)+e}}},"__esModule",{value:!0}),me=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var de=Object.defineProperty({default:function(t,e,r){return void 0===r&&(r=void 0===e?1:e,e=0),(0,me.default)(e,me.default.number.integer),(0,me.default)(r,me.default.number.integer),function(){return t.next()*(r-e+1)+e|0}}},"__esModule",{value:!0}),ge=Object.defineProperty({default:function(t){return function(){return t.next()>=.5}}},"__esModule",{value:!0}),we=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var ve=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return(0,we.default)(e,we.default.number),(0,we.default)(r,we.default.number),function(){var n=void 0,o=void 0,i=void 0;do{i=(n=2*t.next()-1)*n+(o=2*t.next()-1)*o}while(!i||i>1);return e+r*o*Math.sqrt(-2*Math.log(i)/i)}}},"__esModule",{value:!0}),pe=Object.defineProperty({default:function(t){for(var e=arguments.length,r=Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=t.normal.apply(t,r);return function(){return Math.exp(o())}}},"__esModule",{value:!0}),xe=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var ye=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return(0,xe.default)(e,xe.default.number.gte(0).lt(1)),function(){return t.next()+e|0}}},"__esModule",{value:!0}),be=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Me=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5;return(0,be.default)(e,be.default.number.positive.integer),(0,be.default)(r,be.default.number.gte(0).lte(1)),function(){for(var n=0,o=0;n++<e;)o+=t.next()<r;return o}}},"__esModule",{value:!0}),_e=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var ke=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;(0,_e.default)(e,_e.default.number.gt(0).lte(1));var r=1/Math.log(1-e);return function(){return 1+Math.log(t.next())*r|0}}},"__esModule",{value:!0}),$e=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Ee=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],je=function(t){return Ee[t]},Se=.9189385332046727,Ne=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if((0,$e.default)(e,$e.default.number.positive),e<10){var r=Math.exp(-e);return function(){for(var n=r,o=0,i=t.next();i>n;)i-=n,n=e*n/++o;return o}}var n=Math.sqrt(e),o=.931+2.53*n,i=.02483*o-.059,s=1.1239+1.1328/(o-3.4),a=.9277-3.6224/(o-2);return function(){for(;;){var r=void 0,u=t.next();if(u<=.86*a)return r=u/a-.43,Math.floor((2*i/(.5-Math.abs(r))+o)*r+e+.445);u>=a?r=t.next()-.5:(r=((r=u/a-.93)<0?-.5:.5)-r,u=t.next()*a);var h=.5-Math.abs(r);if(!(h<.013&&u>h)){var l=0|Math.floor((2*i/h+o)*r+e+.445);if(u=u*s/(i/(h*h)+o),l>=10){var c=(l+.5)*Math.log(e/l)-e-Se+l-(1/12-(1/360-1/(1260*l*l))/(l*l))/l;if(Math.log(u*n)<=c)return l}else if(l>=0&&Math.log(u)<=l*Math.log(e)-e-je(l))return l}}}}},"__esModule",{value:!0}),Re=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Ae=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Re.default)(e,Re.default.number.positive),function(){return-Math.log(1-t.next())/e}}},"__esModule",{value:!0}),qe=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Ce=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,qe.default)(e,qe.default.number.integer.gte(0)),function(){for(var r=0,n=0;n<e;++n)r+=t.next();return r}}},"__esModule",{value:!0}),Te=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Ve=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Te.default)(e,Te.default.number.integer.positive);var r=t.irwinHall(e);return function(){return r()/e}}},"__esModule",{value:!0}),Ie=function(t){return t&&t.__esModule?t:{default:t}}(Lt);var Oe=Object.defineProperty({default:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,Ie.default)(e,Ie.default.number.gte(0));var r=1/e;return function(){return 1/Math.pow(1-t.next(),r)}}},"__esModule",{value:!0}),Pe=Rt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.RNGFactory=e.RNG=void 0;var r=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),n=x(Lt),o=x(Ht),i=x(le),s=x(fe),a=x(de),u=x(ge),h=x(ve),l=x(pe),c=x(ye),f=x(Me),m=x(ke),d=x(Ne),g=x(Ae),w=x(Ce),v=x(Ve),p=x(Oe);function x(t){return t&&t.__esModule?t:{default:t}}e.RNG=o.default,e.RNGFactory=i.default;var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(0,n.default)(e,n.default.object.instanceOf(o.default)),this._cache={},this.use(e)}return r(t,[{key:"clone",value:function(){return new t(arguments.length?i.default.apply(void 0,arguments):this.rng.clone())}},{key:"use",value:function(){this._rng=i.default.apply(void 0,arguments)}},{key:"patch",value:function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()}},{key:"unpatch",value:function(){this._patch&&(Math.random=this._patch,delete this._patch)}},{key:"next",value:function(){return this._rng.next()}},{key:"float",value:function(t,e){return this.uniform(t,e)()}},{key:"int",value:function(t,e){return this.uniformInt(t,e)()}},{key:"integer",value:function(t,e){return this.uniformInt(t,e)()}},{key:"bool",value:function(){return this.uniformBoolean()()}},{key:"boolean",value:function(){return this.uniformBoolean()()}},{key:"uniform",value:function(t,e){return this._memoize("uniform",s.default,t,e)}},{key:"uniformInt",value:function(t,e){return this._memoize("uniformInt",a.default,t,e)}},{key:"uniformBoolean",value:function(){return this._memoize("uniformBoolean",u.default)}},{key:"normal",value:function(t,e){return(0,h.default)(this,t,e)}},{key:"logNormal",value:function(t,e){return(0,l.default)(this,t,e)}},{key:"bernoulli",value:function(t){return(0,c.default)(this,t)}},{key:"binomial",value:function(t,e){return(0,f.default)(this,t,e)}},{key:"geometric",value:function(t){return(0,m.default)(this,t)}},{key:"poisson",value:function(t){return(0,d.default)(this,t)}},{key:"exponential",value:function(t){return(0,g.default)(this,t)}},{key:"irwinHall",value:function(t){return(0,w.default)(this,t)}},{key:"bates",value:function(t){return(0,v.default)(this,t)}},{key:"pareto",value:function(t){return(0,p.default)(this,t)}},{key:"_memoize",value:function(t,e){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i=""+n.join(";"),s=this._cache[t];return void 0!==s&&s.key===i||(s={key:i,distribution:e.apply(void 0,[this].concat(n))},this._cache[t]=s),s.distribution}},{key:"rng",get:function(){return this._rng}}]),t}();e.default=new y})).default;class Le{constructor(t,e){t instanceof yt&&e instanceof yt?(this.mean=t,this.cov=e):(this.mean=new yt([t]).transpose(),this.cov=new yt(e))}at(t){const e=new yt([t]).transpose().sub(this.mean);return e.transpose().mmul(_t(this.cov)).mmul(e).mul(-.5).exp()*(1/Math.sqrt(Math.pow(2*Math.PI,this.mean.rows)*this.cov.det()))}marginalize(t){const e=ze(this.mean,0,0,t,1),r=ze(this.mean,t,0,this.mean.rows,1),n=ze(this.cov,0,0,t,t),o=ze(this.cov,t,t,this.mean.rows,this.mean.rows);return[new Le(e,n),new Le(r,o)]}condition(t){const e=t.length,r=new yt([t]).transpose(),n=ze(this.cov,0,0,e,e),o=ze(this.cov,0,e,e,this.mean.rows),i=o.transpose(),s=ze(this.cov,e,e,this.mean.rows,this.mean.rows),a=new jt(n).lowerTriangularMatrix,u=kt(a,r),h=kt(a,o).transpose().mmul(u),l=s.sub(i.mmul(_t(n)).mmul(o));return new Le(h,l)}transformationMatrix(){const t=new $t(this.cov),e=t.eigenvectorMatrix,r=yt.zeros(e.rows,e.columns);for(let e=0;e<r.rows;++e)r.set(e,e,Math.sqrt(t.realEigenvalues[e]));return e.mmul(r)}sample(){const t=yt.zeros(this.mean.rows,1),e=Pe.normal();for(let r=0;r<this.mean.rows;++r)t.set(r,0,e());return yt.add(this.mean,this.transformationMatrix().mmul(t))}getMean(){return this.mean.transpose()[0]}getSd(){return this.cov.diag().map((t=>Math.sqrt(t)))}}function ze(t,e,r,n,o){const i=new yt(n-e,o-r);for(let s=e;s<n;++s)for(let n=r;n<o;++n)i.set(s-e,n-r,t.get(s,n));return i}function De(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function He(t){let e=t,r=t;function n(t,e,n,o){for(null==n&&(n=0),null==o&&(o=t.length);n<o;){const i=n+o>>>1;r(t[i],e)<0?n=i+1:o=i}return n}return 1===t.length&&(e=(e,r)=>t(e)-r,r=function(t){return(e,r)=>De(t(e),r)}(t)),{left:n,center:function(t,r,o,i){null==o&&(o=0),null==i&&(i=t.length);const s=n(t,r,o,i-1);return s>o&&e(t[s-1],r)>-e(t[s],r)?s-1:s},right:function(t,e,n,o){for(null==n&&(n=0),null==o&&(o=t.length);n<o;){const i=n+o>>>1;r(t[i],e)>0?o=i:n=i+1}return n}}}const Ue=He(De).right;He((function(t){return null===t?NaN:+t})).center;var Be=Math.sqrt(50),Fe=Math.sqrt(10),Xe=Math.sqrt(2);function We(t,e,r){var n=(e-t)/Math.max(0,r),o=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,o);return o>=0?(i>=Be?10:i>=Fe?5:i>=Xe?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=Be?10:i>=Fe?5:i>=Xe?2:1)}function Ge(t,e,r){t=+t,e=+e,r=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+r;for(var n=-1,o=0|Math.max(0,Math.ceil((e-t)/r)),i=new Array(o);++n<o;)i[n]=t+n*r;return i}function Ke(t){if(!(o=t.length))return[];for(var e=-1,r=function(t,e){let r;if(void 0===e)for(const e of t)null!=e&&(r>e||void 0===r&&e>=e)&&(r=e);else{let n=-1;for(let o of t)null!=(o=e(o,++n,t))&&(r>o||void 0===r&&o>=o)&&(r=o)}return r}(t,Qe),n=new Array(r);++e<r;)for(var o,i=-1,s=n[e]=new Array(o);++i<o;)s[i]=t[i][e];return n}function Qe(t){return t.length}function Ye(){return Ke(arguments)}var Ze={value:()=>{}};function Je(){for(var t,e=0,r=arguments.length,n={};e<r;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new tr(n)}function tr(t){this._=t}function er(t,e){return t.trim().split(/^|\s+/).map((function(t){var r="",n=t.indexOf(".");if(n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}}))}function rr(t,e){for(var r,n=0,o=t.length;n<o;++n)if((r=t[n]).name===e)return r.value}function nr(t,e,r){for(var n=0,o=t.length;n<o;++n)if(t[n].name===e){t[n]=Ze,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=r&&t.push({name:e,value:r}),t}function or(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function ir(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function sr(){}tr.prototype=Je.prototype={constructor:tr,on:function(t,e){var r,n=this._,o=er(t+"",n),i=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<s;)if(r=(t=o[i]).type)n[r]=nr(n[r],t.name,e);else if(null==e)for(r in n)n[r]=nr(n[r],t.name,null);return this}for(;++i<s;)if((r=(t=o[i]).type)&&(r=rr(n[r],t.name)))return r},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new tr(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var r,n,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,r=(n=this._[t]).length;i<r;++i)n[i].value.apply(e,o)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],o=0,i=n.length;o<i;++o)n[o].value.apply(e,r)}};var ar=.7,ur=1/ar,hr="\\s*([+-]?\\d+)\\s*",lr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",cr="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fr=/^#([0-9a-f]{3,8})$/,mr=new RegExp("^rgb\\("+[hr,hr,hr]+"\\)$"),dr=new RegExp("^rgb\\("+[cr,cr,cr]+"\\)$"),gr=new RegExp("^rgba\\("+[hr,hr,hr,lr]+"\\)$"),wr=new RegExp("^rgba\\("+[cr,cr,cr,lr]+"\\)$"),vr=new RegExp("^hsl\\("+[lr,cr,cr]+"\\)$"),pr=new RegExp("^hsla\\("+[lr,cr,cr,lr]+"\\)$"),xr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function yr(){return this.rgb().formatHex()}function br(){return this.rgb().formatRgb()}function Mr(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=fr.exec(t))?(r=e[1].length,e=parseInt(e[1],16),6===r?_r(e):3===r?new jr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===r?kr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===r?kr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=mr.exec(t))?new jr(e[1],e[2],e[3],1):(e=dr.exec(t))?new jr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=gr.exec(t))?kr(e[1],e[2],e[3],e[4]):(e=wr.exec(t))?kr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=vr.exec(t))?Ar(e[1],e[2]/100,e[3]/100,1):(e=pr.exec(t))?Ar(e[1],e[2]/100,e[3]/100,e[4]):xr.hasOwnProperty(t)?_r(xr[t]):"transparent"===t?new jr(NaN,NaN,NaN,0):null}function _r(t){return new jr(t>>16&255,t>>8&255,255&t,1)}function kr(t,e,r,n){return n<=0&&(t=e=r=NaN),new jr(t,e,r,n)}function $r(t){return t instanceof sr||(t=Mr(t)),t?new jr((t=t.rgb()).r,t.g,t.b,t.opacity):new jr}function Er(t,e,r,n){return 1===arguments.length?$r(t):new jr(t,e,r,null==n?1:n)}function jr(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}function Sr(){return"#"+Rr(this.r)+Rr(this.g)+Rr(this.b)}function Nr(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Rr(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Ar(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new Cr(t,e,r,n)}function qr(t){if(t instanceof Cr)return new Cr(t.h,t.s,t.l,t.opacity);if(t instanceof sr||(t=Mr(t)),!t)return new Cr;if(t instanceof Cr)return t;var e=(t=t.rgb()).r/255,r=t.g/255,n=t.b/255,o=Math.min(e,r,n),i=Math.max(e,r,n),s=NaN,a=i-o,u=(i+o)/2;return a?(s=e===i?(r-n)/a+6*(r<n):r===i?(n-e)/a+2:(e-r)/a+4,a/=u<.5?i+o:2-i-o,s*=60):a=u>0&&u<1?0:s,new Cr(s,a,u,t.opacity)}function Cr(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}function Tr(t,e,r){return 255*(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)}or(sr,Mr,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:yr,formatHex:yr,formatHsl:function(){return qr(this).formatHsl()},formatRgb:br,toString:br}),or(jr,Er,ir(sr,{brighter:function(t){return t=null==t?ur:Math.pow(ur,t),new jr(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?ar:Math.pow(ar,t),new jr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Sr,formatHex:Sr,formatRgb:Nr,toString:Nr})),or(Cr,(function(t,e,r,n){return 1===arguments.length?qr(t):new Cr(t,e,r,null==n?1:n)}),ir(sr,{brighter:function(t){return t=null==t?ur:Math.pow(ur,t),new Cr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?ar:Math.pow(ar,t),new Cr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,o=2*r-n;return new jr(Tr(t>=240?t-240:t+120,o,n),Tr(t,o,n),Tr(t<120?t+240:t-120,o,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Vr=t=>()=>t;function Ir(t){return 1==(t=+t)?Or:function(e,r){return r-e?function(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}(e,r,t):Vr(isNaN(e)?r:e)}}function Or(t,e){var r=e-t;return r?function(t,e){return function(r){return t+r*e}}(t,r):Vr(isNaN(t)?e:t)}var Pr=function t(e){var r=Ir(e);function n(t,e){var n=r((t=Er(t)).r,(e=Er(e)).r),o=r(t.g,e.g),i=r(t.b,e.b),s=Or(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=o(e),t.b=i(e),t.opacity=s(e),t+""}}return n.gamma=t,n}(1);function Lr(t,e){e||(e=[]);var r,n=t?Math.min(e.length,t.length):0,o=e.slice();return function(i){for(r=0;r<n;++r)o[r]=t[r]*(1-i)+e[r]*i;return o}}function zr(t,e){var r,n=e?e.length:0,o=t?Math.min(n,t.length):0,i=new Array(o),s=new Array(n);for(r=0;r<o;++r)i[r]=Wr(t[r],e[r]);for(;r<n;++r)s[r]=e[r];return function(t){for(r=0;r<o;++r)s[r]=i[r](t);return s}}function Dr(t,e){var r=new Date;return t=+t,e=+e,function(n){return r.setTime(t*(1-n)+e*n),r}}function Hr(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}function Ur(t,e){var r,n={},o={};for(r in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)r in t?n[r]=Wr(t[r],e[r]):o[r]=e[r];return function(t){for(r in n)o[r]=n[r](t);return o}}var Br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fr=new RegExp(Br.source,"g");function Xr(t,e){var r,n,o,i=Br.lastIndex=Fr.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(r=Br.exec(t))&&(n=Fr.exec(e));)(o=n.index)>i&&(o=e.slice(i,o),a[s]?a[s]+=o:a[++s]=o),(r=r[0])===(n=n[0])?a[s]?a[s]+=n:a[++s]=n:(a[++s]=null,u.push({i:s,x:Hr(r,n)})),i=Fr.lastIndex;return i<e.length&&(o=e.slice(i),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var r,n=0;n<e;++n)a[(r=u[n]).i]=r.x(t);return a.join("")})}function Wr(t,e){var r,n=typeof e;return null==e||"boolean"===n?Vr(e):("number"===n?Hr:"string"===n?(r=Mr(e))?(e=r,Pr):Xr:e instanceof Mr?Pr:e instanceof Date?Dr:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?Lr:Array.isArray(e)?zr:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Ur:Hr)(t,e)}function Gr(t,e){return t=+t,e=+e,function(r){return Math.round(t*(1-r)+e*r)}}Je("start","end","cancel","interrupt");const Kr=Math.PI,Qr=2*Kr,Yr=1e-6,Zr=Qr-Yr;function Jr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function tn(){return new Jr}function en(t,e){if((r=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var r,n=t.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+t.slice(r+1)]}function rn(t){return(t=en(Math.abs(t)))?t[1]:NaN}Jr.prototype=tn.prototype={constructor:Jr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,r,n){this._+="Q"+ +t+","+ +e+","+(this._x1=+r)+","+(this._y1=+n)},bezierCurveTo:function(t,e,r,n,o,i){this._+="C"+ +t+","+ +e+","+ +r+","+ +n+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(t,e,r,n,o){t=+t,e=+e,r=+r,n=+n,o=+o;var i=this._x1,s=this._y1,a=r-t,u=n-e,h=i-t,l=s-e,c=h*h+l*l;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>Yr)if(Math.abs(l*a-u*h)>Yr&&o){var f=r-i,m=n-s,d=a*a+u*u,g=f*f+m*m,w=Math.sqrt(d),v=Math.sqrt(c),p=o*Math.tan((Kr-Math.acos((d+c-g)/(2*w*v)))/2),x=p/v,y=p/w;Math.abs(x-1)>Yr&&(this._+="L"+(t+x*h)+","+(e+x*l)),this._+="A"+o+","+o+",0,0,"+ +(l*f>h*m)+","+(this._x1=t+y*a)+","+(this._y1=e+y*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,r,n,o,i){t=+t,e=+e,i=!!i;var s=(r=+r)*Math.cos(n),a=r*Math.sin(n),u=t+s,h=e+a,l=1^i,c=i?n-o:o-n;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+u+","+h:(Math.abs(this._x1-u)>Yr||Math.abs(this._y1-h)>Yr)&&(this._+="L"+u+","+h),r&&(c<0&&(c=c%Qr+Qr),c>Zr?this._+="A"+r+","+r+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+r+","+r+",0,1,"+l+","+(this._x1=u)+","+(this._y1=h):c>Yr&&(this._+="A"+r+","+r+",0,"+ +(c>=Kr)+","+l+","+(this._x1=t+r*Math.cos(o))+","+(this._y1=e+r*Math.sin(o))))},rect:function(t,e,r,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +r+"v"+ +n+"h"+-r+"Z"},toString:function(){return this._}};var nn,on=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function sn(t){if(!(e=on.exec(t)))throw new Error("invalid format: "+t);var e;return new an({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function an(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function un(t,e){var r=en(t,e);if(!r)return t+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}sn.prototype=an.prototype,an.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var hn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>un(100*t,e),r:un,s:function(t,e){var r=en(t,e);if(!r)return t+"";var n=r[0],o=r[1],i=o-(nn=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+en(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ln(t){return t}var cn,fn,mn,dn=Array.prototype.map,gn=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function wn(t){var e,r,n=void 0===t.grouping||void 0===t.thousands?ln:(e=dn.call(t.grouping,Number),r=t.thousands+"",function(t,n){for(var o=t.length,i=[],s=0,a=e[0],u=0;o>0&&a>0&&(u+a+1>n&&(a=Math.max(1,n-u)),i.push(t.substring(o-=a,o+a)),!((u+=a+1)>n));)a=e[s=(s+1)%e.length];return i.reverse().join(r)}),o=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?ln:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(dn.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=sn(t)).fill,r=t.align,c=t.sign,f=t.symbol,m=t.zero,d=t.width,g=t.comma,w=t.precision,v=t.trim,p=t.type;"n"===p?(g=!0,p="g"):hn[p]||(void 0===w&&(w=12),v=!0,p="g"),(m||"0"===e&&"="===r)&&(m=!0,e="0",r="=");var x="$"===f?o:"#"===f&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",y="$"===f?i:/[%p]/.test(p)?u:"",b=hn[p],M=/[defgprs%]/.test(p);function _(t){var o,i,u,f=x,_=y;if("c"===p)_=b(t)+_,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:b(Math.abs(t),w),v&&(t=function(t){t:for(var e,r=t.length,n=1,o=-1;n<r;++n)switch(t[n]){case".":o=e=n;break;case"0":0===o&&(o=n),e=n;break;default:if(!+t[n])break t;o>0&&(o=0)}return o>0?t.slice(0,o)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==c&&(k=!1),f=(k?"("===c?c:h:"-"===c||"("===c?"":c)+f,_=("s"===p?gn[8+nn/3]:"")+_+(k&&"("===c?")":""),M)for(o=-1,i=t.length;++o<i;)if(48>(u=t.charCodeAt(o))||u>57){_=(46===u?s+t.slice(o+1):t.slice(o))+_,t=t.slice(0,o);break}}g&&!m&&(t=n(t,1/0));var $=f.length+t.length+_.length,E=$<d?new Array(d-$+1).join(e):"";switch(g&&m&&(t=n(E+t,E.length?d-_.length:1/0),E=""),r){case"<":t=f+t+_+E;break;case"=":t=f+E+t+_;break;case"^":t=E.slice(0,$=E.length>>1)+f+t+_+E.slice($);break;default:t=E+f+t+_}return a(t)}return w=void 0===w?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w)),_.toString=function(){return t+""},_}return{format:c,formatPrefix:function(t,e){var r=c(((t=sn(t)).type="f",t)),n=3*Math.max(-8,Math.min(8,Math.floor(rn(e)/3))),o=Math.pow(10,-n),i=gn[8+n/3];return function(t){return r(o*t)+i}}}}function vn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function pn(t){return+t}cn=wn({thousands:",",grouping:[3],currency:["$",""]}),fn=cn.format,mn=cn.formatPrefix;var xn=[0,1];function yn(t){return t}function bn(t,e){return(e-=t=+t)?function(r){return(r-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Mn(t,e,r){var n=t[0],o=t[1],i=e[0],s=e[1];return o<n?(n=bn(o,n),i=r(s,i)):(n=bn(n,o),i=r(i,s)),function(t){return i(n(t))}}function _n(t,e,r){var n=Math.min(t.length,e.length)-1,o=new Array(n),i=new Array(n),s=-1;for(t[n]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<n;)o[s]=bn(t[s],t[s+1]),i[s]=r(e[s],e[s+1]);return function(e){var r=Ue(t,e,1,n)-1;return i[r](o[r](e))}}function kn(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $n(){var t,e,r,n,o,i,s=xn,a=xn,u=Wr,h=yn;function l(){var t,e,r,u=Math.min(s.length,a.length);return h!==yn&&(t=s[0],e=s[u-1],t>e&&(r=t,t=e,e=r),h=function(r){return Math.max(t,Math.min(e,r))}),n=u>2?_n:Mn,o=i=null,c}function c(e){return null==e||isNaN(e=+e)?r:(o||(o=n(s.map(t),a,u)))(t(h(e)))}return c.invert=function(r){return h(e((i||(i=n(a,s.map(t),Hr)))(r)))},c.domain=function(t){return arguments.length?(s=Array.from(t,pn),l()):s.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),l()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),u=Gr,l()},c.clamp=function(t){return arguments.length?(h=!!t||yn,l()):h!==yn},c.interpolate=function(t){return arguments.length?(u=t,l()):u},c.unknown=function(t){return arguments.length?(r=t,c):r},function(r,n){return t=r,e=n,l()}}function En(){return $n()(yn,yn)}function jn(t,e,r,n){var o,i=function(t,e,r){var n=Math.abs(e-t)/Math.max(0,r),o=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/o;return i>=Be?o*=10:i>=Fe?o*=5:i>=Xe&&(o*=2),e<t?-o:o}(t,e,r);switch((n=sn(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=n.precision||isNaN(o=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(rn(e)/3)))-rn(Math.abs(t)))}(i,s))||(n.precision=o),mn(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(o=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,rn(e)-rn(t))+1}(i,Math.max(Math.abs(t),Math.abs(e))))||(n.precision=o-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(o=function(t){return Math.max(0,-rn(Math.abs(t)))}(i))||(n.precision=o-2*("%"===n.type))}return fn(n)}function Sn(t){var e=t.domain;return t.ticks=function(t){var r=e();return function(t,e,r){var n,o,i,s,a=-1;if(r=+r,(t=+t)==(e=+e)&&r>0)return[t];if((n=e<t)&&(o=t,t=e,e=o),0===(s=We(t,e,r))||!isFinite(s))return[];if(s>0){let r=Math.round(t/s),n=Math.round(e/s);for(r*s<t&&++r,n*s>e&&--n,i=new Array(o=n-r+1);++a<o;)i[a]=(r+a)*s}else{s=-s;let r=Math.round(t*s),n=Math.round(e*s);for(r/s<t&&++r,n/s>e&&--n,i=new Array(o=n-r+1);++a<o;)i[a]=(r+a)/s}return n&&i.reverse(),i}(r[0],r[r.length-1],null==t?10:t)},t.tickFormat=function(t,r){var n=e();return jn(n[0],n[n.length-1],null==t?10:t,r)},t.nice=function(r){null==r&&(r=10);var n,o,i=e(),s=0,a=i.length-1,u=i[s],h=i[a],l=10;for(h<u&&(o=u,u=h,h=o,o=s,s=a,a=o);l-- >0;){if((o=We(u,h,r))===n)return i[s]=u,i[a]=h,e(i);if(o>0)u=Math.floor(u/o)*o,h=Math.ceil(h/o)*o;else{if(!(o<0))break;u=Math.ceil(u*o)/o,h=Math.floor(h*o)/o}n=o}return t},t}function Nn(){var t=En();return t.copy=function(){return kn(t,Nn())},vn.apply(t,arguments),Sn(t)}function Rn(t){return function(){return t}}function An(t){this._context=t}function qn(t){return new An(t)}function Cn(t){return t[0]}function Tn(t){return t[1]}function Vn(t,e){var r=Rn(!0),n=null,o=qn,i=null;function s(s){var a,u,h,l=(s=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(s)).length,c=!1;for(null==n&&(i=o(h=tn())),a=0;a<=l;++a)!(a<l&&r(u=s[a],a,s))===c&&((c=!c)?i.lineStart():i.lineEnd()),c&&i.point(+t(u,a,s),+e(u,a,s));if(h)return i=null,h+""||null}return t="function"==typeof t?t:void 0===t?Cn:Rn(t),e="function"==typeof e?e:void 0===e?Tn:Rn(e),s.x=function(e){return arguments.length?(t="function"==typeof e?e:Rn(+e),s):t},s.y=function(t){return arguments.length?(e="function"==typeof t?t:Rn(+t),s):e},s.defined=function(t){return arguments.length?(r="function"==typeof t?t:Rn(!!t),s):r},s.curve=function(t){return arguments.length?(o=t,null!=n&&(i=o(n)),s):o},s.context=function(t){return arguments.length?(null==t?n=i=null:i=o(n=t),s):n},s}An.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const In=.1;class On{constructor(t){this.ctx=t,this.x=[1,6.5,7.5],this.y=[-.4,.3,.05],this.beta=[-.95,1.15,-.4],this.dataset=Ye(this.x,this.y,this.beta),this.height=this.ctx.height,this.width=this.ctx.width}makeLine(t){return Vn().x((t=>this.ctx.u(t[0]))).y((t=>this.ctx.v(t[1])))(t)}curve(t,e){const r=new Le([t],[[1]]),n=Ge(this.ctx.xmin,this.ctx.xmax+In,In),o=n.map((t=>e*r.at([t]))),i=Ye(n,o);return this.makeLine(i)}curvePoint(t,e,r){const n=new Le([t],[[1]]);return this.ctx.v(e*n.at([r]))}solutionCurve(){const t=new Le([0],[[1]]),e=Ge(this.ctx.xmin,this.ctx.xmax+In,In),r=e.map((e=>this.dataset.map((([r,n,o])=>o*t.at([r-e]))).reduce(((t,e)=>t+e),0))),n=Ye(e,r);return this.makeLine(n)}solutionPoint(t){const e=new Le([0],[[1]]),r=this.dataset.map((([r,n,o])=>o*e.at([r-t]))).reduce(((t,e)=>t+e),0);return this.ctx.v(r)}u(t){return this.ctx.u(t)}v(t){return this.ctx.v(t)}}class Pn{constructor(t,e,[r,n],[o,i]){this.width=t,this.height=e,this.xmin=r,this.xmax=n,this.xToViewport=Nn().domain([r,n]).range([0,t]),this.yToViewport=Nn().domain([o,i]).range([e,0])}x(t){return this.xToViewport.invert(t)}y(t){return this.yToViewport.invert(t)}u(t){return this.xToViewport(t)}v(t){return this.yToViewport(t)}xDomain(){return this.xToViewport.domain()}yDomain(){return this.yToViewport.domain()}}function Ln(t,e,r){const n=t.slice();return n[8]=e[r],n[10]=r,n}function zn(t,e,r){const n=t.slice();return n[8]=e[r],n}function Dn(t,e,r){const n=t.slice();return n[8]=e[r][0],n[13]=e[r][1],n[14]=e[r][2],n[10]=r,n}function Hn(t,e,r){const n=t.slice();return n[16]=e[r],n}function Un(t,e,r){const n=t.slice();return n[8]=e[r][0],n[13]=e[r][1],n[14]=e[r][2],n[10]=r,n}function Bn(t,e,r){const n=t.slice();return n[16]=e[r],n}function Fn(t,e,r){const n=t.slice();return n[8]=e[r][0],n[13]=e[r][1],n[14]=e[r][2],n}function Xn(e){let r;return{c(){r=l("div"),w(r,"class","gauss-grid svelte-1jitcyb")},m(t,e){a(t,r,e)},p:t,d(t){t&&u(r)}}}function Wn(t){let e,r,n,o,i,f,g,v,p,x,y,b,M,_=t[0]&&Gn(t),k=t[1]&&Qn(t),$=t[2]&&Jn(t),E=t[3]&&ro(t),j=t[5].x,S=[];for(let e=0;e<j.length;e+=1)S[e]=oo(Ln(t,j,e));return{c(){e=l("div"),r=l("div"),n=c("svg"),_&&_.c(),o=d(),k&&k.c(),i=d(),$&&$.c(),f=d(),E&&E.c(),x=m(),y=c("svg");for(let t=0;t<S.length;t+=1)S[t].c();w(n,"width",g=t[5].width),w(n,"height",v=t[5].height),w(n,"viewBox",p="0 0\n                  "+t[5].width+" "+t[5].height),w(n,"class","plot"),w(y,"width",b=t[5].width),w(y,"height","40"),w(y,"viewBox",M="0 0\n                  "+t[5].width+" 40"),w(r,"class","grid-item svelte-1jitcyb"),w(e,"class","gauss-grid svelte-1jitcyb")},m(t,u){a(t,e,u),s(e,r),s(r,n),_&&_.m(n,null),s(n,o),k&&k.m(n,null),s(n,i),$&&$.m(n,null),s(n,f),E&&E.m(n,null),s(r,x),s(r,y);for(let t=0;t<S.length;t+=1)S[t].m(y,null)},p(t,e){if(t[0]?_?_.p(t,e):(_=Gn(t),_.c(),_.m(n,o)):_&&(_.d(1),_=null),t[1]?k?k.p(t,e):(k=Qn(t),k.c(),k.m(n,i)):k&&(k.d(1),k=null),t[2]?$?$.p(t,e):($=Jn(t),$.c(),$.m(n,f)):$&&($.d(1),$=null),t[3]?E?E.p(t,e):(E=ro(t),E.c(),E.m(n,null)):E&&(E.d(1),E=null),32&e&&g!==(g=t[5].width)&&w(n,"width",g),32&e&&v!==(v=t[5].height)&&w(n,"height",v),32&e&&p!==(p="0 0\n                  "+t[5].width+" "+t[5].height)&&w(n,"viewBox",p),32&e){let r;for(j=t[5].x,r=0;r<j.length;r+=1){const n=Ln(t,j,r);S[r]?S[r].p(n,e):(S[r]=oo(n),S[r].c(),S[r].m(y,null))}for(;r<S.length;r+=1)S[r].d(1);S.length=j.length}32&e&&b!==(b=t[5].width)&&w(y,"width",b),32&e&&M!==(M="0 0\n                  "+t[5].width+" 40")&&w(y,"viewBox",M)},d(t){t&&u(e),_&&_.d(),k&&k.d(),$&&$.d(),E&&E.d(),h(S,t)}}}function Gn(t){let e,r=t[5].dataset,n=[];for(let e=0;e<r.length;e+=1)n[e]=Kn(Fn(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,o){if(32&o){let i;for(r=t[5].dataset,i=0;i<r.length;i+=1){const s=Fn(t,r,i);n[i]?n[i].p(s,o):(n[i]=Kn(s),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},d(t){h(n,t),t&&u(e)}}}function Kn(t){let e,r,n;return{c(){e=c("circle"),w(e,"class","data svelte-1jitcyb"),p(e,"stroke","#000000"),w(e,"cx",r=t[5].u(t[8])),w(e,"cy",n=t[5].v(t[13])),w(e,"r","5")},m(t,r){a(t,e,r)},p(t,o){32&o&&r!==(r=t[5].u(t[8]))&&w(e,"cx",r),32&o&&n!==(n=t[5].v(t[13]))&&w(e,"cy",n)},d(t){t&&u(e)}}}function Qn(t){let e,r=t[5].dataset,n=[];for(let e=0;e<r.length;e+=1)n[e]=Zn(Un(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,o){if(96&o){let i;for(r=t[5].dataset,i=0;i<r.length;i+=1){const s=Un(t,r,i);n[i]?n[i].p(s,o):(n[i]=Zn(s),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},d(t){h(n,t),t&&u(e)}}}function Yn(t){let e,r,n;return{c(){e=c("circle"),w(e,"class","point svelte-1jitcyb"),w(e,"cx",r=t[5].u(t[16])),w(e,"cy",n=t[5].curvePoint(t[8],1,t[16])),w(e,"r","3"),p(e,"stroke",t[6][t[10]])},m(t,r){a(t,e,r)},p(t,o){32&o&&r!==(r=t[5].u(t[16]))&&w(e,"cx",r),32&o&&n!==(n=t[5].curvePoint(t[8],1,t[16]))&&w(e,"cy",n)},d(t){t&&u(e)}}}function Zn(t){let e,r,n,o=t[5].x,i=[];for(let e=0;e<o.length;e+=1)i[e]=Yn(Bn(t,o,e));return{c(){e=c("path");for(let t=0;t<i.length;t+=1)i[t].c();n=d(),w(e,"class","curve svelte-1jitcyb"),w(e,"d",r=t[5].curve(t[8],1)),p(e,"stroke",t[6][t[10]])},m(t,r){a(t,e,r);for(let e=0;e<i.length;e+=1)i[e].m(t,r);a(t,n,r)},p(t,s){if(32&s&&r!==(r=t[5].curve(t[8],1))&&w(e,"d",r),96&s){let e;for(o=t[5].x,e=0;e<o.length;e+=1){const r=Bn(t,o,e);i[e]?i[e].p(r,s):(i[e]=Yn(r),i[e].c(),i[e].m(n.parentNode,n))}for(;e<i.length;e+=1)i[e].d(1);i.length=o.length}},d(t){t&&u(e),h(i,t),t&&u(n)}}}function Jn(t){let e,r=t[5].dataset,n=[];for(let e=0;e<r.length;e+=1)n[e]=eo(Dn(t,r,e));return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=d()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);a(t,e,r)},p(t,o){if(96&o){let i;for(r=t[5].dataset,i=0;i<r.length;i+=1){const s=Dn(t,r,i);n[i]?n[i].p(s,o):(n[i]=eo(s),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},d(t){h(n,t),t&&u(e)}}}function to(t){let e,r,n;return{c(){e=c("circle"),w(e,"class","point svelte-1jitcyb"),w(e,"cx",r=t[5].u(t[16])),w(e,"cy",n=t[5].curvePoint(t[8],t[14],t[16])),w(e,"r","3"),p(e,"stroke",t[6][t[10]])},m(t,r){a(t,e,r)},p(t,o){32&o&&r!==(r=t[5].u(t[16]))&&w(e,"cx",r),32&o&&n!==(n=t[5].curvePoint(t[8],t[14],t[16]))&&w(e,"cy",n)},d(t){t&&u(e)}}}function eo(t){let e,r,n,o=t[5].x,i=[];for(let e=0;e<o.length;e+=1)i[e]=to(Hn(t,o,e));return{c(){e=c("path");for(let t=0;t<i.length;t+=1)i[t].c();n=d(),w(e,"class","curve svelte-1jitcyb"),p(e,"stroke",t[6][t[10]]),w(e,"d",r=t[5].curve(t[8],t[14]))},m(t,r){a(t,e,r);for(let e=0;e<i.length;e+=1)i[e].m(t,r);a(t,n,r)},p(t,s){if(32&s&&r!==(r=t[5].curve(t[8],t[14]))&&w(e,"d",r),96&s){let e;for(o=t[5].x,e=0;e<o.length;e+=1){const r=Hn(t,o,e);i[e]?i[e].p(r,s):(i[e]=to(r),i[e].c(),i[e].m(n.parentNode,n))}for(;e<i.length;e+=1)i[e].d(1);i.length=o.length}},d(t){t&&u(e),h(i,t),t&&u(n)}}}function ro(t){let e,r,n,o=t[5].x,i=[];for(let e=0;e<o.length;e+=1)i[e]=no(zn(t,o,e));return{c(){e=c("path");for(let t=0;t<i.length;t+=1)i[t].c();n=d(),w(e,"class","solution-curve svelte-1jitcyb"),w(e,"d",r=t[5].solutionCurve())},m(t,r){a(t,e,r);for(let e=0;e<i.length;e+=1)i[e].m(t,r);a(t,n,r)},p(t,s){if(32&s&&r!==(r=t[5].solutionCurve())&&w(e,"d",r),32&s){let e;for(o=t[5].x,e=0;e<o.length;e+=1){const r=zn(t,o,e);i[e]?i[e].p(r,s):(i[e]=no(r),i[e].c(),i[e].m(n.parentNode,n))}for(;e<i.length;e+=1)i[e].d(1);i.length=o.length}},d(t){t&&u(e),h(i,t),t&&u(n)}}}function no(t){let e,r,n;return{c(){e=c("circle"),w(e,"class","solution-pt svelte-1jitcyb"),w(e,"cx",r=t[5].u(t[8])),w(e,"cy",n=t[5].solutionPoint(t[8])),w(e,"r","3")},m(t,r){a(t,e,r)},p(t,o){32&o&&r!==(r=t[5].u(t[8]))&&w(e,"cx",r),32&o&&n!==(n=t[5].solutionPoint(t[8]))&&w(e,"cy",n)},d(t){t&&u(e)}}}function oo(t){let e,r,n,o,i;return{c(){e=c("text"),r=f("x"),n=c("tspan"),o=f(t[10]),w(n,"class","ss svelte-1jitcyb"),w(e,"x",i=t[5].u(t[8])),w(e,"y","25")},m(t,i){a(t,e,i),s(e,r),s(e,n),s(n,o)},p(t,r){32&r&&i!==(i=t[5].u(t[8]))&&w(e,"x",i)},d(t){t&&u(e)}}}function io(e){let r;function n(t,e){return t[4]?Wn:Xn}let o=n(e),i=o(e);return{c(){i.c(),r=d()},m(t,e){i.m(t,e),a(t,r,e)},p(t,[e]){o===(o=n(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(r.parentNode,r)))},i:t,o:t,d(t){i.d(t),t&&u(r)}}}function so(t,e,r){let n,o,{showdata:i=!1}=e,{showbasis:s=!1}=e,{showscaled:a=!1}=e,{showsolution:u=!1}=e,{contextwidth:h}=e;return t.$$set=t=>{"showdata"in t&&r(0,i=t.showdata),"showbasis"in t&&r(1,s=t.showbasis),"showscaled"in t&&r(2,a=t.showscaled),"showsolution"in t&&r(3,u=t.showsolution),"contextwidth"in t&&r(4,h=t.contextwidth)},t.$$.update=()=>{16&t.$$.dirty&&r(7,n=new Pn(h||0,350,[0,10],[-.5,.5])),128&t.$$.dirty&&r(5,o=new On(n))},[i,s,a,u,h,o,["#33cc33","#cccc00","#cc0000"],n]}class ao extends H{constructor(t){super(),D(this,t,so,io,i,{showdata:0,showbasis:1,showscaled:2,showsolution:3,contextwidth:4})}}function uo(t){let e,r,n,o,i,h,c,f,d,w,x,y,M,_,k,$,E,j,S,R,A,q,C,T,z,D,H,U,B,F,X,W,G,K,Q,Y,Z,J,tt,et,rt,nt,ot,it,st,at,ut,ht,lt,ct,ft,mt,dt,gt,wt,vt,pt,xt,yt,bt,Mt,_t,kt,$t,Et,jt,St,Nt,Rt,At,qt,Ct,Tt,Vt,It;return k=new ao({props:{showdata:"true",contextwidth:t[0]}}),q=new ao({props:{showdata:"true",showbasis:"true",contextwidth:t[0]}}),W=new ao({props:{showdata:"true",showbasis:"true",contextwidth:t[0]}}),at=new ao({props:{showdata:"true",showscaled:"true",contextwidth:t[0]}}),bt=new ao({props:{showdata:"true",showscaled:"true",showsolution:"true",contextwidth:t[0]}}),{c(){e=l("main"),r=l("d-front-matter"),r.innerHTML='<script type="text/json">{\n        "title": "Introduction to Kernel Regression",\n      "description": "A gentle introduction to Kernel Regression",\n      "authors": [\n      {\n          "author": "Henry Bigelow"\n      }\n      ]\n      }<\/script>',n=m(),o=l("d-title"),o.innerHTML="<h1>Introduction to Kernel Regression</h1>",i=m(),h=l("d-byline"),c=m(),f=l("d-article"),d=l("h3"),d.textContent="A problem for Kernel Regression to solve",w=m(),x=l("p"),x.innerHTML="Consider the following:  you are given a dataset <d-math>\\textbf{D} =\n            \\{(x_i, y_i)\\}_{i \\in (1, \\cdots, n)}</d-math>, with\n        <d-math>\\mathcal{X} \\times \\mathcal{Y} \\in \\mathbb{R} \\times\n            \\mathbb{R}</d-math>.  There is nothing known about the true\n        relationship between <d-math>X</d-math> and <d-math>Y</d-math> except that\n        it is deterministic, continuous, and with some bounded first derivative.\n        In other words, &quot;smooth&quot;.  So you would like to find a smooth function to\n        fit the data.",y=m(),M=l("figure"),_=l("d-figure"),O(k.$$.fragment),E=m(),j=l("p"),j.innerHTML="With this smoothness goal in mind, you have decided to create a function\n        which is a linear combination of <d-math>n</d-math> gaussians, each one\n        centered at one of the <d-math>x_i</d-math>.  Since the gaussians themselves\n        are smooth, the resulting linear combination will also be smooth.  The goal\n        will be to adjust the weight of each gaussian and hopfully fit the\n        <d-math>y_i</d-math> at each point <d-math>x_i</d-math>.",S=m(),R=l("figure"),A=l("d-figure"),O(q.$$.fragment),C=m(),T=l("p"),T.innerHTML="Here are the functions we have chosen to use, now shown with the data.\n        Notice that there is one function per data point, centered at the\n        <d-math>x_i</d-math> coordinate.  The goal will be to find some weight vector\n        <d-math>\\beta</d-math> that combines these together to form a curve that goes through all of\n        the <d-math>y_i</d-math> values.",z=m(),D=l("p"),D.innerHTML="How do we find <d-math>\\beta</d-math>?  At first it seems like a hard problem.  We could\n        easily weight the <d-math>i^{th}</d-math> function so that its peak equals\n        <d-math>y_i</d-math>.  But, the resulting function would miss the\n        <d-math>y_i</d-math> due to the additional contribution of the other functions\n        at that point, since these functions are non-zero everywhere.  Every time you\n        adjust one of the <d-math>\\beta_i</d-math>, the values of the solution function changes\n        everywhere, so it isn&#39;t obvious how to find a solution, or if one exists at\n        all.",H=m(),U=l("h3"),U.textContent="The approach",B=m(),F=l("figure"),X=l("d-figure"),O(W.$$.fragment),G=m(),K=l("p"),K.innerHTML="For the moment, we are only concerned with the values of the solution\n        function at positions <d-math>x_i</d-math>.  Each value of the solution\n        function at <d-math>x_i</d-math> will be the same linear combination of the\n        curve heights at <d-math>x_i</d-math>, so we have highlighted them here.",Q=m(),Y=l("p"),Y.innerHTML="Recall from linear algebra, that if you have a set of <d-math>n</d-math>\n        linearly independent vectors in <d-math>\\mathbb{R}^n</d-math>, those vectors\n        are said to <i>span</i>  <d-math>\\mathbb{R}^n</d-math>. This means every other\n        vector in <d-math>\\mathbb{R}^n</d-math> may be formed as a unique linear\n        combination of these spanning vectors.",Z=m(),J=l("p"),J.innerHTML="Looking at the graph again, you can now see that each curve, evaluated at\n        the <d-math>x_i</d-math> in order, provides one of these spanning vectors (this\n        isn&#39;t proven but let&#39;s for the moment accept it).  And, the set of\n        <d-math>y_i</d-math> values is just our target vector.  So, all we need is to\n        express it as the unique linear combination <d-math>\\beta</d-math> which must\n        exist.",tt=m(),et=l("p"),et.textContent="To make this explicit, let:",rt=m(),nt=l("d-math"),nt.textContent="\\begin{aligned}\n            k_i(x) & \\equiv \\text{curves centered at $x_i$} \\\\\n            f(x) & \\equiv \\beta_1 k_1(x) + \\cdots + \\beta_n k_n(x) & \\text{the solution function} \\\\[1em]\n            D_x & \\equiv (x_1, \\cdots, x_n) & \\text{vector of $x_i$ values in the dataset} \\\\\n            (k_i)_{D_x} & \\equiv (k_i(x_1), \\cdots, k_i(x_n)) & \\text{values of $k_i$ along $D_x$ (the spanning vectors)} \\\\\n            (f)_{D_x} & \\equiv (f(x_1), \\cdots, f(x_n)) & \\text{values of $f$ along $D_x$ (the target vector)} \\\\\n            \\end{aligned}",ot=m(),it=l("figure"),st=l("d-figure"),O(at.$$.fragment),ut=m(),ht=l("p"),ht.innerHTML="Now, shown above are the same curves, each scaled by a candidate\n        <d-math>\\beta</d-math>.  The goal is for the sum of these scaled curves to form\n        a function that goes through the <d-math>y_i</d-math>.  Using the linear\n        algebra fact that an expansion exists, we can assert that there exists such a\n        <d-math>\\beta</d-math>, formally:",lt=m(),ct=l("d-math"),ct.textContent="\\begin{aligned}\n            (f)_{D_x} = \\beta_1 (k_1)_{D_x} + \\cdots + \\beta_n (k_n)_{D_x} = Y & \\\\\n            \\end{aligned}",ft=m(),mt=l("p"),mt.textContent="Or, in matrix notation, let:",dt=m(),gt=l("d-math"),gt.textContent="\\begin{aligned}\n            K & \\equiv\n            \\begin{bmatrix}\n            - (k_1)_{D_x} - \\\\\n            - (k_2)_{D_x} - \\\\\n            \\cdots \\\\\n            - (k_n)_{D_x} -\n            \\end{bmatrix} \\\\[1em]\n            \\beta & \\equiv [\\beta_1, \\cdots, \\beta_n] & \\text{row vector} \\\\[1em]\n            \\end{aligned}",wt=m(),vt=l("p"),vt.innerHTML="So, the unique function that goes through all values <d-math>y_i</d-math> uses <d-math>\\beta</d-math> that\n        satisfies <d-math>\\beta K = Y</d-math>.",pt=m(),xt=l("figure"),yt=l("d-figure"),O(bt.$$.fragment),Mt=m(),_t=l("h3"),_t.textContent="Where is the Kernel?",kt=m(),$t=l("p"),$t.innerHTML="Notice that the family of functions <d-math>k_i(x)</d-math> are all related by a\n        two-argument gaussian formula (if we consider <d-math>\\sigma</d-math> to be constant) with\n        signature <d-math>\\mathcal{X} \\times \\mathcal{X} \\rightarrow \\mathbb{R}</d-math>.  One\n        argument is the mean parameter, and the other the position.   We could call\n        that function <d-math>k</d-math> (with no subscript):",Et=m(),jt=l("d-math"),jt.textContent="\\begin{aligned}\n            k(x, x') & \\equiv \\tfrac{1}{\\sigma \\sqrt{2 \\pi}} e^{-\\tfrac{(x - x')^2}{2 \\sigma^2}} & : \\mathcal{X} \\times \\mathcal{X} \\rightarrow \\mathbb{R} \\\\\n            \\end{aligned}",St=m(),Nt=l("p"),Nt.innerHTML="More generally, we designed our solution function at the very beginning to\n        be a linear combination of functions which were 1) parameterized by a point in\n        <d-math>\\mathcal{X}</d-math> and 2) defined over domain\n        <d-math>\\mathcal{X}</d-math>.  Implicitly, the two-argument function that was\n        needed to define these functions was already there.",Rt=m(),At=l("p"),At.innerHTML="This function <d-math>k(x, x&#39;)</d-math> is known as a &quot;kernel&quot;.  We can now express the\n        matrix, and our solution function in terms of the kernel:",qt=m(),Ct=l("d-math"),Ct.textContent="\\begin{aligned}\n            K & \\equiv\n            \\begin{bmatrix}\n            k(x_1, x_1), \\cdots, k(x_1, x_n) \\\\\n            k(x_2, x_1), \\cdots, k(x_2, x_n) \\\\\n            \\cdots \\\\\n            k(x_n, x_1), \\cdots, k(x_n, x_n) \n            \\end{bmatrix} \\\\[1em]\n            f(x) & \\equiv \\sum_i { \\beta_i k(x_i, x) }\\\\\n            \\end{aligned}",Tt=m(),Vt=l("d-appendix"),p(o,"padding-bottom","0"),N((()=>t[1].call(M))),v(nt,"block",""),v(ct,"block",""),v(gt,"block",""),v(jt,"block",""),v(Ct,"block","")},m(m,v){a(m,e,v),s(e,r),s(e,n),s(e,o),s(e,i),s(e,h),s(e,c),s(e,f),s(f,d),s(f,w),s(f,x),s(f,y),s(f,M),s(M,_),P(k,_,null),$=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const r=l("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const n=b();let o;return n?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=g(window,"message",(t=>{t.source===r.contentWindow&&e()}))):(r.src="about:blank",r.onload=()=>{o=g(r.contentWindow,"resize",e)}),s(t,r),()=>{(n||o&&r.contentWindow)&&o(),u(r)}}(M,t[1].bind(M)),s(f,E),s(f,j),s(f,S),s(f,R),s(R,A),P(q,A,null),s(f,C),s(f,T),s(f,z),s(f,D),s(f,H),s(f,U),s(f,B),s(f,F),s(F,X),P(W,X,null),s(f,G),s(f,K),s(f,Q),s(f,Y),s(f,Z),s(f,J),s(f,tt),s(f,et),s(f,rt),s(f,nt),s(f,ot),s(f,it),s(it,st),P(at,st,null),s(f,ut),s(f,ht),s(f,lt),s(f,ct),s(f,ft),s(f,mt),s(f,dt),s(f,gt),s(f,wt),s(f,vt),s(f,pt),s(f,xt),s(xt,yt),P(bt,yt,null),s(f,Mt),s(f,_t),s(f,kt),s(f,$t),s(f,Et),s(f,jt),s(f,St),s(f,Nt),s(f,Rt),s(f,At),s(f,qt),s(f,Ct),s(e,Tt),s(e,Vt),It=!0},p(t,[e]){const r={};1&e&&(r.contextwidth=t[0]),k.$set(r);const n={};1&e&&(n.contextwidth=t[0]),q.$set(n);const o={};1&e&&(o.contextwidth=t[0]),W.$set(o);const i={};1&e&&(i.contextwidth=t[0]),at.$set(i);const s={};1&e&&(s.contextwidth=t[0]),bt.$set(s)},i(t){It||(V(k.$$.fragment,t),V(q.$$.fragment,t),V(W.$$.fragment,t),V(at.$$.fragment,t),V(bt.$$.fragment,t),It=!0)},o(t){I(k.$$.fragment,t),I(q.$$.fragment,t),I(W.$$.fragment,t),I(at.$$.fragment,t),I(bt.$$.fragment,t),It=!1},d(t){t&&u(e),L(k),$(),L(q),L(W),L(at),L(bt)}}}function ho(t,e,r){let n;return[n,function(){n=this.clientWidth,r(0,n)}]}return new class extends H{constructor(t){super(),D(this,t,ho,uo,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
